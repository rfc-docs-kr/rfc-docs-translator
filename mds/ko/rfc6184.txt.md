

```text
Internet Engineering Task Force (IETF)                        Y.-K. Wang
Request for Comments: 6184                                       R. Even
Obsoletes: 3984                                      Huawei Technologies
Category: Standards Track                                  T. Kristensen
ISSN: 2070-1721                                                 Tandberg
                                                                R. Jesup
                                                WorldGate Communications
                                                                May 2011

                   RTP Payload Format for H.264 Video
```

---
# **Abstract**

이 메모는 SVC\(Scalable Video Coding\) 확장 및 Multiview Video Coding 확장을 제외하고 ITU-T 권장 H.264 비디오 코덱 및 기술적으로 동일한 ISO/IEC 국제 표준 14496-10 비디오 코덱에 대한 RTP 페이로드 형식을 설명합니다. RTP 페이로드 형식은 다른 곳에서 정의됩니다. RTP 페이로드 형식은 각 RTP 페이로드에서 H.264 비디오 인코더에 의해 생성된 하나 이상의 NALU\(Network Abstraction Layer Unit\)의 패킷화를 허용합니다. 페이로드 형식은 단순한 낮은 비트율 대화 사용부터 인터리브 전송을 통한 인터넷 비디오 스트리밍, 높은 비트율 주문형 비디오에 이르기까지 다양한 애플리케이션을 지원하므로 적용 가능성이 넓습니다.

이 메모는 RFC 3984를 폐기합니다. RFC 3984의 변경 사항은 섹션 14에 요약되어 있습니다. RFC 3984에 대한 이전 버전과의 호환성 문제는 섹션 15에서 논의됩니다.

---
# **Status of This Memo**

이것은 인터넷 표준 추적 문서입니다.

이 문서는 IETF\(Internet Engineering Task Force\)의 제품입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 출판 승인을 받았습니다. 인터넷 표준에 대한 자세한 내용은 RFC 5741의 섹션 2에서 확인할 수 있습니다.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 http://www.rfc-editor.org/info/rfc6184에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2011 IETF Trust 및 문서 작성자로 확인된 사람. 판권 소유.

이 문서는 이 문서의 발행일에 유효한 BCP 78 및 IETF 문서에 관한 IETF 트러스트의 법적 조항\(http://trustee.ietf.org/license-info\)의 적용을 받습니다. 이 문서와 관련된 귀하의 권리 및 제한 사항을 설명하므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출한 코드 구성 요소는 Trust Legal Provisions의 섹션 4.e에 설명된 대로 Simplified BSD License 텍스트를 포함해야 하며 Simplified BSD License에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1. Introduction ....................................................4
      1.1. The H.264 Codec ............................................4
      1.2. Parameter Set Concept ......................................5
      1.3. Network Abstraction Layer Unit Types .......................6
   2. Conventions .....................................................7
   3. Scope ...........................................................7
   4. Definitions and Abbreviations ...................................7
      4.1. Definitions ................................................7
      4.2. Abbreviations ..............................................9
   5. RTP Payload Format .............................................10
      5.1. RTP Header Usage ..........................................10
      5.2. Payload Structures ........................................12
      5.3. NAL Unit Header Usage .....................................13
      5.4. Packetization Modes .......................................16
      5.5. Decoding Order Number (DON) ...............................17
      5.6. Single NAL Unit Packet ....................................19
      5.7. Aggregation Packets .......................................20
           5.7.1. Single-Time Aggregation Packet (STAP) ..............22
           5.7.2. Multi-Time Aggregation Packets (MTAPs) .............25
      5.8. Fragmentation Units (FUs) .................................29
   6. Packetization Rules ............................................33
      6.1. Common Packetization Rules ................................33
      6.2. Single NAL Unit Mode ......................................34
      6.3. Non-Interleaved Mode ......................................34
      6.4. Interleaved Mode ..........................................34
   7. De-Packetization Process .......................................35
      7.1. Single NAL Unit and Non-Interleaved Mode ..................35
      7.2. Interleaved Mode ..........................................35
           7.2.1. Size of the De-Interleaving Buffer .................36
           7.2.2. De-Interleaving Process ............................36
      7.3. Additional De-Packetization Guidelines ....................38
   8. Payload Format Parameters ......................................39
      8.1. Media Type Registration ...................................39
      8.2. SDP Parameters ............................................57
           8.2.1. Mapping of Payload Type Parameters to SDP ..........57
           8.2.2. Usage with the SDP Offer/Answer Model ..............58
           8.2.3. Usage in Declarative Session Descriptions ..........66
      8.3. Examples ..................................................68
      8.4. Parameter Set Considerations ..............................75
      8.5. Decoder Refresh Point Procedure Using In-Band
           Transport of Parameter Sets (Informative)..................78
           8.5.1. IDR Procedure to Respond to a Request for
                  a Decoder Refresh Point ............................78
           8.5.2. Gradual Recovery Procedure to Respond to
                  a Request for a Decoder Refresh Point ..............79
   9. Security Considerations ........................................79
   10. Congestion Control ............................................80
   11. IANA Considerations ...........................................81
   12. Informative Appendix: Application Examples ....................81
      12.1. Video Telephony According to Annex A of ITU-T
            Recommendation H.241 .....................................81
      12.2. Video Telephony, No Slice Data Partitioning, No
            NAL Unit Aggregation .....................................82
      12.3. Video Telephony, Interleaved Packetization Using
            NAL Unit Aggregation .....................................82
      12.4. Video Telephony with Data Partitioning ...................83
      12.5. Video Telephony or Streaming with FUs and Forward
            Error Correction .........................................83
      12.6. Low Bitrate Streaming ....................................86
      12.7. Robust Packet Scheduling in Video Streaming ..............86
   13. Informative Appendix: Rationale for Decoding Order Number .....87
      13.1. Introduction .............................................87
      13.2. Example of Multi-Picture Slice Interleaving ..............88
      13.3. Example of Robust Packet Scheduling ......................89
      13.4. Robust Transmission Scheduling of Redundant Coded
            Slices ...................................................93
      13.5. Remarks on Other Design Possibilities ....................94
   14. Changes from RFC 3984 .........................................94
   15. Backward Compatibility to RFC 3984 ............................96
   16. Acknowledgements ..............................................98
   17. References ....................................................98
      17.1. Normative References .....................................98
      17.2. Informative References ...................................99
```

---
## **1.  Introduction**

이 메모는 ITU-T 권장사항 H.264 \[1\] 및 ISO/IEC 국제 표준 14496-10 \[2\]\(둘 모두 AVC\(Advanced Video Coding\)라고도 함\)로 알려진 비디오 코딩 표준에 대한 RTP 페이로드 사양을 지정합니다. 이 메모에서는 코덱과 표준에 H.264라는 이름이 사용되지만, 이 메모는 코딩 표준에 해당하는 ISO/IEC에도 동일하게 적용됩니다.

이 메모는 RFC 3984를 폐기합니다. RFC 3984의 변경 사항은 섹션 14에 요약되어 있습니다. RFC 3984에 대한 이전 버전과의 호환성 문제는 섹션 15에서 논의됩니다.

---
### **1.1.  The H.264 Codec**

H.264 비디오 코덱은 낮은 비트율 인터넷 스트리밍 애플리케이션부터 거의 무손실 코딩을 사용하는 HDTV 방송 및 디지털 시네마 애플리케이션에 이르기까지 모든 형태의 디지털 압축 비디오를 포괄하는 매우 광범위한 애플리케이션 범위를 가지고 있습니다. 현재 기술 상태와 비교하여 H.264의 전반적인 성능은 50% 이상의 비트레이트 절감 효과가 보고된 바 있습니다. 예를 들어, 디지털 위성 TV 품질은 현재 MPEG 2 비디오의 작동 지점이 약 3.5Mbit/s인 것과 비교하여 1.5Mbit/s로 달성 가능한 것으로 보고되었습니다\[10\].

코덱 사양\[1\] 자체에서는 VCL\(비디오 코딩 계층\)과 NAL\(네트워크 추상화 계층\)을 개념적으로 구분합니다. VCL에는 코덱의 신호 처리 기능이 포함되어 있습니다. 변환, 양자화, 움직임 보상 예측과 같은 메커니즘; 그리고 루프 필터. 이는 모션 보상 및 잔차 신호의 변환 코딩과 함께 화면 간 예측을 사용하는 매크로블록 기반 코더인 오늘날 대부분의 비디오 코덱의 일반적인 개념을 따릅니다. VCL 인코더는 슬라이스, 즉 정수 개의 매크로블록의 매크로블록 데이터와 슬라이스 헤더의 정보\(슬라이스의 첫 번째 매크로블록의 공간 주소, 초기 양자화 매개변수 및 유사한 정보를 포함\)를 포함하는 비트 문자열을 출력합니다. 슬라이스의 매크로블록은 슬라이스 그룹의 구문을 사용하여 다른 매크로블록 할당이 지정되지 않는 한 스캔 순서로 정렬됩니다. 화면 내 예측은 슬라이스 내에서만 사용됩니다. 자세한 내용은 \[10\]에서 제공됩니다.

NAL 인코더는 VCL 인코더의 슬라이스 출력을 NALU\(Network Abstraction Layer Unit\)로 캡슐화합니다. NALU는 패킷 네트워크를 통한 전송이나 패킷 지향 프로토콜에 사용하기에 적합합니다.

멀티플렉스 환경. H.264의 부록 B는 바이트스트림 지향 네트워크를 통해 그러한 NALU를 전송하는 캡슐화 프로세스를 정의합니다. 이 메모의 범위에서 부록 B는 관련이 없습니다.

내부적으로 NAL은 NAL 단위를 사용합니다. NAL 단위는 1바이트 헤더와 페이로드 바이트 문자열로 구성됩니다. 헤더는 NAL 단위의 유형, NAL 단위 페이로드의 비트 오류 또는 구문 위반의 \(잠재적\) 존재, 디코딩 프로세스에 대한 NAL 단위의 상대적 중요성에 관한 정보를 나타냅니다. 이 RTP 페이로드 사양은 NAL 단위 페이로드의 비트열을 인식하지 못하도록 설계되었습니다.

H.264의 주요 속성 중 하나는 전송 시간, 디코딩 시간, 슬라이스와 영상의 샘플링 또는 프리젠테이션 시간을 완전히 분리하는 것입니다. H.264에 지정된 디코딩 프로세스는 시간을 인식하지 못하며 H.264 구문은 건너뛴 프레임 수와 같은 정보를 전달하지 않습니다\(이전 비디오 압축 표준의 임시 참조 형식에서 일반적임\). 또한 많은 그림에 영향을 미치고 따라서 본질적으로 시간을 초월하는 NAL 단위가 있습니다. 이러한 이유로 RTP 타임스탬프를 처리하려면 샘플링 또는 프리젠테이션 시간이 정의되지 않았거나 전송 시간에 알 수 없는 NAL 단위에 대해 몇 가지 특별한 고려 사항이 필요합니다.

---
### **1.2.  Parameter Set Concept**

H.264의 매우 기본적인 설계 개념 중 하나는 자체 포함 패킷을 생성하여 RFC 4629 \[11\] 또는 MPEG-4 Visual의 헤더 확장 코드\(HEC\) \[12\]의 헤더 복제와 같은 메커니즘을 불필요하게 만드는 것입니다. 이는 미디어 스트림에서 둘 이상의 슬라이스와 관련된 정보를 분리함으로써 달성되었습니다. 이 상위 계층 메타 정보는 슬라이스 패킷이 포함된 RTP 패킷 스트림에서 미리 안정적으로 비동기식으로 전송되어야 합니다. \(이 정보를 대역 내로 전송하기 위한 규정은 목적에 적합한 대역 외 전송 채널이 없는 애플리케이션에도 제공됩니다.\) 상위 수준 매개변수의 조합을 매개변수 세트라고 합니다. H.264 사양에는 시퀀스 매개변수 세트와 그림 매개변수 세트라는 두 가지 유형의 매개변수 세트가 포함됩니다. 활성 시퀀스 매개변수 세트는 코딩된 비디오 시퀀스 전반에 걸쳐 변경되지 않고 유지되며, 활성 화면 매개변수 세트는 코딩된 화면 내에서 변경되지 않고 유지됩니다. 시퀀스 및 그림 매개변수 집합 구조에는 그림 크기, 사용된 선택적 코딩 모드, 매크로블록 대 슬라이스 그룹 맵과 같은 정보가 포함되어 있습니다.

매개변수 세트 업데이트를 슬라이스 패킷 스트림에 동기적으로 전송할 필요 없이 사진 매개변수\(예: 사진 크기\)를 변경할 수 있도록 인코더와 디코더는 둘 이상의 시퀀스 및 사진 매개변수 세트 목록을 유지할 수 있습니다. 각 슬라이스 헤더에는 사용할 시퀀스 및 그림 매개변수 집합을 나타내는 코드워드가 포함되어 있습니다.

이 메커니즘을 사용하면 패킷 스트림에서 매개변수 세트 전송을 분리하고 외부 수단\(예: 기능 교환의 부작용\) 또는 \(신뢰할 수 있거나 신뢰할 수 없는\) 제어 프로토콜을 통해 매개변수 세트를 전송할 수 있습니다. 전송되지 않지만 애플리케이션 설계 사양에 의해 수정될 수도 있습니다.

---
### **1.3.  Network Abstraction Layer Unit Types**

NAL 설계에 대한 튜토리얼 정보는 \[13\], \[14\], \[15\]에서 찾을 수 있습니다.

모든 NAL 단위는 이 RTP 페이로드 형식의 페이로드 헤더 역할도 하는 단일 NAL 단위 유형 옥텟으로 구성됩니다. NAL 유닛의 페이로드에 대한 설명은 다음과 같다.

NAL 단위 유형 옥텟의 구문과 의미는 \[1\]에 명시되어 있지만 NAL 단위 유형 옥텟의 필수 속성은 아래에 요약되어 있습니다. NAL 단위 유형 옥텟은 다음과 같은 형식을 갖습니다.

```text
      +---------------+
      |0|1|2|3|4|5|6|7|
      +-+-+-+-+-+-+-+-+
      |F|NRI|  Type   |
      +---------------+
```

H.264 사양에 명시된 NAL 단위 유형 옥텟 구성요소의 의미는 아래에 간략하게 설명되어 있습니다.

F: 1비트

- 금지된\_제로비트. H.264 사양에서는 값 1을 구문 위반으로 선언합니다.

NRI: 2비트

- nal\_ref\_idc. 00의 값은 NAL 단위의 콘텐츠가 화면 간 예측을 위해 참조 화면을 재구성하는 데 사용되지 않음을 나타냅니다. 이러한 NAL 단위는 참조 화면의 무결성을 위험에 빠뜨리지 않고 폐기될 수 있습니다. 00보다 큰 값은 참조 픽처의 무결성을 유지하기 위해 NAL 단위의 디코딩이 필요함을 나타냅니다.

유형: 5비트

- nal\_unit\_type. 이 구성 요소는 \[1\]의 표 7-1과 이 메모의 뒷부분에 정의된 대로 NAL 단위 페이로드 유형을 지정합니다. 현재 정의된 모든 NAL 단위 유형과 그 의미에 대한 참조는 \[1\]의 섹션 7.4.1을 참조하세요.

이 메모는 섹션 5.2에 제시된 새로운 NAL 단위 유형을 소개합니다. 이 메모에 정의된 NAL 단위 유형은 \[1\]에 지정되지 않은 것으로 표시되어 있습니다. 더욱이, 이 사양은 섹션 5.3에 설명된 대로 F와 NRI의 의미를 확장합니다.

---
## **2.  Conventions**

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119 \[4\]에 설명된 대로 해석됩니다.\(MUST NOT\)

이 사양에서는 비트 필드를 처리할 때 비트를 설정하고 지우는 개념을 사용합니다. 비트를 설정하는 것은 해당 비트에 1\(On\) 값을 할당하는 것과 같습니다. 비트를 지우는 것은 해당 비트에 0\(꺼짐\) 값을 할당하는 것과 같습니다.

---
## **3.  Scope**

이 페이로드 사양은 H.264의 부록 B에서 논의된 비트스트림 형식이 아닌 RTP를 통해 "네이키드" H.264 NAL 단위 스트림을 전달하는 데에만 사용할 수 있습니다. 아마도 이 사양의 첫 번째 애플리케이션은 대화형 멀티미디어 분야, 화상 통화 또는 화상 회의에 있을 것이지만 페이로드 형식은 인터넷 스트리밍 및 IP를 통한 TV와 같은 다른 애플리케이션에도 적용됩니다.

---
## **4.  Definitions and Abbreviations**
---
### **4.1.  Definitions**

이 문서에서는 \[1\]의 정의를 사용합니다. 편의상 \[1\]에 정의된 다음 용어를 요약합니다.

- 액세스 단위: 항상 기본 코딩된 화면을 포함하는 NAL 단위 세트입니다. 1차 코딩된 픽처에 더하여, 액세스 단위는 또한 하나 이상의 중복 코딩된 픽처 또는 코딩된 픽처의 슬라이스 또는 슬라이스 데이터 파티션을 포함하지 않는 다른 NAL 단위를 포함할 수도 있습니다. 액세스 유닛을 디코딩하면 항상 디코딩된 화면이 생성됩니다.

- 코딩된 비디오 시퀀스: 디코딩 순서에 따라 순간 디코딩 새로 고침\(IDR\) 액세스 단위와 후속 IDR을 포함하지 않는 모든 후속 액세스 단위를 포함하는 0개 이상의 비IDR 액세스 단위로 구성된 액세스 단위 시퀀스 액세스 유닛.

- IDR 액세스 단위: 기본 코딩된 화면이 IDR 화면인 액세스 단위입니다.

- IDR 그림: 디코딩 프로세스에서 "재설정"을 유발하는 I 또는 SI 슬라이스 유형의 슬라이스만 포함하는 코딩된 그림입니다. IDR 픽처의 디코딩 후, 디코딩 순서에 따라 다음의 모든 코딩된 픽처는 IDR 픽처 이전에 디코딩된 임의의 픽처로부터 인터 예측 없이 디코딩될 수 있다.

- 기본 코딩된 화면: H.264를 따르는 비트스트림에 대한 디코딩 프로세스에 의해 사용되는 화면의 코딩된 표현입니다. 기본 코딩된 화면에는 화면의 모든 매크로블록이 포함됩니다.

- 중복 코딩된 그림: 그림 또는 그림의 일부를 코딩한 표현입니다. 중복 코딩된 화면의 내용은 H.264를 준수하는 비트스트림에 대한 디코딩 프로세스에서 사용되지 않습니다. 중복 코딩된 화면의 콘텐츠는 오류 또는 손실을 포함하는 비트스트림에 대한 디코딩 프로세스에 의해 사용될 수 있습니다.

- VCL NAL 단위: 코딩된 슬라이스 및 코딩된 데이터 파티션 NAL 단위를 지칭하기 위해 사용되는 집합적인 용어.

또한 다음 정의가 적용됩니다.

- DON\(decoding order number\): 페이로드 구조 내의 필드 또는 NAL 단위 디코딩 순서를 나타내는 파생 변수. DON 값의 범위는 0부터 65535까지입니다. 최대값에 도달한 후 DON 값은 0으로 돌아갑니다.

- NAL 단위 디코딩 순서: \[1\]의 7.4.1.2절에 주어진 NAL 단위 순서에 대한 제약을 따르는 NAL 단위 순서.

- NALU-time: NAL 단위가 자체 RTP 패킷으로 전송되는 경우 RTP 타임스탬프가 갖게 되는 값입니다.

- 전송 순서: RTP 시퀀스 번호의 오름차순\(모듈로 산술\)으로 된 패킷 순서입니다. Aggregation 패킷 내에서 NAL 유닛의 전송 순서는 패킷에 NAL 유닛이 나타나는 순서와 동일합니다.

- 미디어 인식 네트워크 요소\(MANE\): RTP 페이로드 헤더 또는 RTP 페이로드의 특정 측면을 구문 분석하고 콘텐츠에 반응할 수 있는 미들박스 또는 애플리케이션 계층 게이트웨이와 같은 네트워크 요소입니다.

- 참고 사항: MANE의 개념은 MANE가 신호를 인식해야 하고\(예: 미디어 스트림의 페이로드 유형 매핑에 대해 학습하기 위해\) 작동할 때 신뢰할 수 있어야 한다는 점에서 일반 라우터 또는 게이트웨이를 뛰어넘습니다. 보안 실시간 전송 프로토콜\(SRTP\)을 사용합니다. MANE를 사용하면 미디어 코딩의 필요에 따라 패킷을 삭제할 수 있다는 장점이 있습니다. 예를 들어, MANE가 특정 링크의 정체로 인해 패킷을 삭제해야 하는 경우 제거로 인해 사용자 경험에 가장 부정적인 영향을 미치는 패킷을 식별하고 제거할 수 있습니다.

- 정적 매크로블록: 비디오 스트림의 특정 양의 매크로블록은 \[3\]의 섹션 8.3.2.8에 정의된 대로 정적으로 정의될 수 있습니다. 정적 매크로블록은 비정적 매크로블록 처리를 위한 추가 처리 주기를 확보합니다. 주어진 비디오 처리 리소스의 양과 주어진 해상도를 기반으로 정적 매크로블록의 수가 많을수록 그에 따라 더 높은 프레임 속도가 가능해집니다.

- 기본 하위 프로필: 하나의 프로필의 모든 코딩 도구이거나 하나 이상의 프로필의 코딩 도구의 공통 하위 집합일 수 있는 코딩 도구의 하위 집합으로 profile-level-id 매개 변수로 표시됩니다.

- 기본 레벨: profile-level-id 매개변수가 나타내는 레벨로 profile\_idc, profile-iop, level\_idc의 3개 옥텟으로 구성됩니다. 기본 수준은 대부분의 경우 level\_idc로 표시되며 경우에 따라 추가로 profile-iop으로 표시됩니다.

---
### **4.2.  Abbreviations**

DON: 디코딩 순서 번호

- DONB: Decoding Order Number Base DOND: Decoding Order Number Difference FEC: Forward Error Correction FU: Fragmentation Unit IDR: Instantaneous Decoding Refresh IEC: International Electrotechnical Commission ISO: International Organization for Standardization ITU-T: International Telecommunication Union, Telecommunication Standardization Sector MANE : 미디어 인식 네트워크 요소 MTAP: 다중 시간 집계 패킷

MTAP16: 16비트 타임스탬프 오프셋이 있는 MTAP

- MTAP24: 24비트 타임스탬프 오프셋이 있는 MTAP NAL: 네트워크 추상화 계층 NALU: NAL 단위 SAR: 샘플 종횡비 SEI: 보충 향상 정보 STAP: 단일 시간 집계 패킷 STAP-A: STAP 유형 A STAP-B: STAP 유형 B TS: 타임스탬프 VCL: 비디오 코딩 레이어 VUI: 비디오 사용성 정보

---
## **5.  RTP Payload Format**
---
### **5.1.  RTP Header Usage**

RTP 헤더의 형식은 RFC 3550 \[5\]에 지정되어 있으며 편의상 그림 1에 다시 인쇄되어 있습니다. 이 페이로드 형식은 해당 사양과 일치하는 방식으로 헤더의 필드를 사용합니다.

RTP 패킷당 하나의 NAL 단위가 캡슐화되는 경우 RECOMMENDED RTP 페이로드 형식은 섹션 5.6에 지정됩니다. 집합 패킷과 조각화 단위에 대한 RTP 페이로드\(및 일부 RTP 헤더 비트에 대한 설정\)는 각각 섹션 5.7.2와 5.8에 지정되어 있습니다.\(SHOULD\)

```text
       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |V=2|P|X|  CC   |M|     PT      |       sequence number         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                           timestamp                           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |           synchronization source (SSRC) identifier            |
      +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
      |            contributing source (CSRC) identifiers             |
      |                             ....                              |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

- 그림 1. RFC 3550에 따른 RTP 헤더

본 RTP 페이로드 포맷에 따라 설정되는 RTP 헤더 정보는 다음과 같이 설정된다.

마커 비트\(M\): 1비트

- 비디오에서 M 비트의 일반적인 사용에 맞춰 RTP 타임스탬프가 나타내는 액세스 단위의 가장 마지막 패킷에 대해 설정

- 효율적인 재생 버퍼 처리를 허용하는 형식입니다. 집합 패킷\(STAP 및 MTAP\)의 경우 RTP 헤더의 마커 비트는 집합 패킷의 마지막 NAL 단위의 마커 비트가 자체 RTP 패킷으로 전송된 경우의 값으로 설정되어야 합니다. 디코더는 이 비트를 액세스 유닛의 마지막 패킷의 초기 표시로 사용할 수 있지만 이 속성에 의존해서는 안 됩니다.\(MUST, MUST NOT\)

참고 사항: 단 하나의 M 비트만

- 다수의 NAL 유닛을 전달하는 집합 패킷. 따라서 게이트웨이가 집합 패킷을 여러 패킷으로 다시 패킷화한 경우 해당 패킷의 M 비트를 안정적으로 설정할 수 없습니다.

페이로드 유형\(PT\): 7비트

- 이 새로운 패킷 형식에 대한 RTP 페이로드 유형 할당은 이 문서의 범위를 벗어나므로 여기서는 지정하지 않습니다. 페이로드 유형 할당은 사용된 프로필을 통해 또는 동적 방식으로 수행되어야 합니다.

시퀀스 번호\(SN\): 16비트

- RFC 3550에 따라 설정 및 사용됩니다. 단일 NALU 및 비인터리브 패킷화 모드의 경우 시퀀스 번호는 NALU의 디코딩 순서를 결정하는 데 사용됩니다.

타임스탬프: 32비트

- RTP 타임스탬프는 콘텐츠의 샘플링 타임스탬프로 설정됩니다. 90kHz 클록 속도를 사용해야 합니다.\(MUST\)

- NAL 단위가 자신의 타이밍 속성\(예: 매개변수 세트 및 SEI NAL 단위\)을 갖지 않는 경우, RTP 타임스탬프는 NAL 단위가 포함된 액세스 단위의 기본 코딩된 화면의 RTP 타임스탬프로 설정됩니다. \[1\]의 섹션 7.4.1.2.

- MTAP에 대한 RTP 타임스탬프 설정은 섹션 5.7.2에 정의되어 있습니다.

- 수신기는 디스플레이 타임스탬프가 하나만 있는 액세스 유닛에 포함된 모든 사진 타이밍 SEI 메시지를 무시해야 합니다. 대신, 수신기는 디스플레이 프로세스를 동기화하기 위해 RTP 타임스탬프를 사용해야 합니다.\(SHOULD, SHOULD\)

- 하나의 액세스 단위가 Picture Timing SEI 메시지에 전달된 두 개 이상의 디스플레이 타임스탬프를 가지고 있는 경우, SEI 메시지의 정보는 RTP 타임스탬프에 상대적인 것으로 처리되어야 하며, 가장 빠른 이벤트는 RTP 타임스탬프에 의해 주어진 시간에 발생하고 이후의 후속 이벤트는 화면 타이밍 SEI 메시지에 전달되는 화면 시간 값의 차이로 제공됩니다.\(SHOULD\)

- tSEI1, tSEI2, ..., tSEIn을 액세스 단위의 SEI 메시지에 포함된 표시 타임스탬프라고 하고, 여기서 tSEI1은 이러한 모든 타임스탬프 중 가장 빠른 것입니다. tmadjst\(\)를 SEI 메시지 시간 규모를 90kHz 시간 규모로 조정하는 함수라고 가정합니다. TS를 RTP 타임스탬프라고 하겠습니다. 그러면 tSEI1과 관련된 이벤트의 표시 시간은 TS입니다. x가 \[2..n\]인 tSEIx가 있는 이벤트의 표시 시간은 TS + tmadjst\(tSEIx - tSEI1\)입니다.

- 참고 사항: 코딩된 프레임을 필드로 표시하는 것은 코딩된 프레임으로 구성된 영화 콘텐츠가 인터레이스 스캐닝을 사용하여 디스플레이에 표시되는 3:2 풀다운 작업에서 일반적으로 필요합니다. 그림 타이밍 SEI 메시지는 동일한 코딩된 그림에 대해 여러 타임스탬프를 전달할 수 있으므로 3:2 풀다운 프로세스가 완벽하게 제어됩니다. RTP 타임스탬프에서는 코딩된 프레임당 하나의 타임스탬프만 전달할 수 있으므로 그림 타이밍 SEI 메시지 메커니즘이 필요합니다.

---
### **5.2.  Payload Structures**

페이로드 형식은 세 가지 기본 페이로드 구조를 정의합니다. 수신기는 RTP 패킷 페이로드의 첫 번째 바이트로 페이로드 구조를 식별할 수 있습니다. 이 바이트는 RTP 페이로드 헤더 역할을 하며 경우에 따라 페이로드의 첫 번째 바이트 역할도 합니다. 이 바이트는 항상 NAL 단위 헤더로 구성됩니다. NAL 단위 유형 필드는 어떤 구조가 존재하는지 나타냅니다. 가능한 구조는 다음과 같습니다.

단일 NAL 단위 패킷: 페이로드에 단일 NAL 단위만 포함합니다. NAL 헤더 유형 필드는 원래 NAL 단위 유형과 동일합니다. 즉, 1부터 23까지의 범위입니다. 섹션 5.6에 지정되어 있습니다.

Aggregation Packet: 여러 NAL 단위를 단일 RTP 페이로드로 집계하는 데 사용되는 패킷 유형입니다. 이 패킷은 STAP-A\(Single-Time Aggregation Packet type A\), STAP-B\(Single-Time Aggregation Packet type B\), 16비트 오프셋이 있는 MTAP\(Multi-Time Aggregation Packet\)\(MTAP16\)의 네 가지 버전으로 존재합니다. \) 및 24비트 오프셋이 있는 MTAP\(Multi-Time Aggregation Packet\)\(MTAP24\)가 있습니다. STAP-A, STAP-B, MTAP16, MTAP24에 할당된 NAL 단위 유형 번호는 각각 24, 25, 26, 27이다. 섹션 5.7에 지정되어 있습니다.

조각화 단위: 여러 RTP 패킷을 통해 단일 NAL 단위를 조각화하는 데 사용됩니다. 각각 NAL 장치 유형 번호 28과 29로 식별되는 FU-A와 FU-B의 두 가지 버전으로 존재합니다. 섹션 5.8에 지정되어 있습니다.

- 참고 사항: 이 사양은 단일 NAL 단위 패킷 및 단편화 단위에 캡슐화된 NAL 단위의 크기를 제한하지 않습니다. 모든 집합 패킷에 캡슐화된 NAL 단위의 최대 크기는 65535바이트입니다.

표 1에는 NAL 단위 유형과 각 NAL 단위가 패킷 페이로드로 직접 사용될 때 해당 RTP 패킷 유형이 요약되어 있으며 해당 유형이 본 메모에 설명되어 있습니다.

- 표 1. NAL 유닛 유형 및 해당 패킷 유형 요약

```text
      NAL Unit  Packet    Packet Type Name               Section
      Type      Type
      -------------------------------------------------------------
      0        reserved                                     -
      1-23     NAL unit  Single NAL unit packet             5.6
      24       STAP-A    Single-time aggregation packet     5.7.1
      25       STAP-B    Single-time aggregation packet     5.7.1
      26       MTAP16    Multi-time aggregation packet      5.7.2
      27       MTAP24    Multi-time aggregation packet      5.7.2
      28       FU-A      Fragmentation unit                 5.8
      29       FU-B      Fragmentation unit                 5.8
      30-31    reserved                                     -
```

---
### **5.3.  NAL Unit Header Usage**

NAL 단위 헤더의 구조와 의미는 섹션 1.3에서 소개되었습니다. 편의상 NAL 단위 헤더의 형식은 아래와 같이 다시 인쇄됩니다.

```text
      +---------------+
      |0|1|2|3|4|5|6|7|
      +-+-+-+-+-+-+-+-+
      |F|NRI|  Type   |
      +---------------+
```

이 섹션에서는 이 사양에 따라 F와 NRI의 의미를 지정합니다.

F: 1비트

- 금지된\_제로비트. 0 값은 NAL 단위 유형 옥텟과 페이로드에 비트 오류나 기타 구문 위반이 포함되어서는 안 된다는 것을 나타냅니다. 값 1은 NAL 단위 유형 옥텟 및 페이로드에 비트 오류 또는 기타 구문 위반이 포함될 수 있음을 나타냅니다.

- MANE은 NAL 단위에서 감지된 비트 오류를 ​​나타내기 위해 F 비트를 설정해야 합니다. H.264 사양에서는 F 비트가 0과 같을 것을 요구합니다. F 비트가 설정되면 디코더는 비트 오류 또는 기타 구문 위반이 페이로드 또는 NAL 단위 유형 옥텟에 존재할 수 있음을 알립니다. F 비트가 1과 동일한 NAL 단위에 대한 가장 간단한 디코더 반응은 그러한 NAL 단위를 폐기하고 폐기된 NAL 단위에서 손실된 데이터를 숨기는 것입니다.\(SHOULD\)

NRI: 2비트

- nal\_ref\_idc. 값 00과 0이 아닌 값의 의미는 H.264 사양에서 변경되지 않은 상태로 유지됩니다. 즉, 00의 값은 NAL 유닛의 콘텐츠가 인터 픽처 예측을 위한 참조 픽처를 복원하는 데 사용되지 않음을 나타냅니다. 이러한 NAL 단위는 참조 화면의 무결성을 위험에 빠뜨리지 않고 폐기될 수 있습니다. 00보다 큰 값은 참조 픽처의 무결성을 유지하기 위해 NAL 단위의 디코딩이 필요함을 나타냅니다.

- 위의 사양 외에도 본 RTP 페이로드 사양에 따르면 NRI 값은 인코더에서 결정한 상대적 전송 우선순위를 나타냅니다. MANE는 이 정보를 사용하여 덜 중요한 NAL 단위보다 더 중요한 NAL 단위를 더 잘 보호할 수 있습니다. 가장 높은 전송 우선순위는 11이고 그 다음은 10, 01입니다. 마지막으로 00이 가장 낮습니다.

- 참고 사항: NRI의 0이 아닌 값은 H.264 디코더에서 동일하게 처리됩니다. 따라서 수신기는 NAL 단위를 디코더에 전달할 때 NRI 값을 조작할 필요가 없습니다.

- H.264 인코더는 nal\_unit\_type 값이 1\~12 범위에 있을 때 H.264 사양\(하위 절 7.4.1\)에 따라 NRI 값을 설정해야 합니다. 특히, H.264 사양에서는 nal\_unit\_type이 6, 9, 10, 11 또는 12인 모든 NAL 단위에 대해 NRI 값이 0과 같아야 한다고 요구합니다.\(MUST, MUST\)

- nal\_unit\_type이 7 또는 8\(각각 시퀀스 매개변수 집합 또는 그림 매개변수 집합을 나타냄\)인 NAL 단위의 경우, H.264 인코더는 NRI 값을 11\(이진 형식\)로 설정해야 합니다. nal\_unit\_type이 5인 기본 코딩된 픽처의 코딩된 슬라이스 NAL 단위\(IDR 픽처에 속하는 코딩된 슬라이스를 나타냄\)에 대해, H.264 인코더는 NRI의 값을 11\(이진 형식으로\)로 설정해야 합니다.\(SHOULD, SHOULD\)

- 나머지 nal\_unit\_types를 NRI 값으로 매핑하려면 다음 예를 사용할 수 있으며 특정 환경에서 효율적인 것으로 나타났습니다\[14\]. 애플리케이션과 사용 중인 H.264 프로필에 따라 다른 매핑도 바람직할 수 있습니다.\(MAY, MAY\)

- 참고 사항: 특정 프로필\(예: 기본 프로필 또는 기준 프로필\)에서는 데이터 분할을 사용할 수 없습니다. 결과적으로, NAL 단위 유형 2, 3, 4는 비디오 비트스트림이 데이터 분할이 허용되는 프로파일을 따르는 경우에만 발생할 수 있으며 메인 또는 베이스라인 프로파일을 따르는 스트림에서는 발생할 수 없습니다.

- 표 2. 1차 코딩된 참조 픽처의 코딩된 슬라이스 및 코딩된 슬라이스 데이터 파티션에 대한 NRI 값의 예

```text
       NAL Unit Type     Content of NAL Unit              NRI (binary)
       ----------------------------------------------------------------
        1              non-IDR coded slice                         10
        2              Coded slice data partition A                10
        3              Coded slice data partition B                01
        4              Coded slice data partition C                01
```

- 참고 사항: 앞서 언급한 대로 비참조 영상의 NRI 값은 H.264에 따라 00입니다.

- H.264 인코더는 중복 코딩된 참조 화면의 코딩된 슬라이스 및 코딩된 슬라이스 데이터 파티션 NAL 단위에 대한 NRI 값을 01\(이진 형식\)과 동일하게 설정해야 합니다.\(SHOULD\)

- NAL 단위 유형 24\~29에 대한 NRI 값의 정의는 이 메모의 섹션 5.7 및 5.8에 나와 있습니다.

- 13에서 23까지의 범위에 있는 nal\_unit\_type을 갖는 NAL 유닛에 대해서는 NRI 값에 대한 권장 사항이 제공되지 않습니다. 왜냐하면 이러한 값은 ITU-T 및 ISO/IEC용으로 예약되어 있기 때문입니다. nal\_unit\_type이 0이거나 30에서 31까지의 범위에 있는 nal\_unit\_type을 갖는 NAL 단위에 대해서는 NRI 값에 대한 권장 사항이 제공되지 않습니다. 왜냐하면 이 값의 의미가 이 메모에 지정되어 있지 않기 때문입니다.

---
### **5.4.  Packetization Modes**

이 메모는 패킷화 모드의 세 가지 경우를 지정합니다.

```text
   o  Single NAL unit mode

   o  Non-interleaved mode

   o  Interleaved mode
```

단일 NAL 단위 모드는 ITU-T 권고사항 H.241 \[3\]\(섹션 12.1 참조\)을 준수하는 대화 시스템을 대상으로 합니다. 비인터리브 모드는 ITU-T 권장 사항 H.241을 준수하지 않는 대화 시스템을 대상으로 합니다. 비인터리브 모드에서는 NAL 단위가 NAL 단위 디코딩 순서에 따라 전송된다. 인터리브 모드는 매우 낮은 종단 간 대기 시간이 필요하지 않은 시스템을 대상으로 합니다. 인터리브 모드는 NAL 단위 디코딩 순서를 벗어나 NAL 단위의 전송을 허용합니다.

사용 중인 패킷화 모드는 OPTIONAL 패킷화 모드 미디어 유형 매개변수의 값으로 신호를 받을 수 있습니다. 사용된 패킷화 모드는 RTP 페이로드에 허용되는 NAL 단위 유형을 제어합니다. 표 3에는 각 패킷화 모드에 허용되는 패킷 페이로드 유형이 요약되어 있습니다. 패킷화 모드는 섹션 6에 자세히 설명되어 있습니다.\(MAY\)

```text
      Table 3.  Summary of allowed NAL unit types for each packetization
                mode (yes = allowed, no = disallowed, ig = ignore)

      Payload Packet    Single NAL    Non-Interleaved    Interleaved
      Type    Type      Unit Mode           Mode             Mode
      -------------------------------------------------------------
      0      reserved      ig               ig               ig
      1-23   NAL unit     yes              yes               no
      24     STAP-A        no              yes               no
      25     STAP-B        no               no              yes
      26     MTAP16        no               no              yes
      27     MTAP24        no               no              yes
      28     FU-A          no              yes              yes
      29     FU-B          no               no              yes
      30-31  reserved      ig               ig               ig
```

일부 NAL 단위 또는 페이로드 유형 값\(표 3에 예약된 것으로 표시됨\)은 향후 확장을 위해 예약되어 있습니다. 이러한 유형의 NAL 단위는 발신자에 의해 전송되어서는 안 되며\(패킷 페이로드로 직접, 집합 패킷의 집합 단위로 또는 FU 패킷의 조각화된 단위로\) 수신자가 무시해야 합니다. 예를 들어, 연관된 패킷 유형 "NAL 단위"를 갖는 페이로드 유형 1-23은 다음과 같습니다.\(MUST\)

"단일 NAL 단위 모드" 및 "비인터리브 모드"에서는 허용되지만 "인터리브 모드"에서는 허용되지 않습니다. 그러나 NAL 단위 유형 1-23의 NAL 단위는 STAP-B, MTAP16 및 MTAP24 패킷의 집합 단위뿐만 아니라 FU-A 및 FU-B 패킷의 조각화된 단위로 "인터리브 모드"에서 사용될 수 있습니다. 마찬가지로, NAL 단위 유형 1-23의 NAL 단위는 패킷 페이로드로 직접 사용되는 것 외에도 STAP-A 패킷의 집합 단위 또는 FU-A 패킷의 조각화된 단위로 "비인터리브 모드"에서 사용될 수도 있습니다.

---
### **5.5.  Decoding Order Number (DON)**

인터리브 패킷화 모드에서는 NAL 단위의 전송 순서가 NAL 단위의 디코딩 순서와 다를 수 있다. DON\(Decoding Order Number\)은 페이로드 구조의 필드이거나 NAL 단위 디코딩 순서를 나타내는 파생 변수입니다. 디코딩 순서를 벗어난 전송과 DON 사용에 대한 이론적 근거와 사용 사례의 예는 섹션 13에 나와 있습니다.

전송 및 디코딩 순서의 결합은 다음과 같이 OPTIONAL sprop-interleaving-length 미디어 유형 매개변수에 의해 제어됩니다. OPTIONAL sprop-interleaving-length 미디어 유형 매개변수의 값이 0과 같을 때\(명시적으로 또는 기본적으로\), NAL 단위의 전송 순서는 NAL 단위 디코딩 순서를 따라야 합니다. OPTIONAL sprop-interleaving-length 미디어 유형 매개변수의 값이 0보다 큰 경우:\(MAY, MUST, MAY\)

o MTAP16 및 MTAP24의 NAL 단위 순서는 NAL 단위 디코딩 순서가 될 필요가 없으며,

o 두 개의 연속 패킷에서 STAP-B, MTAP 및 FU를 역패킷화하여 생성된 NAL 단위의 순서는 NAL 단위 디코딩 순서일 필요는 없습니다.

단일 NAL 단위 패킷, STAP-A 및 FU-A에 대한 RTP 페이로드 구조에는 DON이 포함되지 않습니다. STAP-B 및 FU-B 구조에는 DON이 포함되며 MTAP의 구조는 섹션 5.7.2에 지정된 대로 DON 파생을 가능하게 합니다.

- 참고 사항: FU-A가 인터리브 모드에서 발생하면 항상 DON을 설정하는 FU-B를 따릅니다.

- 참고 사항: 송신기가 패킷당 단일 NAL 단위를 캡슐화하고 디코딩 순서를 벗어나 패킷을 전송하려는 경우 STAP-B 패킷 유형을 사용할 수 있습니다.

단일 NAL 단위 패킷화 모드에서 RTP 시퀀스 번호에 의해 결정되는 NAL 단위의 전송 순서는 NAL 단위 디코딩 순서와 동일해야 합니다. 인터리빙되지 않은 패킷화에서는\(MUST\)

모드에서 단일 NAL 단위 패킷, STAP-A 및 FU-A의 NAL 단위 전송 순서는 NAL 단위 디코딩 순서와 동일해야 합니다. STAP 내의 NAL 단위는 NAL 단위 디코딩 순서로 나타나야 합니다. 따라서, 디코딩 순서는 먼저 STAP 내의 암시적 순서를 통해 제공되고, 이후 STAP, FU 및 단일 NAL 단위 패킷 사이의 순서에 대해 RTP 시퀀스 번호를 통해 제공된다.\(MUST, MUST\)

STAP-B, MTAP 및 FU-B로 시작하는 일련의 단편화 단위에서 전달되는 NAL 단위에 대한 DON 값의 신호는 각각 섹션 5.7.1, 5.7.2 및 5.8에 지정됩니다. 전송 순서에서 첫 번째 NAL 단위의 DON 값은 임의의 값으로 설정될 수 있습니다. DON 값의 범위는 0부터 65535까지입니다. 최대값에 도달한 후 DON 값은 0으로 돌아갑니다.\(MAY\)

임의의 STAP-B, MTAP 또는 FU-B로 시작하는 일련의 단편화 단위에 포함된 두 NAL 단위의 디코딩 순서는 다음과 같이 결정됩니다. DON\(i\)를 전송 순서에서 인덱스 i를 갖는 NAL 단위의 디코딩 순서 번호라고 하자. 함수 don\_diff\(m,n\)는 다음과 같이 지정됩니다.

- DON\(m\) == DON\(n\)이면 don\_diff\(m,n\) = 0

```text
      If (DON(m) < DON(n) and DON(n) - DON(m) < 32768),
      don_diff(m,n) = DON(n) - DON(m)

      If (DON(m) > DON(n) and DON(m) - DON(n) >= 32768),
      don_diff(m,n) = 65536 - DON(m) + DON(n)

      If (DON(m) < DON(n) and DON(n) - DON(m) >= 32768),
      don_diff(m,n) = - (DON(m) + 65536 - DON(n))

      If (DON(m) > DON(n) and DON(m) - DON(n) < 32768),
      don_diff(m,n) = - (DON(m) - DON(n))
```

don\_diff\(m,n\)의 양수 값은 전송 순서 인덱스 n을 갖는 NAL 단위가 전송 순서 인덱스 m을 갖는 NAL 단위의 디코딩 순서에 뒤따른다는 것을 나타낸다. don\_diff\(m,n\)이 0과 같을 때, 두 NAL 단위의 NAL 단위 디코딩 순서는 어느 순서일 수 있습니다. don\_diff\(m,n\)의 음수 값은 전송 순서 인덱스 n을 갖는 NAL 단위가 전송 순서 인덱스 m을 갖는 NAL 단위보다 디코딩 순서에 앞서 있음을 나타낸다.

DON 관련 필드\(DON, DONB 및 DOND, 섹션 5.7 참조\)의 값은 위에 지정된 대로 DON 값에 의해 결정된 디코딩 순서가 NAL 단위 디코딩 순서를 따르도록 해야 합니다.\(MUST\)

NAL 단위 디코딩 순서에서 두 NAL 단위의 순서가 바뀌고 새로운 순서가 NAL 단위 디코딩 순서를 따르지 않는 경우, NAL 단위는 동일한 DON 값을 가져서는 안 됩니다. NAL 단위 스트림에서 두 개의 연속적인 NAL 단위의 순서가 바뀌고 새로운 순서가 여전히 NAL 단위 디코딩 순서를 따르는 경우, NAL 단위는 동일한 DON 값을 가질 수 있습니다. 예를 들어, 사용 중인 비디오 코딩 프로파일에 의해 임의의 슬라이스 순서가 허용되는 경우, 코딩된 픽처의 모든 코딩된 슬라이스 NAL 단위는 동일한 DON 값을 갖도록 허용됩니다. 결과적으로, 동일한 DON 값을 갖는 NAL 유닛들은 어떤 순서로든 디코딩될 수 있으며, 서로 다른 DON 값을 갖는 두 개의 NAL 유닛들은 위에서 명시된 순서대로 디코더에 전달되어야 한다. NAL 단위 디코딩 순서에서 두 개의 연속 NAL 단위가 서로 다른 DON 값을 가질 때, 디코딩 순서에서 두 번째 NAL 단위에 대한 DON 값은 첫 번째 NAL 단위에 대해 1씩 증가된 DON 값이어야 합니다.\(MUST NOT, MAY, SHOULD\)

NAL 유닛 디코딩 순서를 복구하기 위한 디패킷화 프로세스의 예가 섹션 7에 제공됩니다.

- 참고 사항: 수신기는 NAL 단위 디코딩 순서에서 2개의 연속 NAL 단위에 대한 DON 값의 절대 차이가 오류 없는 전송에서도 1과 동일할 것이라고 기대해서는 안 됩니다. NAL 유닛에 DON의 값을 연관시키는 시점에서는 모든 NAL 유닛이 수신기에 전달되었는지 알 수 없으므로 1씩 증가시킬 필요는 없다. 예를 들어, 게이트웨이는 패킷이 전달되는 네트워크에서 비트레이트가 부족한 경우 비참조 픽처의 코딩된 슬라이스 NAL 단위 또는 SEI NAL 단위를 전달하지 않을 수 있습니다. 또 다른 예에서, 라이브 방송은 때때로 광고와 같은 미리 인코딩된 콘텐츠에 의해 중단됩니다. 미리 인코딩된 클립의 첫 번째 인트라 영상은 수신기에서 쉽게 사용할 수 있도록 미리 전송됩니다. 첫 번째 인트라 영상을 전송할 때, 발신자는 사전 인코딩된 클립의 첫 번째 인트라 영상이 디코딩 순서에 따라오기 전에 얼마나 많은 NAL 단위가 인코딩될 것인지 정확히 알지 못합니다. 따라서, 미리 인코딩된 클립의 첫 번째 인트라 픽처의 NAL 단위에 대한 DON 값을 전송 시 추정해야 하며, DON 값에 차이가 발생할 수 있다.

---
### **5.6.  Single NAL Unit Packet**

여기에 정의된 단일 NAL 단위 패킷은 \[1\]에 정의된 유형의 NAL 단위를 하나만 포함해야 합니다. 이는 단일 NAL 단위 패킷 내에서 집합 패킷이나 조각화 단위를 모두 사용할 수 없음을 의미합니다. 단일 NAL 단위 패킷을 RTP 시퀀스 번호 순서로 역패킷화하여 구성된 NAL 단위 스트림은 NAL 단위 디코딩 순서를 따라야 한다. 단일 NAL 단위 패킷의 구조는 그림 2에 나와 있습니다.\(MUST, MUST\)

- 참고 사항: NAL 단위의 첫 번째 바이트는 RTP 페이로드 헤더 역할을 합니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |F|NRI|  Type   |                                               |
    +-+-+-+-+-+-+-+-+                                               |
    |                                                               |
    |               Bytes 2..n of a single NAL unit                 |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 2.  RTP payload format for single NAL unit packet
```

---
### **5.7.  Aggregation Packets**

집합 패킷은 본 페이로드 사양의 NAL 단위 집합 체계입니다. 이 체계는 유선 IP 네트워크\(이더넷 MTU 크기\(대략 1500바이트\)에 의해 제한되는 MTU 크기\)와 IP 기반 또는 비IP 기반\(대략 1500바이트\)이라는 두 가지 주요 대상 네트워크의 크게 다른 MTU 크기를 반영하기 위해 도입되었습니다. 예를 들어, ITU-T H.324/M\) 254바이트 이하의 기본 전송 단위 크기를 갖는 무선 통신 시스템. 두 세계 간의 미디어 트랜스코딩을 방지하고 바람직하지 않은 패킷화 오버헤드를 방지하기 위해 NAL 단위 집계 방식이 도입되었습니다.

이 사양에서는 두 가지 유형의 집계 패킷을 정의합니다.

o 단일 시간 집합 패킷\(STAP\): 동일한 NALU 시간을 가진 NAL 단위를 집합합니다. 두 가지 유형의 STAP가 정의되는데, 하나는 DON이 없는 것\(STAP-A\)이고 다른 하나는 DON을 포함하는 것\(STAP-B\)입니다.

o MTAP\(다중 시간 집합 패킷\): 잠재적으로 다른 NALU 시간을 사용하여 NAL 단위를 집합합니다. NAL 단위 타임스탬프 오프셋의 길이가 다른 두 개의 서로 다른 MTAP가 정의됩니다.

집합 패킷으로 운반되는 각 NAL 단위는 집합 단위로 캡슐화됩니다. 네 가지 집계 단위와 그 특성은 아래를 참조하세요.

집계 패킷에 대한 RTP 페이로드 형식의 구조는 그림 3에 나와 있습니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |F|NRI|  Type   |                                               |
    +-+-+-+-+-+-+-+-+                                               |
    |                                                               |
    |             one or more aggregation units                     |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 3.  RTP payload format for aggregation packets
```

MTAP와 STAP는 다음 패킷화 규칙을 공유합니다.

o RTP 타임스탬프는 집계될 모든 NAL 단위의 NALU 시간 중 가장 빠른 것으로 설정되어야 합니다.\(MUST\)

o NAL 단위 유형 옥텟의 유형 필드는 표 4에 표시된 대로 적절한 값으로 설정되어야 합니다.\(MUST\)

o 집계된 NAL 단위의 모든 F 비트가 0인 경우 F 비트를 지워야 합니다. 그렇지 않으면 반드시 설정해야 합니다.\(MUST\)

o NRI의 값은 집합 패킷에 포함된 모든 NAL 단위의 최대값이어야 합니다.\(MUST\)

```text
                 Table 4.  Type field for STAPs and MTAPs

      Type   Packet    Timestamp offset   DON-related fields
                       field length       (DON, DONB, DOND)
                       (in bits)          present
      --------------------------------------------------------
      24     STAP-A       0                 no
      25     STAP-B       0                 yes
      26     MTAP16      16                 yes
      27     MTAP24      24                 yes
```

RTP 헤더의 마커 비트는 집계된 패킷의 마지막 NAL 단위의 마커 비트가 자체 RTP 패킷으로 전송된 경우 가질 수 있는 값으로 설정됩니다.

집계 패킷의 페이로드는 하나 이상의 집계 단위로 구성됩니다. 네 가지 다른 유형의 집계 단위에 대해서는 섹션 5.7.1 및 5.7.2를 참조하십시오. 집합 패킷은 필요한 만큼의 집합 단위를 전달할 수 있습니다. 그러나 집합 패킷의 총 데이터 양은 분명히 IP 패킷에 맞아야 하며 결과 IP 패킷이 MTU 크기보다 작도록 크기를 선택해야 합니다. 집계 패킷은 섹션 5.8에 지정된 대로 조각화 단위를 포함해서는 안 됩니다. 집계 패킷은 중첩되어서는 안 됩니다. 즉, 집합 패킷은 다른 집합 패킷을 포함해서는 안 됩니다.\(MUST, MUST NOT, MUST NOT\)

---
#### **5.7.1.  Single-Time Aggregation Packet (STAP)**

단일 시간 집합 패킷\(STAP\)은 모두 동일한 NALU 시간을 공유하는 NAL 단위가 집합될 때마다 사용해야 합니다. STAP-A의 페이로드는 DON을 포함하지 않으며 그림 4에 표시된 것처럼 하나 이상의 단일 시간 집계 단위로 구성됩니다. STAP-B의 페이로드는 16비트 부호 없는 DON\(디코딩 순서 번호\)으로 구성됩니다. 네트워크 바이트 순서\) 다음에는 그림 5에 표시된 대로 최소 하나의 단일 시간 집계 단위가 옵니다.\(SHOULD\)

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    :                                               |
    +-+-+-+-+-+-+-+-+                                               |
    |                                                               |
    |                single-time aggregation units                  |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 4.  Payload format for STAP-A

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    :  decoding order number (DON)  |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    |                                                               |
    |                single-time aggregation units                  |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 5.  Payload format for STAP-B
```

DON 필드는 전송 순서에 따라 STAP-B의 첫 번째 NAL 단위에 대한 DON 값을 지정합니다. STAP-B에서 출현 순서에 따른 각각의 연속적인 NAL 유닛에 대해, DON의 값은 \(STAP-B에서 이전 NAL 유닛의 DON 값 + 1\) % 65536과 동일하며, 여기서 '%'는 모듈로 연산.

단일 시간 집계 단위는 다음 NAL 단위의 크기를 바이트 단위로 나타내는 16비트 부호 없는 크기 정보\(네트워크 바이트 순서\)로 구성됩니다\(이 두 옥텟은 제외하지만 NAL 단위의 NAL 단위 유형 옥텟은 포함\). NAL 단위 유형 바이트를 포함하여 NAL 단위 자체가 뒤따릅니다. 단일 시간 집계 단위는 RTP 페이로드 내에서 바이트 정렬되지만 32비트 워드 경계에서는 정렬되지 않을 수 있습니다. 그림 6은 단일 시간 집계 단위의 구조를 나타냅니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    :        NAL unit size          |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    |                                                               |
    |                           NAL unit                            |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 6.  Structure for single-time aggregation unit
```

그림 7은 STAP-A를 포함하는 RTP 패킷의 예를 나타냅니다. STAP에는 그림에서 1과 2로 표시된 두 개의 단일 시간 집계 단위가 포함되어 있습니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          RTP Header                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAP-A NAL HDR |         NALU 1 Size           | NALU 1 HDR    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         NALU 1 Data                           |
    :                                                               :
    +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               | NALU 2 Size                   | NALU 2 HDR    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         NALU 2 Data                           |
    :                                                               :
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 7.  An example of an RTP packet including an STAP-A
               containing two single-time aggregation units
```

그림 8은 STAP-B를 포함하는 RTP 패킷의 예를 나타냅니다. STAP에는 그림에서 1과 2로 표시된 두 개의 단일 시간 집계 단위가 포함되어 있습니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          RTP Header                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |STAP-B NAL HDR | DON                           | NALU 1 Size   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | NALU 1 Size   | NALU 1 HDR    | NALU 1 Data                   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
    :                                                               :
    +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               | NALU 2 Size                   | NALU 2 HDR    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                       NALU 2 Data                             |
    :                                                               :
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 8.  An example of an RTP packet including an STAP-B
               containing two single-time aggregation units
```

---
#### **5.7.2.  Multi-Time Aggregation Packets (MTAPs)**

MTAP의 NAL 단위 페이로드는 그림 9에 제시된 것처럼 16비트 DONB\(Unsigned Decoding Order Number Base\)\(네트워크 바이트 순서\)와 하나 이상의 다중 시간 집계 단위로 구성됩니다. DONB는 반드시 DON 값을 포함해야 합니다. MTAP의 NAL 단위 중 NAL 단위 디코딩 순서에서 첫 번째 NAL 단위.\(MUST\)

- 참고 사항: NAL 단위 디코딩 순서의 첫 번째 NAL 단위는 NAL 단위가 MTAP에서 캡슐화되는 순서의 첫 번째 NAL 단위일 필요는 없습니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
                    :  decoding order number base   |               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    |                                                               |
    |                 multi-time aggregation units                  |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 9.  NAL unit payload format for MTAPs
```

이 사양에서는 두 가지 서로 다른 다중 시간 집계 단위가 정의됩니다. 둘 다 다음 NAL 단위의 부호 없는 크기 정보\(네트워크 바이트 순서\) 16비트, DOND\(Unsigned Decoding Order Number Difference\) 8비트, 타임스탬프 오프셋\(TS\)의 n비트\(네트워크 바이트 순서\)로 구성됩니다. 오프셋\), n은 16 또는 24일 수 있습니다. 다양한 MTAP 유형\(MTAP16 및 MTAP24\) 간의 선택은 애플리케이션에 따라 다릅니다. 타임스탬프 오프셋이 클수록 MTAP의 유연성은 높아지지만 오버헤드는 또한 더 높습니다.

MTAP16과 MTAP24에 대한 다중 시간 집계 단위의 구조는 각각 그림 10과 11에 나와 있습니다. 패킷 내 집계 단위의 시작 또는 끝 위치는 32비트 워드 경계에 있을 필요가 없습니다. 다중시간 집합 단위에 포함된 NAL 단위의 DON은 \(DONB + DOND\)% 65536과 동일하며, 여기서 %는 모듈로 연산을 의미한다. 이 메모는 MTAP 내 NAL 단위의 순서를 지정하지 않지만 대부분의 경우 NAL 단위 디코딩 순서를 사용해야 합니다.\(SHOULD\)

타임스탬프 오프셋 필드는 다음 공식의 값과 동일한 값으로 설정되어야 합니다. NALU-시간이 패킷의 RTP 타임스탬프보다 크거나 같으면 타임스탬프 오프셋은 다음과 같습니다\(NALU-시간 단위 - 패킷의 RTP 타임스탬프\). NALU 시간이 패킷의 RTP 타임스탬프보다 작은 경우 타임스탬프 오프셋은 NALU 시간 + \(2^32 - 패킷의 RTP 타임스탬프\)와 같습니다.\(MUST\)

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :        NAL unit size          |      DOND     |  TS offset    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  TS offset    |                                               |
    +-+-+-+-+-+-+-+-+              NAL unit                         |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 10.  Multi-time aggregation unit for MTAP16

     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    :        NAL unit size         |      DOND     |  TS offset    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         TS offset             |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
    |                              NAL unit                         |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 11.  Multi-time aggregation unit for MTAP24
```

MTAP의 "가장 빠른" 다중 시간 집계 단위의 경우 타임스탬프 오프셋이 0이어야 합니다. 따라서 MTAP 자체의 RTP 타임스탬프는 가장 빠른 NALU 시간과 동일합니다.\(MUST\)

- 참고 사항: "가장 빠른" 다중 시간 집합 단위는 집합 단위에 포함된 NAL 단위가 단일 NAL 단위 패킷에 캡슐화되는 경우 MTAP의 모든 집합 단위 중에서 가장 작은 확장 RTP 타임스탬프를 갖는 단위입니다. 확장된 타임스탬프는 32비트를 초과하는 타임스탬프이며 타임스탬프 필드의 순환을 계산할 수 있으므로 타임스탬프가 순환하는 경우 가장 작은 값을 결정할 수 있습니다. 이러한 "가장 빠른" 집합 단위는 집합 단위가 MTAP에 캡슐화되는 순서에 따라 첫 번째 집합 단위가 아닐 수도 있습니다. "가장 빠른" NAL 단위는 NAL 단위 디코딩 순서에서 첫 번째 NAL 단위와 동일할 필요도 없습니다.

그림 12는 그림에서 1과 2로 표시된 두 개의 다중 시간 집합 단위를 포함하는 MTAP16 유형의 다중 시간 집합 패킷을 포함하는 RTP 패킷의 예를 나타냅니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          RTP Header                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |MTAP16 NAL HDR |  decoding order number base   | NALU 1 Size   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  NALU 1 Size  |  NALU 1 DOND  |       NALU 1 TS offset        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  NALU 1 HDR   |  NALU 1 DATA                                  |
    +-+-+-+-+-+-+-+-+                                               +
    :                                                               :
    +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               | NALU 2 SIZE                   |  NALU 2 DOND  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       NALU 2 TS offset        |  NALU 2 HDR   |  NALU 2 DATA  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |
    :                                                               :
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 12.  An RTP packet including a multi-time aggregation
                packet of type MTAP16 containing two multi-time
                aggregation units
```

그림 13은 그림에서 1과 2로 표시된 두 개의 다중 시간 집계 단위를 포함하는 MTAP24 유형의 다중 시간 집계 패킷을 포함하는 RTP 패킷의 예를 나타냅니다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                          RTP Header                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |MTAP24 NAL HDR |  decoding order number base   | NALU 1 Size   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  NALU 1 Size  |  NALU 1 DOND  |       NALU 1 TS offs          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |NALU 1 TS offs |  NALU 1 HDR   |  NALU 1 DATA                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
    :                                                               :
    +               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |               | NALU 2 SIZE                   |  NALU 2 DOND  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       NALU 2 TS offset                        |  NALU 2 HDR   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  NALU 2 DATA                                                  |
    :                                                               :
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 13.  An RTP packet including a multi-time aggregation
                packet of type MTAP24 containing two multi-time
                aggregation units
```

---
### **5.8.  Fragmentation Units (FUs)**

이 페이로드 유형을 사용하면 NAL 단위를 여러 RTP 패킷으로 분할할 수 있습니다. 하위 계층 조각화\(예: IP별\)에 의존하는 대신 애플리케이션 계층에서 그렇게 하면 다음과 같은 이점이 있습니다.

o 페이로드 형식은 사전 녹화된 비디오, 특히 HD 형식에 존재할 수 있는 IPv4 네트워크를 통해 64KB보다 큰 NAL 단위를 전송할 수 있습니다\(사진당 슬라이스 수에 제한이 있으므로 결과적으로 사진당 NAL 단위 제한으로 인해 큰 NAL 단위가 발생할 수 있음\)

o 단편화 메커니즘은 단일 NAL 단위를 단편화하고 섹션 12.5에 설명된 대로 일반 순방향 오류 정정을 적용하는 것을 허용합니다.

단편화는 단일 NAL 단위에 대해서만 정의되며 집합 패킷에 대해서는 정의되지 않습니다. NAL 단위의 조각은 해당 NAL 단위의 연속적인 옥텟의 정수 개수로 구성됩니다. NAL 단위의 각 옥텟은 해당 NAL 단위의 정확히 하나의 조각의 일부여야 합니다. 동일한 NAL 단위의 조각은 RTP 시퀀스 번호가 오름차순으로 연속적인 순서로 전송되어야 합니다\(첫 번째와 마지막 조각 사이에 전송되는 동일한 RTP 패킷 스트림 내의 다른 RTP 패킷 없음\). 마찬가지로, NAL 유닛은 RTP 시퀀스 번호 순서로 재조립되어야 합니다.\(MUST, MUST, MUST\)

NAL 단위가 단편화되어 단편화 단위\(FU\) 내에서 전달되는 경우 이를 단편화된 NAL 단위라고 합니다. STAP 및 MTAP는 조각화되어서는 안 됩니다. FU는 중첩되어서는 안 됩니다. 즉, FU는 다른 FU를 포함해서는 안 됩니다.\(MUST NOT, MUST NOT\)

FU를 전달하는 RTP 패킷의 RTP 타임스탬프는 조각난 NAL 단위의 NALU-시간으로 설정됩니다.

그림 14는 FU-A에 대한 RTP 페이로드 형식을 나타냅니다. FU-A는 1옥텟의 단편화 단위 지시자, 1옥텟의 단편화 단위 헤더, 단편화 단위 페이로드로 구성된다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | FU indicator  |   FU header   |                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               |
    |                                                               |
    |                         FU payload                            |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 14.  RTP payload format for FU-A
```

그림 15는 FU-B의 RTP 페이로드 형식을 보여줍니다. FU-B는 1옥텟의 조각화 단위 지시자, 1옥텟의 조각화 단위 헤더, DON\(디코딩 순서 번호\)\(네트워크 바이트 순서\) 및 조각화 단위 페이로드로 구성됩니다. 즉, FU-B의 구조는 추가적인 DON 필드를 제외하면 FU-A의 구조와 동일하다.

```text
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | FU indicator  |   FU header   |               DON             |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-|
    |                                                               |
    |                         FU payload                            |
    |                                                               |
    |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                               :...OPTIONAL RTP padding        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

    Figure 15.  RTP payload format for FU-B
```

NAL 단위 유형 FU-B는 조각화된 NAL 단위의 첫 번째 조각화 단위에 대해 인터리빙된 패킷화 모드에서 사용되어야 합니다. NAL 유닛 유형 FU-B는 다른 경우에는 사용되어서는 안 됩니다. 즉, 인터리빙된 패킷화 모드에서 조각화된 각 NALU는 첫 번째 조각으로 FU-B를 갖고 그 뒤에 하나 이상의 FU-A 조각이 있습니다.\(MUST, MUST NOT\)

FU 표시기 옥텟의 형식은 다음과 같습니다.

```text
       +---------------+
       |0|1|2|3|4|5|6|7|
       +-+-+-+-+-+-+-+-+
       |F|NRI|  Type   |
       +---------------+
```

FU 표시기 옥텟의 유형 필드에 있는 28 및 29와 같은 값은 각각 FU-A 및 FU-B를 식별합니다. F 비트의 사용은 섹션 5.3에 설명되어 있습니다. NRI 필드의 값은 분할된 NAL 단위의 NRI 필드 값에 따라 설정되어야 합니다.\(MUST\)

FU 헤더의 형식은 다음과 같습니다.

```text
      +---------------+
      |0|1|2|3|4|5|6|7|
      +-+-+-+-+-+-+-+-+
      |S|E|R|  Type   |
      +---------------+
```

S: 1비트

- 1로 설정되면 시작 비트는 조각난 NAL 단위의 시작을 나타냅니다. 다음 FU 페이로드가 단편화된 NAL 단위 페이로드의 시작이 아닌 경우 시작 비트는 0으로 설정됩니다.

전자: 1비트

- 1로 설정되면 종료 비트는 조각화된 NAL 단위의 끝을 나타냅니다. 즉, 페이로드의 마지막 바이트는 조각화된 NAL 단위의 마지막 바이트이기도 합니다. 다음 FU 페이로드가 조각화된 NAL 단위의 마지막 조각이 아닌 경우 종료 비트는 0으로 설정됩니다.

R: 1비트

- 예약된 비트는 0과 같아야 하며 수신기에서 무시되어야 합니다.\(MUST\)

유형: 5비트

- \[1\]의 표 7-1에 정의된 NAL 단위 페이로드 유형.

FU-B의 DON 값은 섹션 5.5에 설명된 대로 선택됩니다.

- 참고 사항: FU-B의 DON 필드를 사용하면 게이트웨이가 수신 NAL 단위를 NAL 단위 디코딩 순서로 구성하지 않고도 NAL 단위를 FU-B로 분할할 수 있습니다.

단편화된 NAL 단위는 하나의 FU로 전송되어서는 안 됩니다. 즉, 시작 비트와 종료 비트는 모두 동일한 FU 헤더에서 하나로 설정되어서는 안 됩니다.\(MUST NOT\)

FU 페이로드는 분할된 NAL 유닛의 페이로드의 조각들로 구성되므로, 연속적인 FU의 분할 유닛 페이로드들을 순차적으로 연결하면 분할된 NAL 유닛의 페이로드를 재구성할 수 있다. 조각화된 NAL 단위의 NAL 단위 유형 옥텟은 조각화 단위 페이로드에 그 자체로 포함되지 않고, 오히려 조각화된 NAL 단위의 NAL 단위 유형 옥텟에 대한 정보가 FU 지시자 옥텟의 F 및 NRI 필드에 전달됩니다. 조각화 단위와 FU 헤더의 유형 필드에 있습니다. FU 페이로드는 임의 개수의 옥텟을 가질 수 있으며 비어 있을 수 있습니다.\(MAY\)

- 참고 사항: 빈 FU는 거의 무손실 환경에서 특정 발신자 클래스의 대기 시간을 줄이기 위해 허용됩니다. 이러한 발신자는 NALU가 완전히 생성되기 전, 따라서 NALU 크기가 알려지기 전에 NALU 조각을 패킷화한다는 특징이 있습니다. 길이가 0인 NALU 조각이 허용되지 않는 경우 발신자는 현재 조각을 전송하기 전에 다음 조각의 데이터 중 최소한 1비트를 생성해야 합니다. 때때로 여러 매크로블록이 0비트를 차지하는 H.264의 특성으로 인해 이는 바람직하지 않으며 지연이 추가될 수 있습니다. 그러나 길이가 0인 NALU 조각의 \(잠재적\) 사용은 전송에 사용되는 추가 패킷으로 인해 NALU의 적어도 일부가 손실될 위험이 증가한다는 점을 주의 깊게 고려해야 합니다.

조각화 단위가 손실된 경우 수신기는 동일한 조각화된 NAL 단위에 해당하는 전송 순서에 따라 다음 조각화 단위를 모두 폐기해야 합니다.\(SHOULD\)

엔드포인트 또는 MANE의 수신기는 해당 NAL 단위의 조각 n이 수신되지 않은 경우에도 NAL 단위의 처음 n-1개의 조각을 \(불완전한\) NAL 단위로 집계할 수 있습니다. 이 경우, NAL 유닛의 allowed\_zero\_bit는 구문 위반을 나타내기 위해 1로 설정되어야 합니다.\(MAY, MUST\)

---
## **6.  Packetization Rules**

패킷화 모드는 섹션 5.2에 소개되어 있습니다. 둘 이상의 패킷화 모드에 공통적인 패킷화 규칙은 섹션 6.1에 지정되어 있습니다. 단일 NAL 단위 모드, 비인터리브 모드 및 인터리브 모드에 대한 패킷화 규칙은 각각 섹션 6.2, 6.3 및 6.4에 지정됩니다.

---
### **6.1.  Common Packetization Rules**

모든 발신자는 사용 중인 패킷화 모드에 관계없이 다음 패킷화 규칙을 시행해야 합니다.\(MUST\)

o 동일한 코딩된 픽처에 속하는\(따라서 동일한 RTP 타임스탬프 값을 공유하는\) 코딩된 슬라이스 NAL 단위 또는 코딩된 슬라이스 데이터 파티션 NAL 단위는 임의의 순서로 전송될 수 있습니다. 그러나 지연이 중요한 시스템의 경우 지연을 최소화하기 위해 원래의 디코딩 순서로 전송되어야 합니다. 디코딩 순서는 비트스트림의 NAL 단위 순서라는 점에 유의하세요.\(SHOULD\)

o 매개변수 세트는 섹션 8.4에 제공된 규칙 및 권장 사항에 따라 처리됩니다.

o MANE은 시퀀스 또는 그림 매개변수 세트 NAL 단위를 제외한 어떤 NAL 단위도 복제해서는 안 됩니다. 이 메모나 H.264 사양 모두 중복된 NAL 단위를 식별하는 수단을 제공하지 않기 때문입니다. 시퀀스 및 화면 매개변수 세트 NAL 단위는 올바른 수신 가능성을 높이기 위해 복제될 수 있지만 이러한 복제는 활성 시퀀스 또는 화면 매개변수 세트의 내용에 영향을 주어서는 안 됩니다. 복제는 애플리케이션 계층에서 수행되어야 하며 RTP 패킷\(동일한 시퀀스 번호를 사용\)을 복제하여 수행되어서는 안 됩니다.\(MUST NOT, MUST NOT, SHOULD\)

비인터리브 모드와 인터리브 모드를 사용하는 발신자는 다음 패킷화 규칙을 시행해야 합니다.\(MUST\)

o RTP 변환기에서 MANE는 단일 NAL 단위 패킷을 하나의 집합 패킷으로 변환하거나, 집합 패킷을 여러 개의 단일 NAL 단위 패킷으로 변환하거나, 두 개념을 혼합할 수 있습니다. RTP 변환기는 최소한 다음 매개변수를 고려해야 합니다: 경로 MTU 크기, 불평등 보호 메커니즘\(예: RFC 5109\[18\]에 따른 패킷 기반 FEC를 통해, 특히 시퀀스 및 그림 매개변수 세트 NAL 단위 및 코딩된 슬라이스 데이터 파티션의 경우\) NAL 단위\), 시스템의 견딜 수 있는 대기 시간 및 수신기의 버퍼링 기능입니다.\(MAY, SHOULD\)

- 참고 사항: RFC 3550에 따라 RTCP\(RTP 제어 프로토콜\)를 처리하려면 RTP 변환기가 필요합니다.

---
### **6.2.  Single NAL Unit Mode**

이 모드는 OPTIONAL 패킷화 모드 미디어 유형 매개변수의 값이 0이거나 패킷화 모드가 존재하지 않을 때 사용됩니다. 모든 수신기는 이 모드를 지원해야 합니다. 이는 주로 ITU-T 권고안 H.241 \[3\]을 사용하는 시스템과 호환되는 저지연 애플리케이션을 위한 것입니다\(섹션 12.1 참조\). 이 모드에서는 단일 NAL 단위 패킷만 사용할 수 있습니다. STAP, MTAP 및 FU는 사용하면 안 됩니다. 단일 NAL 단위 패킷의 전송 순서는 NAL 단위 디코딩 순서를 준수해야 합니다.\(MAY, MUST, MAY, MUST NOT, MUST\)

---
### **6.3.  Non-Interleaved Mode**

이 모드는 OPTIONAL packetization-mode 미디어 유형 매개변수의 값이 1일 때 사용됩니다. 이 모드는 지원되어야 합니다. 이는 주로 저지연 애플리케이션을 위한 것입니다. 이 모드에서는 단일 NAL 단위 패킷, STAP-A 및 FU-A만 사용할 수 있습니다. STAP-B, MTAP 및 FU-B는 사용하면 안 됩니다. NAL 단위의 전송 순서는 NAL 단위 디코딩 순서를 준수해야 합니다.\(MAY, SHOULD, MAY, MUST NOT, MUST\)

---
### **6.4.  Interleaved Mode**

이 모드는 OPTIONAL packetization-mode 미디어 유형 매개변수의 값이 2일 때 사용됩니다. 일부 수신기는 이 모드를 지원할 수도 있습니다. STAP-B, MTAP, FU-A 및 FU-B를 사용할 수 있습니다. STAP-A 및 단일 NAL 단위 패킷은 사용되어서는 안 됩니다. 패킷과 NAL 단위의 전송 순서는 5.5절에 명시된 대로 제한됩니다.\(MAY, MAY, MAY, MUST NOT\)

---
## **7.  De-Packetization Process**

패킷 해제 프로세스는 구현에 따라 다릅니다. 그러므로 다음의 설명은 적절한 구현의 예로 보아야 한다. 동일한 입력에 대한 출력이 아래 설명된 프로세스와 동일하다면 다른 방식을 사용할 수도 있습니다. 동일한 출력은 결과 NAL 단위와 그 순서가 동일하다는 것을 의미합니다. 설명된 알고리즘과 관련된 최적화가 가능할 수 있습니다. 7.1절에서는 단일 NAL 단위 및 비인터리브 패킷화 모드에 대한 역패킷화 프로세스를 제시하고, 7.2절에서는 인터리브 모드에 대한 프로세스를 설명합니다. 섹션 7.3에는 지능형 수신기에 대한 추가 패킷 해제 지침이 포함되어 있습니다.

버퍼 관리와 관련된 모든 일반 RTP 메커니즘이 적용됩니다. 특히 중복되거나 오래된 RTP 패킷\(RTP 시퀀스 번호 및 RTP 타임스탬프로 표시됨\)이 제거됩니다. 정확한 디코딩 시간을 결정하려면 적절한 스트림 간 동기화를 허용하기 위한 의도적인 지연 가능성과 같은 요소를 고려해야 합니다.

---
### **7.1.  Single NAL Unit and Non-Interleaved Mode**

수신기에는 전송 지연 지터를 보상하기 위한 수신기 버퍼가 포함되어 있습니다. 수신기는 수신 패킷을 수신 순서대로 수신기 버퍼에 저장합니다. 패킷은 RTP 시퀀스 번호 순서로 패킷 해제됩니다. 패킷 해제된 패킷이 단일 NAL 단위 패킷인 경우, 패킷에 포함된 NAL 단위는 디코더로 직접 전달됩니다. 패킷 해제된 패킷이 STAP-A인 경우, 패킷에 포함된 NAL 단위는 패킷에 캡슐화된 순서대로 디코더에 전달됩니다. 단일 NAL 단위의 조각을 포함하는 모든 FU-A 패킷에 대해 패킷 해제된 조각은 전송 순서대로 연결되어 NAL 단위를 복구한 다음 디코더로 전달됩니다.

- 참고 사항: 디코더가 임의의 슬라이스 순서를 지원하는 경우 그림의 코딩된 슬라이스는 수신 및 전송 순서에 관계없이 임의의 순서로 디코더에 전달될 수 있습니다.

---
### **7.2.  Interleaved Mode**

이러한 패킷 해제 규칙 뒤에 있는 일반적인 개념은 NAL 단위를 전송 순서에서 NAL 단위 디코딩 순서로 재정렬하는 것입니다.

수신기는 전송 지연 지터를 보상하고 NAL 단위를 전송 순서에서 NAL 단위 디코딩 순서로 재정렬하는 데 사용되는 수신기 버퍼를 포함합니다. 본 절에서는 수신자의 동작을 다음과 같은 가정 하에 설명한다.

전송 지연 지터가 없습니다. 전송 지연 지터의 보상에도 사용되는 실제 수신기 버퍼와 수신기 버퍼를 구별하기 위해 이하에서는 수신기 버퍼를 디인터리빙 버퍼라고 합니다. 수신기는 또한 전송 지연 지터를 준비해야 합니다. 즉, 전송 지연 지터 버퍼링 및 디인터리빙 버퍼링을 위해 별도의 버퍼를 예약하거나 전송 지연 지터 및 디인터리빙 모두에 수신기 버퍼를 사용해야 합니다. 또한 수신기는 버퍼링 작업에서 전송 지연 지터를 고려해야 합니다\(예: 디코딩 및 재생을 시작하기 전에 추가 초기 버퍼링\).\(SHOULD, SHOULD\)

이 섹션은 다음과 같이 구성됩니다. 하위 섹션 7.2.1은 디인터리빙 버퍼의 크기를 계산하는 방법을 나타냅니다. 하위 섹션 7.2.2는 수신된 NAL 단위를 NAL 단위 디코딩 순서로 구성하는 방법에 대한 수신기 프로세스를 지정합니다.

---
#### **7.2.1.  Size of the De-Interleaving Buffer**

Offer/Answer 또는 선언적 SDP\(Session Description Protocol\) 사용에서 sprop-deint-buf-req 미디어 유형 매개변수는 디인터리빙 버퍼 크기에 대한 요구 사항을 알립니다. 따라서 바이트 수 측면에서 디인터리빙 버퍼 크기를 sprop-deint-buf-req 미디어 유형 매개변수 값보다 크거나 같게 설정하는 것이 좋습니다.\(SHOULD\)

SDP 제안/응답 모델 또는 기타 기능 교환 절차가 세션 설정에 사용되는 경우 수신된 스트림의 속성은 수신기 기능을 초과하지 않도록 해야 합니다. SDP Offer/Answer 모델에서 수신기는 deint-buf-cap 미디어 유형 매개변수를 사용하여 디인터리빙 버퍼를 할당하는 기능을 나타낼 수 있습니다. deint-buf-cap 및 sprop-deint-buf-req 미디어 유형 매개변수에 대한 자세한 내용은 섹션 8.1을 참조하고 SDP 제안/응답 모델에서의 사용에 대한 자세한 내용은 섹션 8.2.2를 참조하세요.\(SHOULD\)

---
#### **7.2.2.  De-Interleaving Process**

수신기에는 초기 버퍼링과 재생 중 버퍼링이라는 두 가지 버퍼링 상태가 있습니다. 초기 버퍼링은 RTP 세션이 초기화될 때 발생합니다. 초기 버퍼링 이후 디코딩 및 재생이 시작되며, 재생 중 버퍼링 모드가 사용됩니다.

수신기는 버퍼링 상태와 상관없이 들어오는 NAL 유닛들을 수신 순서대로 다음과 같이 디인터리빙 버퍼에 저장한다. 집합 패킷의 NAL 단위는 디인터리빙 버퍼에 개별적으로 저장됩니다. DON의 값은 각 NAL 단위에 대해 계산되어 저장됩니다.

수신기 작업은 다음 함수와 상수를 사용하여 아래에 설명되어 있습니다.

o AbsDON 기능은 섹션 8.1에 지정되어 있습니다.

o don\_diff 함수는 섹션 5.5에 지정되어 있습니다.

o 상수 N은 1씩 증가된 선택적 sprop-interleaving-length 미디어 유형 매개변수\(섹션 8.1 참조\)의 값입니다.\(MAY\)

초기 버퍼링은 다음 조건 중 하나가 충족될 때까지 지속됩니다.

o 디인터리빙 버퍼에는 N개 이상의 VCL NAL 단위가 있습니다.

o sprop-max-don-diff가 존재하는 경우 don\_diff\(m,n\)은 sprop-max-don-diff의 값보다 크다. 여기서 n은 수신된 NAL 중 AbsDON의 값이 가장 큰 NAL 단위에 해당한다. m은 수신된 NAL 유닛 중 AbsDON 값이 가장 작은 NAL 유닛에 해당한다.

o 초기 버퍼링은 선택적 sprop-init-buf-time 미디어 유형 매개변수의 값보다 크거나 같은 기간 동안 지속되었습니다.\(MAY\)

디인터리빙 버퍼에서 제거될 NAL 단위는 다음과 같이 결정됩니다.

o 디인터리빙 버퍼가 적어도 N개의 VCL NAL 단위를 포함하는 경우, NAL 단위는 디인터리빙 버퍼에서 제거되고 버퍼가 N-1 VCL NAL 단위를 포함할 때까지 아래 지정된 순서로 디코더에 전달됩니다.

o sprop-max-don-diff가 존재하는 경우 don\_diff\(m,n\)가 sprop-max-don-diff보다 큰 모든 NAL 단위 m은 디인터리빙 버퍼에서 제거되고 순서대로 디코더에 전달됩니다. 아래에 지정됩니다. 여기서, n은 디인터리빙 버퍼의 NAL 유닛 중 AbsDON의 값이 가장 큰 NAL 유닛에 해당한다.

NAL 단위가 디코더에 전달되는 순서는 다음과 같이 지정됩니다.

o PDON을 RTP 세션 시작 시 0으로 초기화되는 변수로 둡니다.

o DON 값과 연관된 각 NAL 단위에 대해 DON 거리는 다음과 같이 계산됩니다. NAL 유닛의 DON 값이 PDON 값보다 큰 경우, DON 거리는 DON - PDON과 동일하다. 그렇지 않은 경우 DON 거리는 65535 - PDON + DON + 1과 같습니다.

o NAL 단위는 DON 거리의 오름차순으로 디코더에 전달됩니다. 여러 NAL 단위가 동일한 DON 거리 값을 공유하는 경우 순서에 관계없이 디코더에 전달될 수 있습니다.

o 원하는 수의 NAL 단위가 디코더에 전달되면 PDON 값은 디코더에 전달된 마지막 NAL 단위에 대한 DON 값으로 설정됩니다.

---
### **7.3.  Additional De-Packetization Guidelines**

다음과 같은 추가 패킷 해제 규칙을 사용하여 작동 중인 H.264 패킷 해제 도구를 구현할 수 있습니다.

o 지능형 RTP 수신기\(예: 게이트웨이\)는 손실된 코딩된 슬라이스 데이터 파티션 A\(DPA\)를 식별할 수 있습니다. 손실된 DPA가 감지되면 가능한 재전송 및 FEC를 고려한 후 게이트웨이는 해당 코딩된 슬라이스 데이터 파티션 B 및 C를 전송하지 않기로 결정할 수 있습니다. 해당 정보는 H.264 디코더에 의미가 없기 때문입니다. 이러한 방식으로 MANE는 복잡한 비트스트림을 구문 분석하지 않고 쓸모 없는 패킷을 폐기하여 네트워크 부하를 줄일 수 있습니다.

o 지능형 RTP 수신기\(예: 게이트웨이\)는 손실된 FU를 식별할 수 있습니다. 손실된 FU가 발견되면 게이트웨이는 동일한 조각화된 NAL 장치의 다음 FU를 전송하지 않기로 결정할 수 있습니다. 해당 정보는 H.264 디코더에 의미가 없기 때문입니다. 이러한 방식으로 MANE는 복잡한 비트스트림을 구문 분석하지 않고 쓸모 없는 패킷을 폐기하여 네트워크 부하를 줄일 수 있습니다.

o 패킷 또는 NALU를 폐기해야 하는 지능형 수신기는 먼저 NAL 단위 유형 옥텟의 NRI 필드 값이 0인 모든 패킷/NALU를 폐기해야 합니다. 이렇게 하면 사용자 경험에 대한 영향을 최소화하고 참조 화면을 그대로 유지할 수 있습니다. 더 많은 패킷을 폐기해야 하는 경우

- 수치적으로 낮은 NRI 값을 가진 패킷은 수치적으로 더 높은 NRI 값을 가진 패킷보다 먼저 폐기되어야 합니다. 그러나 NRI가 0보다 큰 패킷을 폐기하면 디코더 드리프트가 발생할 가능성이 높으므로 피해야 합니다.\(SHOULD\)

---
## **8.  Payload Format Parameters**

이 섹션에서는 페이로드 형식의 선택적 기능과 비트스트림의 특정 기능을 선택하는 데 사용할 수 있는 매개변수를 지정합니다. 매개변수는 ITU-T H.264 | 미디어 하위 유형 등록의 일부로 여기에 지정됩니다. ISO/IEC 14496-10 코덱. SDP를 사용하는 애플리케이션을 위해 SDP\(Session Description Protocol\)\[6\]에 대한 매개변수 매핑도 제공됩니다. SDP를 사용하지 않는 제어 프로토콜과 함께 사용하기 위해 동등한 매개변수를 다른 곳에서 정의할 수 있습니다.\(MAY\)

일부 매개변수는 전송될 스트림의 속성을 수신자에게 제공합니다. 이러한 모든 매개변수의 이름은 스트림 속성의 경우 "sprop"로 시작됩니다. 이러한 "sprop" 매개변수 중 일부는 다른 페이로드 또는 코덱 구성 매개변수에 의해 제한됩니다. 예를 들어, sprop-parameter-sets 매개변수는 profile-level-id 매개변수에 의해 제한됩니다.

---
### **8.1.  Media Type Registration**

ITU-T H.264의 미디어 하위 유형 | ISO/IEC 14496-10 코덱은 IETF 트리에서 할당되었습니다.

```text
   Media Type name:     video

   Media subtype name:  H264

   Required parameters: none

   OPTIONAL parameters:
```

프로필 수준 ID:

- 시퀀스 매개변수 세트 NAL 단위의 다음 3바이트에 대한 base16\[7\]\(16진수\) 표현은 \[1\]에 지정됩니다. 1\) profile\_idc, 2\) 여기에서 profile-iop라고 하는 바이트는 다음 값으로 구성됩니다. Constraint\_set0\_flag, Constraint\_set1\_flag, Constraint\_set2\_flag, Constraint\_set3\_flag, Constraint\_set4\_flag, Constraint\_set5\_flag 및 Reserved\_zero\_2bits\(가장 중요한 비트부터 시작하여 비트 중요도 순서\) 및 3\) level\_idc. Reserved\_zero\_2bits는 \[1\]에서 0과 같아야 하지만 이에 대한 다른 값은 향후 ITU-T 또는 ISO/IEC에 의해 지정될 수 있습니다.

- profile-level-id 매개변수는 기본 하위 프로필\(즉, 스트림을 생성하는 데 사용되었거나 수신기가 지원하는 코딩 도구의 하위 집합\)과 스트림의 기본 수준 또는 수신기가 지원하는 것을 나타냅니다.

- 기본 하위 프로필은 profile\_idc 바이트와 profile-iop 바이트의 일부 필드로 집합적으로 표시됩니다. profile-iop 바이트의 필드 값에 따라 기본 하위 프로필은 섹션 7.4.2.1에 지정된 대로 하나의 프로필에서 지원하는 코딩 도구 집합이거나 여러 프로필의 코딩 도구의 공통 하위 집합일 수 있습니다. \[1\] 중 1개. 기본 수준은 level\_idc 바이트로 표시되며, profile\_idc가 66, 77 또는 88\(기본, 기본 또는 확장 프로필\)이고 level\_idc가 11인 경우 추가로 프로필의 비트 4\(constraint\_set3\_flag\)로 표시됩니다. -iop 바이트. profile\_idc가 66, 77 또는 88\(기준, 기본 또는 확장 프로필\)이고, level\_idc가 11이고, profile-iop 바이트의 비트 4\(constraint\_set3\_flag\)가 1인 경우 기본 수준은 Level입니다. 1b.

- 표 5에는 \[1\]의 부록 A에 정의된 모든 프로파일과 각 프로파일에 대해 동일한 하위 프로파일을 나타내는 profile\_idc 및 profile-iop의 가능한 조합이 나열되어 있습니다.

- 표 5. 하나의 프로파일이 지원하는 전체 코딩 도구 세트에 해당하는 동일한 하위 프로파일을 나타내는 profile\_idc 및 profile-iop의 조합. 다음에서 x는 0 또는 1일 수 있으며, 프로파일 이름은 다음과 같이 표시됩니다. CB: 제한된 기준 프로필, B: 기준 프로필, M: 기본 프로필, E: 확장 프로필, H: 하이 프로필, H10: 하이 10 프로필, H42: 하이 4:2:2 프로필, H44: 하이 4:4:4 예측 프로필, H10I: 높음 10 인트라 프로필, H42I: 높음 4:2:2 인트라 프로필, H44I: 높음 4:4:4 인트라 프로필 및 C44I: CAVLC 4:4:4 인트라 프로필.

```text
              Profile     profile_idc        profile-iop
                          (hexadecimal)      (binary)

              CB          42 (B)             x1xx0000
                 same as: 4D (M)             1xxx0000
                 same as: 58 (E)             11xx0000
              B           42 (B)             x0xx0000
                 same as: 58 (E)             10xx0000
              M           4D (M)             0x0x0000
              E           58                 00xx0000
              H           64                 00000000
              H10         6E                 00000000
              H42         7A                 00000000
              H44         F4                 00000000
              H10I        6E                 00010000
              H42I        7A                 00010000
              H44I        F4                 00010000
              C44I        2C                 00010000
```

- 예를 들어 위 표에서 profile\_idc가 58\(Extended\)이고 profile-iop이 11xx0000인 것은 profile\_idc가 42\(Baseline\)이고 profile-iop이 x1xx0000인 동일한 하위 프로필을 나타냅니다. profile\_idc와 profile-iop의 다른 조합\(표 5에 나열되지 않음\)은 둘 이상의 프로필에 대한 코딩 도구의 공통 하위 집합에 해당하는 하위 프로필을 나타낼 수 있습니다. 또한 특정 프로파일을 따르는 디코더는 다른 프로파일을 따르는 비트스트림을 디코딩할 수 있다는 점에 유의하십시오.

profile-level-id 매개변수가 다음을 나타내는 데 사용되는 경우

- NAL 단위 스트림의 속성은 스트림을 디코딩하기 위해 디코더가 지원해야 하는 코딩 도구의 최소 하위 집합이 기본 서브 프로파일이고 디코더가 지원해야 하는 가장 낮은 레벨이 기본 레벨임을 나타냅니다.

- profile-level-id 매개변수가 기능 교환 또는 세션 설정에 사용되는 경우 코덱이 수신 및 전송을 모두 지원하는 기본 하위 프로필과 동일한 코딩 도구의 하위 집합을 나타냅니다. max-recv-level이 없으면 profile-level-id의 기본 수준은 코덱이 지원하려는 최고 수준을 나타냅니다. max-recv-level이 있는 경우 코덱이 수신을 지원하는 최고 수준을 나타냅니다. 수신 또는 전송의 경우 지원되는 최고 수준보다 낮은 모든 수준도 지원되어야 합니다.\(MUST\)

- 참고 사항: 기능 교환 및 세션 설정 절차는 지원되는 각 하위 프로필에 대한 기능을 별도로 나열하는 수단을 제공해야 합니다. 예를 들어, SDP Offer/Answer 모델의 one-of-N 코덱 선택 절차가 사용될 수 있습니다\(\[8\]의 섹션 10.2\). N개 중 하나의 코덱 선택 절차는 동일한 하위 프로필을 나타내는 profile\_idc와 profile-iop의 서로 다른 조합을 제공하는 데에도 사용될 수 있습니다. 동일한 하위 프로필을 나타내는 profile\_idc와 profile-iop의 다양한 조합이 있는 경우 one-of-N 코덱 선택 절차를 사용하면 상당히 큰 SDP 메시지가 생성될 수 있습니다. 따라서 수신자는 동일한 하위 프로필을 나타내는 profile\_idc 및 profile-iop의 다양한 등가 조합을 이해하고 등가 조합을 사용하여 제안을 수락할 준비가 되어 있어야 합니다.

- profile-level-id가 없으면 레벨 1에서 추가 제약 조건이 없는 기준 프로필을 추론해야 합니다.\(MUST\)

최대-recv-레벨:

- 이 매개변수는 최고 수준이 기본 수준\(profile-level-id로 표시된 수준\)보다 높을 때 수신기가 지원하는 최고 수준을 나타내는 데 사용될 수 있습니다. max-recv-level의 값은 \[1\]에 지정된 시퀀스 매개변수 세트 NAL 단위인 profile-iop\(위에 정의된 대로\) 및 level\_idc의 구문 요소 profile\_idc 뒤의 2바이트에 대한 base16\(16진수\) 표현입니다. max-recv-level의 level\_idc 바이트가 11이고 max-recv-level의 profile-iop 바이트의 비트 4가 1이거나 max-recv-level의 level\_idc 바이트가 9이고 bit max-recv-level의 profile-iop 바이트 중 4는 0과 같으며, 수신기가 지원하는 최고 레벨은 레벨 1b입니다. 그렇지 않으면 수신기가 지원하는 최고 레벨은 max-recv-level의 level\_idc 바이트를 10으로 나눈 값과 같습니다.\(MAY\)

- 수신기가 지원하는 최고 레벨이 기본 레벨보다 높지 않은 경우 max-recv-level이 존재해서는 안 됩니다.\(MUST NOT\)

- max-mbps, max-smbps, max-fs, max-cpb, max-dpb 및 max-br: 이러한 매개변수는 수신기 구현 기능을 알리는 데 사용될 수 있습니다. 이러한 매개변수는 다른 목적으로 사용되어서는 안 됩니다. profile-level-id 매개변수 또는 max-recv-level 매개변수의 값으로 전달되는 최고 수준은 수신기가 완전히 지원할 수 있는 수준이어야 합니다. max-mbps, max-smbps, max-fs, max-cpb, max-dpb 및 max-br은 아래에 지정된 대로 신호된 최고 레벨의 필수 기능을 확장하는 수신기의 기능을 나타내는 데 사용될 수 있습니다.\(MAY, MUST NOT, MUST, MAY\)

- 세트\(max-mbps, max-smbps, max-fs, max-cpb, max-dpb, max-br\)에서 둘 이상의 매개변수가 존재하는 경우 수신기는 모든 신호 기능을 동시에 지원해야 합니다. 예를 들어, max-mbps와 max-br이 모두 존재하는 경우 프레임 속도와 비트 전송률을 모두 확장하여 신호된 최고 수준이 지원됩니다. 즉, 수신기는 매크로블록 처리 속도가 최대 max-mbps\(포함\)이고, 비트율이 최대 max-br\(포함\)인 NAL 단위 스트림을 디코딩할 수 있으며, 코딩된 픽처 버퍼 크기는 다음과 같이 도출됩니다. 아래 max-br 매개변수의 의미와 기타 속성은 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값에 지정된 최고 수준을 준수합니다.\(MUST\)

- 수신기가 레벨 A의 모든 속성을 지원할 수 있는 경우 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값에 지정된 최고 레벨은 레벨 A여야 합니다\(즉, 레벨 A보다 낮아서는 안 됩니다. \). 즉, 수신기는 값에 지정된 최고 수준과 비교하여 더 높은 수준의 요구 사항을 함께 충족하는 max-mbps, max-fs, max-cpb, max-dpb 및 max-br 값을 신호로 보내서는 안 됩니다. profile-level-id 매개변수 또는 max-recv-level 매개변수.\(MUST NOT, MUST NOT\)

- 참고 사항: NAL 단위 스트림의 속성을 신호하기 위해 선택적 미디어 유형 매개변수가 사용되는 경우 max-mbps, max-smbps, max-fs, max-cpb, max-dpb 및 max-br은 존재하지 않습니다. profile-level-id의 값은 항상 NAL 단위 스트림이 지정된 프로필 및 수준을 완전히 준수하도록 해야 합니다.\(MAY\)

- max-mbps: max-mbps의 값은 초당 매크로블록 단위로 최대 매크로블록 처리 속도를 나타내는 정수이다. max-mbps 매개변수는 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값으로 전달된 신호된 최고 레벨에 필요한 것보다 더 높은 속도로 수신기가 비디오를 디코딩할 수 있다는 신호를 보냅니다.

- max-mbps가 신호되면 수신기는 신호된 최고 레벨을 준수하는 NAL 단위 스트림을 디코딩할 수 있어야 합니다. 단, 신호된 최고 레벨에 대한 \[1\]의 표 A-1의 MaxMBPS 값은 다음으로 대체됩니다. 최대 mbps의 값. max-mbps 값은 최고 수준에 대해 \[1\]의 표 A-1에 제공된 MaxMBPS 값보다 크거나 같아야 합니다. 발신자는 이 지식을 사용하여 신호된 최고 레벨에 표시된 것보다 더 높은 영상 속도로 주어진 크기의 영상을 보낼 수 있습니다.\(MUST, MUST, MAY\)

- max-smbps: max-smbps의 값은 모든 매크로블록이 정적 매크로블록이라는 가정하에 최대 정적 매크로블록 처리 속도를 초당 정적 매크로블록 단위로 나타내는 정수이다. max-smbps가 신호를 받으면 \[1\]의 표 A-1에 있는 MaxMBPS 값은 다음 계산 결과로 대체되어야 합니다.

- o max-mbps 매개변수가 신호를 받으면 MaxMacroblocksPerSecond 변수를 max-mbps 값으로 설정합니다. 그렇지 않으면 MaxMacroblocksPerSecond를 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값으로 전달되는 신호 최고 레벨에 대해 표 A-1 \[1\]의 MaxMBPS 값과 동일하게 설정하십시오.

- o 변수 P\_non-static을 그림 n의 비정적 매크로블록 비율로 설정합니다.

o 변수 P\_static을 정적 비율로 설정합니다.

- 그림 n의 매크로블록

o \[1\]의 표 A-1의 MaxMBPS 값은 다음과 같아야 합니다.

- 인코더에 의해 다음과 같다고 간주됩니다:

```text
            MaxMacroblocksPerSecond * max-smbps / (P_non-static *
            max-smbps + P_static * MaxMacroblocksPerSecond)
```

- 인코더는 각 그림에 대해 이 값을 다시 계산해야 합니다. max-smbps의 값은 max-mbps 매개변수의 값으로 명시적으로 제공되거나 신호된 최고 레벨에 대해 \[1\]의 표 A-1에 암시적으로 제공되는 MaxMBPS의 값보다 크거나 같아야 합니다. 발신자는 이 지식을 사용하여 신호된 최고 레벨에 표시된 것보다 더 높은 영상 속도로 주어진 크기의 영상을 보낼 수 있습니다.\(MUST, MAY\)

- max-fs: max-fs의 값은 매크로블록 단위로 최대 프레임 크기를 나타내는 정수이다. max-fs 매개변수는 전달된 최고 수준의 신호에 필요한 것보다 더 큰 그림 크기를 수신기가 디코딩할 수 있음을 나타냅니다.

- profile-level-id 매개변수 또는 max-recv-level 매개변수의 값. max-fs가 신호되면 수신기는 신호된 최고 레벨을 준수하는 NAL 단위 스트림을 디코딩할 수 있어야 합니다. 단, 신호된 최고 레벨에 대한 \[1\]의 표 A-1의 MaxFS 값은 다음으로 대체됩니다. max-fs의 값. max-fs 값은 \[1\]의 표 A-1에 제공된 최고 수준의 MaxFS 값보다 크거나 같아야 합니다. 발신자는 이 지식을 사용하여 신호를 받은 최고 수준에 표시된 것보다 비례적으로 낮은 프레임 속도로 더 큰 그림을 보낼 수 있습니다.\(MUST, MUST, MAY\)

- max-cpb: max-cpb의 값은 VCL HRD 매개변수의 경우 1000비트 단위, NAL HRD 매개변수의 경우 1200비트 단위로 최대 코딩된 픽처 버퍼 크기를 나타내는 정수입니다. 이 매개변수는 cpbBrVclFactor 및 cpbBrNALFactor 단위를 사용하지 않습니다\(\[1\]의 표 A-1 참조\). max-cpb 매개변수는 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값으로 전달된 신호된 최고 레벨에 필요한 코딩된 그림 버퍼 메모리의 최소량보다 더 많은 메모리를 수신기에 가지고 있다는 신호를 보냅니다. max-cpb가 신호되면 수신기는 신호된 최고 레벨을 준수하는 NAL 단위 스트림을 디코딩할 수 있어야 합니다. 단, 신호된 최고 레벨에 대한 \[1\]의 표 A-1의 MaxCPB 값은 다음과 같이 대체됩니다. max-cpb 값\(필요한 경우 cpbBrVclFactor 및 cpbBrNALFactor를 고려한 후\) max-cpb 값\(필요한 경우 cpbBrVclFactor 및 cpbBrNALFactor를 고려한 후\)은 최고 수준에 대해 \[1\]의 표 A-1에 제공된 MaxCPB 값보다 크거나 같아야 합니다. 발신자는 이 지식을 사용하여 \[1\]의 표 A-1에 있는 MaxCPB 값으로 달성할 수 있는 것보다 더 큰 비트 전송률 변화로 코딩된 비디오 스트림을 구성할 수 있습니다.\(MUST, MUST, MAY\)

- 참고 사항: 코딩된 그림 버퍼는 가상 참조 디코더\(H.264의 부록 C\)에 사용됩니다. 생성된 비트스트림이 표준을 준수하는지 확인하고 출력 비트 전송률을 제어하려면 H.264 인코더에서 가상 참조 디코더를 사용하는 것이 좋습니다. 따라서, 코딩된 화상 버퍼는 디인터리빙 및 디지터 버퍼를 포함하여 수신기의 다른 잠재적인 버퍼와 개념적으로 독립적입니다. 코딩된 그림 버퍼는 H.264의 Annex C에 지정된 대로 디코더에서 구현될 필요가 없지만 표준 호환 디코더는 표준 호환 비트스트림을 디코딩할 수 있는 경우 버퍼링 배열을 가질 수 있습니다. 따라서 실제로 비디오 디코더의 입력 버퍼는 수신기의 디인터리빙 및 디지터 버퍼와 통합될 수 있습니다.

- max-dpb: max-dpb의 값은 8/3 매크로블록 단위로 최대 디코딩된 픽처 버퍼 크기를 나타내는 정수이다. max-dpb 매개변수는 profile-level-id 매개변수 또는 max-recv-level 매개변수의 값으로 전달된 신호된 최고 레벨에 필요한 최소량의 디코딩된 그림 버퍼 메모리보다 수신기에 더 많은 메모리가 있다는 신호를 보냅니다. max-dpb가 신호되면 수신기는 신호된 최고 레벨을 준수하는 NAL 단위 스트림을 디코딩할 수 있어야 합니다. 단, 신호된 최고 레벨에 대한 \[1\]의 표 A-1의 MaxDpbMbs 값은 다음과 같이 대체됩니다. max-dpb \* 3/8의 값. 결과적으로, max-dpb를 신호하는 수신기는 디코딩된 그림 버퍼에 다음 수의 디코딩된 프레임, 상보 필드 쌍 및 쌍을 이루지 않은 필드를 저장할 수 있어야 합니다.\(MUST, MUST\)

```text
            Min(max-dpb * 3 / 8 / ( PicWidthInMbs * FrameHeightInMbs),
            16)
```

- PicWidthInMbs와 FrameHeightInMbs는 \[1\]에 정의되어 있습니다.

- max-dpb의 값은 MaxDpbMbs \* 3 / 8의 값보다 크거나 같아야 하며, 여기서 MaxDpbMbs의 값은 최고 수준에 대해 \[1\]의 표 A-1에 나와 있습니다. 발신자는 이 지식을 사용하여 향상된 압축으로 코딩된 비디오 스트림을 구성할 수 있습니다.\(MUST, MAY\)

- 참고 사항: 이 매개변수는 주로 ITU-T 권장 사항 H.245의 유사한 코드 포인트를 보완하여 신호 게이트웨이 설계를 용이하게 하기 위해 추가되었습니다. 디코딩된 그림 버퍼는 재구성된 샘플을 저장합니다. 디코딩된 그림 버퍼의 크기와 RTP에 사용되는 버퍼, 특히 디인터리빙 및 디지터 버퍼 사이에는 관계가 없습니다.

참고 사항: 이 문서의 RFC 3984에서

- 더 이상 사용되지 않으며 이 매개변수의 단위는 1024바이트입니다. 이 문서에서는 단위가 8/3 매크로블록으로 변경되었습니다. 이러한 변경의 이유는 RFC 3984에서 참조하는 H.264 사양의 2003 버전에서 이 문서에서 참조하는 H.264 사양의 2010 버전으로의 변경, 특히 H의 표 A-1에 대한 변경 때문이었습니다. 이전에는 지원되지 않았던 색상 형식 및 비트 심도 추가로 인해 .264 사양이 적용되었습니다. 이 매개변수의 변경된 의미는 RFC 3984와의 역호환성을 유지하고 H.264 사양의 2010 버전에 정의된 모든 프로필을 지원합니다.

- max-br: max-br 값은 VCL HRD 매개변수의 경우 초당 1000비트 단위, NAL HRD 매개변수의 경우 초당 1200비트 단위로 최대 비디오 비트레이트를 나타내는 정수입니다. 이 매개변수는 cpbBrVclFactor 및 cpbBrNALFactor 단위를 사용하지 않습니다\(\[1\]의 표 A-1 참조\).

- max-br 매개변수는 수신기의 비디오 디코더가 profile-level-id 매개변수 또는 max-recv-level의 값으로 전달된 신호된 최고 레벨에 필요한 것보다 높은 비트 전송률로 비디오를 디코딩할 수 있음을 나타냅니다. 매개변수.

- max-br이 신호되면 수신기의 비디오 코덱은 신호된 최고 레벨을 준수하는 NAL 단위 스트림을 디코딩할 수 있어야 합니다. 단, 최고 레벨에서 지정한 제한에는 다음 예외가 있습니다.\(MUST\)

- o max-br 값\(필요한 경우 cpbBrVclFactor 및 cpbBrNALFactor를 고려한 후\)은 최고 수준에 대해 \[1\]의 표 A-1에 있는 MaxBR 값을 대체합니다.

- o max-cpb 매개변수가 없는 경우 다음 공식의 결과는 \[1\]의 표 A-1의 MaxCPB 값을 대체합니다. \(신호 수준의 MaxCPB\) \* max-br / \(신호 수준의 MaxBR 최고 수준\).

- 예를 들어 수신기가 max-br이 1550인 메인 프로필 레벨 1.2에 대한 기능을 신호하는 경우 이는 VCL HRD 매개변수의 경우 최대 비디오 비트 전송률이 1550kbits/sec이고 NAL HRD의 경우 최대 비디오 비트 전송률이 1860kbits/sec임을 나타냅니다. 매개변수 및 CPB 크기는 4036458비트\(1550000 / 384000 \* 1000 \* 1000\)입니다.

max-br 값\(cpbBrVclFactor 및

- 필요한 경우 cpbBrNALFactor 고려\) 신호를 받은 최고 레벨에 대해 \[1\]의 표 A-1에 제공된 MaxBR 값보다 크거나 같아야 합니다.\(MUST\)

- 발신자는 향상된 비디오 품질을 달성하기 위해 이 지식을 사용하여 H.264의 부록 A 레벨 정의에서 허용되는 더 높은 비트 전송률 비디오를 보낼 수 있습니다.\(MAY\)

- 참고 사항: 이 매개변수는 주로 ITU-T 권장 사항 H.245의 유사한 코드 포인트를 보완하여 신호 게이트웨이 설계를 용이하게 하기 위해 추가되었습니다. 네트워크가 주어진 시간에 이러한 비트 전송률을 처리할 수 있다는 가정은

- 이 매개변수. 특히, 혼잡 제어 제약 하에서 신호 비트율이 가능하다는 결론은 도출될 수 없습니다.

중복 사진 캡:

- 이 매개변수는 수신기 구현 기능을 나타냅니다. 0과 같을 때, 매개변수는 수신기가 잘못 디코딩된 기본 코딩된 화면을 정정하기 위해 중복된 코딩된 화면을 사용하려고 시도하지 않음을 나타냅니다. 0과 같으면 수신기는 중복 슬라이스를 사용할 수 없습니다. 그러므로 발신자는 대역폭을 절약하기 위해 중복 슬라이스 전송을 피해야 합니다. 1과 같을 때, 수신자는 기본 디코딩된 화면에서 손상된 영역을 포함하는 중복 슬라이스를\(적어도 부분적으로\) 디코딩할 수 있으므로 송신자는 중복 슬라이스를 보낼 수 있습니다. 매개변수가 없으면 redundant-pic-cap에 0 값을 사용해야 합니다. redundant-pic-cap이 있는 경우 값은 0 또는 1이어야 합니다.\(SHOULD, MAY, MUST, MUST\)

- profile-level-id 매개변수가 redundant-pic-cap 매개변수와 동일한 신호에 존재하고 profile-level-id에 표시된 프로필이 중복 코딩된 사진\(예: Main 프로필\)의 사용을 허용하지 않는 경우 , redundant-pic-cap의 값은 0과 같아야 합니다. 수신기가 redundant-pic-cap이 0과 같다고 표시할 때 수신된 스트림은 중복된 코딩된 그림을 포함해서는 안 됩니다.\(MUST, SHOULD NOT\)

- 참고 사항: redundant-pic-cap이 0과 같더라도 디코더가 중복 코딩된 그림이 허용되는 프로필\(기준선, 확장\)을 지원하는 경우 디코더는 중복 코덱 그림을 무시할 수 있습니다.

- 참고 사항: redundant-pic-cap이 1과 같더라도 수신기는 중복 슬라이스의 디코딩을 대체하거나 보완하기 위해 다른 오류 은폐 전략을 선택할 수도 있습니다.

sprop-매개변수 세트:

- 이 매개변수는 디코딩 순서에서 다른 NAL 단위보다 앞에 NAL 단위 스트림에 배치될 수 있는 임의의 시퀀스 및 그림 매개변수 세트 NAL 단위\(여기서는 초기 매개변수 세트 NAL 단위라고 함\)를 전달하는 데 사용될 수 있습니다. 매개변수는 기능 교환 절차에서 코덱 기능을 나타내는 데 사용되어서는 안 됩니다. 매개변수의 값은 섹션 7.3.2.1에 지정된 매개변수 세트 NAL 단위의 base64 \[7\] 표현을 쉼표로 구분한\(','\) 목록입니다.\(MAY, MUST NOT\)

- \[1\]의 7.3.2.2. 매개변수 세트 NAL 단위의 바이트 수는 일반적으로 10 미만이지만 그림 매개변수 세트 NAL 단위는 수백 바이트를 포함할 수 있습니다.

- 참고 사항: SDP 제안/응답 모델에서 각각 고유한 sprop-매개변수 세트 매개변수가 있는 여러 페이로드 유형이 제공되는 경우 수신기는 해당 매개변수 세트가 충돌하는 저장 위치\(즉, 매개변수의 동일한 값\)를 사용하지 않는다고 가정할 수 없습니다. 식별자를 설정합니다\). 따라서 수신기는 모든 sprop-parameter-set를 버퍼링하고 특정 페이로드 유형을 디코딩하는 디코더 인스턴스에서 사용할 수 있도록 해야 합니다.

- sprop-parameter-sets 매개변수는 profile-level-id를 준수하는 매개변수 세트만 포함해야 합니다. 즉, 매개변수 세트 중 하나가 나타내는 코딩 도구의 하위 세트는 기본 하위 프로필과 동일해야 하며 매개변수 세트로 표시된 레벨은 반드시 기본 레벨과 동일해야 합니다.\(MUST\)

sprop-레벨-매개변수 세트:

- 이 매개변수는 디코딩 순서에서 다른 NAL 단위보다 앞서 NAL 단위 스트림에 배치될 수 있고 연관된 임의의 시퀀스 및 그림 매개변수 세트 NAL 단위\(여기서는 초기 매개변수 세트 NAL 단위라고 함\)를 전달하는 데 사용될 수 있습니다. 기본 수준과 다른 수준이 하나 이상 있습니다. 매개변수는 기능 교환 절차에서 코덱 기능을 나타내는 데 사용되어서는 안 됩니다.\(MAY, MUST NOT\)

- sprop-level-parameter-sets 매개변수에는 기본 수준과 다른 하나 이상의 수준에 대한 매개변수 세트가 포함되어 있습니다. 한 수준과 연관된 모든 매개변수 세트는 클러스터링되며 profile-level-id와 동일한 구문을 가진 3바이트 필드가 앞에 붙습니다. 이를 통해 수신기는 한 레벨에 대한 매개변수 세트를 설치하고 나머지는 폐기할 수 있습니다. 3바이트 필드의 이름은 PLId이고, 한 수준과 관련된 모든 매개변수 집합의 이름은 PSL입니다. 이는 sprop-parameter-sets와 동일한 구문을 갖습니다. 각 레벨에 대한 매개변수 세트는 PLId:PSL 형식으로 표시됩니다. 즉, PLId 뒤에 콜론\(':'\)이 따르고 해당 레벨에 대한 초기 매개변수 세트 NAL 단위의 base64\[7\] 표현이 표시됩니다. PLId:PSL의 각 쌍도 콜론으로 구분됩니다. PSL에는 해당 레벨에 대한 여러 매개변수 세트가 쉼표\(','\)로 구분되어 포함될 수 있습니다.

- 각 PLId 필드가 나타내는 코딩 도구의 하위 집합은 기본 하위 프로파일과 동일해야 하며\(MUST\), 각 PLId 필드가 나타내는 레벨은 기본 레벨과 달라야 합니다\(MUST\). 모두\(MUST\)

- 각 PSL에 포함된 시퀀스 매개변수 세트는 profile\_idc부터 level\_idc까지 3바이트를 가져야 하며 이전 PLId와 동일해야 합니다.\(MUST\)

- 참고 사항: 이 매개변수는 SDP 제공/응답 및 매개변수 세트의 대역 외 전송에서 효율적인 레벨 다운그레이드 또는 업그레이드를 동시에 허용합니다.

사용 수준-src-매개변수 세트:

- 이 매개변수는 수신기 성능을 나타내는 데 사용될 수 있습니다. 값은 0 또는 1일 수 있습니다. 매개변수가 없으면 값은 0과 같다고 추론되어야 합니다. 값 0은 수신자가 sprop-level-parameter-sets 매개변수를 이해하지 못함을 나타냅니다. \[9\]의 섹션 6.3에 지정된 "fmtp" 소스 속성을 이해하지 못하고, sprop-level-parameter-sets가 있는 경우 무시하며, "fmtp" 소스 속성을 사용하여 전달될 때 sprop-parameter-sets를 무시합니다. 값 1은 수신자가 sprop-level-parameter-sets 매개변수를 이해하고, \[9\]의 섹션 6.3에 지정된 "fmtp" 소스 속성을 이해하며, sprop-level-parameter에 포함된 매개변수 세트를 사용할 수 있음을 나타냅니다. - "fmtp" 소스 속성을 사용하여 전달되는 sprop- 매개변수 세트에 포함되거나 포함됩니다.\(MAY, MAY, MUST\)

- 참고 사항: RFC 3984 수신자는 \[9\]의 섹션 6.3에 지정된 대로 sprop-level-parameter-sets, use-level-src-parameter-sets 또는 "fmtp" 소스 속성을 이해하지 못합니다. 따라서 SDP 제안/응답 중에 응답자로서 RFC 3984 수신자는 섹션 6.3에 지정된 대로 "fmtp" 소스 속성을 사용하여 전달된 제안 및 sprop-매개변수 집합에 있을 때 sprop-level-매개변수 집합을 단순히 무시합니다. \[9\]의. 제공된 페이로드 유형이 기본 수준보다 낮은 수준에서 수락되었다고 가정합니다. 제공된 페이로드 유형에 sprop-level-parameter-sets 또는 "fmtp" 소스 속성을 사용하여 전달된 sprop-parameter-sets가 포함되어 있고 제공자가 응답자가 다음과 동일한 use-level-src-parameter-sets를 포함하지 않았음을 확인한 경우 1의 답변에서 제공자는 매개변수 세트의 대역 내 전송이 필요하다는 것을 알고 있습니다.

대역 내 매개변수 세트:

- 이 매개변수는 수신기 성능을 나타내는 데 사용될 수 있습니다. 값은 0 또는 1일 수 있습니다. 값 1은 수신기가 sprop-parameter-sets 및 sprop-level-parameter-sets의 대역 외 매개변수 세트를 폐기함을 나타냅니다. 따라서 송신자는 모든 매개변수 세트를 대역 내로 전송해야 합니다. 값 0은 수신기가 대역 외 매개변수 세트를 활용함을 나타냅니다.\(MAY, MAY, MUST\)

- sprop-parameter-sets 및/또는 sprop-level-parameter-sets에 포함됩니다. 그러나 이 경우 송신자는 여전히 매개변수 세트를 대역 내로 전송하도록 선택할 수 있습니다. in-band-parameter-sets가 1과 같으면 use-level-src-parameter-sets가 존재해서는 안되거나 0과 같아야 합니다. 매개변수가 존재하지 않으면 이 수신기 기능이 지정되지 않으므로 송신자는 대역 외 매개변수 세트만 보낼 수도 있고, 대역 내 매개변수 세트만 보낼 수도 있고, 둘 다 보낼 수도 있습니다.\(MAY, MUST NOT, MAY\)

레벨 비대칭 허용:

- 이 매개변수는 SDP 제안/응답에서 레벨 비대칭성, 즉 응답자-제공자 방향의 레벨과 제안자-응답자 방향의 다른 레벨로 인코딩된 미디어 전송이 허용되는지 여부를 나타내는 데 사용될 수 있습니다. 값은 0 또는 1과 같을 수 있습니다. 매개변수가 없으면 값은 0과 같다고 추론되어야 합니다. 제안과 답변 모두에서 값 1은 레벨 비대칭이 허용됨을 나타냅니다. 제안이나 답변의 값이 0이면 레벨 비대칭이 허용되지 않음을 나타냅니다.\(MAY, MAY, MUST\)

- 제안이나 답변 중 level-asymmetry-allowed가 0인 경우\(또는 존재하지 않는 경우\) 수준 비대칭이 허용되지 않습니다. 이 경우, Offerer에서 Answerer 방향으로 사용할 레벨은 반대 방향으로 사용할 레벨과 동일해야 합니다.\(MUST\)

패킷화 모드:

- 이 매개변수는 RTP 페이로드 유형의 속성이나 수신기 구현 기능을 나타냅니다. 단일 구성 지점만 표시될 수 있습니다. 따라서 둘 이상의 패킷화 모드를 지원하는 기능이 선언되면 여러 구성 지점\(RTP 페이로드 유형\)을 사용해야 합니다.

packetization-mode 값이 0 또는

- 패킷화 모드가 존재하지 않으면 단일 NAL 모드를 사용해야 합니다. 이 모드는 ITU-T 권장사항 H.241 \[3\]을 사용하는 표준에서 사용됩니다\(섹션 12.1 참조\). packetization-mode의 값이 1이면 비인터리브 모드를 사용해야 합니다. packetization-mode 값이 2이면 인터리브 모드를 사용해야 합니다. 패킷화 모드의 값은 0\~2 범위의 정수여야 합니다.\(MUST, MUST, MUST, MUST\)

sprop-인터리빙 깊이:

- 이 매개변수는 packetization-mode가 존재하지 않거나 packetization-mode 값이 0 또는 1인 경우 존재해서는 안 됩니다. 이 매개변수는 packetization-mode 값이 2인 경우 존재해야 합니다.\(MUST NOT, MUST\)

- 이 매개변수는 RTP 패킷 스트림의 속성을 나타냅니다. 이는 전송 순서에서 RTP 패킷 스트림의 VCL NAL 단위보다 앞서고 디코딩 순서에서 VCL NAL 단위 뒤에 오는 VCL NAL 단위의 최대 수를 지정합니다. 결과적으로, NAL 유닛 디코딩 순서 복구를 위한 버퍼 크기가 VCL NAL 유닛 기준으로 적어도 sprop-interleaving-length + 1 값일 때 수신기가 NAL 유닛 디코딩 순서를 재구성할 수 있음이 보장됩니다.

- sprop-interleaving-length 값은 0\~32767 범위의 정수여야 합니다.\(MUST\)

sprop-deint-buf-req:

- 이 매개변수는 packetization-mode가 존재하지 않거나 packetization-mode 값이 0 또는 1인 경우에는 존재해서는 안 됩니다. packetization-mode의 값이 2인 경우에는 존재해야 합니다.\(MUST NOT, MUST\)

sprop-deint-buf-req는 필요한 크기를 알려줍니다.

- RTP 패킷 스트림을 위한 디인터리빙 버퍼. 매개변수의 값은 섹션 7.2에 지정된 디인터리빙 버퍼에 필요한 최대 버퍼 점유\(바이트 단위\)보다 크거나 같아야 합니다. 디인터리빙 버퍼 크기가 바이트 단위로 sprop-deint-buf-req 값 이상일 때 수신기는 인터리빙된 NAL 단위를 NAL 단위 디코딩 순서에 따라 디인터리빙할 수 있음이 보장됩니다.\(MUST\)

- sprop-deint-buf-req 값은 0\~4294967295 범위의 정수여야 합니다.\(MUST\)

- 참고 사항: sprop-deint-buf-req는 디인터리빙 버퍼의 필수 크기만 나타냅니다. 네트워크 지터가 발생할 수 있는 경우 적절한 크기의 지터 버퍼도 제공해야 합니다.

deint-buf-cap:

- 이 매개변수는 수신기 구현의 기능을 신호하고 수신기가 NAL 단위 디코딩 순서를 재구성하기 위해 사용할 수 있는 바이트 단위의 디인터리빙 버퍼 공간의 양을 나타냅니다. 수신기는 sprop-deint-buf-req 매개변수 값이 이 매개변수보다 작거나 같은 모든 스트림을 처리할 수 있습니다.

- 매개변수가 없으면 deint-buf-cap에 0 값을 사용해야 합니다. deint-buf-cap의 값은 0에서 4294967295\(포함\) 범위의 정수여야 합니다.\(MUST, MUST\)

- 참고 사항: deint-buf-cap은 수신자의 디인터리빙 버퍼의 가능한 최대 크기를 나타냅니다. 네트워크 지터가 발생할 수 있는 경우 적절한 크기의 지터 버퍼도 제공해야 합니다.

sprop-init-buf-시간:

- 이 매개변수는 RTP 패킷 스트림의 속성을 알리는 데 사용될 수 있습니다. packetization-mode 값이 0 또는 1인 경우 매개변수가 존재해서는 안 됩니다.\(MAY, MUST NOT\)

- 매개변수는 전송 순서에서 NAL 단위 디코딩 순서를 복구하기 위해 디코딩을 시작하기 전에 수신기가 기다려야 하는 초기 버퍼링 시간을 나타냅니다. 매개변수는 신뢰성 있고 순간적인 전송, 전송과 디코딩의 타임라인이 동일하고 첫 번째 패킷이 도착할 때 디코딩이 시작된다는 가정 하에 \(NAL 단위의 디코딩 시간 - NAL 단위의 전송 시간\)의 최대값입니다.\(MUST\)

- sprop-init-buf-time 값을 지정하는 예는 다음과 같습니다. NAL 단위 스트림은 다음과 같은 인터리브 순서로 전송됩니다. 여기서 값은 디코딩 시간에 해당하고 전송 순서는 왼쪽에서 오른쪽입니다.

```text
               0  2  1  3  5  4  6  8  7 ...
```

NAL 단위의 안정적인 전송 속도를 가정하면,

- 전송 시간은 다음과 같습니다:

```text
               0  1  2  3  4  5  6  7  8 ...
```

- 전송 시간에서 열 단위로 디코딩 시간을 빼면 다음 계열이 생성됩니다.

```text
               0 -1  1  0 -1  1  0 -1  1 ...
```

- 따라서 NAL 단위 전송 시간 간격으로 보면 이 예에서 sprop-init-buf-time 값은 1입니다. 매개변수는 90kHz 클록의 클록 틱에서 음이 아닌 base10 정수 표현으로 코딩됩니다. . 매개변수가 없으면 초기 버퍼링 시간 값이 정의되지 않습니다. 그렇지 않은 경우 sprop-init-buf-time 값은 0에서 4294967295\(포함\) 범위의 정수여야 합니다.\(MUST\)

- 신호된 sprop-init-buf-time 외에도 수신기는 믹서, 변환기, 게이트웨이, 프록시, 트래픽 셰이퍼 및 기타 네트워크 요소로 인해 발생하는 지연 지터에 대한 버퍼링을 포함하여 전송 지연 지터 버퍼링을 고려해야 합니다.\(SHOULD\)

sprop-최대-돈-차이:

- 이 매개변수는 RTP 패킷 스트림의 속성을 알리는 데 사용될 수 있습니다. 송신기, 수신기 또는 코덱 기능에 신호를 보내는 데 사용해서는 안 됩니다. packetization-mode 값이 0 또는 1이면 매개변수가 존재해서는 안 됩니다. sprop-max-don-diff는 0에서 32767까지의 범위에 있는 정수입니다. sprop-max-don-diff가 없으면 매개변수 값이 지정되지 않습니다. sprop-max-don-diff는 다음과 같이 계산됩니다.\(MAY, MUST NOT, MUST NOT\)

sprop-max-don-diff = 최대{AbsDON\(i\) - AbsDON\(j\)},

- 모든 i와 j\>i에 대해,

- 여기서 i와 j는 전송 순서에서 NAL 단위의 인덱스를 나타내고 AbsDON은 65535 이후 0으로 랩 어라운드되지 않는 NAL 단위의 디코딩 순서 번호를 나타냅니다. 즉, AbsDON은 다음과 같이 계산됩니다. n은 전송 순서에 따라 연속적인 NAL 단위입니다. 전송 순서의 첫 번째 NAL 단위\(인덱스가 0임\)에 대해 AbsDON\(0\) = DON\(0\)입니다. 다른 NAL 단위의 경우 AbsDON은 다음과 같이 계산됩니다.

```text
            If DON(m) == DON(n), AbsDON(n) = AbsDON(m)

            If (DON(m) < DON(n) and DON(n) - DON(m) < 32768),
              AbsDON(n) = AbsDON(m) + DON(n) - DON(m)

            If (DON(m) > DON(n) and DON(m) - DON(n) >= 32768),
              AbsDON(n) = AbsDON(m) + 65536 - DON(m) + DON(n)

            If (DON(m) < DON(n) and DON(n) - DON(m) >= 32768),
              AbsDON(n) = AbsDON(m) - (DON(m) + 65536 - DON(n))

            If (DON(m) > DON(n) and DON(m) - DON(n) < 32768),
              AbsDON(n) = AbsDON(m) - (DON(m) - DON(n))
```

- 여기서 DON\(i\)는 전송 순서에서 인덱스 i를 갖는 NAL 단위의 디코딩 순서 번호이다. 디코딩 순서 번호는 섹션 5.5에 지정되어 있습니다.

- 참고 사항: 수신기는 sprop-max-don-diff를 사용하여 수신기 버퍼의 어떤 NAL 단위가 디코더에 전달될 수 있는지 트리거할 수 있습니다.

최대-rcmd-nalu-크기:

- 이 매개변수는 수신기의 기능을 알리는 데 사용될 수 있습니다. 매개변수는 다른 목적으로 사용되어서는 안 됩니다. 매개변수의 값은 수신자가 효율적으로 처리할 수 있는 최대 NALU 크기\(바이트\)를 나타냅니다. 매개변수 값은 권장사항이며 엄격한 상한이 아닙니다. 발신자는 더 큰 NALU를 생성할 수 있지만 이를 처리하는 데에는 제한 사항을 준수하는 NALU보다 비용이 더 많이 들 수 있다는 점을 알아야 합니다.\(MAY, MUST NOT, MAY\)

- max-rcmd-nalu-size 값은 0\~4294967295 범위의 정수여야 합니다. 이 매개변수를 지정하지 않으면 NALU 크기에 대해 알려진 제한이 존재하지 않습니다. 발신자는 여전히 발신자와 수신자 사이에 사용 가능한 MTU 크기를 고려해야 하며 이 목적을 위해 MTU 검색을 실행해야 합니다.\(MUST, SHOULD\)

- 이 매개변수는 예를 들어 H.223 전송 데이터 장치보다 작은 NALU가 더 효율적인 H.223 비디오 전화 통신 게이트웨이에 대한 IP에 의해 동기가 부여됩니다. 게이트웨이는 IP를 종료할 수 있습니다. 따라서 MTU 검색은 일반적으로 게이트웨이 외부에서는 작동하지 않습니다.

- 참고 사항: 이 매개변수를 필요한 값보다 낮게 설정하면 부정적인 영향을 미칠 수 있습니다.

사르 이해:

- 이 매개변수는 수신기 기능을 나타내는 데 사용될 수 있으며 그 외에는 아무것도 표시되지 않습니다. 이 매개변수는 수신자가 이해하는 255보다 작은 aspect\_ratio\_idc\(\[1\]에 지정됨\)의 최대값을 나타냅니다. \[1\]의 표 E-1은 Aspect\_ratio\_idc가 0과 같다고 "지정되지 않음"으로 지정합니다. 특정 샘플 종횡비\(SAR\)로서 1\~16\(포함\), 17부터 254까지는 "예약됨"으로 간주됩니다. 255는 SAR 너비와 SAR 높이가 명시적으로 신호되는 확장 SAR입니다. 따라서 \[1\]에 따른 디코더를 사용하는 수신기는 수신기가 SAR이 무엇인지 정확히 알고 있다는 의미에서 1부터 16까지의 범위에 있는 양상\_ratio\_idc와 255와 동일한 양상을 이해합니다. 그러한 수신기에 대해 sar-understood의 값은 16입니다. 미래에 \[1\]의 표 E-1이 확장되어, 예를 들어, Aspect\_ratio\_idc에 대한 SAR이 17로 지정되면, 다음을 갖는 수신기에 대해 확장, 가치를 이해하는 디코더\(MAY\)

- sar-understood는 17입니다. \[1\]의 2003년 버전에 따른 디코더가 있는 수신기의 경우 sar-understood의 값은 13입니다. 그 안에 있는 최소 예약된 양상\_ratio\_idc는 14이기 때문입니다.

- sar-understood가 존재하지 않는 경우 값은 13과 같다고 추론되어야 합니다.\(MUST\)

sar 지원:

- 이 매개변수는 수신기 기능을 나타내는 데 사용될 수 있으며 그 외에는 아무것도 표시되지 않습니다. 이 매개변수의 값은 1에서 sar-understood\(포함\) 범위의 정수이며 255와 같습니다. sar-supported의 값은 255보다 작은 N과 동일하며 수신기가 H.264 양상\_ratio\_idc에 해당하는 모든 SAR을 지원함을 나타냅니다. 기하학적 왜곡 없이 1부터 N까지의 범위에 있는 값\(\[1\]의 표 E-1 참조\). sar-supported 값이 255라는 것은 수신기가 두 개의 16비트 정수 값을 분자와 분모로 사용하여 표현 가능한 모든 샘플 종횡비, 즉 H.264 Aspect\_ratio\_idc 값 255를 사용하여 표현 가능한 모든 샘플 종횡비를 지원함을 나타냅니다. Extended\_SAR, \[1\]의 표 E-1 참조\), 기하학적 왜곡 없음.\(MAY\)

- H.264 호환 인코더는 0과 같은 양상\_ratio\_idc 또는 sar가 이해하는 것보다 크고 255보다 작은 양상\_ratio\_idc를 전송해서는 안 됩니다. H.264 호환 인코더는 수신기가 기하학적 왜곡 없이 표시할 수 있는 양상\_ratio\_idc를 전송해야 합니다. 그러나 H.264 호환 인코더는 SAR을 사용하여 사진을 전송하도록 선택할 수 있습니다.\(SHOULD NOT, SHOULD, MAY\)

- 스트림의 실제 샘플 종횡비 또는 확장된 샘플 종횡비가 있는 경우 시퀀스 매개변수 세트의 VUI\(비디오 사용성 정보\) 부분에 전달됩니다.

인코딩 고려사항:

- 이 유형은 RTP\(RFC 3550\)를 통한 전송에만 정의됩니다.

보안 고려사항:

- RFC 6184의 섹션 9를 참조하세요.

공개 사양:

- RFC 6184 및 해당 섹션 17을 참조하세요.

```text
      Additional information:
         None

      File extensions:  none

      Macintosh file type code:  none
```

- 개체 식별자 또는 OID: 없음

- 자세한 내용을 문의할 사람 및 이메일 주소: 왕예귀, yekui.wang@huawei.com

```text
      Intended usage:  COMMON

      Author:
         Ye-Kui Wang, yekui.wang@huawei.com
```

컨트롤러 변경:

- IESG에서 위임한 IETF 오디오/비디오 전송 실무 그룹.

---
### **8.2.  SDP Parameters**

수신자는 이 메모에 지정되지 않은 모든 매개변수를 무시해야 합니다.\(MUST\)

---
#### **8.2.1.  Mapping of Payload Type Parameters to SDP**

미디어 유형 video/H264 문자열은 다음과 같이 SDP\(Session Description Protocol\) \[6\]의 필드에 매핑됩니다.

o SDP의 "m=" 줄에 있는 미디어 이름은 비디오여야 합니다.\(MUST\)

o SDP의 "a=rtpmap" 줄에 있는 인코딩 이름은 H264\(미디어 하위 유형\)여야 합니다.\(MUST\)

o "a=rtpmap" 라인의 클럭 속도는 90000이어야 합니다.\(MUST\)

o 선택적 매개변수 profile-level-id, max-recv-level, max-mbps, max-smbps, max-fs, max-cpb, max-dpb, max-br, redundant-pic-cap, use-level- src-매개변수 세트, 대역 내 매개변수 세트, 레벨 비대칭 허용, 패킷화 모드, sprop-인터리빙 깊이, sprop-deint-buf-req, deint-buf-cap, sprop-init-buf- time, sprop- max-don-diff, max-rcmd-nalu-size, sar-understood 및 sar-supported가 있는 경우 SDP의 "a=fmtp" 줄에 포함되어야 합니다. 이러한 매개변수는 세미콜론으로 구분된 매개변수=값 쌍 목록 형식의 미디어 유형 문자열로 표현됩니다.\(MUST\)

o 선택적 매개변수 sprop-parameter-sets 및 sprop-level-parameter-sets가 있는 경우 SDP의 "a=fmtp" 라인에 포함되거나 \[의 섹션 6.3에 지정된 대로 "fmtp" 소스 속성을 사용하여 전달되어야 합니다. 9\]. 특정 미디어 형식\(예: RTP 페이로드 유형\)의 경우 sprop-parameter-sets 또는 sprop-level-parameter-sets는 모두 "a=fmtp" 행에 포함되어서는 안 됩니다.\(MUST, MUST NOT\)

- SDP이며 "fmtp" 소스 속성을 사용하여 전달됩니다. SDP의 "a=fmtp" 줄에 포함된 경우 이러한 매개변수는 세미콜론으로 구분된 매개변수=값 쌍 목록 형식의 미디어 유형 문자열로 표현됩니다. "fmtp" 소스 속성을 사용하여 전달되는 경우 이러한 매개변수는 "fmtp" 소스 속성의 일부로 지정된 소스 및 페이로드 유형과만 연관됩니다.

- 참고 사항: "fmtp" 소스 속성을 사용하여 sprop-parameter-sets 및 sprop-level-parameter-sets를 전달하면 Topo-Video-switch-MCU와 같은 토폴로지에서 매개변수 세트의 대역 외 전송이 허용됩니다\[29\] .

SDP의 미디어 표현 예는 다음과 같습니다\(기준 프로필, 레벨 3.0, 기본 프로필의 일부 제약 조건이 준수되지 않을 수 있음\).

```text
      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E;
                packetization-mode=1;
                sprop-parameter-sets=<parameter sets data>
```

---
#### **8.2.2.  Usage with the SDP Offer/Answer Model**

유니캐스트 사용 협상을 위해 제안/응답 모델\[8\]에서 SDP를 사용하여 RTP를 통해 H.264가 제공되는 경우 다음 제한 사항과 규칙이 적용됩니다.

o H.264의 미디어 형식 구성을 식별하는 매개변수는 profile-level-id 및 packetization-mode입니다. 이러한 미디어 형식 구성 매개변수\(profile-level-id의 수준 부분 제외\)는 대칭적으로 사용해야 합니다. 즉, 응답자는 모든 구성 매개변수를 유지하거나 하나 이상의 매개변수 값이 지원되지 않는 경우 미디어 형식\(페이로드 유형\)을 완전히 제거해야 합니다. profile-level-id의 레벨 부분에는 level\_idc가 포함되며, profile\_idc가 66, 77 또는 88일 때 레벨 1b를 표시하기 위해 profile-iop의 비트 4\(constraint\_set3\_flag\)가 포함됩니다. profile-level-id의 레벨 부분은 변경 가능합니다.\(MUST\)

- 참고 사항: 대칭 사용에 대한 요구 사항은 profile-level-id의 수준 부분에는 적용되지 않으며 다른 스트림 속성 및 기능 매개 변수에는 적용되지 않습니다.

- 참고사항: H.264\[1\]에서 Level 1b를 제외한 모든 레벨은 level\_idc 값을 10으로 나눈 값과 같습니다. Level 1b는 Level 1.0보다 높지만 Level 1.1보다 낮은 레벨이며 광고로 신호를 보냅니다. 혹독한 방식으로, 레벨이 였기 때문에

- 레벨 1.0 및 레벨 1.1 이후에 지정됩니다. 기준선, 기본 및 확장 프로필\(profile\_idc가 각각 66, 77, 88임\)의 경우 레벨 1b는 level\_idc가 11\(즉, 레벨 1.1과 동일\)이고 Constraint\_set3\_flag가 1로 표시됩니다. 다른 프로필의 경우 , 레벨 1b는 level\_idc가 9로 표시됩니다\(단, 이 프로필의 레벨 1b는 level\_idc가 10이고 레벨 1.1보다 낮은 레벨 1보다 여전히 높습니다\). SDP 제안/응답에서 제안에 대한 답변은 제안에 표시된 수준과 같거나 낮은 수준을 나타낼 수 있습니다. 레벨 1b의 임시 표시로 인해 제공자와 응답자는 profile\_idc가 66, 77 또는 88이고 level\_idc가 다음인 경우 profile-level-id 매개변수의 중간 옥텟의 비트 4\(constraint\_set3\_flag\) 값을 확인해야 합니다. 11과 같습니다.

- 이러한 구성의 처리 및 일치를 단순화하려면 \[8\]에 지정된 대로 제안에 사용된 것과 동일한 RTP 페이로드 유형 번호를 답변에도 사용해야 합니다. 구성이 제안과 정확히 동일하지 않는 한 답변에는 제안에 사용된 페이로드 유형 번호가 포함되어서는 안 됩니다.\(SHOULD, MUST NOT\)

- 참고 사항: 제안자가 답변을 받으면 미디어 유형\(예: 비디오/H264\) 및 위의 미디어 구성 매개변수를 기반으로 제안에 선언되지 않은 페이로드 유형을 이미 선언한 페이로드 유형과 비교해야 합니다. 답변에 다른 페이로드 유형 번호가 사용될 수 있으므로 이를 통해 문제의 구성이 새로운지 또는 이미 제공된 구성과 동일한지 여부를 결정할 수 있습니다.

o max-recv-level 매개변수가 있는 경우 수신에 지원되는 최고 수준을 선언합니다. max-recv-level이 없는 경우 수신을 지원하는 최고 수준은 profile-level-id의 level 부분에 표시된 기본 수준과 동일합니다. max-recv-level이 있는 경우 기본 수준보다 높아야 합니다.\(MUST\)

o level-asymmetry-allowed 매개변수는 레벨 비대칭이 허용되는지 여부를 나타냅니다.

- 제안이나 답변 중 level-asymmetry-allowed가 0인 경우\(또는 존재하지 않는 경우\) 수준 비대칭이 허용되지 않습니다. 이 경우, Offerer에서 Answerer 방향으로 사용할 레벨은 반대 방향으로 사용할 레벨과 동일해야 하며, 공용으로 사용하는 레벨은 Offer의 기본 레벨 중 낮은 값과 동일합니다. 답변의 기본 수준입니다.\(MUST\)

- 그렇지 않은 경우 level-asymmetry-allowed는 제안과 답변 모두 1이 되며, 수준 비대칭이 허용됩니다. 이 경우, 제안자-응답자 방향에서 사용할 레벨은 응답자가 수신을 지원하는 최고 레벨과 같아야 하며, 응답자-오퍼러 방향으로 사용할 레벨은 응답자의 최고 레벨과 같아야 합니다. 제공자는 수신을 지원합니다.\(MUST\)

- 레벨 비대칭이 허용되지 않으면 레벨 업그레이드가 허용되지 않습니다. 즉, 답변의 기본 레벨은 제안의 기본 레벨과 같거나 낮아야 합니다.\(MUST\)

o sprop-deint-buf-req, sprop-interleaving-length, sprop-max-don-diff 및 sprop-init-buf-time 매개변수는 제안자 또는 응답자가 보내는 RTP 패킷 스트림의 속성을 설명합니다. 미디어 형식 구성. 이는 Offer/Answer 매개변수의 일반적인 사용법과 다릅니다. 일반적으로 이러한 매개변수는 제안자 또는 응답자가 수신할 수 있는 스트림의 속성을 선언합니다. H.264를 처리할 때 제공자는 응답자가 제공되는 구성을 사용하여 인코딩된 미디어를 수신할 수 있다고 가정합니다.

- 참고 사항: 위의 매개변수는 동일한 구성을 가진 선언 엔터티가 전송한 모든 스트림에 적용됩니다. 즉, 소스에 의존합니다. 값은 페이로드 유형에 바인딩되는 대신 구성에 적용되므로 전송 시 다른 페이로드 유형에 적용되어야 할 수도 있습니다.

o 기능 매개변수 max-mbps, max-smbps, max-fs, max-cpb, max-dpb, max-br, redundant-pic-cap, max-rcmd-nalu-size, sar- Understanding 및 sar-supported 제안자 또는 응답자의 수신 능력을 추가로 선언하는 데 사용될 수 있습니다. 이러한 매개변수는 방향 속성이 "sendonly"일 때와 매개변수가 제공자 또는 응답자가 스트림 수신을 위해 허용하는 제한 사항을 설명할 때 존재해서는 안 됩니다.\(MAY, MUST NOT\)

o 제공자는 인터리빙된 H.264 스트림에 대한 제안에 디인터리빙 버퍼 크기인 sprop-deint-buf-req를 포함해야 합니다. 제공자와 응답자가 수신 스트림에서 버퍼링을 디인터리빙하는 기능에 대해 서로 알릴 수 있도록 두 당사자 모두 deint-buf-cap을 포함하는 것이 좋습니다. 인터리빙된 스트림의 경우 수신기의 기능을 알 수 없는 경우 버퍼링 요구 사항이 다른 여러 페이로드 유형을 제공하는 것을 고려하는 것도 권장됩니다.\(SHOULD, SHOULD\)

o sprop-parameter-sets 또는 sprop-level-parameter-sets 매개변수가 있는 경우\(SDP의 "a=fmtp" 라인에 포함되거나 SDP의 섹션 6.3에 지정된 대로 "fmtp" 소스 속성을 사용하여 전달됨\)

- \[9\]\)는 매개변수 세트의 대역 외 전송에 사용됩니다. 그러나 매개변수 세트의 대역 외 전송이 사용되는 경우 매개변수 세트는 여전히 대역 내에서 추가로 전송될 수 있습니다.\(MAY\)

- 응답자는 대역 외 매개변수 세트 전송이 제안자-응답자 방향에서 사용되었는지 여부에 관계없이 전송 중인 스트림에 대한 매개변수 세트의 대역 외 또는 대역 내 전송을 사용할 수 있습니다. 답변에 포함된 매개변수 세트는 제안에 포함된 매개변수 세트와 독립적입니다. 두 개의 서로 다른 비디오 스트림\(하나는 응답자에서 제공자까지, 다른 하나는 반대 방향\)을 디코딩하는 데 사용되기 때문입니다.\(MAY\)

- 다음 규칙은 제안자에서 응답자 방향으로 매개변수 집합을 전송하는 데 적용됩니다.

- o 제안에는 sprop-parameter-sets 및 sprop-level-parameter-sets 중 하나 또는 둘 다 포함될 수 있습니다. sprop-parameter-sets나 sprop-level-parameter-sets가 모두 제안에 없으면 매개변수 세트의 대역 내 전송만 사용됩니다.\(MAY\)

- o 응답에 1과 동일한 대역 내 매개변수 세트가 포함된 경우 제공자는 대역 내 매개변수 세트를 전송해야 합니다. 그렇지 않으면 다음이 적용됩니다.\(MUST\)

- o 제안자-응답자 방향으로 사용할 레벨이 제안의 기본 레벨과 동일한 경우 다음이 적용됩니다.

- 제안의 "a=fmtp" 라인에 sprop-parameter-sets가 포함된 경우 응답자는 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-parameter-sets에 포함된 매개변수 세트를 사용할 준비를 해야 합니다.\(MUST\)

- 제안에서 "fmtp" 소스 속성을 사용하여 전달된 sprop-parameter-sets가 있는 경우 다음이 적용됩니다. 답변에 1과 같은 use-level-src-parameter-sets 또는 "fmtp" 소스 속성이 포함된 경우 응답자는 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-parameter-sets에 포함된 매개변수 세트를 사용할 준비를 해야 합니다. 그렇지 않은 경우 제공자는 대역 내에서 매개변수 세트를 전송해야 합니다.\(MUST\)

- 제안에 sprop-parameter-sets가 없는 경우 제안자는 매개변수 집합을 대역 내로 전송해야 합니다.\(MUST\)

- 응답자는 제안에 있는 경우\("a=fmtp" 행에 포함되거나 "fmtp" 소스 속성을 사용하여 전달됨\) sprop-level-parameter- 세트를 무시해야 합니다.\(MUST\)

- o 그렇지 않은 경우 제안자-응답자 방향에서 사용할 수준은 제안의 기본 수준과 동일하지 않으며 다음이 적용됩니다.

- 응답자는 제안에 있는 경우\("a=fmtp" 라인에 포함되거나 "fmtp" 소스 속성을 사용하여 전달됨\) sprop-parameter-set를 무시해야 합니다.\(MUST\)

- use-level-src-parameter-sets가 1이 아니거나 "fmtp" 소스 속성이 답변에 존재하지 않는 경우, 응답자는 제안에 있을 때 sprop-level-parameter-sets를 무시해야 하며 제안자는 이를 무시해야 합니다. 반드시 매개변수 세트를 대역 내로 전송해야 합니다.\(MUST\)

- use-level-src-parameter-sets가 1과 같거나 "fmtp" 소스 속성이 답변에 있는 경우 응답자는 sprop-level-parameter-sets에 포함된 매개변수 세트를 사용할 준비를 해야 합니다. 제안에 있는 경우 허용된 레벨\(즉, 답변의 기본 레벨\)에 대해 수신 NAL 단위 스트림을 디코딩하고 sprop-level-parameter-sets에 포함된 다른 모든 매개변수 세트를 무시합니다.\(MUST\)

- 제안자-응답자 방향에서 사용할 레벨에 대한 매개변수 세트가 제안의 sprop-level-parameter-sets에 없는 경우 제안자는 매개변수 세트를 대역 내로 전송해야 합니다.\(MUST\)

- 응답자에서 제안자 방향으로 매개변수 세트를 전송하는 데 다음 규칙이 적용됩니다.

- o 답변에는 sprop-parameter-sets 또는 sprop-level-parameter-sets 중 하나가 포함될 수 있지만 둘 다 포함되어서는 안 됩니다. sprop-parameter-sets 또는 sprop-level-parameter-sets가 응답에 없으면 매개변수 세트의 대역 내 전송만 사용됩니다.\(MUST NOT\)

- o 제안에 1과 동일한 대역 내 매개변수 세트가 포함된 경우 응답자는 응답에 sprop-parameter-sets 또는 sprop-level-parameter-sets를 포함해서는 안 되며 대역 내 매개변수 세트를 전송해야 합니다. 그렇지 않으면 다음이 적용됩니다.\(MUST NOT\)

- o 답변자-제안자 방향으로 사용할 레벨이 답변의 기본 레벨과 동일한 경우 다음이 적용됩니다.

- 답변의 "a=fmtp" 줄에 sprop-parameter-sets가 포함된 경우 제공자는 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-parameter-sets에 포함된 매개변수 세트를 사용할 준비를 해야 합니다.\(MUST\)

- 답변에 "fmtp" 소스 속성을 사용하여 전달된 sprop-parameter-sets가 있는 경우 다음이 적용됩니다. 제안이 1과 같은 use-level-src-parameter-sets 또는 "fmtp" 소스 속성을 포함하는 경우, 제안자는 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-parameter-sets에 포함된 매개변수 세트를 사용할 준비를 해야 합니다. 그렇지 않은 경우 응답자는 반드시 매개변수 세트를 대역 내로 전송해야 합니다.\(MUST\)

- sprop-parameter-sets가 응답에 없으면 응답자는 매개변수 세트를 대역 내로 전송해야 합니다.\(MUST\)

- 제공자는 응답에 있는 경우\("a=fmtp" 라인에 포함되거나 "fmtp" 소스 속성을 사용하여 전달됨\) sprop-level-parameter-set를 무시해야 합니다.\(MUST\)

- o 그렇지 않은 경우, 답변자-제안자 방향에서 사용할 레벨은 답변의 기본 레벨과 동일하지 않으며 다음이 적용됩니다.

- 제공자는 응답에 sprop-parameter-set가 있는 경우\(SDP의 "a=fmtp" 라인에 포함되거나 "fmtp" 소스 속성을 사용하여 전달됨\)를 무시해야 합니다.\(MUST\)

- use-level-src-parameter-sets가 1이 아니거나 "fmtp" 소스 속성이 제안에 존재하지 않는 경우, 제안자는 sprop-level-parameter-sets\(있는 경우\)를 무시해야 하며 응답자는 매개변수를 전송해야 합니다. 대역 내로 설정합니다.\(MUST\)

```text
                     When either use-level-src-parameter-sets is equal
                     to 1 or the "fmtp" source attribute is present in
                     the offer, the offerer MUST be prepared to use the
                     parameter sets that are included in sprop-level-
```

사용할 레벨에 대한 매개변수 세트

- 답변에 있는 경우 응답자에서 제안자로의 방향은 들어오는 NAL 단위 스트림을 디코딩하고 답변의 sprop-level-parameter-sets에 포함된 다른 모든 매개변수 세트를 무시합니다.

- 응답자-제공자 방향에서 사용할 레벨에 대한 매개변수 세트가 응답의 sprop-level-parameter-sets에 없는 경우 응답자는 매개변수 세트를 대역 내로 전송해야 합니다.\(MUST\)

- sprop-parameter-sets 또는 sprop-level-parameter-sets가 \[9\]의 섹션 6.3에 지정된 대로 "fmtp" 소스 속성을 사용하여 전달되는 경우 매개변수의 수신자는 sprop-parameter에 포함된 매개변수 세트를 저장해야 합니다. - 허용된 수준에 대한 -sets 또는 sprop-level-parameter-sets를 설정하고 이를 "fmtp" 소스 속성의 일부로 제공된 소스와 연결합니다. 하나의 소스와 연관된 매개변수 세트는 동일한 소스의 RTP 패킷으로 전달되는 NAL 단위를 디코딩하는 데에만 사용해야 합니다. 이 메커니즘을 사용하는 경우 SSRC 충돌 감지 및 해결은 \[9\]에 지정된 대로 수행되어야 합니다.\(MUST, MUST, MUST\)

- 참고 사항: "fmtp" 소스 속성을 사용한 sprop-parameter-sets 및 sprop-level-parameter-sets 전달은 Topo-Video-switch-MCU\[29\]와 같은 토폴로지에서 대역 외 전송을 활성화하는 데 사용될 수 있습니다. 매개변수 세트.

멀티캐스트를 통해 전달되는 스트림의 경우 다음 규칙이 적용됩니다.

o 미디어 형식 구성은 레벨 부분과 패킷화 모드를 포함하는 "profile-level-id"로 식별됩니다. 이러한 미디어 형식 구성 매개변수\(profile-level-id의 수준 부분 포함\)는 대칭적으로 사용해야 합니다. 즉, 응답자는 모든 구성 매개변수를 유지하거나 미디어 형식\(페이로드 유형\)을 완전히 제거해야 합니다. 이는 멀티캐스트에서 Offer/Answer에 대한 profile-level-id의 레벨 부분을 변경할 수 없음을 의미합니다.\(MUST\)

- 이러한 구성의 처리 및 일치를 단순화하려면 \[8\]에 지정된 대로 제안에 사용된 것과 동일한 RTP 페이로드 유형 번호를 답변에도 사용해야 합니다. 구성이 제안과 동일하지 않은 한 답변에는 제안에 사용된 페이로드 유형 번호가 포함되어서는 안 됩니다.\(SHOULD, MUST NOT\)

o 수신된 매개변수 세트는 원래 소스와 연관되어야 하며 동일한 소스에서 들어오는 NAL 단위 스트림을 디코딩하는 데에만 사용해야 합니다.\(MUST\)

o 위의 규칙을 준수하는 한 다른 매개변수에 대한 규칙은 유니캐스트에 대한 위와 동일합니다.

표 6은 다양한 방향 속성에 사용해야 하는 모든 미디어 유형 매개변수의 해석을 나열합니다.\(MUST\)

```text
       Table 6.  Interpretation of parameters for different direction
                 attributes
```

```text
                                              sendonly --+
                                           recvonly --+  |
                                        sendrecv --+  |  |
                                                   |  |  |
                profile-level-id                   C  C  P
                max-recv-level                     R  R  -
                packetization-mode                 C  C  P
                sprop-deint-buf-req                P  -  P
                sprop-interleaving-depth           P  -  P
                sprop-max-don-diff                 P  -  P
                sprop-init-buf-time                P  -  P
                max-mbps                           R  R  -
                max-smbps                          R  R  -
                max-fs                             R  R  -
                max-cpb                            R  R  -
                max-dpb                            R  R  -
                max-br                             R  R  -
                redundant-pic-cap                  R  R  -
                deint-buf-cap                      R  R  -
                max-rcmd-nalu-size                 R  R  -
                sar-understood                     R  R  -
                sar-supported                      R  R  -
                in-band-parameter-sets             R  R  -
                use-level-src-parameter-sets       R  R  -
                level-asymmetry-allowed            O  -  -
                sprop-parameter-sets               S  -  S
                sprop-level-parameter-sets         S  -  S
```

```text
             Legend:

             C: configuration for sending and receiving streams
             O: offer/answer mode
             P: properties of the stream to be sent
             R: receiver capabilities
             S: out-of-band parameter sets
             -: not usable (when present, SHOULD be ignored)
```

수신기 기능을 선언하는 데 사용되는 매개변수는 일반적으로 다운그레이드 가능합니다. 즉, 보낸 사람의 가능한 행동에 대한 상한을 표현합니다. 따라서 발신자는 이러한 매개변수의 더 낮은/더 작은 값만 사용하여 인코더를 설정하도록 선택할 수 있습니다.\(MAY\)

유니캐스트 사용을 위한 profile-level-id 매개변수의 level 부분을 제외하고 구성 지점을 선언하는 매개변수는 변경할 수 없습니다.

보낸 사람의 기능이 선언되고 이 선언에 다운그레이드할 수 없는 매개 변수가 사용되는 경우 이러한 매개 변수는 보낸 사람이 스트림을 수신할 수 있는 구성을 표현합니다. 높은 상호 운용성 수준을 달성하려면 패킷화 모드와 같은 여러 대체 구성을 제공하는 것이 좋습니다. 단일 페이로드 유형으로 여러 구성을 제공하는 것은 불가능합니다. 따라서 여러 구성 제안이 제공되는 경우 각 제안에는 해당 제안과 연결된 자체 RTP 페이로드 유형이 필요합니다.

수신기는 페이로드 형식 기능의 하위 집합만 지원하더라도 모든 미디어 유형 매개변수를 이해해야 합니다\(SHOULD\). 이를 통해 수신자는 미디어 수신 제안이 언제 제안 수신자가 지원하는 것으로 다운그레이드될 수 있는지 이해할 수 있습니다.\(SHOULD\)

응답자는 추가 미디어 형식 구성으로 제안을 확장할 수 있습니다. 그러나 이를 사용하려면 대부분의 경우 미디어 발신자가 사용할 스트림 속성 매개변수를 제공하기 위해 제공자로부터 두 번째 제안이 필요합니다. 이는 또한 제공자가 이 미디어 형식 구성을 전송할 뿐만 아니라 수신할 수 있어야 한다는 효과도 있습니다.\(MAY\)

제공자가 송신과 수신 사이에 비대칭 기능을 갖기를 원하는 경우 제공자는 레벨 비대칭 허용을 통해 비대칭 레벨을 1과 동일하게 허용할 수 있습니다. 또는 제공자는 다른 RTP 세션, 즉 "로 선언된 다른 미디어 라인을 제공할 수 있습니다. 각각 recvonly" 및 "sendonly"입니다. 이는 시스템에 추가 영향을 미칠 수 있으며 두 미디어 라인을 연결하기 위해 추가 외부 의미가 필요할 수 있습니다.

---
#### **8.2.3.  Usage in Declarative Session Descriptions**

RTSP\(Real Time Streaming Protocol\) \[27\] 또는 SAP\(Session Announcement Protocol\) \[28\]과 같이 RTP를 통한 H.264가 선언적 스타일로 SDP와 함께 제공되는 경우 다음 사항을 고려해야 합니다.

o 스트림 속성과 수신기 기능을 모두 나타낼 수 있는 모든 매개변수는 스트림 속성만 나타내는 데 사용됩니다. 예를 들어 이 경우 profile-level-id 매개변수는 스트림 수신 기능이 아닌 스트림에서 사용되는 값만 선언합니다. 결과적으로 매개변수에 대한 다음 해석을 사용해야 합니다.\(MUST\)

- 실제 구성 또는 스트림 속성 선언:

```text
         - profile-level-id
         - packetization-mode
         - sprop-interleaving-depth
         - sprop-deint-buf-req
         - sprop-max-don-diff
         - sprop-init-buf-time
```

- 매개변수 세트의 대역 외 전송:

```text
         - sprop-parameter-sets
         - sprop-level-parameter-sets
```

- 사용할 수 없음\(존재하는 경우 무시해야 함\):\(SHOULD\)

```text
         - max-mbps
         - max-smbps
         - max-fs
         - max-cpb
         - max-dpb
         - max-br
         - max-recv-level
         - redundant-pic-cap
         - max-rcmd-nalu-size
         - deint-buf-cap
         - sar-understood
         - sar-supported
         - in-band-parameter-sets
         - level-asymmetry-allowed
         - use-level-src-parameter-sets
```

o SDP의 수신기는 제공된 매개변수의 모든 매개변수와 값을 지원해야 합니다. 그렇지 않으면 수신자는 세션을 거부\(RTSP\)하거나 참여하지 않아야\(SAP\)해야 합니다. 수신 애플리케이션에서 지원할 것으로 예상되는 값을 사용하는 것은 세션 작성자의 몫입니다.\(MUST\)

---
### **8.3.  Examples**

양 당사자가 모두 보내고 받을 것으로 예상되는 SDP 제안/응답 교환은 다음과 같습니다. SDP의 미디어 코덱 관련 부분만 표시됩니다. 텍스트 제약으로 인해 일부 줄이 줄 바꿈되었습니다.

```text
      Offerer -> Answerer SDP message:

      m=video 49170 RTP/AVP 100 99 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; packetization-mode=0;
        sprop-parameter-sets=<parameter sets data#0>
      a=rtpmap:99 H264/90000
      a=fmtp:99 profile-level-id=42A01E; packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#1>
      a=rtpmap:100 H264/90000
      a=fmtp:100 profile-level-id=42A01E; packetization-mode=2;
        sprop-parameter-sets=<parameter sets data#2>;
        sprop-interleaving-depth=45; sprop-deint-buf-req=64000;
        sprop-init-buf-time=102478; deint-buf-cap=128000
```

위 제안은 세 가지 다른 패킷화 형식으로 동일한 코덱 구성을 제공합니다. 페이로드 유형 98은 단일 NALU 모드를 나타내고, 페이로드 유형 99는 비인터리브 모드를 나타내며, 페이로드 유형 100은 인터리브 모드를 나타냅니다. 인터리브 모드의 경우 답변이 페이로드 유형 100에 대한 지원을 나타내는 경우 제공자가 사용할 인터리빙 매개변수도 포함됩니다. 세 가지 경우 모두 sprop-parameter-sets 매개변수는 이 구성이 승인될 때 제공자로부터 스트림을 수신할 때 응답자가 요구하는 초기 매개변수 세트를 전달합니다. sprop-parameter-sets 값은 페이로드 유형마다 다를 수 있습니다.

```text
      Answerer -> Offerer SDP message:

      m=video 49170 RTP/AVP 100 99 97
      a=rtpmap:97 H264/90000
      a=fmtp:97 profile-level-id=42A01E; packetization-mode=0;
        sprop-parameter-sets=<parameter sets data#3>
      a=rtpmap:99 H264/90000
      a=fmtp:99 profile-level-id=42A01E; packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#4>;
        max-rcmd-nalu-size=3980
      a=rtpmap:100 H264/90000
      a=fmtp:100 profile-level-id=42A01E; packetization-mode=2;
        sprop-parameter-sets=<parameter sets data#5>;
        sprop-interleaving-depth=60;
        sprop-deint-buf-req=86000; sprop-init-buf-time=156320;
        deint-buf-cap=128000; max-rcmd-nalu-size=3980
```

제안/응답 협상에는 송신 및 수신 스트림이 모두 포함되므로 제안은 제안자가 수신하려는 내용에 대한 정확한 매개변수를 나타내는 반면, 답변은 응답자가 수신하려는 내용과 동일함을 나타냅니다. 이 경우 제안자는 페이로드 유형 98을 수신하겠다고 선언했습니다. 응답자는 동등한 페이로드 유형 97을 선언하여 이를 수락합니다. 즉, 두 매개변수 profile-level-id 및 packetization-mode에 대해 동일한 값을 갖습니다\(packetization-mode가 0이고 sprop-deint-buf-req가 존재하지 않기 때문입니다\). 제안된 페이로드 유형 98이 승인되면 응답자는 제안이 최종적으로 이 구성을 사용하기로 결정한 경우 sprop-parameter-sets=<매개변수 세트 데이터#0\>에 포함된 매개변수 세트를 저장해야 합니다. 답변에서 응답자는 이 구성이 최종적으로 사용될 경우 응답자가 보낸 스트림에서 사용할 매개변수 세트를 sprop-parameter-set=<매개변수 세트 데이터#3\>에 포함합니다.

응답자는 페이로드 유형 99와 100이 나타내는 두 가지 구성의 수신도 허용합니다. 다시 말하지만, 제안이 최종적으로 이 두 가지 중 하나를 사용하기로 결정한 경우 응답자는 sprop-parameter-sets=<parameterets data#1\> 및 sprop-parameter-sets=<parameterets data#2\>에 포함된 매개변수 세트를 저장해야 합니다. 구성. 응답자는 응답자-제공자 방향에 대한 초기 매개변수 세트를 제공합니다. 즉, sprop-parameter-set=<매개변수 세트 데이터#4\> 및 sprop-parameter-sets=<매개변수 세트 데이터#5\>의 매개변수 세트입니다. 페이로드 유형을 전송하는 데 사용할 페이로드 유형 99 및 100에 대해 각각. 또한 응답자는 deint-buf-cap 매개변수를 제공하여 디인터리빙 작업에 대한 메모리 제한을 제공자에게 제공합니다. 이는 제안자가 두 번째 제안을 하기로 결정한 경우에만 유용합니다.

계정. max-rcmd-nalu-size는 응답자가 최대 3980바이트 크기까지 NALU를 효율적으로 처리할 수 있음을 나타냅니다. 그러나 네트워크가 이 크기를 지원한다는 보장은 없습니다.

다음 예에서는 레벨 다운그레이드 없이 제안이 승인되고\(즉, 기본 레벨인 레벨 3.0이 승인됨\) sprop-parameter-sets 및 sprop-level-parameter-sets가 모두 제안에 존재합니다. 응답자는 sprop-level-parameter-sets=<매개변수 세트 데이터#1\>을 무시하고 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-parameter-sets=<매개변수 세트 데이터#0\>에 매개변수 세트를 저장해야 합니다. 제공자는 들어오는 NAL 단위 스트림을 디코딩하기 위한 응답의 sprop-parameter-sets=<parameterets data#2\>에 매개변수 세트를 저장해야 합니다. 이 예에서 sprop-parameter-sets=<매개변수 세트 데이터#2\>의 매개변수 세트는 레벨 3.0과 연결되어야 합니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#0>;
        sprop-level-parameter-sets=<parameter sets data#1>

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#2>
```

다음 예에서는 제안\(기준 프로필, 수준 1.1\)이 수준 다운그레이드\(허용 수준은 수준 1b임\)로 수락되고 sprop-parameter-sets 및 sprop-level-parameter-sets가 모두 제안에 있습니다. 응답자는 sprop-parameter-sets=<매개변수 세트 데이터#0\> 및 sprop-level-parameter-sets=<매개변수 세트 데이터#1\>에서 허용된 수준\(레벨 1b\)에 해당하지 않는 모든 매개변수 세트를 무시하고 매개변수를 저장해야 합니다. 들어오는 NAL 단위 스트림을 디코딩하기 위해 sprop-level-parameter-sets=<매개변수 세트 데이터#1\>에서 허용된 레벨\(레벨 1b\)에 대해 설정합니다. 제공자는 들어오는 NAL 단위 스트림을 디코딩하기 위한 응답의 sprop-parameter-sets=<parameterets data#2\>에 매개변수 세트를 저장해야 합니다. 이 예에서는 sprop-parameter-sets=<매개 변수 세트 데이터#2\>의 매개 변수 집합이 수준 1b와 연결되어야 합니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A00B; //Baseline profile, Level 1.1
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#0>;
        sprop-level-parameter-sets=<parameter sets data#1>

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42B00B; //Baseline profile, Level 1b
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#2>;
        use-level-src-parameter-sets=1
```

다음 예에서는 제안\(기준 프로필, 수준 1.1\)이 수준 다운그레이드\(허용 수준은 수준 1b임\)로 수락되고 sprop-parameter-sets 및 sprop-level-parameter-sets가 모두 제안에 있습니다. 그러나 응답자는 레거시 RFC 3984 구현이며 sprop-level-parameter-sets를 이해하지 못합니다. 따라서 답변에는 use-level-src-parameter-sets\(응답자가 이해하지 못하는 것\)가 포함되지 않습니다. 따라서 응답자는 sprop-parameter-sets=<매개변수 세트 데이터#0\> 및 sprop-level-parameter-sets=<매개변수 세트 데이터#1\>을 모두 무시해야 하며 제공자는 매개변수 세트를 대역 내로 전송해야 합니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A00B; //Baseline profile, Level 1.1
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#0>;
        sprop-level-parameter-sets=<parameter sets data#1>

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42B00B; //Baseline profile, Level 1b
        packetization-mode=1
```

다음 예에서는 레벨 다운그레이드 없이 제안이 수락되었으며 제안에 sprop-parameter-sets가 있습니다. sprop-parameter-sets=<매개변수 세트 데이터#0\>의 매개변수 세트는 다음과 같아야 합니다.

```text
   be stored and used by the encoder of the offerer and the decoder of
   the answerer, and parameter sets in sprop-parameter-sets=<parameter
   sets data#1> must be used by the encoder of the answerer and the
   decoder of the offerer.  Note that sprop-parameter-sets=<parameter
   sets data#0> is basically independent of sprop-parameter-
   sets=<parameter sets data#1>.

      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#0>

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#1>
```

다음 예에서는 수준 다운그레이드 없이 제안이 수락되었으며 sprop-parameter-sets 또는 sprop-level-parameter-sets가 제안에 존재하지 않습니다. 즉, 매개변수 세트의 대역 외 전송이 없음을 의미합니다. 그런 다음 대역 내로 전송되어야 합니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1
```

다음 예에서는 레벨 다운그레이드를 통해 제안이 수락되었으며 제안에 sprop-parameter-sets가 있습니다. sprop-parameter-sets=<매개변수 세트 데이터#0\>에는 레벨 3.0을 나타내는 level\_idc가 포함되어 있으므로 응답자가 레벨 2.0을 원하므로 사용할 수 없으며 응답자는 이를 무시해야 하며 대역 내 매개변수 세트를 사용해야 합니다. .

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1;
        sprop-parameter-sets=<parameter sets data#0>

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A014; //Baseline profile, Level 2.0
        packetization-mode=1
```

다음 예에서 제안은 레벨 다운그레이드와 함께 수락되며 sprop-parameter-sets 또는 sprop-level-parameter-sets가 제안에 존재하지 않습니다. 즉, 매개변수 세트의 대역 외 전송이 없음을 의미합니다. 그런 다음 대역 내로 전송되어야 합니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A014; //Baseline profile, Level 2.0
        packetization-mode=1

   In the following example, the offer is accepted with level upgrading,
   and neither sprop-parameter-sets nor sprop-level-parameter-sets is
   present in the offer or the answer, meaning that there is no out-of-
   band transmission of parameter sets, which then have to be
   transported in-band.  The level to use in the offerer-to-answerer
   direction is Level 3.0, and the level to use in the answerer-to-
```

제공자 방향은 레벨 2.0입니다. 응답자는 레벨 2.0까지 모든 레벨에서 보낼 수 있으며 제안자는 레벨 3.0까지 모든 레벨에서 보낼 수 있습니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A014; //Baseline profile, Level 2.0
        packetization-mode=1; level-asymmetry-allowed=1

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1; level-asymmetry-allowed=1
```

다음 예에서 제공자는 Topo-Video-switch-MCU\[29\]와 같은 토폴로지의 다중 지점 제어 장치\(MCU\)이며, 다른 세 참가자\(B, 대역 외 전송을 사용하여\)로부터 수신된 매개변수 세트를 제공합니다. C, D\) 응답자인 참가자 A로부터 매개변수 세트를 수신합니다. 참가자는 다른 SSRC 값에 매핑되는 정식 이름\(CNAME\) 값으로 식별됩니다. 4명의 참가자 모두가 동일한 코덱 구성을 사용합니다. 참가자 A는 <파라미터 세트 데이터#B\>, <파라미터 세트 데이터#C\>, <파라미터 세트 데이터#D\>에 포함된 파라미터 세트를 각각 참가자 B, C, D에 저장하고 연관시키며, <파라미터 참가자 B에서만 발생하는 RTP 패킷에 전달된 NAL 단위를 디코딩하기 위해 set data#B\>를 사용하고, 참가자 C에서만 발생하는 RTP 패킷에 전달되는 NAL 단위를 디코딩하기 위해 <매개변수 세트 데이터#C\>를 사용하고, <매개변수 세트 데이터#D\>를 사용합니다. 참가자 D에서만 발생하는 RTP 패킷에 포함된 NAL 단위를 디코딩하기 위한 것입니다.

```text
      Offer SDP:

      m=video 49170 RTP/AVP 98
      a=ssrc:SSRC-B cname:CNAME-B
      a=ssrc:SSRC-C cname:CNAME-C
      a=ssrc:SSRC-D cname:CNAME-D
      a=ssrc:SSRC-B fmtp:98
        sprop-parameter-sets=<parameter sets data#B>
      a=ssrc:SSRC-C fmtp:98
        sprop-parameter-sets=<parameter sets data#C>
      a=ssrc:SSRC-D fmtp:98
        sprop-parameter-sets=<parameter sets data#D>
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1

      Answer SDP:

      m=video 49170 RTP/AVP 98
      a=ssrc:SSRC-A cname:CNAME-A
      a=ssrc:SSRC-A fmtp:98
        sprop-parameter-sets=<parameter sets data#A>
      a=rtpmap:98 H264/90000
      a=fmtp:98 profile-level-id=42A01E; //Baseline profile, Level 3.0
        packetization-mode=1
```

---
### **8.4.  Parameter Set Considerations**

H.264 매개변수 세트는 비디오 코덱의 기본 부분이자 작동에 필수적입니다\(섹션 1.2 참조\). 그 특성과 디코딩 프로세스의 중요성으로 인해 손실되거나 잘못 전송된 매개변수 세트는 수신기에서 로컬로 숨기기가 어렵습니다. 손상된 매개변수 세트에 대한 참조는 일반적으로 디코딩 프로세스에 치명적인 결과를 가져옵니다. 예를 들어, 매개변수 세트 NAL 유닛의 잘못된 전송 또는 손실로 인해 손상이 발생할 수 있을 뿐만 아니라 매개변수 세트 업데이트의 시기적절한 전송으로 인해 손상이 발생할 수도 있습니다. 매개변수 세트 업데이트는 화면 매개변수 세트 또는 시퀀스 매개변수 세트 식별자가 변경되지 않고 유지되는 화면 매개변수 세트 또는 시퀀스 매개변수 세트에서 적어도 하나의 매개변수의 변경을 의미합니다. 따라서 RTP 발신자 구현자를 위한 지침으로 다음 권장 사항을 제공합니다.

매개변수 세트 NALU는 세 가지 다른 원리를 사용하여 전송될 수 있습니다.

A. 실제 RTP 세션 이전에 세션 제어 프로토콜\(대역 외\)을 사용합니다.

B. 진행 중인 RTP 세션 중에 세션 제어 프로토콜\(대역 외\)을 사용합니다.

C. 진행 중인 RTP 세션 동안 페이로드\(대역 내\)의 RTP 패킷 스트림 내.

세션 제어 프로토콜 내에서 원칙 A와 B를 구현하는 것이 좋습니다. SIP 및 SDP는 SDP 제공/응답 모델과 이 메모의 이전 섹션에 설명된 대로 사용할 수 있습니다. 섹션 8.2.2에는 미디어 유형 매개변수 sprop-parameter-sets, sprop-level-parameter-sets, use-level-src를 사용하여 SDP Offer/Answer에서 대역 내 또는 대역 외 매개변수 세트 전송에 대한 자세한 논의가 포함되어 있습니다. -매개변수 세트 및 대역 내 매개변수 세트. 이 섹션에는 세션 제어 프로토콜 내에서 원칙 A와 B를 구현하는 방법에 대한 지침이 포함되어 있습니다. 이는 사용되는 특정 프로토콜과 무관합니다. 원칙 C는 이 사양에 정의된 RTP 페이로드 형식에서 지원됩니다. 원칙 C를 사용하는 것이 바람직할 수 있는 Topo-Video-switch-MCU\[29\]와 같은 토폴로지가 있습니다.

매개변수 집합의 대역 내 신호가 사용되는 경우 그림 및 시퀀스 매개변수 집합 NALU는 신뢰할 수 있는 RTP 전달 방법\(아래 참조\)을 사용하여 RTP 페이로드에서 전송되어야 합니다. 해당 RTP 패킷 스트림의 상당 부분이 디코딩되는 것을 방지합니다.\(SHOULD\)

매개변수 세트의 대역 내 신호가 사용되는 경우 송신자는 오류 특성을 고려하고 매개변수 세트를 올바르게 전달할 수 있는 높은 확률을 제공하는 메커니즘을 사용해야 합니다. 올바른 수신 확률을 높이는 메커니즘에는 패킷 반복, FEC 및 재전송이 포함됩니다. 신뢰할 수 없는 대역 외 제어 프로토콜을 사용하면 대역 내 신호와 유사한 단점\(손실 가능성\)이 있으며, 또한 동기화에 어려움이 발생할 수도 있습니다\(아래 참조\). 따라서 권장되지 않습니다.\(SHOULD, SHOULD NOT\)

매개변수 세트는 원칙 B와 C를 사용하여 세션 수명 동안 추가되거나 업데이트될 수 있습니다. 매개변수 세트는 이를 참조하는 NAL 단위 이전에 디코더에 존재해야 합니다. 매개변수 세트를 업데이트하거나 추가하면 추가 문제가 발생할 수 있습니다. 따라서 다음 권장 사항을 고려해야 합니다.\(MAY\)

- 매개변수 세트가 추가되거나 업데이트되면 매개변수 세트를 사용하기 전에 전달되도록 주의를 기울여야 합니다. 새 매개변수 세트가 추가되면 이전에 사용되지 않은 매개변수 세트 식별자가 사용됩니다. 대역 외 신호와 대역 내 트래픽 간에 동기화가 존재하지 않는 것이 일반적입니다. 대역 외 신호가 사용되는 경우 신호 프로토콜에서 전달을 승인하기 전에 추가 또는 업데이트된 매개변수 세트가 필요한 NALU 전송을 발신자가 시작하지 않는 것이 좋습니다.\(SHOULD, SHOULD\)

- 매개변수 세트가 업데이트되면 다음과 같은 동기화 문제를 고려해야 합니다. 수신자에 설정된 매개변수를 덮어쓸 때 발신자는 문제의 매개변수 세트가 네트워크나 수신자 버퍼에 있는 NALU에 필요하지 않은지 확인해야 합니다. 그렇지 않으면 잘못된 매개변수 세트로 디코딩이 발생할 수 있습니다. 이 문제를 줄이려면 충분히 오랫동안 사용되지 않은 매개변수 세트만 덮어쓰거나\(모든 관련 NALU가 소비되었는지 확인하기 위해\) 대신 새 매개변수 세트를 추가하는 것이 좋습니다\(부정적인 결과가 발생할 수 있음\). 비디오 코딩의 효율성을 위해\).\(SHOULD\)

- 참고 사항: Topo-Video-switch-MCU\[29\]와 같은 일부 토폴로지에서는 전체 매개변수 세트 세트의 출처가 고유하지 않은 매개변수 세트 식별자를 사용할 수 있는 여러 소스에서 나올 수 있습니다. 이 경우 대역 외 채널에서 매개변수 세트의 고유성을 활성화하는 다른 메커니즘이 없으면 제안이 기존 매개변수 세트를 덮어쓸 수 있습니다.

- 다중 당사자 세션에서 한 참가자는 가능할 때마다 서로 다른 소스에서 오는 매개변수 세트를 소스 식별과 연결해야 합니다\(예: 대역 외 전송된 매개변수 세트를 전달함으로써\). 일반적으로 서로 다른 소스는 독립적인 매개변수 세트 식별자 값 공간을 사용하기 때문입니다.\(MUST\)

- 동일한 RTP 세션에서 원칙 B와 C를 모두 사용하여 매개변수 세트를 추가하거나 수정하면 제어 채널과 RTP 채널 간의 동기화가 부족하여 매개변수 세트의 불일치가 발생할 수 있습니다. 따라서 원칙 B와 C는 충분한 동기화가 제공되지 않는 한 동일한 세션에서 사용되어서는 안 됩니다.\(MUST NOT\)

일부 시나리오\(예: H.241에 해당하는 페이로드 형식 사양의 하위 집합만 사용되는 경우\) 또는 토폴로지에서는 대역 외 매개변수 집합 전송을 사용하는 것이 불가능합니다. 이 경우 매개변수 세트는 대역 내로 전송되어야 합니다. 여기서 비트스트림의 매개변수가 설정되지 않은 데이터와의 동기화는 암시적이지만 손실 가능성을 고려해야 합니다.

위에서 설명한 메커니즘을 사용하여 손실 확률을 줄여야 합니다. 매개변수 세트의 손실이 감지된 경우, 예를 들어 RTCP 피드백 FIR\(Full Intra Request\) \[30\]을 사용하여 디코더 새로 고침 지점 절차를 사용하여 복구가 달성될 수 있습니다. 두 가지 예제 디코더 리프레시 포인트 절차가 유익한 섹션 8.5에 제공됩니다.

- 매개변수 세트가 처음에 원칙 A를 사용하여 제공되고 나중에 대역 내에서 추가 또는 업데이트되는 경우\(원리 C\) 대역 외로 전달되는 매개변수 세트 업데이트와 관련된 위험이 있습니다. 수신기가 일부 대역 내 업데이트를 놓친 경우\(예: 손실 또는 늦은 조정으로 인해\) 해당 수신기는 오래된 매개변수를 사용하여 비트스트림을 디코딩하려고 시도합니다. 따라서 매개변수 세트 ID를 대역 외 매개변수 세트와 대역 내 매개변수 세트 사이에 분할하는 것이 좋습니다.\(SHOULD\)

```text
8.5.  Decoder Refresh Point Procedure Using In-Band Transport of
      Parameter Sets (Informative)
```

\[1\]에 따른 비디오 인코더를 가진 발신자가 디코더 새로 고침 포인트에 대한 요청을 수신하면 인코더는 섹션 8.5.1 또는 8.5.2에 지정된 절차 중 하나를 사용하여 빠른 업데이트 모드로 들어가야 합니다. 섹션 8.5.1의 절차는 무손실 전송 환경에서 선호되는 응답입니다. 두 절차 모두 H.264 비디오 인코딩에 대한 빠른 업데이트 모드로 들어가기 위한 요구 사항을 충족합니다.

8.5.1. 디코더 리프레시 포인트 요청에 응답하기 위한 IDR 절차

이 섹션에서는 디코더 새로 고침 지점 요청에 응답할 수 있는 한 가지 방법을 제공합니다.

인코더는 여기에 제시된 순서대로 다음을 수행해야 합니다.

1\) 즉시 IDR 사진을 보낼 준비를 하세요.

2\) 전송할 IDR 그림에서 사용할 시퀀스 매개변수 세트를 전송합니다. 인코더는 선택적으로 다른 시퀀스 매개변수 세트를 보낼 수도 있습니다.

3\) 전송될 IDR 사진에 사용될 사진 매개변수 세트를 전송합니다. 인코더는 선택적으로 다른 그림 매개변수 세트를 보낼 수도 있습니다.

4\) IDR 사진을 보냅니다.

5\) 이 시점부터 요청을 수신하기 전에 해당 매개변수 세트가 이전에 전송되었는지 여부에 관계없이 임의의 NAL 단위에 의한 참조 이전에 이 절차에서 아직 전송되지 않은 다른 시퀀스 또는 그림 매개변수 세트를 전송합니다. 디코더 새로 고침 지점의 경우. 필요에 따라 이러한 매개변수 세트는 일괄적으로, 한 번에 하나씩 또는 이 두 가지 방법을 조합하여 전송할 수 있습니다. 매개변수 세트는 중복성을 위해 언제든지 다시 전송될 수 있습니다. 위의 섹션 8.4에 설명된 대로 매개변수 세트 업데이트가 있는 경우 주의해야 합니다.

8.5.2. 디코더 리프레시 포인트 요청에 응답하기 위한 점진적 복구 절차

이 섹션에서는 디코더 새로 고침 지점에 대한 요청에 응답할 수 있는 또 다른 방법을 제공합니다.

인코더는 여기에 제시된 순서대로 다음을 수행해야 합니다.

1\) 복구 지점 SEI 메시지를 보냅니다\(\[1\]의 섹션 D.1.7 및 D.2.7 참조\).

2\) NAL 단위에 의한 참조 이전에 복구 포인트 SEI 메시지 이전에 전송된 임의의 시퀀스 및 그림 매개변수 세트를 반복합니다.

인코더는 지금부터 전송에 오류가 없다는 가정 하에 출력 순서에 따라 복구 지점 SEI 메시지에 의해 표시된 복구 지점 또는 그 이후의 화면 간 예측을 위해 디코더가 모든 참조 화면에 액세스할 수 있도록 보장해야 합니다. .

복구 지점 SEI 메시지의 Recovery\_frame\_cnt 구문 요소 값은 빠른 복구를 보장할 수 있을 만큼 작아야 합니다.

필요에 따라 이러한 매개변수 세트는 일괄적으로, 한 번에 하나씩 또는 이 두 가지 방법을 조합하여 다시 전송할 수 있습니다. 매개변수 세트는 중복성을 위해 언제든지 다시 전송될 수 있습니다. 위의 섹션 8.4에 설명된 대로 매개변수 세트 업데이트가 있는 경우 주의해야 합니다.

---
## **9.  Security Considerations**

본 사양에 정의된 페이로드 형식을 사용하는 RTP 패킷은 RTP 사양\[5\] 및 적절한 RTP 프로필\(예: \[16\]\)에서 논의된 보안 고려 사항의 적용을 받습니다. 이는 미디어 스트림의 기밀성이 SRTP\[26\]의 적용과 같은 암호화를 통해 달성된다는 것을 의미합니다. 이 페이로드 형식에 사용되는 데이터 압축은

엔드투엔드 방식으로 적용되므로 압축 후에 암호화를 수행해야 합니다. 균일하지 않은 수신기 측 계산 부하가 있는 압축 기술을 사용하는 데이터 인코딩에는 잠재적인 서비스 거부 위협이 존재합니다. 공격자는 디코딩하기 복잡하고 수신기에 과부하를 일으키는 병리학적 데이터그램을 스트림에 주입할 수 있습니다. H.264는 향후 많은 NAL 단위의 디코딩 프로세스에 영향을 미치는 NAL 단위를 포함하는 데이터그램을 생성하는 것이 매우 간단하기 때문에 이러한 공격에 특히 취약합니다. 따라서 최소한 RTP 패킷의 데이터 원본 인증 및 데이터 무결성 보호를 사용하는 것이 권장됩니다\(예: SRTP\[26\]\).\(SHOULD\)

RTP 패킷과 해당 페이로드의 기밀성과 무결성을 보장하는 적절한 메커니즘은 애플리케이션과 사용되는 전송 및 신호 프로토콜에 따라 크게 달라집니다. 따라서 위의 예로 SRTP가 제공되었지만 다른 가능한 선택도 존재합니다.

디코더는 특히 활성 요소가 포함된 경우 사용자 데이터 SEI 메시지 처리와 관련하여 주의를 기울여야 하며 적용 범위를 스트림을 포함하는 프리젠테이션으로 제한해야 합니다.\(MUST\)

인증, 무결성 또는 기밀성 보호를 포함한 엔드투엔드 보안은 MANE가 전체 패킷을 폐기하는 것 이외의 미디어 인식 작업을 수행하는 것을 방지합니다. 기밀 보호의 경우 미디어 인식 방식으로 패킷을 폐기하는 것도 방지됩니다. 해당 작업을 수행하려면 MANE가 보안 컨텍스트 설정에 포함된 신뢰할 수 있는 엔터티여야 합니다.

---
## **10.  Congestion Control**

RTP에 대한 혼잡 제어는 RFC 3550\[5\] 및 적용 가능한 RTP 프로필\(예: RFC 3551\[16\]\)에 따라 사용해야 합니다. 최선의 서비스를 사용하는 경우 이 페이로드 형식의 사용자는 패킷 손실률이 허용 가능한 매개변수 내에 있는지 확인하기 위해 패킷 손실을 모니터링해야 한다는 추가 요구 사항이 있습니다. 동일한 네트워크 경로를 통과하고 동일한 네트워크 조건을 경험하는 TCP 흐름이 합리적인 시간 단위로 측정하여 RTP 흐름이 달성하는 것보다 적지 않은 평균 처리량을 달성하는 경우 패킷 손실은 허용 가능한 것으로 간주됩니다. 이 조건은 전송 속도\(또는 계층화된 멀티캐스트 세션에 가입된 계층 수\)를 조정하기 위해 혼잡 제어 메커니즘을 구현하거나 손실률이 허용할 수 없을 정도로 높은 경우 수신기가 세션을 떠나도록 준비함으로써 충족될 수 있습니다.\(MUST, MUST\)

혼잡 제어 원칙을 준수하는 데 필요한 비트 전송률 적응은 실시간 인코딩을 사용할 때 쉽게 달성할 수 있습니다. 그러나 사전 인코딩된 콘텐츠가 전송되는 경우 대역폭 적응에는 서로 다른 비트 전송률에서 동일한 콘텐츠에 대한 둘 이상의 코딩된 표현의 가용성이 필요하거나 비트스트림의 비참조 영상 또는 하위 시퀀스\[22\]가 존재해야 합니다. 서로 다른 표현 간의 전환은 일반적으로 동일한 RTP 세션에서 수행될 수 있습니다\(예: 확장 프로파일의 SI/SP 슬라이스로 알려진 개념을 사용하거나 IDR 그림 경계에서 스트림을 전환함으로써\). 다운그레이드할 수 없는 매개변수\(예: 프로필/레벨 ID의 프로필 부분\)를 변경해야 하는 경우에만 미디어 스트림을 종료하고 다시 시작해야 합니다. 이는 다른 RTP 페이로드 유형을 사용하여 수행할 수 있습니다.

MANE는 섹션 7.3에 설명된 제안을 따르고 이전 패킷 손실로 인해 스트림이 손상된 경우 패킷 스트림에서 특정 사용할 수 없는 패킷을 제거할 수 있습니다. 이는 특별한 경우에 네트워크 부하를 줄이는 데 도움이 될 수 있습니다.\(MAY\)

---
## **11.  IANA Considerations**

RFC 3984에 지정된 H264 미디어 하위 유형 이름은 이 메모의 섹션 8.1에 정의된 대로 업데이트되었습니다.

---
## **12.  Informative Appendix: Application Examples**

이 페이로드 사양은 H.264에 대해 예상되는 매우 넓은 애플리케이션 공간을 포괄하기 위해 사용이 매우 유연합니다. 그러나 이러한 뛰어난 유연성으로 인해 구현자가 합리적인 패킷화 방식을 결정하는 것도 어려워집니다. 이 사양을 실제 시나리오에 적용하는 방법에 대한 일부 정보는 가까운 미래에 학술 출판물, 테스트 모델 소프트웨어 및 설명의 형태로 나타날 가능성이 높습니다. 그러나 일부 예비 사용 시나리오도 여기에 설명되어 있습니다.

12.1. ITU-T 권장사항 H.241의 부록 A에 따른 화상 통화

H.264를 선택적 영상 압축 방식으로 사용하는 H.323 기반 영상통화 시스템은 H.241\[3\]의 Annex A를 패킷화 방식으로 지원해야 한다. 이 부록에 정의된 패킷화 메커니즘은 이 사양의 일부 하위 집합과 기술적으로 동일합니다.

시스템이 H.241의 Annex A에 따라 작동할 때 매개변수 세트 NAL 단위가 대역 내로 전송됩니다. 단일 NAL 단위 패킷만 사용됩니다. 이러한 시스템 중 다수는 정기적으로 IDR 사진을 전송하지 않지만,

사용자 상호 작용이나 제어 프로토콜 수단에 의해 필요할 때\(예: 다중 지점 제어 장치에서 비디오 채널 간 전환 시 또는 피드백에 의해 요청된 오류 복구 시\)

```text
12.2.  Video Telephony, No Slice Data Partitioning, No NAL Unit
       Aggregation
```

이 체계의 RTP 부분이 구현되고 테스트되었습니다\(제어 프로토콜 부분은 아니지만 아래 참조\).

대부분의 실제 화상 통화 애플리케이션에서 영상 크기나 옵션 모드와 같은 영상 매개변수는 연결 수명 동안 절대 변하지 않습니다. 따라서 필요한 모든 매개변수 세트\(보통 하나만\)는 예를 들어 이 문서의 섹션 8.2에 지정된 SDP 구문에 따라 기능 교환/공지 프로세스의 부작용으로 전송됩니다. RTP 세션이 시작되기 전에 필요한 모든 매개변수 세트 정보가 설정되므로 매개변수 세트 NAL 단위를 전송할 필요가 없습니다. 슬라이스 데이터 파티셔닝도 사용되지 않습니다. 따라서 RTP 패킷 스트림은 기본적으로 단일 코딩된 슬라이스를 전달하는 NAL 단위로 구성됩니다.

인코더는 최상의 성능을 제공하도록 코딩된 슬라이스 NAL 단위의 크기를 선택합니다. 대개 이는 코딩된 슬라이스 크기를 IP 네트워크의 MTU 크기에 맞게 조정하여 수행됩니다. 작은 사진 크기의 경우 패킷 1개당 사진 1개 전략이 될 수 있습니다. 내부 새로 고침 알고리즘은 패킷 손실과 그에 따른 드리프트 관련 아티팩트를 정리합니다.

```text
12.3.  Video Telephony, Interleaved Packetization Using NAL Unit
       Aggregation
```

이 방식은 더 나은 오류 은폐를 허용하며 RFC 4629 패킷화를 사용하는 H.263 기반 설계에 사용됩니다\[11\]. 이를 시행하여 좋은 결과가 보고되었다\[13\].

VCL 인코더는 한 MB 라인의 모든 매크로블록\(MB\)이 한 슬라이스에 할당되도록 소스 영상을 코딩합니다. 짝수 MB 행 주소를 갖는 모든 슬라이스는 하나의 STAP로 결합되고, 홀수 MB 행 주소를 갖는 모든 슬라이스는 다른 STAP으로 결합됩니다. 해당 STAP는 RTP 패킷으로 전송됩니다. 매개변수 세트의 설정은 위에서 설명한 대로 수행됩니다.

여기서는 STAP 사용이 필수적입니다. 개별 슬라이스\(CIF\(Common Intermediate Format\) 그림의 경우 18개\)가 많으면 IP/UDP/RTP 헤더 오버헤드가 허용할 수 없을 정도로 높아질 수 있기 때문입니다\(소스 코딩 도구 FMO를 사용하지 않는 한\). , 이 시나리오에서는 가정되지 않습니다\). 또한, 일부 무선 영상 전송 시스템,

H.324M 및 3GPP에서 규정한 IP 기반 화상전화와 같은 통신은 상대적으로 작은 전송 패킷 크기를 사용할 가능성이 높습니다. 예를 들어, H.223 AL3 SDU의 일반적인 MTU 크기는 약 100바이트입니다\[17\]. 이 패킷화 방식에 따라 개별 슬라이스를 코딩하면 개별 슬라이스가 무선 시스템의 선호되는 최대 패킷 크기보다 작을 가능성이 높기 때문에 유선 및 무선 네트워크 간의 통신에 추가 이점을 제공합니다. 결과적으로, 게이트웨이는 유선 네트워크에서 사용되는 STAP를 무선 네트워크에서 선호되는 단 하나의 NAL 유닛을 사용하여 여러 개의 RTP 패킷으로 변환할 수 있으며 그 반대의 경우도 마찬가지입니다.

---
### **12.4.  Video Telephony with Data Partitioning**

이 방식은 구현되었으며 특히 높은 패킷 손실률에서 우수한 성능을 제공하는 것으로 나타났습니다\[13\].

데이터 분할은 일부 형태의 동일하지 않은 오류 방지가 가능한 경우에만 유용한 것으로 알려져 있습니다. 일반적으로 단일 세션 RTP 환경에서는 오류 특성도 가정됩니다. 즉, 세션의 모든 패킷의 패킷 손실 확률은 통계적으로 동일합니다. 그러나 RTP 세션에서 개별 패킷의 패킷 손실 확률을 줄이는 방법이 있습니다. 예를 들어 RFC 5109\[18\]에 따른 FEC 패킷은 어떤 미디어 패킷이 FEC 패킷과 연관되어 있는지 지정합니다.

모든 경우에 발생하는 오버헤드는 상당하지만 내부 정보에 소비되는 비트 수와 크기가 동일합니다. 그러나 이 메커니즘은 시스템에 지연을 추가하지 않습니다.

다시 말하면, 완전한 매개변수 세트 설정은 제어 프로토콜 수단을 통해 수행됩니다.

12.5. FU 및 순방향 오류 수정을 사용한 화상 통화 또는 스트리밍

이 방식은 구현되었으며 특히 높은 패킷 손실률에서 우수한 성능을 제공하는 것으로 나타났습니다\[19\].

재전송을 적용할 수 없는 시나리오에서 패킷 손실을 방지하는 가장 효율적인 방법은 FEC\(순방향 오류 수정\)입니다. 애플리케이션 계층의 종단 간 FEC 사용은 개별 링크의 FEC 기반 보호보다 효율성이 떨어지는 경우가 많지만\(특히 전송 경로에 서로 다른 특성의 링크가 있는 경우\) 애플리케이션 계층의 종단 간 FEC는 불가피합니다. 일부 시나리오에서는. RFC 5109\[18\]는 패킷 손실 환경에서 일반 애플리케이션 계층, 종단 간 FEC를 사용하는 수단을 제공합니다. XOR 연산을 적용하여 이진 순방향 오류 정정 코드가 생성됩니다.

서로 다른 패킷의 동일한 비트 위치에 있는 비트. 이진 코드는 매개변수 \(n,k\)에 의해 지정될 수 있습니다. 여기서 k는 연결에 사용된 정보 패킷 수이고 n은 k 정보 패킷에 대해 생성된 총 패킷 수입니다. 즉, k 정보 패킷에 대해 n-k 패리티 패킷이 생성됩니다.

RFC 5109 프레임워크 내에서 매개변수 \(n,k\)와 함께 코드를 사용하는 경우 다음 속성이 잘 알려져 있습니다.

a\) 하나의 RTP 패킷에 적용되는 경우 RFC 5109는 패킷 반복만 제공합니다.

b\) RFC 5109는 XOR로 연결된 패킷의 길이가 동일한 경우 비트 전송률이 가장 효율적입니다.

```text
   c) At the same packet loss probability p and for a fixed k, the
      greater the value of n, the smaller the residual error probability
      becomes.  For example, for a packet loss probability of 10%, k=1,
      and n=2, the residual error probability is about 1%, whereas for
      n=3, the residual error probability is about 0.1%.

   d) At the same packet loss probability p and for a fixed code rate
      k/n, the greater the value of n, the smaller the residual error
      probability becomes.  For example, at a packet loss probability of
      p=10%, k=1, and n=2, the residual error rate is about 1%, whereas
      for an extended Golay code with k=12 and n=24, the residual error
      rate is about 0.01%.
```

FU를 사용하지 않고 H.264 기준 코딩 비디오와 함께 RFC 5109를 적용하려면 다음과 같은 몇 가지 옵션을 고려할 수 있습니다.

1\) 비디오 인코더는 각 비디오 프레임이 단일 슬라이스로 코딩되는 NAL 단위를 생성합니다. FEC를 적용하면 \(n=2, k=1\)과 같은 간단한 코드를 사용할 수 있습니다. 즉, 각 NAL 단위는 기본적으로 반복됩니다. 단점은 분명히 위의 d\)에 따른 나쁜 코드 성능과 \(n, k=1\) 코드만 사용할 수 있으므로 유연성이 낮다는 것입니다.

2\) 비디오 인코더는 각 비디오 프레임이 하나 이상의 연속 슬라이스로 인코딩되는 NAL 단위를 생성합니다. FEC를 적용하면 NAL 단위 시퀀스에 대해 더 나은 코드\(예: \(n=24, k=12\)\)를 사용할 수 있습니다. 프레임당 RTP 패킷 수에 따라 손실로 인해 상당한 지연이 발생할 수 있으며, 이는 프레임당 더 많은 RTP 패킷이 사용되면 감소됩니다. 완전히 다른 길이의 패킷도 연결될 수 있으며 이로 인해 비트 전송률이 감소합니다.

- 위의 b\)에 따른 효율성. 그러나 약간의 주의를 기울이면 1kb 이상의 슬라이스에 대해 유사한 길이\(100-200바이트 차이\)가 생성될 수 있으며 이로 인해 비트 효율성이 크게 떨어지지는 않습니다.

3\) 비디오 인코더는 특정 프레임이 거의 동일한 길이의 k 슬라이스를 포함하는 NAL 단위를 생성합니다. 그런 다음 FEC를 적용하면 더 나은 코드, 예를 들어 \(n=24, k=12\)가 각 프레임에 대한 NAL 단위 시퀀스에 대해 사용될 수 있습니다. 위의 2\)에 비해 지연시간이 줄어들 수는 있으나 몇 가지 단점이 분명하다. 첫째, 슬라이스 구조 코딩은 프레임 내 예측을 감소시키고 추가적인 슬라이스 오버헤드가 필요하기 때문에 인코딩된 비디오의 코딩 효율성이 크게 낮아집니다. 둘째, 사전 인코딩된 콘텐츠 또는 게이트웨이를 통해 작동할 때 비디오는 일반적으로 FEC가 적용될 수 있도록 k 슬라이스로 적절하게 코딩되지 않습니다. 마지막으로, 동일한 길이의 k 슬라이스를 생성하는 비디오 인코딩은 간단하지 않으며 둘 이상의 인코딩 패스가 필요할 수 있습니다.

언급된 많은 단점은 FEC와 함께 FU를 적용하면 피할 수 있습니다. 각 NAL 단위는 기본적으로 동일한 길이의 임의 개수의 FU로 분할될 수 있습니다. 따라서 인코더가 동일한 길이의 슬라이스를 생성하려고 노력하지 않은 경우에도 합리적인 k 및 n을 사용하는 FEC를 적용할 수 있습니다. 예를 들어, 전체 프레임을 포함하는 코딩된 슬라이스 NAL 단위를 k개의 FU로 분할하고 패리티 검사 코드\(n=k+1, k\)를 적용할 수 있다. 그러나 생성된 모든 조각을 복구할 수 없으면 전체 조각이 손실된다는 단점이 있습니다. 따라서 프레임이 여러 조각으로 분할된 경우보다 더 큰 섹션이 손실됩니다.

제시된 기술을 사용하면 추가적인 소스 코딩 계층 중복성\(예: 주기적 인트라 프레임\)이 없더라도 우수한 전송 오류 허용 오차를 달성할 수 있습니다. 결과적으로, 동일한 코딩된 비디오 시퀀스를 사용하여 오류 없는 전송과 오류가 발생하기 쉬운 네트워크를 통한 전송에 대해 최대 압축 효율성과 품질을 달성할 수 있습니다. 또한 이 기술을 사용하면 지연을 추가하지 않고도 사전 인코딩된 시퀀스에 FEC를 적용할 수 있습니다. 이 경우 오류가 발생하기 쉬운 네트워크용으로 인코딩되지 않은 사전 인코딩된 시퀀스는 광범위한 지연을 추가하지 않고도 거의 안정적으로 전송될 수 있습니다. 또한 동일한 길이의 FU는 RFC 5109의 비트 전송률을 효율적으로 사용합니다.

오류 확률이 전송된 패킷의 길이에 따라 달라지는 경우\(예: 모바일 전송의 경우\[15\]\) FEC와 함께 FU를 적용하는 이점은 훨씬 더 분명합니다. 기본적으로 FU 크기의 유연성으로 인해 각 NAL 단위에 대해 적절한 FEC가 적용되고 NAL 단위의 불평등한 오류 보호가 가능해집니다.

FU와 FEC를 사용하는 경우 발생하는 오버헤드는 상당하지만 FEC가 적용되지 않는 경우 인트라 코딩된 매크로블록에 소비해야 하는 비트 수와 크기가 동일합니다. \[19\]에서는 오버헤드를 포함하여 동일한 오류율과 동일한 전체 비트 전송률을 사용할 때 FEC 기반 접근 방식의 전반적인 성능이 품질을 향상시키는 것으로 나타났습니다.

---
### **12.6.  Low Bitrate Streaming**

이 방식은 H.263 및 비표준 RTP 패킷화로 구현되었으며 좋은 결과를 얻었습니다\[20\]. H.264에서는 비슷한 좋은 결과를 얻을 수 없는 기술적인 이유가 없습니다.

오늘날의 인터넷 스트리밍에서는 전화 접속 모뎀이 있는 터미널이 콘텐츠에 액세스할 수 있도록 제공되는 비트 전송률 중 일부가 상대적으로 낮습니다. 유선 IP 네트워크에서는 네트워크 정체를 줄이기 위해 더 작고 자주 발생하는 패킷보다 상대적으로 큰 패킷\(예: 500 - 1500바이트\)이 선호됩니다. 또한, 대용량 패킷을 사용하면 RTP/UDP/IP 헤더 오버헤드의 양이 줄어듭니다. 낮은 비트 전송률 비디오의 경우 큰 패킷을 사용한다는 것은 때로는 최대 몇 개의 사진을 하나의 패킷에 캡슐화해야 함을 의미합니다.

그러나 다수의 코딩된 사진이 포함된 패킷의 손실은 이전 사진을 반복하는 것 외에는 전체 사진의 손실을 숨길 수 있는 방법이 사실상 없기 때문에 시각적 품질에 심각한 영향을 미칩니다. 상대적으로 큰 패킷을 구성하고 성공적인 손실 은폐 가능성을 유지하는 한 가지 방법은 여러 그림의 인터리브된 조각을 포함하는 MTAP를 구성하는 것입니다. MTAP에는 동일한 그림에서 공간적으로 인접한 조각이나 공간적으로 겹치는 조각이 포함되어서는 안 됩니다. 패킷이 손실된 경우, 손실된 슬라이스는 동일한 픽처의 공간적으로 인접한 슬라이스와 시간적으로 이전 및 다음 픽처의 공간적으로 대응하는 슬라이스로 둘러싸여 있을 가능성이 높습니다. 결과적으로, 손실된 슬라이스의 은폐는 비교적 성공적일 가능성이 높습니다.

---
### **12.7.  Robust Packet Scheduling in Video Streaming**

강력한 패킷 스케줄링은 MPEG-4 Part 2로 구현되었으며 무선 스트리밍 환경에서 시뮬레이션되었습니다\[21\]. H.264에서 유사하거나 더 나은 결과를 얻을 수 없는 기술적인 이유는 없습니다.

스트리밍 클라이언트에는 일반적으로 상대적으로 많은 양의 데이터를 저장할 수 있는 수신기 버퍼가 있습니다. 처음에 스트리밍 세션이 설정되면 클라이언트는 스트림 재생을 즉시 시작하지 않습니다. 오히려 일반적으로 몇 초 동안 들어오는 데이터를 버퍼링합니다. 이 버퍼링은 지속적인 유지에 도움이 됩니다.

때때로 전송 지연이 증가하거나 네트워크 처리량이 떨어지는 경우 클라이언트는 버퍼링된 데이터를 디코딩하고 재생할 수 있습니다. 그렇지 않으면 초기 버퍼링 없이 클라이언트는 디스플레이를 정지하고 디코딩을 중지하며 수신 데이터를 기다려야 합니다. 버퍼링은 모든 프로토콜 수준에서 자동 또는 선택적 재전송에도 필요합니다. 사진의 일부가 손실된 경우 재전송 메커니즘을 사용하여 손실된 데이터를 다시 보낼 수 있습니다. 재전송된 데이터가 예정된 디코딩 또는 재생 시간 이전에 수신되면 손실이 완벽하게 복구됩니다. 코딩된 그림은 디코딩된 시퀀스의 주관적인 품질에 대한 중요도에 따라 순위가 매겨질 수 있습니다. 예를 들어, 기존의 B 픽처와 같은 비참조 픽처는 주관적으로 가장 중요하지 않습니다. 그 이유는 비참조 픽처의 부재가 다른 픽처의 디코딩에 영향을 주지 않기 때문입니다. 비참조 사진 외에도 ITU-T H.264 | ISO/IEC 14496-10 표준에는 하위 시퀀스라는 시간적 확장성 방법이 포함되어 있습니다\[22\]. 주관적인 순위는 코딩된 슬라이스 데이터 파티션 또는 슬라이스 그룹 기반으로 이루어질 수도 있습니다. 주관적으로 가장 중요한 코딩된 슬라이스 및 코딩된 슬라이스 데이터 파티션은 디코딩 순서가 나타내는 것보다 먼저 전송될 수 있는 반면, 주관적으로 가장 덜 중요한 코딩된 슬라이스 및 코딩된 슬라이스 데이터 파티션은 자연적인 코딩 순서가 나타내는 것보다 늦게 전송될 수 있습니다. 결과적으로, 가장 중요한 슬라이스 및 코딩된 슬라이스 데이터 파티션의 재전송된 부분은 가장 덜 중요한 슬라이스 및 슬라이스 데이터 파티션에 비해 예정된 디코딩 또는 재생 시간 전에 수신될 가능성이 더 높습니다.

---
## **13.  Informative Appendix: Rationale for Decoding Order Number**
---
### **13.1.  Introduction**

DON\(Decoding Order Number\) 개념은 주로 효율적인 다중 화면 슬라이스 인터리빙\(12.6절 참조\)과 강력한 패킷 스케줄링\(12.7절 참조\)을 가능하게 하기 위해 도입되었습니다. 이들 애플리케이션 모두에서, NAL 단위는 디코딩 순서를 벗어나 전송됩니다. DON은 NAL 단위의 디코딩 순서를 나타내며 수신기에서 디코딩 순서를 복구하는 데 사용되어야 합니다. 효율적인 다중 화면 슬라이스 인터리빙과 견고한 패킷 스케줄링에 대한 사용 사례의 예는 각각 섹션 13.2와 13.3에 나와 있습니다. 13.4절에서는 중복 코딩된 그림을 통해 달성되는 오류 복원력에 대한 DON 개념의 이점을 설명합니다. 섹션 13.5에서는 DON에 대해 고려된 대안을 요약하고 이 RTP 페이로드 사양에 DON이 선택된 이유를 설명합니다.

---
### **13.2.  Example of Multi-Picture Slice Interleaving**

다중 영상 슬라이스 인터리빙의 예는 다음과 같습니다. 아래에는 코딩된 비디오 시퀀스의 하위 집합이 출력 순서로 나와 있습니다. R은 참조 픽쳐를 나타내고, N은 비참조 픽쳐를 나타내며, 숫자는 상대 출력 시간을 나타낸다.

```text
      ... R1 N2 R3 N4 R5 ...
```

이러한 그림의 디코딩 순서는 왼쪽에서 오른쪽으로 다음과 같습니다.

```text
      ... R1 R3 N2 R5 N4 ...
```

픽처 R1, R3, N2, R5 및 N4의 NAL 단위에는 각각 1, 2, 3, 4 및 5와 동일한 DON이 표시됩니다.

각 참조 픽처는 다음과 같이 분산된 3개의 슬라이스 그룹으로 구성됩니다\(숫자는 QCIF\(Quarter Common Intermediate Format\) 프레임의 각 매크로블록에 대한 슬라이스 그룹 번호를 나타냅니다\).

```text
      0 1 2 0 1 2 0 1 2 0 1
      2 0 1 2 0 1 2 0 1 2 0
      1 2 0 1 2 0 1 2 0 1 2
      0 1 2 0 1 2 0 1 2 0 1
      2 0 1 2 0 1 2 0 1 2 0
      1 2 0 1 2 0 1 2 0 1 2
      0 1 2 0 1 2 0 1 2 0 1
      2 0 1 2 0 1 2 0 1 2 0
      1 2 0 1 2 0 1 2 0 1 2
```

단순화를 위해 슬라이스 그룹의 모든 매크로블록이 하나의 슬라이스에 포함된다고 가정합니다. 3개의 MTAP는 3개의 연속 참조 그림으로 구성되어 각 MTAP에는 3개의 집계 단위가 포함되며 각 단위에는 하나의 슬라이스 그룹의 모든 매크로블록이 포함됩니다. 첫 번째 MTAP는 픽처 R1의 슬라이스 그룹 0, 픽처 R3의 슬라이스 그룹 1, 픽처 R5의 슬라이스 그룹 2를 포함합니다. 두 번째 MTAP는 픽처 R1의 슬라이스 그룹 1, 픽처 R3의 슬라이스 그룹 2, 픽처 R5의 슬라이스 그룹 0을 포함합니다. 세 번째 MTAP는 픽처 R1의 슬라이스 그룹 2, 픽처 R3의 슬라이스 그룹 0, 픽처 R5의 슬라이스 그룹 1을 포함합니다. 각각의 비참조 사진은 STAP-B로 캡슐화됩니다.

결과적으로 NAL 단위의 전송 순서는 다음과 같습니다.

R1, 슬라이스 그룹 0, DON 1, MTAP,RTP SN에 전달됨: N

- R3, 슬라이스 그룹 1, DON 2, MTAP에서 전달,RTP SN: N R5, 슬라이스 그룹 2, DON 4, MTAP에서 전달,RTP SN: N R1, 슬라이스 그룹 1, DON 1, MTAP,RTP SN에서 전달 : N+1 R3, 슬라이스 그룹 2, DON 2, MTAP, RTP에서 전달 SN: N+1 R5, 슬라이스 그룹 0, DON 4, MTAP, RTP에서 전달 SN: N+1 R1, 슬라이스 그룹 2, DON 1 , MTAP에 전달됨,RTP SN: N+2 R3, 슬라이스 그룹 1, DON 2, MTAP에 전달됨,RTP SN: N+2 R5, 슬라이스 그룹 0, DON 4, MTAP에 전달됨,RTP SN: N+2 N2 , DON 3, STAP-B에 운반됨, RTP SN: N+3 N4, DON 5, STAP-B에 운반됨, RTP SN: N+4

수신기는 각각의 NAL 단위와 연관된 DON의 값에 기초하여 디코딩 순서로 NAL 단위를 다시 구성할 수 있습니다.

MTAP 중 하나가 손실되면 공간적으로 인접하고 시간적으로 같은 위치에 있는 매크로블록이 수신되어 손실을 효율적으로 숨기는 데 사용될 수 있습니다. STAP 중 하나가 손실되면 손실 효과가 일시적으로 전파되지 않습니다.

---
### **13.3.  Example of Robust Packet Scheduling**

강력한 패킷 스케줄링의 예는 다음과 같습니다. 예제에 사용된 통신 시스템은 비디오가 소스에서 싱크로 처리되는 순서대로 다음 구성 요소로 구성됩니다.

o 카메라 및 캡처 o 사전 인코딩 버퍼 o 인코더 o 인코딩된 그림 버퍼 o 송신기 o 전송 채널 o 수신기 o 수신기 버퍼 o 디코더 o 디코딩된 그림 버퍼 o 디스플레이

본 예시에서 사용된 영상통신 시스템은 다음과 같이 동작한다. 비디오 스트림 처리는 시스템의 모든 구성 요소에서 점진적으로 동시에 발생합니다. 소스 비디오 시퀀스가 ​​촬영되어 사전 인코딩 버퍼에 캡처됩니다. 사전 인코딩 버퍼는 예를 들어 샘플링 순서에서 인코딩 순서로 그림의 순서를 지정하거나 비트 전송률 제어 목적으로 압축되지 않은 여러 프레임을 분석하는 데 사용할 수 있습니다. 어떤 경우에는 사전 인코딩 버퍼가 존재하지 않을 수도 있습니다. 대신에 샘플링된 사진은

바로 인코딩됩니다. 인코더는 사전 인코딩 버퍼의 그림을 인코딩하고 출력\(즉, 코딩된 그림\)을 인코딩된 그림 버퍼에 저장합니다. 송신기는 인코딩된 픽처 버퍼로부터 코딩된 픽처들을 전송 패킷으로 캡슐화하고 이를 전송 채널을 통해 수신기로 보낸다. 수신기는 수신된 패킷을 수신기 버퍼에 저장합니다. 수신기 버퍼링 프로세스에는 일반적으로 전송 지연 지터에 대한 버퍼링이 포함됩니다. 수신기 버퍼는 코딩된 데이터의 올바른 디코딩 순서를 복구하는 데에도 사용될 수 있습니다. 디코더는 수신기 버퍼에서 코딩된 데이터를 읽고 디코딩된 그림을 디코딩된 그림 버퍼에 대한 출력으로 생성합니다. 디코딩된 그림 버퍼는 그림의 출력\(또는 표시\) 순서를 복구하는 데 사용됩니다. 마지막으로 사진이 표시됩니다.

다음 예시 도면에서 I는 IDR 픽처를 나타내고, R은 참조 픽처를 나타내고, N은 비참조 픽처를 나타내고, I, R, N 뒤의 숫자는 디코딩 순서에서 이전 IDR 픽처에 대한 샘플링 시간을 나타낸다. 그림 순서 아래의 값은 확장된 시스템 시계 타임스탬프를 나타냅니다. 이 예에서는 시스템 시계가 임의로 초기화되고 시간은 왼쪽에서 오른쪽으로 흐릅니다. 인코딩, 전송 및 디코딩에 시간이 걸리지 않는다고 가정하면 각 I, R 및 N 픽처는 이전 처리 단계와 비교하여 동일한 타임라인에 매핑됩니다. 따라서 동시에 발생하는 이벤트는 모든 예시 그림에서 동일한 열에 위치합니다.

아래에는 코딩된 그림 시퀀스의 하위 집합이 샘플링 순서로 표시되어 있습니다.

```text
       ...  N58 N59 I00 N01 N02 R03 N04 N05 R06 ... N58 N59 I00 N01 ...
       ... --|---|---|---|---|---|---|---|---|- ... -|---|---|---|- ...
       ...  58  59  60  61  62  63  64  65  66  ... 128 129 130 131 ...

       Figure 16.  Sequence of pictures in sampling order
```

샘플링된 픽처는 인코딩 순서대로 정렬하기 위해 사전 인코딩 버퍼에 버퍼링됩니다. 본 예에서는 이전 참조 픽처에서만 예측되는 IDR 픽처 바로 앞의 비참조 픽처를 제외하고, 출력 순서대로 이전 참조 픽처와 다음 참조 픽처 모두에서 비참조 픽처를 예측한다고 가정한다. 출력 순서. 따라서, 프리인코딩 버퍼에는 적어도 2개의 픽처가 포함되어야 하며, 버퍼링으로 인해 2개의 픽처 간격만큼 지연이 발생하게 된다. 사전 인코딩 버퍼링 프로세스의 출력과 영상의 인코딩\(및 디코딩\) 순서는 다음과 같습니다.

```text
       ... N58 N59 I00 R03 N01 N02 R06 N04 N05 ...
       ... -|---|---|---|---|---|---|---|---|- ...
       ... 60  61  62  63  64  65  66  67  68  ...

       Figure 17.  Reordered pictures in the pre-encoding buffer
```

인코더 또는 송신기는 각 픽처의 DON 값을 디코딩 순서에 따라 이전 픽처의 DON 값에 1을 더한 값으로 설정할 수 있다.

단순화를 위해 다음과 같이 가정하겠습니다.

o 시퀀스의 프레임 속도는 일정합니다. o 각 그림은 단 하나의 슬라이스로 구성됩니다. o 각 슬라이스는 단일 NAL 단위 패킷에 캡슐화됩니다. o 전송 지연이 없으며, o 그림은 일정한 간격으로 전송됩니다\(즉, 1 / \(프레임 속도\)\).

그림이 디코딩 순서대로 전송되면 다음과 같이 수신됩니다.

```text
       ... N58 N59 I00 R03 N01 N02 R06 N04 N05 ...
       ... -|---|---|---|---|---|---|---|---|- ...
       ... 60  61  62  63  64  65  66  67  68  ...

       Figure 18.  Received pictures in decoding order
```

OPTIONAL sprop-interleaving-length 미디어 유형 매개변수는 전송\(또는 수신\) 순서가 디코딩 순서와 동일하므로 0으로 설정됩니다.\(MAY\)

처음에 디코더는 아래에 설명된 것처럼 디코딩 순서에서 출력 순서로 그림을 구성하기 위해 디코딩된 그림 버퍼에 하나의 그림 간격 동안 버퍼링해야 합니다.

```text
       ... N58 N59 I00 N01 N02 R03 N04 N05 R06 ...
       ... -|---|---|---|---|---|---|---|---|- ...
       ... 61  62  63  64  65  66  67  68  69  ...

       Figure 19.  Output order
```

디코딩된 그림 버퍼에 필요한 초기 버퍼링의 양은 버퍼링 기간 SEI 메시지 또는 H.264 비디오 사용성 정보의 num\_reorder\_frames 구문 요소를 통해 신호로 전달될 수 있습니다. num\_reorder\_frames는 프레임의 최대 수, 상보 필드 쌍 또는 임의의 프레임 앞에 오는 비쌍 필드, 상보 필드 쌍 또는 쌍을 이루지 않은 필드를 나타냅니다.

디코딩 순서대로 순서가 지정되고 출력 순서대로 이어집니다. 단순화를 위해 num\_reorder\_frames가 디코딩된 그림 버퍼의 초기 버퍼를 나타내는 데 사용된다고 가정합니다. 이 예에서 num\_reorder\_frames는 1과 같습니다.

전송 중에 IDR 사진 I00이 손실되고 시스템 클럭 값이 62일 때 재전송 요청이 발행되면 재전송된 사진을 수신하는 데 하나의 사진 간격\(시스템 클럭이 타임스탬프 63에 도달할 때까지\)이 있다는 것을 알 수 있습니다. IDR 사진 I00.

그러면 IDR 영상이 디코딩 위치보다 두 프레임 간격 이전에 전송된다고 가정해 보겠습니다. 즉, 사진은 다음과 같이 전송됩니다.

```text
       ...  I00 N58 N59 R03 N01 N02 R06 N04 N05 ...
       ... --|---|---|---|---|---|---|---|---|- ...
       ...  62  63  64  65  66  67  68  69  70  ...

       Figure 20.  Interleaving: Early IDR pictures in sending order
```

OPTIONAL sprop-interleaving-length 미디어 유형 매개변수는 해당 정의에 따라 1로 설정됩니다. \(이 예에서 sprop-인터리빙 깊이의 값은 다음과 같이 도출될 수 있습니다. 픽처 I00은 전송 순서에서 픽처 N58 또는 N59보다 앞선 유일한 픽처이고 디코딩 순서에서는 그 다음입니다. 픽처 I00, N58 및 N59를 제외하고, 전송 순서는 픽처의 디코딩 순서와 동일하며, 코딩된 픽처는 정확히 하나의 NAL 단위로 캡슐화되므로 sprop-interleaving-뎁스 값은 전송 순서에서 픽처보다 앞선 픽처와 픽처 다음의 최대 픽처 수와 같습니다. 디코딩 순서대로\).\(MAY\)

수신기 버퍼링 프로세스는 sprop-interleaving-length 매개변수의 값에 따라 한 번에 두 개의 그림을 포함하고 각 그림과 관련된 DON 값을 기반으로 수신 순서에서 올바른 디코딩 순서로 그림의 순서를 지정합니다. 수신기 버퍼링 프로세스의 출력은 다음과 같습니다.

```text
       ... N58 N59 I00 R03 N01 N02 R06 N04 N05 ...
       ... -|---|---|---|---|---|---|---|---|- ...
       ... 63  64  65  66  67  68  69  70  71  ...

       Figure 21.  Interleaving: Receiver buffer
```

다시 말하면, 아래에 설명된 것처럼 디코딩 순서에서 출력 순서로 그림을 구성하려면 하나의 그림 간격의 초기 버퍼링 지연이 필요합니다.

```text
        ... N58 N59 I00 N01 N02 R03 N04 N05 ...
        ... -|---|---|---|---|---|---|---|- ...
        ... 64  65  66  67  68  69  70  71  ...

        Figure 22.  Interleaving: Receiver buffer after reordering
```

가능한 애플리케이션, 전송 또는 링크 계층 재전송을 포함하여 전송 중에 IDR 영상이 겪을 수 있는 최대 지연은 3개의 영상 간격과 동일합니다. 따라서, IDR 영상의 손실 복원력은 영상이 디코딩 순서대로 전송되는 경우에 비해 재전송을 지원하는 시스템에서 향상됩니다.

---
### **13.4.  Robust Transmission Scheduling of Redundant Coded Slices**

중복 코딩된 픽처는 해당 기본 코딩 픽처가 올바르게 디코딩된 경우 디코딩 프로세스에서 사용되지 않는 픽처 또는 픽처의 일부에 대한 코딩된 표현입니다. 디코딩된 기본 화면의 영역과 동일한 액세스 단위의 중복 화면에 대한 H.264 디코딩 프로세스를 적용한 결과인 해당 영역 사이에는 눈에 띄는 차이가 없어야 합니다. 중복 코딩된 슬라이스는 중복 코딩된 화면의 일부인 코딩된 슬라이스입니다.

오류가 발생하기 쉬운 비디오 전송에서 동일하지 않은 오류 보호를 제공하기 위해 중복된 코딩된 그림을 사용할 수 있습니다. 화상의 1차 코딩된 표현이 부정확하게 디코딩되면, 대응하는 중복 코딩된 화상이 디코딩될 수 있습니다. 중복 코덱 사진 기능을 사용하는 응용 프로그램 및 코딩 기술의 예로는 비디오 중복 코딩\[23\] 및 멀티캐스트 스트리밍의 "핵심 사진" 보호\[24\]가 있습니다.

오류가 발생하기 쉬운 많은 비디오 통신 시스템의 한 가지 특성은 전송 오류가 종종 폭주한다는 것입니다. 따라서 전송 순서에 따라 둘 이상의 연속 전송 패킷에 영향을 미칠 수 있습니다. 낮은 비트율 비디오 통신에서는 전체 코딩된 화면이 하나의 전송 패킷으로 캡슐화되는 것이 비교적 일반적입니다. 결과적으로, 1차 코딩 픽처와 이에 대응하는 중복 코딩 픽처는 전송 순서에 따라 연속적인 패킷으로 전송될 수 있다. 버스티 전송 오류에 대한 전송 방식을 보다 잘 허용하도록 하려면 단일 패킷 이상으로 분리된 기본 코딩된 화면과 중복된 코딩된 화면을 전송하는 것이 좋습니다. DON 개념이 이를 가능하게 합니다.

---
### **13.5.  Remarks on Other Design Possibilities**

H.264 코딩 표준의 슬라이스 헤더 구문 구조에는 코딩된 프레임의 디코딩 순서를 나타낼 수 있는 frame\_num 구문 요소가 포함되어 있습니다. 그러나 다음과 같은 이유로 인해 디코딩 순서를 복구하는 데 있어 프레임\_넘버 구문 요소의 사용은 실현 가능하지 않거나 바람직하지 않습니다.

o 수신기는 코딩된 그림당 적어도 하나의 슬라이스 헤더를 구문 분석해야 합니다\(코딩된 데이터를 디코더에 전달하기 전에\).

o 프레임 번호 구문 요소가 각 IDR 그림에서 0으로 재설정되므로 여러 코딩된 비디오 시퀀스의 코딩된 슬라이스는 인터리브될 수 없습니다.

o 상보적 필드쌍의 코딩된 필드는 프레임\_번호 구문 요소의 동일한 값을 공유합니다. 따라서, 상보적 필드 쌍의 코딩된 필드의 디코딩 순서는 H.264 코딩 구문의 Frame\_num 구문 요소 또는 다른 구문 요소에 기초하여 복구될 수 없습니다.

MPEG-4 기본 스트림 전송을 위한 RTP 페이로드 형식\[25\]은 액세스 단위의 인터리빙과 동일한 RTP 패킷에서 다중 액세스 단위의 전송을 가능하게 합니다. 액세스 단위는 \[1\]의 하위절 7.4.1.2에 따라 기본 코딩된 화면과 연관된 모든 NAL 단위를 포함하도록 H.264 코딩 표준에 지정됩니다. 결과적으로, 서로 다른 그림의 슬라이스는 인터리브될 수 없으며 향상된 오류 복원력을 위한 다중 그림 슬라이스 인터리빙 기술\(12.6절 참조\)을 사용할 수 없습니다.

---
## **14.  Changes from RFC 3984**

다음은 RFC 3984의 기술 변경 사항\(버그 수정 포함\) 목록입니다. 이 기술 변경 목록 외에도 수많은 편집 변경 사항이 있었지만 이 섹션에는 문서화되어 있지 않습니다. 섹션 8.2.2는 이 메모에서 중요한 변경 사항이 많이 발생하는 부분이며 특별한 주의를 기울일 가치가 있다는 점에 유의하십시오.

1\) 섹션 5.4, 5.5, 6.2, 6.3, 6.4에서는 사용 중인 패킷화 모드가 외부 수단에 의해 신호를 받을 수 있다는 점을 삭제했습니다.

2\) 7.2.2항에서 문장 변경

- 디인터리빙 버퍼에는 N개의 VCL NAL 유닛이 있습니다.

```text
       to
```

- 디인터리빙 버퍼에는 N개 이상의 VCL NAL 단위가 있습니다.

3\) 8.1절에서 sprop-init-buf-time\(2항\)의 의미가 다음과 같이 변경되었습니다.

- 매개변수는 신뢰성 있고 순간적인 전송, 전송과 디코딩의 타임라인이 동일하고 첫 번째 패킷이 도착하면 디코딩이 시작된다는 가정 하에 \(NAL 단위의 전송 시간 - NAL 단위의 디코딩 시간\)의 최대값입니다.

```text
       to
```

- 파라미터는 신뢰성 있고 순간적인 전송, 전송과 디코딩의 타임라인이 동일하고 첫 번째 패킷이 도착하면 디코딩이 시작된다는 가정 하에 \(NAL 단위의 디코딩 시간 - NAL 단위의 전송 시간\)의 최대값입니다.

4\) 미디어 유형 매개변수 max-smbps, sprop-level-parameter-sets, use-level-src-parameter-sets, in-band-parameter-sets, sar- Understanding 및 sar-supported가 추가되었습니다.

5\) 8.1절에서 Parameter-add 사양을 삭제했습니다. 매개변수 추가에 대한 다른 설명\(섹션 8.2 및 8.4\)도 제거되었습니다.

6\) 섹션 8.1에서는 profile-level-id로 표시된 것과 동일한 프로필 및 레벨에 대한 매개변수 세트만 포함할 수 있도록 sprop-parameter-sets에 제약 조건을 추가했습니다.

7\) 섹션 8.2.1에서는 sprop-parameter-sets 및 sprop-level-parameter-sets가 SDP의 "a=fmtp" 라인에 포함되거나 섹션에 지정된 대로 "fmtp" 소스 속성을 사용하여 전달될 수 있다고 추가했습니다. \[9\]의 6.3.

8\) 섹션 8.2.2에서는 SDP Offer/Answer 모델과 함께 사용되는 미디어 형식 구성의 일부에서 sprop-deint-buf-req를 제거했습니다.

9\) 섹션 8.2.2에서는 SDP Offer/Answer 모델에서 레벨이 다운그레이드 가능함을 분명히 했습니다. 즉, profile-level-id의 레벨 부분 사용이 대칭일 필요는 없습니다\(답변에 포함된 레벨\). 제안에 포함된 수준보다 낮거나 같을 수 있습니다\).

10\) 섹션 8.2.2에서는 인코딩 기능을 선언하는 데 기능 매개변수를 사용할 수 있다는 점을 삭제했습니다.

11\) 섹션 8.2.2에서는 레벨 다운그레이드 여부에 관계없이 매개변수 세트의 대역 외 전송을 위해 sprop-parameter-set 및 sprop-level-parameter-set를 사용하는 방법에 대한 규칙을 추가했습니다.

12\) 섹션 8.2.2에서는 멀티캐스트에 대한 SDP Offer/Answer와 함께 미디어 유형 매개변수를 사용하는 규칙을 명확히 했습니다.

13\) 섹션 8.2.2에서는 다양한 미디어 유형 매개변수가 제안 또는 답변과 방향 속성의 다양한 조합에서 어떻게 해석되어야 하는지에 대한 목록을 완성하고 수정했습니다.

14\) 섹션 8.4에서 매개변수 집합의 대역 외 전송과 대역 내 전송이 모두 허용되고 둘 다 권장되거나 필수가 아닌 것으로 텍스트를 변경했습니다.

15\) 매개변수 세트 손실을 처리하기 위해 디코더 새로 고침에 대한 예제 방법을 제공하는 섹션 8.5\(정보 제공\)를 추가했습니다.

16\) 미디어 유형 매개변수 max-recv-level 및 level-asymmetry가 추가되었으며 레벨 업그레이드 및 비대칭에 대한 관련 텍스트와 예시가 허용되고 조정되었습니다.

---
## **15.  Backward Compatibility to RFC 3984**

현재 문서는 RFC 3984의 개정판이며 더 이상 사용되지 않습니다. RFC 3984와 관련된 기술적 변경 사항은 섹션 14에 나열되어 있습니다. 이 섹션에서는 이전 버전과의 호환성 문제를 다룹니다.

대부분의 경우 RFC 3984에 따른 레거시 구현과 이 문서에 따른 새로운 구현에 대한 호환성 문제는 없다는 점에 유의해야 합니다. 호환성 문제는 다음 조건이 모두 참인 경우에만 발생할 수 있습니다. 1\) 레거시 구현과 새로운 구현이 상호 작용하고 2\) 매개변수 세트가 대역 외로 전송됩니다. 이러한 호환성 문제가 발생하면 다음 분석을 사용하여 쉽게 디버그하고 비호환성 원인을 찾을 수 있습니다.

항목 1, 2, 3, 7, 9, 10, 12 및 13은 버그 수정 유형의 변경 사항이며 이전 버전과의 호환성 문제가 발생하지 않습니다.

항목 4\(6개의 새로운 미디어 유형 매개변수 추가\)는 레거시 RFC 3984 수신기가 이러한 매개변수를 무시하고 레거시 RFC 3984 발신자가 이러한 매개변수를 사용하지 않아도 괜찮으므로 SDP 제안/응답 기반 애플리케이션에 대한 이전 버전과의 호환성 문제를 발생시키지 않습니다. 선택 사항이기 때문입니다. 그러나 선언적 사용 기반 애플리케이션에는 이전 버전과의 호환성 문제가 있습니다\(다른 5개 애플리케이션과 마찬가지로 sprop-level-parameter-sets 매개변수에만 해당\).

매개변수는 선언적 용도로 사용할 수 없습니다. 예를 들어 RTSP 및 SAP를 사용하는 선언적 사용 기반 애플리케이션에는 RFC 3984에 따른 SDP 수신기가 인식할 수 없는 매개변수가 SDP에 포함된 세션을 수락할 수 없기 때문에 이전 버전과의 호환성 문제가 있습니다. 따라서 RTSP 또는 SAP 서버는 이 메모에 따라 기존 RFC 3984 수신기용 스트림과 수신기용 스트림 두 세트를 준비해야 할 수 있습니다.

항목 5, 6, 11은 매개변수 세트의 대역 외 전송과 관련됩니다. 다음과 같은 이전 버전과의 호환성 문제가 있습니다.

1\) RFC 3984에 따른 레거시 발신자가 profile-level-id에서 sprop-parameter-sets에 표시된 기본 수준과 다른 수준에 대한 매개 변수 집합을 포함하는 경우 sprop-parameter-sets의 매개 변수 값은 이에 따라 수신자에게 유효하지 않습니다. 메모; 따라서 세션이 거부될 수 있습니다.

2\) RFC 3984에 따른 기존 제안자와 이 메모에 따른 응답자 간의 SDP Offer/Answer에서 응답자가 제안에 포함된 매개변수 세트의 상위 집합이 아닌 답변 매개변수 세트에 포함된 경우 sprop-의 매개변수 값 매개변수 세트가 제공자에게 유효하지 않으며 세션이 제대로 시작되지 않을 수 있습니다\(변경 항목 11과 관련\).

3\) 이 메모에 대한 하나의 엔드포인트 A가 1과 동일한 대역 내 매개변수 세트를 포함하는 경우, RFC 3984에 따른 다른 쪽 B는 대역 내 매개변수 세트를 전송해야 한다는 것을 이해하지 못하며 B는 여전히 매개변수 세트를 제외할 수 있습니다. 대역 내 스트림이 전송 중입니다. 결과적으로 엔드포인트 A는 수신하는 스트림을 디코딩할 수 없습니다.

항목 7\(\[9\]의 섹션 6.3에 지정된 "fmtp" 소스 속성을 사용하여 sprop-parameter-sets 및 sprop-level-parameter-sets 전달 허용\)은 항목 4와 유사합니다. 이전 버전과의 호환성 문제가 발생하지 않습니다. SDP 제안/응답 기반 애플리케이션의 경우 레거시 RFC 3984 수신기는 "fmtp" 소스 속성을 무시하고 레거시 RFC 3984 발신자는 선택 사항이므로 "fmtp" 소스 속성을 사용하지 않아도 괜찮습니다. 그러나 SDP 선언적 사용 기반 애플리케이션\(예: RTSP 및 SAP를 사용하는 애플리케이션\)에는 이전 버전과의 호환성 문제가 있습니다. RFC 3984에 따른 SDP 수신기는 SDP에 인식할 수 없는 매개변수\(즉, "fmtp " 소스 속성\). 따라서 RTSP 또는 SAP 서버는 이 메모에 따라 기존 RFC 3984 수신기용 스트림과 수신기용 스트림 두 세트를 준비해야 할 수 있습니다.

항목 14에서는 매개변수 세트의 대역 외 전송이 여전히 허용되므로 이전 버전과의 호환성 문제가 발생하지 않습니다.

추가된 섹션 8.5가 정보를 제공하므로 항목 15에서는 이전 버전과의 호환성 문제가 발생하지 않습니다.

항목 16은 한쪽 끝이 RFC 3984를 준수하는 경우 기본 수준의 처리가 동일하고, 또한 RFC-3984 호환 끝은 새로운 미디어 유형 매개변수\(있는 경우\)를 단순히 무시하므로 이전 버전과의 호환성 문제를 일으키지 않습니다.

---
## **16.  Acknowledgements**

RFC 3984의 저자인 Stephan Wenger, Miska Hannuksela, Thomas Stockhammer, Magnus Westerlund 및 David Singer에게 감사드립니다. Dave Lindbergh, Philippe Gentric, Gonzalo Camarillo, Gary Sullivan, Joerg Ott 및 Colin Perkins는 개발 과정에서 세심한 검토를 해주신 데 감사드립니다. RFC 3984. Stephen Botzko, Magnus Westerlund, Alex Eleftheriadis, Thomas Schierl, Tom Taylor, Ali Begen, Aaron Wells, Stuart Taylor, Robert Sparks, Dan Romascanu 및 Niclas Comstedt는 이 문서를 개발하는 동안 귀중한 의견과 의견을 제공한 데 대해 감사드립니다. 메모.

---
## **17.  References**
---
### **17.1.  Normative References**

\[1\] ITU-T 권고사항 H.264, "일반 시청각 서비스를 위한 고급 비디오 코딩", 2010년 3월.

```text
   [2]   ISO/IEC International Standard 14496-10:2008.
```

\[3\] ITU-T 권고안 H.241, "H.300 시리즈 터미널에 대한 확장된 비디오 절차 및 제어 신호", 2006년 5월.

\[4\] Bradner, S., "요구 사항 수준을 나타 내기 위해 RFC에 사용되는 핵심 단어", BCP 14, RFC 2119, 1997년 3월.

\[5\] Schulzrinne, H., Casner, S., Frederick, R. 및 V. Jacobson, "RTP: 실시간 애플리케이션을 위한 전송 프로토콜", STD 64, RFC 3550, 2003년 7월.

\[6\] Handley, M., Jacobson, V. 및 C. Perkins, "SDP: 세션 설명 프로토콜", RFC 4566, 2006년 7월.

\[7\] Josefsson, S., "Base16, Base32 및 Base64 데이터 인코딩", RFC 4648, 2006년 10월.

\[8\] Rosenberg, J. 및 H. Schulzrinne, "세션 설명 프로토콜\(SDP\)을 사용한 제안/응답 모델", RFC 3264, 2002년 6월.

\[9\] Lennox, J., Ott, J. 및 T. Schierl, "SDP\(세션 설명 프로토콜\)의 소스별 미디어 속성", RFC 5576, 2009년 6월.

---
### **17.2.  Informative References**

\[10\] Luthra, A., Sullivan, G.J. 및 T. Wiegand \(eds.\),

- "H.264/AVC 비디오 코딩 표준에 관한 특별 이슈 소개", 비디오 기술을 위한 회로 및 시스템에 관한 IEEE Transactions, Vol. 2003년 7월 13일, 7호.

\[11\] Ott, J., Bormann, C., Sullivan, G., Wenger, S. 및 R. Even, Ed., "ITU-T Rec. H.263 비디오용 RTP 페이로드 형식", RFC 4629, 2007년 1월.

```text
   [12]  ISO/IEC International Standard 14496-2:2004.
```

\[13\] Wenger, S., "IP를 통한 H.264/AVC", 비디오 기술을 위한 회로 및 시스템에 관한 IEEE 트랜잭션, Vol. 2003년 7월 13일, 7호.

\[14\] Wenger, S., "IP를 통한 H.26L: IP 네트워크 적응 계층", Proceedings Packet Video Workshop, 2002년 4월.

\[15\] Stockhammer, T., Hannuksela, M.M. 및 S. Wenger, "H.26L/JVT 코딩 네트워크 추상화 계층 및 IP 기반 전송", 이미지 처리에 관한 IEEE 국제 컨퍼런스\(ICIP 2002\), 뉴욕주 로체스터, 9월 2002.

\[16\] Schulzrinne, H. 및 S. Casner, "최소 제어를 통한 오디오 및 비디오 회의용 RTP 프로필", STD 65, RFC 3551, 2003년 7월.

\[17\] ITU-T 권고사항 H.223, "낮은 비트율 멀티미디어 통신을 위한 다중화 프로토콜", 2001년 7월.

\[18\] Li, A., Ed., "일반 순방향 오류 수정을 위한 RTP 페이로드 형식", RFC 5109, 2007년 12월.

\[19\] Stockhammer, T., Wiegand, T., Oelbaum, T. 및 F. Obermeier, "패킷 손실 네트워크를 통한 H.264/AVC 기반 전송을 위한 비디오 코딩 및 전송 계층 기술", IEEE 국제 컨퍼런스 이미지 처리\(ICIP 2003\), 스페인 바르셀로나, 2003년 9월.

\[20\] Varsa, V. 및 M. Karczewicz, "압축된 비디오 패킷화의 슬라이스 인터리빙", Packet Video Workshop 2000.

\[21\] 강상호. 및 A. Zakhor, "무선 비디오 스트리밍을 위한 패킷 스케줄링 알고리즘", Packet Video Workshop 2002.

\[22\] Hannuksela, M.M., "GOP의 향상된 개념", JVT-B042,

- http://ftp3.itu.int/av-arch/video-site/0201\_Gen/JVT-B042.doc, 2002년 1월 이용 가능.

\[23\] Wenger, S., "H.263+의 비디오 중복 코딩", 1997

- 패킷 네트워크를 통한 시청각 서비스에 관한 국제 워크숍, 1997년 9월.

\[24\] Wang, Y.-K., Hannuksela, M.M. 및 M. Gabbouj, "불균등하게 보호된 주요 사진을 사용한 오류 복원력 있는 비디오 코딩", Proc. 국제 워크숍 VLBV03, 2003년 9월.

\[25\] van der Meer, J., Mackie, D., Swaminathan, V., Singer, D. 및 P. Gentric, "MPEG-4 기본 스트림 전송을 위한 RTP 페이로드 형식", RFC 3640, 2003년 11월.

\[26\] Baugher, M., McGrew, D., Naslund, M., Carrara, E. 및 K. Norrman, "SRTP\(보안 실시간 전송 프로토콜\)", RFC 3711, 2004년 3월.

\[27\] Schulzrinne, H., Rao, A. 및 R. Lanphier, "실시간 스트리밍 프로토콜\(RTSP\)", RFC 2326, 1998년 4월.

\[28\] Handley, M., Perkins, C. 및 E. Whelan, "세션 발표 프로토콜", RFC 2974, 2000년 10월.

\[29\] Westerlund, M. 및 S. Wenger, "RTP 토폴로지", RFC 5117, 2008년 1월.

\[30\] Wenger, S., Chandra, U., Westerlund, M. 및 B. Burman, "피드백\(AVPF\)이 포함된 RTP 오디오-비주얼 프로필의 코덱 제어 메시지", RFC 5104, 2008년 2월.

---
# **Authors' Addresses**

```text
   Ye-Kui Wang
   Huawei Technologies
   400 Crossing Blvd, 2nd Floor
   Bridgewater, NJ 08807
   USA

   Phone: +1-908-541-3518
   EMail: yekui.wang@huawei.com

   Roni Even
   Huawei Technologies
   14 David Hamelech
   Tel Aviv 64953
   Israel

   Phone: +972-545481099
   EMail: even.roni@huawei.com

   Tom Kristensen
   TANDBERG
   Philip Pedersens vei 22
   N-1366 Lysaker
   Norway

   Phone: +47 67125125
   EMail: tom.kristensen@tandberg.com, tomkri@ifi.uio.no

   Randell Jesup
   WorldGate Communications
   3800 Horizon Blvd, Suite #103
   Trevose, PA 19053-4947
   USA

   Phone: +1-215-354-5166
   EMail: rjesup@wgate.com, randell_ietf@jesup.org
```