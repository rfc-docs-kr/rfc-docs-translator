

```text
Internet Engineering Task Force (IETF)                      S. Santesson
Request for Comments: 6960                                  3xA Security
Obsoletes: 2560, 6277                                           M. Myers
Updates: 5912                                        TraceRoute Security
Category: Standards Track                                      R. Ankney
ISSN: 2070-1721
                                                              A. Malpani
                                                         CA Technologies
                                                             S. Galperin
                                                                      A9
                                                                C. Adams
                                                    University of Ottawa
                                                               June 2013

                X.509 Internet Public Key Infrastructure
               Online Certificate Status Protocol - OCSP
```

---
# **Abstract**

이 문서에서는 CRL\(인증서 해지 목록\)을 요구하지 않고 디지털 인증서의 현재 상태를 확인하는 데 유용한 프로토콜을 지정합니다. PKIX 운영 요구 사항을 다루는 추가 메커니즘은 별도의 문서에 지정되어 있습니다. 이 문서는 RFC 2560 및 6277을 폐기합니다. 또한 RFC 5912도 업데이트합니다.

---
# **Status of This Memo**

이것은 인터넷 표준 추적 문서입니다.

이 문서는 IETF\(Internet Engineering Task Force\)의 산물입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 게시 승인을 받았습니다. 인터넷 표준에 대한 추가 정보는 RFC 5741의 섹션 2에서 확인할 수 있습니다.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 http://www.rfc-editor.org/info/rfc6960에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2013 IETF Trust 및 문서 작성자로 식별된 사람. 판권 소유.

이 문서는 이 문서 발행일에 유효한 BCP 78 및 IETF 문서와 관련된 IETF Trust의 법적 조항\(http://trustee.ietf.org/license-info\)의 적용을 받습니다. 이 문서에 관한 귀하의 권리와 제한 사항이 설명되어 있으므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출된 코드 구성 요소는 신뢰 법률 조항의 섹션 4.e에 설명된 대로 단순화된 BSD 라이센스 텍스트를 포함해야 하며 단순화된 BSD 라이센스에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1. Introduction ....................................................4
      1.1. Requirements Language ......................................5
   2. Protocol Overview ...............................................5
      2.1. Request ....................................................5
      2.2. Response ...................................................6
      2.3. Exception Cases ............................................8
      2.4. Semantics of thisUpdate, nextUpdate, and producedAt ........9
      2.5. Response Pre-Production ....................................9
      2.6. OCSP Signature Authority Delegation .......................10
      2.7. CA Key Compromise .........................................10
   3. Functional Requirements ........................................10
      3.1. Certificate Content .......................................10
      3.2. Signed Response Acceptance Requirements ...................10
   4. Details of the Protocol ........................................11
      4.1. Request Syntax ............................................11
           4.1.1. ASN.1 Specification of the OCSP Request ............11
           4.1.2. Notes on OCSP Requests .............................13
      4.2. Response Syntax ...........................................14
           4.2.1. ASN.1 Specification of the OCSP Response ...........14
           4.2.2. Notes on OCSP Responses ............................16
                  4.2.2.1. Time ......................................16
                  4.2.2.2. Authorized Responders .....................16
                           4.2.2.2.1. Revocation Checking of
                                      an Authorized Responder ........17
                  4.2.2.3. Basic Response ............................18
      4.3. Mandatory and Optional Cryptographic Algorithms ...........19
      4.4. Extensions ................................................19
           4.4.1. Nonce ..............................................20
           4.4.2. CRL References .....................................20
           4.4.3. Acceptable Response Types ..........................20
           4.4.4. Archive Cutoff .....................................21
           4.4.5. CRL Entry Extensions ...............................21
           4.4.6. Service Locator ....................................22
           4.4.7. Preferred Signature Algorithms .....................22
                  4.4.7.1. Extension Syntax ..........................23
                  4.4.7.2. Responder Signature Algorithm Selection ...24
                           4.4.7.2.1. Dynamic Response ...............24
                           4.4.7.2.2. Static Response ................25
           4.4.8. Extended Revoked Definition ........................25
   5. Security Considerations ........................................26
      5.1. Preferred Signature Algorithms ............................27
           5.1.1. Use of Insecure Algorithms .........................27
           5.1.2. Man-in-the-Middle Downgrade Attack .................27
           5.1.3. Denial-of-Service Attack ...........................28
   6. IANA Considerations ............................................28
   7. References .....................................................28
      7.1. Normative References ......................................28
      7.2. Informative References ....................................29
   8. Acknowledgements ...............................................29
   Appendix A. OCSP over HTTP ........................................30
     A.1. Request ....................................................30
     A.2. Response ...................................................30
   Appendix B. ASN.1 Modules .........................................30
     B.1. OCSP in ASN.1 - 1998 Syntax ................................31
     B.2. OCSP in ASN.1 - 2008 Syntax ................................34
   Appendix C. MIME Registrations ....................................39
     C.1. application/ocsp-request ...................................39
     C.2. application/ocsp-response ..................................40
```

---
## **1.  Introduction**

이 문서에서는 CRL을 요구하지 않고 디지털 인증서의 현재 상태를 확인하는 데 유용한 프로토콜을 지정합니다. PKIX 운영 요구 사항을 다루는 추가 메커니즘은 별도의 문서에 지정되어 있습니다.

이 사양은 \[RFC2560\] 및 \[RFC6277\]을 폐기합니다. 이 문서를 발행하는 주된 이유는 RFC 2560 발행 이후 발견된 모호성을 해결하기 위한 것입니다. 이 문서는 몇 가지 영역에서만 RFC 2560과 다릅니다.

- 섹션 2.2에서는 한 번도 발급된 적이 없는 인증서에 대해 이 응답 상태를 허용하도록 "해지됨" 응답의 사용을 확장합니다.

- 섹션 2.3에서는 \[RFC5019\]에 지정된 대로 "인증되지 않은" 오류 응답의 사용을 확장합니다.

- 섹션 4.2.1 및 4.2.2.3에서는 \[RFC5019\]에서 허용된 대로 요청에 포함되지 않은 인증서에 대한 해지 상태 정보가 응답에 포함될 수 있다고 명시합니다.

- 섹션 4.2.2.2에서는 응답자가 승인된 응답자로 간주되는 경우를 명확히 합니다.

- 섹션 4.2.2.3에서는 ResponderID 필드가 OCSP 응답자 서명자 인증서에 해당함을 명확히 합니다.

- 섹션 4.3에서는 \[RFC6277\]에 지정된 대로 클라이언트가 지원해야 하는 암호화 알고리즘 집합과 클라이언트가 지원해야 하는 암호화 알고리즘 집합을 변경합니다.

- 섹션 4.4.1에서는 Nonce 확장에 대해 RFC 2560에서 누락된 ASN.1 구문을 지정합니다.

- 섹션 4.4.7에서는 클라이언트가 \[RFC6277\]에 지정된 응답에 서명하기 위해 서버가 사용하는 것을 선호하는 서명 알고리즘을 지정하기 위해 요청 메시지에 포함될 수 있는 새로운 확장을 지정합니다.

- 섹션 4.4.8에서는 응답자가 섹션 2.2에 정의된 미발급 인증서에 대한 "해지된" 응답의 확장된 사용을 지원함을 나타내는 새로운 확장을 지정합니다.

- 부록 B.2는 \[RFC5912\]를 업데이트하는 ASN.1의 2008 구문을 사용하는 ASN.1 모듈을 제공합니다.

프로토콜의 개요는 섹션 2에 제공됩니다. 기능적 요구 사항은 섹션 3에 지정됩니다. 프로토콜의 세부 사항은 섹션 4에서 논의됩니다. 섹션 5에서 프로토콜과 관련된 보안 문제를 다룹니다. 부록 A는 HTTP를 통한 OCSP를 정의하고, 부록 B는 다음을 제공합니다. ASN.1 구문 요소와 부록 C는 메시지의 MIME 유형을 지정합니다.

---
### **1.1.  Requirements Language**

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119 \[RFC2119\]에 설명된 대로 해석됩니다.

---
## **2.  Protocol Overview**

정기적인 CRL을 확인하는 대신 또는 그에 대한 보충으로 인증서 폐기 상태에 관한 정보를 적시에 얻는 것이 필요할 수 있습니다\(참조: \[RFC5280\], 섹션 3.3\). 예로는 고액 자금 이체 또는 대규모 주식 거래가 있습니다.

OCSP\(온라인 인증서 상태 프로토콜\)를 사용하면 애플리케이션이 식별된 인증서의 \(해지\) 상태를 확인할 수 있습니다. OCSP는 CRL에서 가능한 것보다 시기적절한 폐기 정보를 제공하는 일부 운영 요구 사항을 충족하는 데 사용될 수 있으며 추가 상태 정보를 얻는 데에도 사용될 수 있습니다. OCSP 클라이언트는 OCSP 응답자에게 상태 요청을 발행하고 응답자가 응답을 제공할 때까지 문제의 인증서 수락을 일시 중단합니다.

이 프로토콜은 하나 이상의 인증서 상태를 확인하는 애플리케이션과 해당 상태를 제공하는 서버 간에 교환해야 하는 데이터를 지정합니다.

---
### **2.1.  Request**

OCSP 요청에는 다음 데이터가 포함됩니다.

```text
   - protocol version

   - service request

   - target certificate identifier
```

- OCSP 응답자가 처리할 수 있는 선택적 확장

요청을 받으면 OCSP 응답자는 다음을 결정합니다.

1. 메시지가 잘 구성되어 있다.

1. 응답자는 요청된 서비스를 제공하도록 구성됩니다.

1. 요청에는 응답자가 필요로 하는 정보가 포함되어 있습니다.

이러한 조건 중 하나라도 충족되지 않으면 OCSP 응답자는 오류 메시지를 생성합니다. 그렇지 않으면 확정적인 응답을 반환합니다.

---
### **2.2.  Response**

OCSP 응답은 다양한 유형이 될 수 있습니다. OCSP 응답은 응답 유형과 실제 응답 바이트로 구성됩니다. 모든 OCSP 서버 및 클라이언트에서 지원해야 하는 기본 유형의 OCSP 응답이 있습니다. 이 섹션의 나머지 부분은 이 기본 응답 유형에만 관련됩니다.

모든 최종 응답 메시지는 디지털 서명되어야 합니다. 응답에 서명하는 데 사용되는 키는 다음 중 하나에 속해야 합니다.

- 문제의 인증서를 발급한 CA

- 요청자가 공개 키를 신뢰하는 신뢰할 수 있는 응답자

- 응답자가 해당 CA에 대해 OCSP 응답을 발행할 수 있음을 나타내는 CA가 직접 발행한 특별히 표시된 인증서를 보유하는 CA 지정 응답자\(섹션 4.2.2.2에 정의된 승인된 응답자\)

최종 응답 메시지는 다음으로 구성됩니다.

- 응답 구문 버전

- 응답자의 식별자

- 응답이 생성된 시간

- 요청의 각 인증서에 대한 응답

```text
   - optional extensions

   - signature algorithm OID
```

- 응답 해시 전체에 걸쳐 계산된 서명

요청의 각 인증서에 대한 응답은 다음으로 구성됩니다.

```text
   - target certificate identifier

   - certificate status value

   - response validity interval

   - optional extensions
```

이 사양은 인증서 상태 값에 사용하기 위한 다음과 같은 최종 응답 표시기를 정의합니다.

```text
   - good

   - revoked

   - unknown
```

"양호" 상태는 상태 조회에 대한 긍정적인 응답을 나타냅니다. 최소한 이 긍정적인 응답은 현재 유효 기간 내에 요청된 인증서 일련 번호가 있는 인증서가 취소되지 않았음을 나타냅니다. 이 상태는 인증서가 발급된 적이 있거나 응답이 생성된 시간이 인증서의 유효 기간 내에 있다는 것을 반드시 의미하지는 않습니다. 응답 확장은 발급, 유효성 등에 대한 긍정적인 설명과 같이 인증서 상태에 관해 응답자가 주장한 주장에 대한 추가 정보를 전달하는 데 사용될 수 있습니다.

"해지됨" 상태는 인증서가 일시적으로\(해지 이유는 CertificateHold임\) 또는 영구적으로 해지되었음을 나타냅니다. 연결된 CA가 현재 또는 이전 발급 키\(이 문서에서는 "발급되지 않은" 인증서라고 함\)를 사용하여 요청에 있는 인증서 일련 번호가 있는 인증서를 발급한 기록이 없는 경우에도 이 상태가 반환될 수 있습니다. .

"알 수 없음" 상태는 응답자가 요청 중인 인증서에 대해 알지 못한다는 것을 나타냅니다. 일반적으로 요청은 이 응답자가 제공하지 않는 인식할 수 없는 발급자를 나타내기 때문입니다.

참고: "해지됨" 상태는 요청된 일련 번호가 있는 인증서가 거부되어야 함을 나타내고, "알 수 없음" 상태는 이 응답자가 상태를 확인할 수 없음을 나타내므로 클라이언트가 시도할지 여부를 결정할 수 있습니다. 상태 정보의 다른 소스\(예:

-CRL\). 이는 응답자의 의도가 클라이언트가 상태 정보의 다른 소스를 시도하는 대신 인증서를 거부하도록 하는 것인 미발급 인증서\(위에 정의된 대로\)에 "해지된" 응답을 적합하게 만듭니다. RFC 2560 배포와의 하위 호환성을 유지하기 위해 발급되지 않은 인증서에 대해 "해지됨" 상태는 여전히 선택 사항입니다. 예를 들어 응답자는 요청된 일련 번호가 발급된 인증서에 할당되었는지 여부에 대해 전혀 알지 못할 수 있습니다. 응답자는 RFC 5019에 따라 사전 생성된 응답을 제공할 수 있으며, 이러한 이유로 발급되지 않은 모든 인증서 일련 번호에 대해 서명된 응답을 제공할 수는 없습니다.

응답자가 발급되지 않은 인증서에 대한 상태 요청에 대해 "폐기됨" 응답을 보낼 때 응답자는 OCSP 응답자가 인증서의 확장된 정의를 지원함을 나타내는 확장된 폐지 정의 응답 확장\(섹션 4.4.8\)을 응답에 포함해야 합니다. 발급되지 않은 인증서에도 적용되는 "해지된" 상태입니다. 또한 이 미발급 인증서와 관련된 SingleResponse는 다음과 같습니다.

- 폐기 이유 인증서 보유\(6\)를 지정해야 합니다.

- revocationTime을 1970년 1월 1일로 지정해야 합니다.

- CRL 참조 확장\(섹션 4.4.2\) 또는 CRL 항목 확장\(섹션 4.4.5\)을 포함해서는 안 됩니다.

---
### **2.3.  Exception Cases**

오류가 발생하면 OCSP 응답자가 오류 메시지를 반환할 수 있습니다. 이 메시지는 서명되지 않았습니다. 오류 유형은 다음과 같습니다.

```text
   - malformedRequest

   - internalError

   - tryLater

   - sigRequired

   - unauthorized
```

수신된 요청이 OCSP 구문을 준수하지 않는 경우 서버는 "malformedRequest" 응답을 생성합니다.

"internalError" 응답은 OCSP 응답자가 일관되지 않은 내부 상태에 도달했음을 나타냅니다. 다른 응답자를 사용하여 쿼리를 다시 시도해야 합니다.

OCSP 응답자가 작동하지만 요청된 인증서에 대한 상태를 반환할 수 없는 경우 "tryLater" 응답을 사용하여 서비스가 존재하지만 일시적으로 응답할 수 없음을 나타낼 수 있습니다.

응답을 구성하기 위해 클라이언트가 요청에 서명하도록 서버에서 요구하는 경우 "sigRequired" 응답이 반환됩니다.

클라이언트가 이 서버에 대해 이 쿼리를 수행할 권한이 없거나 서버가 정식으로 응답할 수 없는 경우 "unauthorized" 응답이 반환됩니다\(\[RFC5019\], 섹션 2.2.3 참조\).

---
### **2.4.  Semantics of thisUpdate, nextUpdate, and producedAt**

이 문서에 정의된 응답에는 thisUpdate, nextUpdate, producerAt 및 revocationTime의 4가지 항목이 포함될 수 있습니다. 이러한 필드의 의미는 다음과 같습니다.

```text
   thisUpdate      The most recent time at which the status being
                   indicated is known by the responder to have been
                   correct.

   nextUpdate      The time at or before which newer information will be
                   available about the status of the certificate.

   producedAt      The time at which the OCSP responder signed this
                   response.

   revocationTime  The time at which the certificate was revoked or
                   placed on hold.
```

---
### **2.5.  Response Pre-Production**

OCSP 응답자는 지정된 시간에 인증서 상태를 지정하는 서명된 응답을 미리 생성할 수 있습니다. 상태가 올바른 것으로 알려진 시간은 응답의 thisUpdate 필드에 반영되어야 합니다. 새로운 정보를 사용할 수 있는 시점이나 그 이전의 시간은 nextUpdate 필드에 반영되고, 응답이 생성된 시간은 응답의 producerAt 필드에 표시됩니다.

---
### **2.6.  OCSP Signature Authority Delegation**

인증서의 상태 정보에 서명하는 키는 인증서에 서명한 키와 동일할 필요는 없습니다. 인증서 발급자는 OCSP 서명자의 인증서에 있는 확장 키 사용 확장\(\[RFC5280\], 섹션 4.2.1.12에 정의됨\)에 대한 고유 값을 포함하는 인증서를 발급하여 OCSP 서명 권한을 명시적으로 위임합니다. 이 인증서는 인식 CA가 응답자에게 직접 발급해야 합니다. 자세한 내용은 섹션 4.2.2.2를 참조하세요.

---
### **2.7.  CA Key Compromise**

OCSP 응답자가 특정 CA의 개인 키가 손상되었음을 알게 되면 해당 CA에서 발급한 모든 인증서에 대해 "해지됨" 상태를 반환할 수 있습니다.

---
## **3.  Functional Requirements**
---
### **3.1.  Certificate Content**

OCSP 클라이언트에게 잘 알려진 정보 액세스 지점을 전달하기 위해 CA는 OCSP를 사용하여 확인할 수 있는 인증서에 권한 정보 액세스 확장\(\[RFC5280\], 섹션 4.2.2.1에 정의됨\)을 포함하는 기능을 제공해야 합니다. 또는 OCSP 공급자에 대한 accessLocation을 OCSP 클라이언트에서 로컬로 구성할 수도 있습니다.

로컬에서 호스팅되거나 승인된 응답자가 제공하는 OCSP 서비스를 지원하는 CA는 URI\(Uniform Resource Identifier\) ​​\[RFC3986\] accessLocation에 대한 값과 accessMethod에 대한 OID 값 id-ad-ocsp를 포함하도록 제공해야 합니다. AccessDescription SEQUENCE.

주체 인증서의 accessLocation 필드 값은 OCSP 응답자에 액세스하는 데 사용되는 전송\(예: HTTP\)을 정의하며 기타 전송 종속 정보\(예: URL\)를 포함할 수 있습니다.

---
### **3.2.  Signed Response Acceptance Requirements**

특정 인증서에 대한 서명된 응답을 유효한 것으로 수락하기 전에 OCSP 클라이언트는 다음을 확인해야 합니다.

1. 수신된 응답에서 식별된 인증서는 해당 요청에서 식별된 인증서와 일치합니다.

1. 응답의 서명이 유효합니다.

1. 서명자의 신원이 요청의 의도된 수신자와 일치합니다.

1. 서명자는 현재 문제의 인증서에 대한 응답을 제공할 권한이 있습니다.

1. 표시된 상태가 올바른 것으로 알려진 시점\(thisUpdate\)은 충분히 최근입니다.

1. 가능한 경우 인증서 상태\(nextUpdate\)에 대한 최신 정보를 사용할 수 있는 시간 또는 그 이전은 현재 시간보다 이후입니다.

---
## **4.  Details of the Protocol**

ASN.1 구문은 \[RFC5280\]에 정의된 용어를 가져옵니다. 서명 계산을 위해 서명할 데이터는 ASN.1 DER\(고유 인코딩 규칙\) \[X.690\]을 사용하여 인코딩됩니다.

별도로 지정하지 않는 한 ASN.1 EXPLICIT 태그 지정이 기본값으로 사용됩니다.

다른 곳에서 가져온 용어는 Extensions, CertificateSerialNumber, SubjectPublicKeyInfo, Name, AlgorithmIdentifier 및 CRLReason입니다.

---
### **4.1.  Request Syntax**

이 섹션에서는 확인 요청에 대한 ASN.1 사양을 지정합니다. 메시지의 실제 형식은 사용된 전송 메커니즘\(HTTP, SMTP, LDAP 등\)에 따라 달라질 수 있습니다.

---
#### **4.1.1.  ASN.1 Specification of the OCSP Request**

OCSPRequest에 해당하는 ASN.1 구조는 다음과 같습니다.

```text
   OCSPRequest     ::=     SEQUENCE {
       tbsRequest                  TBSRequest,
       optionalSignature   [0]     EXPLICIT Signature OPTIONAL }

   TBSRequest      ::=     SEQUENCE {
       version             [0]     EXPLICIT Version DEFAULT v1,
       requestorName       [1]     EXPLICIT GeneralName OPTIONAL,
       requestList                 SEQUENCE OF Request,
       requestExtensions   [2]     EXPLICIT Extensions OPTIONAL }

   Signature       ::=     SEQUENCE {
       signatureAlgorithm      AlgorithmIdentifier,
       signature               BIT STRING,
       certs               [0] EXPLICIT SEQUENCE OF Certificate
   OPTIONAL}

   Version         ::=             INTEGER  {  v1(0) }

   Request         ::=     SEQUENCE {
       reqCert                     CertID,
       singleRequestExtensions     [0] EXPLICIT Extensions OPTIONAL }

   CertID          ::=     SEQUENCE {
       hashAlgorithm       AlgorithmIdentifier,
       issuerNameHash      OCTET STRING, -- Hash of issuer's DN
       issuerKeyHash       OCTET STRING, -- Hash of issuer's public key
       serialNumber        CertificateSerialNumber }
```

OCSPRequest의 필드는 다음과 같은 의미를 갖습니다.

- tbsRequest는 선택적으로 서명된 OCSP 요청입니다.

- optionSignature에는 서명 알고리즘의 알고리즘 식별자 및 관련 알고리즘 매개변수가 포함됩니다. 서명의 서명 값; 그리고 선택적으로 서버가 서명된 응답을 확인하는 데 필요한 인증서\(일반적으로 클라이언트의 루트 인증서까지\).

TBSRequest의 내용에는 다음 필드가 포함됩니다.

- 버전은 프로토콜 버전을 나타내며, 이 문서에서는 v1\(0\)입니다.

- requestorName은 선택 사항이며 OCSP 요청자의 이름을 나타냅니다.

- requestList에는 하나 이상의 단일 인증서 상태 요청이 포함되어 있습니다.

- requestExtensions는 선택사항이며 reqCert에 있는 요청에 적용 가능한 확장을 포함합니다. 섹션 4.4를 참조하세요.

요청 내용에는 다음 필드가 포함됩니다.

- reqCert에는 대상 인증서의 식별자가 포함되어 있습니다.

- SingleRequestExtensions는 선택사항이며 이 단일 인증서 상태 요청에 적용할 수 있는 확장을 포함합니다. 섹션 4.4를 참조하세요.

CertID의 내용에는 다음 필드가 포함됩니다.

- hashAlgorithm은 issuerNameHash 및 issuerKeyHash 값을 생성하는 데 사용되는 해시 알고리즘입니다.

- issuerNameHash는 발행자의 고유 이름\(DN\) 해시입니다. 해시는 확인 중인 인증서에 있는 발급자 이름 필드의 DER 인코딩을 통해 계산됩니다.

- issuerKeyHash는 발행자의 공개 키 해시입니다. 해시는 발급자 인증서의 대상 공개 키 필드 값\(태그 및 길이 제외\)에 대해 계산됩니다.

- serialNumber는 상태가 요청되는 인증서의 일련 번호입니다.

---
#### **4.1.2.  Notes on OCSP Requests**

발급자를 식별하기 위해 CA 이름의 해시 외에 CA 공개 키의 해시를 사용하는 주요 이유는 두 CA가 동일한 이름을 사용하도록 선택할 수 있다는 것입니다\(이름의 고유성은 시행\). 그러나 CA가 명시적으로 개인 키를 공유하기로 결정했거나 CA 중 하나의 키가 손상되지 않는 한 두 CA는 동일한 공개 키를 갖지 않습니다.

특정 확장에 대한 지원은 선택 사항입니다. 이들 중 어느 것에도 중요 플래그를 설정하면 안 됩니다. 섹션 4.4에서는 몇 가지 유용한 확장을 제안합니다. 추가 확장은 추가 RFC에서 정의될 수 있습니다. 인식할 수 없는 확장은 무시해야 합니다\(중요한 플래그가 설정되어 있고 이해되지 않는 경우 제외\).

요청자는 OCSP 요청에 서명하도록 선택할 수 있습니다. 이 경우 서명은 tbsRequest 구조를 통해 계산됩니다. 요청이 서명된 경우 요청자는 requestorName 필드에 이름을 지정해야 합니다. 또한 서명된 요청의 경우 요청자는 OCSP 응답자가 서명의 인증서 필드에서 요청자의 서명을 확인하는 데 도움이 되는 인증서를 포함할 수 있습니다.

---
### **4.2.  Response Syntax**

이 섹션에서는 확인 응답에 대한 ASN.1 사양을 지정합니다. 메시지의 실제 형식은 사용된 전송 메커니즘\(HTTP, SMTP, LDAP 등\)에 따라 달라질 수 있습니다.

---
#### **4.2.1.  ASN.1 Specification of the OCSP Response**

OCSP 응답은 최소한 이전 요청의 처리 상태를 나타내는 responseStatus 필드로 구성됩니다. responseStatus 값이 오류 조건 중 하나인 경우 responseBytes 필드가 설정되지 않습니다.

```text
   OCSPResponse ::= SEQUENCE {
      responseStatus         OCSPResponseStatus,
      responseBytes          [0] EXPLICIT ResponseBytes OPTIONAL }

   OCSPResponseStatus ::= ENUMERATED {
       successful            (0),  -- Response has valid confirmations
       malformedRequest      (1),  -- Illegal confirmation request
       internalError         (2),  -- Internal error in issuer
       tryLater              (3),  -- Try again later
                                   -- (4) is not used
       sigRequired           (5),  -- Must sign the request
       unauthorized          (6)   -- Request unauthorized
   }
```

responseBytes의 값은 OBJECT IDENTIFIER와 OCTET STRING으로 인코딩된 OID로 식별되는 응답 구문으로 구성됩니다.

```text
   ResponseBytes ::=       SEQUENCE {
       responseType   OBJECT IDENTIFIER,
       response       OCTET STRING }
```

기본 OCSP 응답자의 경우 responseType은 id-pkix-ocsp-basic입니다.

```text
   id-pkix-ocsp           OBJECT IDENTIFIER ::= { id-ad-ocsp }
   id-pkix-ocsp-basic     OBJECT IDENTIFIER ::= { id-pkix-ocsp 1 }
```

OCSP 응답자는 id-pkix-ocsp-basic 응답 유형의 응답을 생성할 수 있어야 합니다. 이에 따라 OCSP 클라이언트는 id-pkix-ocsp-basic 응답 유형의 응답을 수신하고 처리할 수 있어야 합니다.

응답 값은 BasicOCSPResponse의 DER 인코딩이어야 합니다.

```text
   BasicOCSPResponse       ::= SEQUENCE {
      tbsResponseData      ResponseData,
      signatureAlgorithm   AlgorithmIdentifier,
      signature            BIT STRING,
      certs            [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }
```

서명 값은 ResponseData의 DER 인코딩 해시에서 계산되어야 합니다. 응답자는 OCSP 클라이언트가 응답자의 서명을 확인하는 데 도움이 되는 BasicOCSPResponse의 certs 필드에 인증서를 포함할 수 있습니다. 인증서가 포함되어 있지 않으면 인증서가 없어야 합니다.

```text
   ResponseData ::= SEQUENCE {
      version              [0] EXPLICIT Version DEFAULT v1,
      responderID              ResponderID,
      producedAt               GeneralizedTime,
      responses                SEQUENCE OF SingleResponse,
      responseExtensions   [1] EXPLICIT Extensions OPTIONAL }

   ResponderID ::= CHOICE {
      byName               [1] Name,
      byKey                [2] KeyHash }
```

KeyHash ::= OCTET STRING -- 응답자 공개 키의 SHA-1 해시\(태그 및 길이 필드 제외\)

```text
   SingleResponse ::= SEQUENCE {
      certID                       CertID,
      certStatus                   CertStatus,
      thisUpdate                   GeneralizedTime,
      nextUpdate         [0]       EXPLICIT GeneralizedTime OPTIONAL,
      singleExtensions   [1]       EXPLICIT Extensions OPTIONAL }

   CertStatus ::= CHOICE {
       good        [0]     IMPLICIT NULL,
       revoked     [1]     IMPLICIT RevokedInfo,
       unknown     [2]     IMPLICIT UnknownInfo }

   RevokedInfo ::= SEQUENCE {
       revocationTime              GeneralizedTime,
       revocationReason    [0]     EXPLICIT CRLReason OPTIONAL }

   UnknownInfo ::= NULL
```

---
#### **4.2.2.  Notes on OCSP Responses**
---
##### **4.2.2.1.  Time**

응답에는 thisUpdate, nextUpdate, producerAt, revocationTime 등 4번이 포함될 수 있습니다. 이러한 필드의 의미는 섹션 2.4에 정의되어 있습니다. GeneralizedTime의 형식은 \[RFC5280\]의 섹션 4.1.2.5.2에 지정되어 있습니다.

thisUpdate 및 nextUpdate 필드는 권장되는 유효 기간을 정의합니다. 이 간격은 CRL의 {thisUpdate, nextUpdate} 간격에 해당합니다. nextUpdate 값이 로컬 시스템 시간 값보다 이전인 응답은 신뢰할 수 없는 것으로 간주되어야 합니다. thisUpdate 시간이 로컬 시스템 시간보다 늦은 응답은 신뢰할 수 없는 것으로 간주되어야 합니다.

nextUpdate가 설정되지 않은 경우 응답자는 항상 최신 취소 정보를 사용할 수 있음을 나타냅니다.

---
##### **4.2.2.2.  Authorized Responders**

인증서의 상태 정보에 서명하는 키는 인증서에 서명한 키와 동일할 필요는 없습니다. 그러나 이 정보에 서명하는 주체가 그렇게 할 권한이 있는지 확인하는 것이 필요합니다. 따라서 인증서 발급자는 다음 중 하나를 수행해야 합니다.

- OCSP 응답 자체에 서명하거나

- 이 권한을 다른 개체에 명시적으로 지정합니다.

OCSP 서명 위임은 OCSP 응답 서명자의 인증서에 포함된 확장 키 사용 인증서 확장에 id-kp-OCSPSigning을 포함하여 지정되어야 합니다. 이 인증서는 요청에서 식별된 CA에서 직접 발급되어야 합니다.

CA는 해지 확인 중인 인증서에 서명하는 데 사용된 것과 동일한 발급 키를 사용하여 위임 인증서를 발급해야 합니다. OCSP 응답에 의존하는 시스템은 위임 인증서와 해지 확인 대상 인증서가 동일한 키로 서명된 경우에만 문제의 인증서를 발급한 CA에서 발급한 위임 인증서를 인식해야 합니다.

참고: RFC 2560 \[RFC2560\]과의 하위 호환성을 위해, 취소가 확인되는 인증서를 발급하는 데 사용된 키와 다른 발급 키를 사용하여 승인된 응답자에 대한 인증서를 발급하는 것은 금지되지 않습니다. 그러나 클라이언트가 인증된 응답자와 같은 인증서를 가진 응답자를 인식할 필요가 없기 때문에 이러한 관행은 권장되지 않습니다.

```text
   id-kp-OCSPSigning OBJECT IDENTIFIER ::= {id-kp 9}
```

OCSP 응답에 의존하는 시스템 또는 애플리케이션은 위에서 설명한 대로 id-kp-OCSPSigning 값의 사용을 감지하고 시행할 수 있어야 합니다. 이는 하나 이상의 OCSP 서명 기관을 로컬로 구성하고 각 서명 기관이 신뢰할 수 있는 CA 집합을 지정하는 수단을 제공할 수 있습니다. 응답의 서명을 검증하는 데 필요한 인증서가 다음 기준 중 하나 이상을 충족하지 않는 경우 응답을 거부해야 합니다.

1. 문제의 인증서에 대한 OCSP 서명 기관의 로컬 구성과 일치합니다.

1. 해당 인증서를 발급한 CA의 인증서인가요?

1. 확장 키 사용 확장에 id-kp-OCSPSigning 값을 포함하며 위에 명시된 대로 해당 인증서를 발급한 CA에서 발급합니다.

추가 승인 또는 거부 기준은 응답 자체 또는 응답 서명의 유효성을 검사하는 데 사용되는 인증서에 적용될 수 있습니다.

---
###### **4.2.2.2.1.  Revocation Checking of an Authorized Responder**

승인된 OCSP 응답자는 하나 이상의 CA에 대한 상태 정보를 제공하므로 OCSP 클라이언트는 승인된 응답자의 인증서가 해지되지 않았는지 확인하는 방법을 알아야 합니다. CA는 다음 세 가지 방법 중 하나로 이 문제를 처리하도록 선택할 수 있습니다.

- CA는 OCSP 클라이언트가 응답자의 인증서 수명 동안 응답자를 신뢰할 수 있도록 지정할 수 있습니다. CA는 확장 id-pkix-ocsp-nocheck를 포함하여 이를 수행합니다. 이는 중요하지 않은 확장이어야 합니다. 확장의 값은 NULL이어야 합니다. 그러한 인증서를 발급하는 CA는 응답자 키의 손상이 CA 키의 손상만큼 심각하다는 것을 인식해야 합니다.

적어도 이 인증서의 유효 기간 동안 CRL에 서명하는 데 사용됩니다. CA는 매우 짧은 수명으로 이러한 유형의 인증서를 발급하고 자주 갱신하도록 선택할 수 있습니다.

```text
     id-pkix-ocsp-nocheck OBJECT IDENTIFIER ::= { id-pkix-ocsp 5 }
```

- CA는 응답자의 인증서가 해지되었는지 확인하는 방법을 지정할 수 있습니다. 이는 CRL을 사용하여 검사를 수행해야 하는 경우 CRL 배포 지점을 사용하고, 검사를 다른 방식으로 수행해야 하는 경우 기관 정보 액세스를 사용하여 수행할 수 있습니다. 이 두 가지 메커니즘 중 하나를 지정하는 방법에 대한 자세한 내용은 \[RFC5280\]에서 확인할 수 있습니다.

- CA는 응답자의 인증서에 대한 해지 확인 방법을 지정하지 않기로 선택할 수 있습니다. 이 경우 해당 인증서의 해지 확인 여부를 결정하는 것은 OCSP 클라이언트의 로컬 보안 정책에 달려 있습니다.

---
##### **4.2.2.3.  Basic Response**

기본 응답 유형에는 다음이 포함됩니다.

- 기본 응답 구문의 이 버전에 대해 v1\(값은 0\)이어야 하는 응답 구문의 버전입니다.

- 응답자의 이름 또는 ResponderID와 같은 응답자의 공개 키 해시;

- 응답이 생성된 시간

- 요청의 각 인증서에 대한 응답

```text
   o  optional extensions;
```

- 응답 해시 전체에 걸쳐 계산된 서명 그리고

- 서명 알고리즘 OID.

ResponderID 정보의 목적은 클라이언트가 서명된 OCSP 응답에 서명하는 데 사용되는 인증서를 찾을 수 있도록 하는 것입니다. 따라서 정보는 응답에 서명하는 데 사용된 인증서와 일치해야 합니다.

응답자는 OCSP 클라이언트가 응답자의 서명을 확인하는 데 도움이 되는 BasicOCSPResponse의 certs 필드에 인증서를 포함할 수 있습니다.

요청의 각 인증서에 대한 응답은 다음으로 구성됩니다.

- 폐기 상태 정보가 제공되는 인증서\(즉, 대상 인증서\)의 식별자

- 인증서의 폐기 상태\(양호, 폐기 또는 알 수 없음\) 해지된 경우 인증서가 해지된 시간과 선택적으로 인증서가 해지된 이유를 나타냅니다.

- 응답의 유효 간격 그리고

```text
   o  optional extensions.
```

응답에는 요청의 각 인증서에 대한 SingleResponse가 포함되어야 합니다. 응답에는 추가 SingleResponse 요소가 포함되어서는 안 되지만, 예를 들어 상태 응답을 사전 생성하는 OCSP 응답자는 응답 사전 생성 성능 또는 캐시 효율성을 개선하기 위해 필요한 경우 추가 SingleResponse 요소를 포함할 수 있습니다\(\[RFC5019\], 섹션 2.2. 1\).

---
### **4.3.  Mandatory and Optional Cryptographic Algorithms**

OCSP 서비스를 요청하는 클라이언트는 SHA-256\(\[RFC4055\]에 지정된 sha256WithRSAEncryption OID로 식별됨\)과 함께 RSA를 사용하여 서명된 응답을 처리할 수 있어야 합니다. 클라이언트는 또한 SHA-1\(\[RFC3279\]에 지정된 sha1WithRSAEncryption OID로 식별됨\)이 포함된 RSA 및 SHA-1\(id-dsa-with-sha1로 식별됨\)이 포함된 디지털 서명 알고리즘\(DSA\)을 사용하여 서명된 응답을 처리할 수 있어야 합니다. \[RFC3279\]에 지정된 OID\). 클라이언트는 다른 알고리즘을 지원할 수도 있습니다.

---
### **4.4.  Extensions**

이 섹션에서는 X.509 버전 3 인증서에 사용된 확장 모델을 기반으로 일부 표준 확장을 정의합니다\(\[RFC5280\] 참조\). 모든 확장에 대한 지원은 클라이언트와 응답자 모두에 대해 선택 사항입니다. 각 확장에 대해 정의는 해당 구문, OCSP 응답자가 수행하는 처리 및 해당 응답에 포함된 모든 확장을 나타냅니다.

---
#### **4.4.1.  Nonce**

Nonce는 요청과 응답을 암호화 방식으로 바인딩하여 재생 공격을 방지합니다. Nonce는 요청의 requestExtension 중 하나로 포함되는 반면, 응답에서는 responseExtension 중 하나로 포함됩니다. 요청과 응답 모두에서 nonce는 객체 식별자 id-pkix-ocsp-nonce로 식별되는 반면 extnValue는 nonce의 값입니다.

```text
     id-pkix-ocsp           OBJECT IDENTIFIER ::= { id-ad-ocsp }
     id-pkix-ocsp-nonce     OBJECT IDENTIFIER ::= { id-pkix-ocsp 2 }

     Nonce ::= OCTET STRING
```

---
#### **4.4.2.  CRL References**

OCSP 응답자가 해지되거나 보류 중인 인증서가 있는 CRL을 표시하는 것이 바람직할 수 있습니다. 이는 OCSP가 리포지토리 간에 사용되거나 감사 메커니즘으로 사용되는 경우 유용할 수 있습니다. CRL은 URL\(CRL을 사용할 수 있는 URL\), 숫자\(CRL 번호\) 또는 시간\(해당 CRL이 생성된 시간\)으로 지정할 수 있습니다. 이러한 확장은 SingleExtensions로 지정됩니다. 이 확장의 식별자는 id-pkix-ocsp-crl이고 값은 CrlID입니다.

```text
     id-pkix-ocsp-crl       OBJECT IDENTIFIER ::= { id-pkix-ocsp 3 }

     CrlID ::= SEQUENCE {
        crlUrl               [0]     EXPLICIT IA5String OPTIONAL,
        crlNum               [1]     EXPLICIT INTEGER OPTIONAL,
        crlTime              [2]     EXPLICIT GeneralizedTime OPTIONAL }
```

crlUrl을 선택하면 IA5String은 CRL을 사용할 수 있는 URL을 지정합니다. crlNum의 경우 INTEGER는 관련 CRL의 CRL 번호 확장 값을 지정합니다. crlTime의 경우 GeneralizedTime은 관련 CRL이 발급된 시간을 나타냅니다.

---
#### **4.4.3.  Acceptable Response Types**

OCSP 클라이언트는 자신이 이해하는 응답 유형의 종류를 지정하기를 원할 수도 있습니다. 그렇게 하려면 OID id-pkix-ocsp-response와 AcceptableResponses 값을 가진 확장을 사용해야 합니다. 이 확장은 요청의 requestExtensions 중 하나로 포함됩니다. AcceptableResponses에 포함된 OID는 이 클라이언트가 허용할 수 있는 다양한 응답 유형의 OID입니다\(예: id-pkix-ocsp-basic\).

```text
     id-pkix-ocsp-response  OBJECT IDENTIFIER ::= { id-pkix-ocsp 4 }

     AcceptableResponses ::= SEQUENCE OF OBJECT IDENTIFIER
```

섹션 4.2.1에 명시된 대로 OCSP 응답자는 id-pkix-ocsp-basic 응답 유형의 응답으로 응답할 수 있어야 합니다. 이에 따라 OCSP 클라이언트는 id-pkix-ocsp-basic 응답 유형의 응답을 수신하고 처리할 수 있어야 합니다.

---
#### **4.4.4.  Archive Cutoff**

OCSP 응답자는 인증서 만료 이후에도 해지 정보를 유지하도록 선택할 수 있습니다. 응답의 producerAt 시간에서 이 보존 간격 값을 뺀 날짜가 인증서의 "보관 마감" 날짜로 정의됩니다.

OCSP 지원 응용 프로그램은 OCSP 아카이브 마감 날짜를 사용하여 서명을 검증하는 데 필요한 인증서가 만료된 지 오래되었더라도 디지털 서명이 생성된 날짜에 신뢰할 수 있는지\(또는 신뢰할 수 없는지\) 증명하는 데 기여합니다.

이러한 기록 참조에 대한 지원을 제공하는 OCSP 서버는 응답에 아카이브 마감 날짜 확장을 포함해야 합니다. 포함된 경우 이 값은 id-pkix-ocsp-archive-cutoff 및 GeneralizedTime 구문으로 식별되는 OCSP 단일 확장 확장으로 제공되어야 합니다.

```text
     id-pkix-ocsp-archive-cutoff OBJECT IDENTIFIER ::= {id-pkix-ocsp 6}

     ArchiveCutoff ::= GeneralizedTime
```

예를 들어 서버가 7년 보존 간격 정책으로 운영되고 상태가 t1 시간에 생성된 경우 응답의 ArchiveCutoff 값은 \(t1 - 7년\)이 됩니다.

---
#### **4.4.5.  CRL Entry Extensions**

\[RFC5280\]의 섹션 5.3에 있는 CRL 항목 확장으로 지정된 모든 확장은 SingleExtensions로도 지원됩니다.

---
#### **4.4.6.  Service Locator**

OCSP 서버는 서버가 요청을 수신하고 이를 식별된 인증서에 대해 권한이 있는 것으로 알려진 OCSP 서버로 라우팅하는 모드에서 작동될 수 있습니다. serviceLocator 요청 확장은 이 목적으로 정의됩니다. 이 확장은 요청의 단일 요청 확장 중 하나로 포함됩니다.

```text
     id-pkix-ocsp-service-locator OBJECT IDENTIFIER ::= {id-pkix-ocsp 7}

     ServiceLocator ::= SEQUENCE {
         issuer    Name,
         locator   AuthorityInfoAccessSyntax OPTIONAL }
```

이러한 필드의 값은 제목 인증서의 해당 필드에서 가져옵니다.

---
#### **4.4.7.  Preferred Signature Algorithms**

필수 구현 알고리즘 이외의 알고리즘이 허용되고 클라이언트가 현재 알고리즘 기본 설정을 표시하는 메커니즘이 없기 때문에 비필수 알고리즘을 선택하는 서버가 클라이언트가 할 수 있는 응답을 생성할 위험이 항상 있습니다. 지원하지 않습니다.

OCSP 응답자는 알고리즘 선택을 위한 규칙을 적용할 수 있지만\(예: CRL 및 인증서 서명을 위해 CA에서 사용하는 서명 알고리즘 사용\) 이러한 규칙은 일반적인 상황에서 실패할 수 있습니다.

- CRL 및 인증서에 서명하는 데 사용되는 알고리즘은 OCSP 응답자가 응답에 서명하는 데 사용하는 키 쌍과 일치하지 않을 수 있습니다.

- 알 수 없는 인증서에 대한 요청은 응답자가 여러 알고리즘 옵션 중에서 선택할 수 있는 기반을 제공하지 않습니다.

마지막 기준은 프로토콜을 수정하지 않고는 RFC 2560 \[RFC2560\] 프로토콜을 사용한 대역 내 시그널링에서 얻을 수 있는 정보로는 해결할 수 없습니다.

또한 OCSP 응답자는 다음 두 가지 이유로 CA가 인증서 및 CRL에 서명하는 데 사용하는 것과 다른 서명 알고리즘을 사용하기를 원할 수 있습니다.

- 응답자는 인증서 자체에 서명하는 것보다 계산량이 적은 인증서 상태 응답 알고리즘을 사용할 수 있습니다.

- 구현에서는 두 개의 별도 서명 알고리즘을 사용하여 서명 알고리즘 손상으로 인한 손상 가능성을 방지하려고 할 수 있습니다.

이 섹션에서는 다음을 설명합니다.

- 클라이언트가 선호하는 서명 알고리즘 세트를 표시할 수 있도록 하는 확장입니다.

- 지원되는 기본 알고리즘이 지정되지 않은 경우 성공적인 작업 확률을 최대화하는 서명 알고리즘 선택 규칙입니다.

---
##### **4.4.7.1.  Extension Syntax**

클라이언트는 OCSPRequest의 requestExtensions에 선호하는 서명 알고리즘 확장을 포함하여 요청에 선호하는 알고리즘 세트를 선언할 수 있습니다.

```text
     id-pkix-ocsp-pref-sig-algs OBJECT IDENTIFIER ::= { id-pkix-ocsp 8 }

     PreferredSignatureAlgorithms ::= SEQUENCE OF
                                      PreferredSignatureAlgorithm

     PreferredSignatureAlgorithm ::= SEQUENCE {
        sigIdentifier        AlgorithmIdentifier,
        pubKeyAlgIdentifier  SMIMECapability OPTIONAL
        }
```

AlgorithmIdentifier의 구문은 RFC 5280 \[RFC5280\]의 섹션 4.1.1.2에 정의되어 있습니다. SMIMECapability의 구문은 RFC 5751 \[RFC5751\]에 정의되어 있습니다.

sigIdentifier는 클라이언트가 선호하는 서명 알고리즘을 지정합니다\(예: Algorithm=ecdsa-with-sha256\). 대부분의 일반적인 서명 알고리즘에는 매개변수가 없습니다.

pubKeyAlgIdentifier는 OCSP 응답을 검증하는 데 사용되는 서버 인증서에서 클라이언트가 선호하는 주체 공개 키 알고리즘 식별자를 지정합니다\(예: 알고리즘=id-ecPublicKey 및 매개변수= secp256r1\).

pubKeyAlgIdentifier는 선택사항이며 특정 알고리즘의 다양한 용도를 구별하는 데 필요한 매개변수를 지정하는 수단을 제공합니다. 예를 들어 클라이언트가 특정 타원 곡선 알고리즘에 대해 지원하는 곡선을 지정하는 데 사용할 수 있습니다.

클라이언트는 지정된 기본 서명 알고리즘 각각을 지원해야 하며\(MUST\) 가장 선호되는 것부터 가장 선호되지 않는 것까지 선호도 순서대로 알고리즘을 지정해야 합니다.

이 문서의 섹션 4.4.7.2에서는 서버가 요청 클라이언트에 대한 OCSP 응답에 서명하기 위한 알고리즘을 선택하는 방법을 설명합니다.

---
##### **4.4.7.2.  Responder Signature Algorithm Selection**

RFC 2560 \[RFC2560\]은 OCSP 응답에 사용할 서명 알고리즘을 결정하는 메커니즘을 지정하지 않았습니다. 이는 상호 운용성을 촉진하기 위해 선택된 알고리즘에 대해 충분한 수준의 확실성을 제공하지 않습니다.

---
###### **4.4.7.2.1.  Dynamic Response**

응답자는 선택한 알고리즘이 첫 번째 선택 메커니즘이 가장 높은 우선 순위를 갖는 OCSP 응답자의 모든 보안 요구 사항을 충족하는 한 다음 우선 순위를 사용하여 지원되는 서명 알고리즘을 선택하여 상호 운용성을 보장할 수 있는 잠재력을 최대화할 수 있습니다.

1. 클라이언트 요청에서 기본 서명 알고리즘으로 지정된 알고리즘을 선택합니다.

1. CertID로 지정된 인증서에 대한 상태 정보를 제공하는 인증서 발급자가 발급한 CRL\(인증서 해지 목록\)에 서명하는 데 사용되는 서명 알고리즘을 선택합니다.

1. OCSPRequest에 서명하는 데 사용되는 서명 알고리즘을 선택합니다.

1. 대역 외 메커니즘을 사용하여 서명 서비스에 대한 기본 서명 알고리즘으로 알려진 서명 알고리즘을 선택합니다.

1. 사용 중인 OCSP 버전에 지정된 필수 또는 권장 서명 알고리즘을 선택합니다.

응답자는 암호화 알고리즘 강도에 대한 응답자의 기준을 충족하는 알려지고 지원되는 알고리즘을 선택하는 가장 낮은 번호의 선택 메커니즘을 항상 적용해야 합니다.

---
###### **4.4.7.2.2.  Static Response**

효율성을 위해 OCSP 응답자는 요청에 앞서 정적 응답을 생성하는 것이 허용됩니다. 이 경우 응답 생성 중에 응답자가 클라이언트 요청 데이터를 사용하는 것을 허용하지 않을 수 있습니다. 그러나 응답자는 반환할 미리 생성된 응답을 선택하는 동안 클라이언트 요청 데이터를 계속 사용해야 합니다. 응답자는 미리 생성된 응답에 서명하기 위해 어떤 다른 알고리즘을 사용해야 하는지 결정하기 위한 입력의 일부로 과거 클라이언트 요청을 사용할 수 있습니다.

---
#### **4.4.8.  Extended Revoked Definition**

이 확장은 응답자가 섹션 2.2에 따라 발급되지 않은 인증서도 포함하도록 "해지됨" 상태의 확장된 정의를 지원함을 나타냅니다. 주요 목적 중 하나는 감사를 통해 응답자의 작업 유형을 결정할 수 있도록 하는 것입니다. 클라이언트는 응답의 인증서 상태를 확인하기 위해 이 확장을 구문 분석할 필요가 없습니다.

해당 응답에 발급되지 않은 인증서에 대한 "해지됨" 상태가 포함되어 있는 경우 이 확장은 OCSP 응답에 포함되어야 합니다. 이 확장은 응답자가 확장된 취소 정의를 구현한다는 신호를 보내기 위해 다른 응답에 존재할 수 있습니다. 포함된 경우 이 확장은 responseExtensions에 배치되어야 하며 SingleExtensions에 표시되어서는 안 됩니다.

이 확장은 객체 식별자 id-pkix-ocsp-extended-revoke로 식별됩니다.

```text
     id-pkix-ocsp-extended-revoke OBJECT IDENTIFIER ::= {id-pkix-ocsp 9}
```

확장의 값은 NULL이어야 합니다. 이 확장은 중요로 표시되어서는 안 됩니다.

---
## **5.  Security Considerations**

이 서비스가 효과적이려면 인증서 사용 시스템이 인증서 상태 서비스 공급자에 연결되어야 합니다. 그러한 연결을 얻을 수 없는 경우 인증서 사용 시스템은 대체 위치로 CRL 처리 논리를 구현할 수 있습니다.

쿼리의 홍수와 관련하여 서비스 거부에 대한 취약성이 분명합니다. 암호화 서명 생성은 응답 생성 주기 시간에 큰 영향을 미쳐 상황을 악화시킵니다. 서명되지 않은 오류 응답은 공격자가 잘못된 오류 응답을 보내는 또 다른 서비스 거부 공격에 프로토콜을 노출시킵니다.

미리 계산된 응답을 사용하면 만료 날짜 이전이지만 인증서가 해지된 후에 오래된\(양호한\) 응답이 재생되는 재생 공격이 허용됩니다. OCSP 배포에서는 재생 공격 가능성과 성공적인 실행과 관련된 비용에 대해 사전 계산된 응답의 이점을 신중하게 평가해야 합니다.

요청에는 전달된 응답자가 포함되어 있지 않습니다. 이를 통해 공격자는 원하는 수의 OCSP 응답자에게 요청을 재생할 수 있습니다.

일부 배포 시나리오에서 HTTP 캐싱에 의존하면 중간 서버가 잘못 구성되었거나 캐시 관리 오류가 있는 것으로 알려진 경우 예기치 않은 결과가 발생할 수 있습니다. 구현자는 HTTP를 통해 OCSP를 배포할 때 HTTP 캐시 메커니즘의 안정성을 고려하는 것이 좋습니다.

한 번도 발급된 적이 없는 인증서에 대해 "해지됨" 상태로 응답하면 누군가가 아직 발급되지 않았지만 곧 발급될 인증서에 대한 해지 응답을 얻을 수 있습니다. 요청자가 예측하거나 추측할 수 있습니다. 순차적인 인증서 일련번호 할당을 사용하여 인증서를 발급하는 CA에서는 이러한 예측이 쉽습니다. 이 위험은 규정을 준수하는 구현에서 일련 번호가 영구적으로 취소되는 것을 방지하는 CertificateHold 이유 코드를 사용하도록 요구함으로써 사양에서 처리됩니다. 발급되지 않은 인증서에 대한 상태 요청에 대한 "해지된" 응답을 지원하는 CA의 경우 이 문제를 완전히 방지하는 한 가지 방법은 높은 엔트로피를 사용하여 임의의 인증서 일련 번호 값을 할당하는 것입니다.

---
### **5.1.  Preferred Signature Algorithms**

응답 서명 알고리즘을 선택하는 데 사용되는 메커니즘은 의도된 애플리케이션에 대한 암호 분석 공격에 대해 충분히 안전한 것으로 간주되어야 합니다.

대부분의 응용 프로그램에서는 서명 알고리즘이 최소한 상태가 쿼리되는 원본 인증서에 서명하는 데 사용되는 서명 알고리즘만큼 안전하면 충분합니다. 그러나 이 기준은 서명 알고리즘이 더 이상 신뢰할 수 있는 것으로 간주되지 않는 먼 과거 날짜에 대한 인증서 상태를 쿼리하는 장기 보관 응용 프로그램에는 적용되지 않을 수 있습니다.

---
#### **5.1.1.  Use of Insecure Algorithms**

응답자가 클라이언트가 이해할 것으로 예상되고 암호화 보안에 대한 최신 표준을 충족하는 응답을 생성하는 것이 항상 가능한 것은 아닙니다. 이러한 경우 OCSP 대응 운영자는 최종 사용자가 선택한 대안이 보안 수준이 훨씬 낮거나 보안이 전혀 제공되지 않을 위험을 포함하여 손상된 보안 솔루션을 사용하는 위험과 업그레이드를 요구하는 비용의 균형을 맞춰야 합니다.

보관 애플리케이션에서는 OCSP 응답자가 먼 과거 날짜에 인증서의 유효성을 보고하도록 요청받을 가능성이 높습니다. 이러한 인증서는 더 이상 안전하다고 간주되지 않는 서명 방법을 사용할 수 있습니다. 이러한 상황에서 응답자는 안전하다고 간주되지 않는 서명 메커니즘을 사용하여 서명을 생성해서는 안 됩니다.

클라이언트는 요청에서 기본 서명 알고리즘으로 지정한 응답의 모든 서명 알고리즘을 수락해야 합니다. 따라서 클라이언트는 지원되지 않거나 허용 가능한 보안으로 간주되지 않는 알고리즘을 선호하는 서명 알고리즘으로 지정해서는 안 됩니다.

---
#### **5.1.2.  Man-in-the-Middle Downgrade Attack**

선호하는 서명 알고리즘의 클라이언트 표시를 지원하는 메커니즘은 중간자 다운그레이드 공격으로부터 보호되지 않습니다. OCSP 응답자는 클라이언트가 요청한 경우에도 약한 알고리즘을 사용하여 OCSP 응답에 서명하면 안 되기 때문에 이 제약 조건은 중요한 보안 문제로 간주되지 않습니다. 또한 클라이언트는 응답의 서명 알고리즘을 결정하는 데 사용되는 메커니즘에 관계없이 허용 가능한 암호화 보안에 대한 자체 기준을 충족하지 않는 OCSP 응답을 거부할 수 있습니다.

---
#### **5.1.3.  Denial-of-Service Attack**

이 문서에 정의된 알고리즘 민첩성 메커니즘은 클라이언트 요청이 서버에서 지원되지 않는 알고리즘을 요구하도록 변경되는 서비스 거부 공격에 대한 공격 표면을 약간 증가시킵니다. RFC 4732 \[RFC4732\]에서 논의된 서비스 거부 고려 사항은 이 문서와 관련이 있습니다.

---
## **6.  IANA Considerations**

이 문서에는 RFC 2560이 게시되었을 때 등록된 ocsp-request 및 ocsp-response에 대한 미디어 유형 등록\(부록 C\)이 포함되어 있습니다. 이 문서는 RFC 2560을 폐기했기 때문에 IANA는 이 문서를 가리키도록 ocsp-request 및 ocsp-response에 대한 "애플리케이션 미디어 유형" 레지스트리의 참조를 업데이트했습니다.

---
## **7.  References**
---
### **7.1.  Normative References**

```text
   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2616]  Fielding, R., Gettys, J., Mogul, J., Frystyk, H.,
              Masinter, L., Leach, P., and T. Berners-Lee, "Hypertext
              Transfer Protocol -- HTTP/1.1", RFC 2616, June 1999.

   [RFC3279]  Bassham, L., Polk, W., and R. Housley, "Algorithms and
              Identifiers for the Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 3279, April 2002.

   [RFC3986]  Berners-Lee, T., Fielding, R., and L. Masinter, "Uniform
              Resource Identifier (URI): Generic Syntax", STD 66,
              RFC 3986, January 2005.

   [RFC4055]  Schaad, J., Kaliski, B., and R. Housley, "Additional
              Algorithms and Identifiers for RSA Cryptography for use in
              the Internet X.509 Public Key Infrastructure Certificate
              and Certificate Revocation List (CRL) Profile", RFC 4055,
              June 2005.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, May 2008.

   [RFC5751]  Ramsdell, B. and S. Turner, "Secure/Multipurpose Internet
              Mail Extensions (S/MIME) Version 3.2 Message
              Specification", RFC 5751, January 2010.

   [RFC6277]  Santesson, S. and P. Hallam-Baker, "Online Certificate
              Status Protocol Algorithm Agility", RFC 6277, June 2011.

   [X.690]    ITU-T Recommendation X.690 (2008) | ISO/IEC 8825-1:2008,
              "Information Technology - ASN.1 encoding rules:
              Specification of Basic Encoding Rules (BER), Canonical
              Encoding Rules (CER) and Distinguished Encoding Rules
              (DER)", November 2008.
```

---
### **7.2.  Informative References**

```text
   [RFC2560]  Myers, M., Ankney, R., Malpani, A., Galperin, S., and C.
              Adams, "X.509 Internet Public Key Infrastructure Online
              Certificate Status Protocol - OCSP", RFC 2560, June 1999.

   [RFC4732]  Handley, M., Ed., Rescorla, E., Ed., and IAB, "Internet
              Denial-of-Service Considerations", RFC 4732,
              December 2006.

   [RFC5019]  Deacon, A. and R. Hurst, "The Lightweight Online
              Certificate Status Protocol (OCSP) Profile for High-Volume
              Environments", RFC 5019, September 2007.

   [RFC5912]  Hoffman, P. and J. Schaad, "New ASN.1 Modules for the
              Public Key Infrastructure Using X.509 (PKIX)", RFC 5912,
              June 2010.
```

---
## **8.  Acknowledgements**

이 문서의 개발은 PKIX 작업 그룹 구성원의 광범위한 의견 덕분에 가능해졌습니다.

Jim Schaad는 이 사양의 ASN.1 모듈을 컴파일하고 확인하여 귀중한 지원을 제공했습니다.

---
# **Appendix A.  OCSP over HTTP**

이 섹션에서는 HTTP \[RFC2616\]를 지원하기 위해 요청 및 응답에 수행되는 형식을 설명합니다.

---
### **A.1.  Request**

HTTP 기반 OCSP 요청은 GET 또는 POST 메서드를 사용하여 요청을 제출할 수 있습니다. HTTP 캐싱을 활성화하려면 작은 요청\(인코딩 후 255바이트 미만\)이 GET을 사용하여 제출될 수 있습니다. HTTP 캐싱이 중요하지 않거나 요청이 255바이트보다 큰 경우 요청은 POST를 사용하여 제출되어야 합니다. 개인정보 보호가 요구되는 경우 HTTP를 사용하여 교환되는 OCSP 트랜잭션은 TLS/SSL\(전송 계층 보안/보안 소켓 계층\) 또는 기타 하위 계층 프로토콜을 사용하여 보호될 수 있습니다.

GET 메서드를 사용하는 OCSP 요청은 다음과 같이 구성됩니다.

GET {url}/{OCSPRequest의 DER 인코딩에 대한 base-64 인코딩의 URL 인코딩}

여기서 {url}은 해지 확인 중인 인증서의 기관 정보 액세스 확장 값 또는 OCSP 클라이언트의 기타 로컬 구성에서 파생될 수 있습니다.

POST 메서드를 사용하는 OCSP 요청은 다음과 같이 구성됩니다. Content-Type 헤더의 값은 "application/ocsp-request"이고, 메시지 본문은 OCSPRequest의 DER 인코딩에 대한 이진 값입니다.

---
### **A.2.  Response**

HTTP 기반 OCSP 응답은 적절한 HTTP 헤더와 OCSPResponse의 DER 인코딩 바이너리 값으로 구성됩니다. Content-Type 헤더의 값은 "application/ocsp-response"입니다. Content-Length 헤더는 응답 길이를 지정해야 합니다. 다른 HTTP 헤더가 존재할 수 있으며 요청자가 이해하지 못하는 경우 무시될 수 있습니다.

---
# **Appendix B.  ASN.1 Modules**

이 부록에는 OCSP용 ASN.1 모듈이 포함되어 있습니다. 부록 B.1에는 \[RFC6277\]에 정의된 기본 서명 알고리즘 확장을 포함하여 OCSP의 모든 구문 요소에 대해 ASN.1의 1998 버전을 준수하는 ASN.1 모듈이 포함되어 있습니다. 이 모듈은 \[RFC2560\]의 부록 B 및 \[RFC6277\]의 부록 A.2에 있는 모듈을 대체합니다. 부록 B.2에는 B.1에 있는 모듈에 해당하는 ASN.1 모듈이 포함되어 있습니다.

ASN.1. 이 모듈은 \[RFC5912\]의 섹션 12 및 \[RFC6277\]의 부록 A.1의 모듈을 대체합니다. 2008 ASN.1 모듈이 제공되지만 부록 B.1의 모듈은 PKIX 작업 그룹의 정책에 따라 표준 모듈로 남아 있습니다.

---
### **B.1.  OCSP in ASN.1 - 1998 Syntax**

```text
OCSP-2013-88
      {iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) id-mod(0)
      id-mod-ocsp-2013-88(81)}
```

---
# **DEFINITIONS EXPLICIT TAGS ::=**
---
# **BEGIN**
---
# **IMPORTS**

```text
   -- PKIX Certificate Extensions
      AuthorityInfoAccessSyntax, CRLReason, GeneralName
      FROM PKIX1Implicit88 { iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-implicit(19) }

      Name, CertificateSerialNumber, Extensions,
      id-kp, id-ad-ocsp, Certificate, AlgorithmIdentifier
      FROM PKIX1Explicit88 { iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-explicit(18) };

OCSPRequest ::= SEQUENCE {
   tbsRequest              TBSRequest,
   optionalSignature   [0] EXPLICIT Signature OPTIONAL }

TBSRequest ::= SEQUENCE {
   version             [0] EXPLICIT Version DEFAULT v1,
   requestorName       [1] EXPLICIT GeneralName OPTIONAL,
   requestList             SEQUENCE OF Request,
   requestExtensions   [2] EXPLICIT Extensions OPTIONAL }

Signature ::= SEQUENCE {
   signatureAlgorithm      AlgorithmIdentifier,
   signature               BIT STRING,
   certs               [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }
```

---
# **Version ::= INTEGER { v1(0) }**

```text
Request ::= SEQUENCE {
   reqCert                     CertID,
   singleRequestExtensions [0] EXPLICIT Extensions OPTIONAL }

CertID ::= SEQUENCE {
   hashAlgorithm           AlgorithmIdentifier,
   issuerNameHash          OCTET STRING, -- Hash of issuer's DN
   issuerKeyHash           OCTET STRING, -- Hash of issuer's public key
   serialNumber            CertificateSerialNumber }

OCSPResponse ::= SEQUENCE {
   responseStatus          OCSPResponseStatus,
   responseBytes       [0] EXPLICIT ResponseBytes OPTIONAL }

OCSPResponseStatus ::= ENUMERATED {
   successful          (0),  -- Response has valid confirmations
   malformedRequest    (1),  -- Illegal confirmation request
   internalError       (2),  -- Internal error in issuer
   tryLater            (3),  -- Try again later
                             -- (4) is not used
   sigRequired         (5),  -- Must sign the request
   unauthorized        (6)   -- Request unauthorized
}

ResponseBytes ::= SEQUENCE {
   responseType            OBJECT IDENTIFIER,
   response                OCTET STRING }

BasicOCSPResponse ::= SEQUENCE {
  tbsResponseData          ResponseData,
  signatureAlgorithm       AlgorithmIdentifier,
  signature                BIT STRING,
  certs                [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }

ResponseData ::= SEQUENCE {
   version             [0] EXPLICIT Version DEFAULT v1,
   responderID             ResponderID,
   producedAt              GeneralizedTime,
   responses               SEQUENCE OF SingleResponse,
   responseExtensions  [1] EXPLICIT Extensions OPTIONAL }

ResponderID ::= CHOICE {
   byName              [1] Name,
   byKey               [2] KeyHash }

KeyHash ::= OCTET STRING -- SHA-1 hash of responder's public key
                         -- (i.e., the SHA-1 hash of the value of the
                         -- BIT STRING subjectPublicKey [excluding
                         -- the tag, length, and number of unused
                         -- bits] in the responder's certificate)

SingleResponse ::= SEQUENCE {
   certID                  CertID,
   certStatus              CertStatus,
   thisUpdate              GeneralizedTime,
   nextUpdate          [0] EXPLICIT GeneralizedTime OPTIONAL,
   singleExtensions    [1] EXPLICIT Extensions OPTIONAL }

CertStatus ::= CHOICE {
   good                [0] IMPLICIT NULL,
   revoked             [1] IMPLICIT RevokedInfo,
   unknown             [2] IMPLICIT UnknownInfo }

RevokedInfo ::= SEQUENCE {
   revocationTime          GeneralizedTime,
   revocationReason    [0] EXPLICIT CRLReason OPTIONAL }
```

---
# **UnknownInfo ::= NULL**
---
# **ArchiveCutoff ::= GeneralizedTime**
---
# **AcceptableResponses ::= SEQUENCE OF OBJECT IDENTIFIER**

```text
ServiceLocator ::= SEQUENCE {
   issuer                  Name,
   locator                 AuthorityInfoAccessSyntax }

CrlID ::= SEQUENCE {
    crlUrl               [0]     EXPLICIT IA5String OPTIONAL,
    crlNum               [1]     EXPLICIT INTEGER OPTIONAL,
    crlTime              [2]     EXPLICIT GeneralizedTime OPTIONAL }
```

---
# **PreferredSignatureAlgorithms ::= SEQUENCE OF PreferredSignatureAlgorithm**

```text
PreferredSignatureAlgorithm ::= SEQUENCE {
   sigIdentifier   AlgorithmIdentifier,
   certIdentifier  AlgorithmIdentifier OPTIONAL }

-- Object Identifiers

id-kp-OCSPSigning            OBJECT IDENTIFIER ::= { id-kp 9 }
id-pkix-ocsp                 OBJECT IDENTIFIER ::= { id-ad-ocsp }
id-pkix-ocsp-basic           OBJECT IDENTIFIER ::= { id-pkix-ocsp 1 }
id-pkix-ocsp-nonce           OBJECT IDENTIFIER ::= { id-pkix-ocsp 2 }
id-pkix-ocsp-crl             OBJECT IDENTIFIER ::= { id-pkix-ocsp 3 }
id-pkix-ocsp-response        OBJECT IDENTIFIER ::= { id-pkix-ocsp 4 }
id-pkix-ocsp-nocheck         OBJECT IDENTIFIER ::= { id-pkix-ocsp 5 }
id-pkix-ocsp-archive-cutoff  OBJECT IDENTIFIER ::= { id-pkix-ocsp 6 }
id-pkix-ocsp-service-locator OBJECT IDENTIFIER ::= { id-pkix-ocsp 7 }
id-pkix-ocsp-pref-sig-algs   OBJECT IDENTIFIER ::= { id-pkix-ocsp 8 }
id-pkix-ocsp-extended-revoke OBJECT IDENTIFIER ::= { id-pkix-ocsp 9 }
```

---
# **END**
---
### **B.2.  OCSP in ASN.1 - 2008 Syntax**

```text
OCSP-2013-08
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-ocsp-2013-08(82)}
```

---
# **DEFINITIONS EXPLICIT TAGS ::=**
---
# **BEGIN**
---
# **IMPORTS**

확장{}, 확장, PKIX-CommonTypes-2009의 속성 -- \[RFC5912\]에서 {iso\(1\) 식별된 조직\(3\) dod\(6\) 인터넷\(1\) 보안\(5\) 메커니즘\(5\) pkix\(7\) id-mod\(0\) id-mod-pkixCommon-02\(57\)}

AlgorithmIdentifier{}, DIGEST-ALGORITHM, SIGNATURE-ALGORITHM, PUBLIC-KEY FROM AlgorithmInformation-2009 -- \[RFC5912\]에서 {iso\(1\) 식별된 조직\(3\) dod\(6\) 인터넷\(1\) 보안\(5\) 메커니즘\( 5\) pkix\(7\) id-mod\(0\) id-mod-algorithmInformation-02\(58\)}

AuthorityInfoAccessSyntax, GeneralName, CrlEntryExtensions FROM PKIX1Implicit-2009 -- From \[RFC5912\] {iso\(1\) 식별된 조직\(3\) dod\(6\) 인터넷\(1\) 보안\(5\) 메커니즘\(5\) pkix\(7\) id-mod\( 0\) id-mod-pkix1-implicit-02\(59\)}

이름, 인증서 일련 번호, id-kp, id-ad-ocsp, 인증서 FROM PKIX1Explicit-2009 -- 출처 \[RFC5912\] {iso\(1\) 식별-조직\(3\) dod\(6\) 인터넷\(1\) 보안\(5\) 메커니즘\( 5\) pkix\(7\) id-mod\(0\) id-mod-pkix1-explicit-02\(51\)}

sa-dsaWithSHA1, sa-rsaWithMD2, sa-rsaWithMD5, sa-rsaWithSHA1 FROM PKIXAlgs-2009 -- \[RFC5912\]에서 {iso\(1\) 식별-조직\(3\) dod\(6\) 인터넷\(1\) 보안\(5\) 메커니즘\( 5\) pkix\(7\) id-mod\(0\) id-mod-pkix1-algorithms2008-02\(56\)};

```text
OCSPRequest     ::=     SEQUENCE {
    tbsRequest                  TBSRequest,
    optionalSignature   [0]     EXPLICIT Signature OPTIONAL }

TBSRequest      ::=     SEQUENCE {
    version             [0] EXPLICIT Version DEFAULT v1,
    requestorName       [1] EXPLICIT GeneralName OPTIONAL,
    requestList             SEQUENCE OF Request,
    requestExtensions   [2] EXPLICIT Extensions {{re-ocsp-nonce |
                     re-ocsp-response, ...,
                     re-ocsp-preferred-signature-algorithms}} OPTIONAL }

Signature       ::=     SEQUENCE {
    signatureAlgorithm   AlgorithmIdentifier
                             { SIGNATURE-ALGORITHM, {...}},
    signature            BIT STRING,
    certs            [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }
```

---
# **Version  ::=  INTEGER  {  v1(0) }**

```text
Request ::=     SEQUENCE {
    reqCert                    CertID,
    singleRequestExtensions    [0] EXPLICIT Extensions
                                       { {re-ocsp-service-locator,
                                              ...}} OPTIONAL }

CertID ::= SEQUENCE {
    hashAlgorithm            AlgorithmIdentifier
                                 {DIGEST-ALGORITHM, {...}},
    issuerNameHash     OCTET STRING, -- Hash of issuer's DN
    issuerKeyHash      OCTET STRING, -- Hash of issuer's public key
    serialNumber       CertificateSerialNumber }

OCSPResponse ::= SEQUENCE {
   responseStatus         OCSPResponseStatus,
   responseBytes          [0] EXPLICIT ResponseBytes OPTIONAL }

OCSPResponseStatus ::= ENUMERATED {
    successful            (0), -- Response has valid confirmations
    malformedRequest      (1), -- Illegal confirmation request
    internalError         (2), -- Internal error in issuer
    tryLater              (3), -- Try again later
                               -- (4) is not used
    sigRequired           (5), -- Must sign the request
    unauthorized          (6)  -- Request unauthorized
}
```

---
# **RESPONSE ::= TYPE-IDENTIFIER**
---
# **ResponseSet RESPONSE ::= {basicResponse, ...}**

```text
ResponseBytes ::=       SEQUENCE {
    responseType        RESPONSE.
                            &id ({ResponseSet}),
    response            OCTET STRING (CONTAINING RESPONSE.
                            &Type({ResponseSet}{@responseType}))}
```

basicResponse RESPONSE ::= { id-pkix-ocsp-basic에 의해 식별된 BasicOCSP응답 }

```text
BasicOCSPResponse       ::= SEQUENCE {
   tbsResponseData      ResponseData,
   signatureAlgorithm   AlgorithmIdentifier{SIGNATURE-ALGORITHM,
                            {sa-dsaWithSHA1 | sa-rsaWithSHA1 |
                                 sa-rsaWithMD5 | sa-rsaWithMD2, ...}},
   signature            BIT STRING,
   certs            [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL }

ResponseData ::= SEQUENCE {
   version              [0] EXPLICIT Version DEFAULT v1,
   responderID              ResponderID,
   producedAt               GeneralizedTime,
   responses                SEQUENCE OF SingleResponse,
   responseExtensions   [1] EXPLICIT Extensions
                               {{re-ocsp-nonce, ...,
                                 re-ocsp-extended-revoke}} OPTIONAL }

ResponderID ::= CHOICE {
   byName   [1] Name,
   byKey    [2] KeyHash }

KeyHash ::= OCTET STRING -- SHA-1 hash of responder's public key
                         -- (excluding the tag and length fields)

SingleResponse ::= SEQUENCE {
   certID                       CertID,
   certStatus                   CertStatus,
   thisUpdate                   GeneralizedTime,
   nextUpdate           [0]     EXPLICIT GeneralizedTime OPTIONAL,
   singleExtensions     [1]     EXPLICIT Extensions{{re-ocsp-crl |
                                             re-ocsp-archive-cutoff |
                                             CrlEntryExtensions, ...}
                                             } OPTIONAL }

CertStatus ::= CHOICE {
    good                [0]     IMPLICIT NULL,
    revoked             [1]     IMPLICIT RevokedInfo,
    unknown             [2]     IMPLICIT UnknownInfo }

RevokedInfo ::= SEQUENCE {
    revocationTime              GeneralizedTime,
    revocationReason    [0]     EXPLICIT CRLReason OPTIONAL }
```

---
# **UnknownInfo ::= NULL**
---
# **ArchiveCutoff ::= GeneralizedTime**
---
# **AcceptableResponses ::= SEQUENCE OF RESPONSE.&id({ResponseSet})**

```text
ServiceLocator ::= SEQUENCE {
    issuer    Name,
    locator   AuthorityInfoAccessSyntax }

CrlID ::= SEQUENCE {
    crlUrl               [0]     EXPLICIT IA5String OPTIONAL,
    crlNum               [1]     EXPLICIT INTEGER OPTIONAL,
    crlTime              [2]     EXPLICIT GeneralizedTime OPTIONAL }
```

---
# **PreferredSignatureAlgorithms ::= SEQUENCE OF PreferredSignatureAlgorithm**

```text
PreferredSignatureAlgorithm ::= SEQUENCE {
   sigIdentifier  AlgorithmIdentifier{SIGNATURE-ALGORITHM, {...}},
   certIdentifier AlgorithmIdentifier{PUBLIC-KEY, {...}} OPTIONAL
}

-- Certificate Extensions

ext-ocsp-nocheck EXTENSION ::= { SYNTAX NULL IDENTIFIED
                                 BY id-pkix-ocsp-nocheck }

-- Request Extensions

re-ocsp-nonce EXTENSION ::= { SYNTAX OCTET STRING IDENTIFIED
                              BY id-pkix-ocsp-nonce }

re-ocsp-response EXTENSION ::= { SYNTAX AcceptableResponses IDENTIFIED
                                 BY id-pkix-ocsp-response }

re-ocsp-service-locator EXTENSION ::= { SYNTAX ServiceLocator
                                        IDENTIFIED BY
                                        id-pkix-ocsp-service-locator }
```

re-ocsp-preferred-signature-algorithms 확장 ::= { id-pkix-ocsp-pref-sig-algs에 의해 식별된 구문 PreferredSignatureAlgorithms }

```text
-- Response Extensions

re-ocsp-crl EXTENSION ::= { SYNTAX CrlID IDENTIFIED BY
                                id-pkix-ocsp-crl }

re-ocsp-archive-cutoff EXTENSION ::= { SYNTAX ArchiveCutoff
                                       IDENTIFIED BY
                                       id-pkix-ocsp-archive-cutoff }

re-ocsp-extended-revoke EXTENSION ::= { SYNTAX NULL IDENTIFIED BY
                                        id-pkix-ocsp-extended-revoke }

-- Object Identifiers

id-kp-OCSPSigning            OBJECT IDENTIFIER ::= { id-kp 9 }
id-pkix-ocsp                 OBJECT IDENTIFIER ::= id-ad-ocsp
id-pkix-ocsp-basic           OBJECT IDENTIFIER ::= { id-pkix-ocsp 1 }
id-pkix-ocsp-nonce           OBJECT IDENTIFIER ::= { id-pkix-ocsp 2 }
id-pkix-ocsp-crl             OBJECT IDENTIFIER ::= { id-pkix-ocsp 3 }
id-pkix-ocsp-response        OBJECT IDENTIFIER ::= { id-pkix-ocsp 4 }
id-pkix-ocsp-nocheck         OBJECT IDENTIFIER ::= { id-pkix-ocsp 5 }
id-pkix-ocsp-archive-cutoff  OBJECT IDENTIFIER ::= { id-pkix-ocsp 6 }
id-pkix-ocsp-service-locator OBJECT IDENTIFIER ::= { id-pkix-ocsp 7 }
id-pkix-ocsp-pref-sig-algs   OBJECT IDENTIFIER ::= { id-pkix-ocsp 8 }
id-pkix-ocsp-extended-revoke OBJECT IDENTIFIER ::= { id-pkix-ocsp 9 }
```

---
# **END**
---
# **Appendix C.  MIME Registrations**
---
### **C.1.  application/ocsp-request**

받는 사람: ietf-types@iana.org 제목: MIME 미디어 유형 등록 application/ocsp-request

```text
   MIME media type name: application

   MIME subtype name: ocsp-request

   Required parameters: None

   Optional parameters: None

   Encoding considerations: binary
```

보안 고려 사항: 정보 요청을 수행합니다. 이 요청은 선택적으로 암호화 서명될 수 있습니다.

```text
   Interoperability considerations: None
```

게시된 사양: 온라인 인증서 상태 프로토콜 - OCSP에 대한 IETF PKIX 워킹 그룹 문서

이 미디어 유형을 사용하는 애플리케이션: OCSP 클라이언트

```text
   Additional information:

      Magic number(s): None
      File extension(s): .ORQ
      Macintosh File Type Code(s): none
```

추가 정보를 문의할 사람 및 이메일 주소: - Stefan Santesson <sts@aaa-sec.com\>

```text
   Intended usage: COMMON

   Author/Change controller: IETF
```

---
### **C.2.  application/ocsp-response**

받는 사람: ietf-types@iana.org 제목: MIME 미디어 유형 등록 application/ocsp-response

```text
   MIME media type name: application

   MIME subtype name: ocsp-response

   Required parameters: None

   Optional parameters: None

   Encoding considerations: binary
```

보안 고려사항: 암호화 서명된 응답을 전달합니다.

```text
   Interoperability considerations: None
```

게시된 사양: 온라인 인증서 상태 프로토콜 - OCSP에 대한 IETF PKIX 워킹 그룹 문서

이 미디어 유형을 사용하는 애플리케이션: OCSP 서버

```text
   Additional information:

      Magic number(s): None
      File extension(s): .ORS
      Macintosh File Type Code(s): none
```

추가 정보를 문의할 사람 및 이메일 주소: - Stefan Santesson <sts@aaa-sec.com\>

```text
   Intended usage: COMMON

   Author/Change controller: IETF
```

---
# **Authors' Addresses**

```text
   Stefan Santesson
   3xA Security AB
   Scheelev. 17
   223 70 Lund
   Sweden

   EMail: sts@aaa-sec.com

   Michael Myers
   TraceRoute Security

   EMail: mmyers@fastq.com

   Rich Ankney

   Ambarish Malpani
   CA Technologies
   455 West Maude Ave.  Suite 210
   Sunnyvale, CA  94085
   United States

   EMail: ambarish@gmail.com

   Slava Galperin
   A9.com Inc.
   130 Lytton Ave.  Suite 300
   Palo Alto, CA  94301
   United States

   EMail: slava.galperin@gmail.com
```

칼라일 아담스 오타와 대학교 800 King Edward Avenue Ottawa ON K1N 6N5 캐나다

```text
   EMail: cadams@eecs.uottawa.ca
```