

```text
Network Working Group                                         R. Housley
Request for Comments: 3280                              RSA Laboratories
Obsoletes: 2459                                                  W. Polk
Category: Standards Track                                           NIST
                                                                 W. Ford
                                                                VeriSign
                                                                 D. Solo
                                                               Citigroup
                                                              April 2002

                Internet X.509 Public Key Infrastructure
       Certificate and Certificate Revocation List (CRL) Profile
```

---
# **Status of this Memo**

이 문서는 인터넷 커뮤니티를 위한 인터넷 표준 추적 프로토콜을 지정하고 개선을 위한 토론 및 제안을 요청합니다. 이 프로토콜의 표준화 상태 및 상태에 대해서는 "Internet Official Protocol Standards"\(STD 1\) 최신판을 참조하십시오. 이 메모의 배포는 무제한입니다.

---
# **Copyright Notice**

저작권\(C\)인터넷학회\(2002\). 판권 소유.

---
# **Abstract**

이 메모는 인터넷에서 사용하기 위한 X.509 v3 인증서와 X.509 v2 인증서 해지 목록\(CRL\)을 프로파일링합니다. 이 접근 방식과 모델에 대한 개요가 소개로 제공됩니다. X.509 v3 인증서 형식은 인터넷 이름 형식의 형식 및 의미에 관한 추가 정보와 함께 자세히 설명되어 있습니다. 표준 인증서 확장이 설명되고 두 개의 인터넷 관련 확장이 정의됩니다. 필수 인증서 확장 세트가 지정됩니다. X.509 v2 CRL 형식을 자세히 설명하고 필수 확장자를 정의합니다. X.509 인증 경로 유효성 검사를 위한 알고리즘이 설명됩니다. ASN.1 모듈과 예제는 부록에 제공됩니다.

---
# **Table of Contents**

```text
   1  Introduction  . . . . . . . . . . . . . . . . . . . . . .   4
   2  Requirements and Assumptions  . . . . . . . . . . . . . .   5
   2.1  Communication and Topology  . . . . . . . . . . . . . .   6
   2.2  Acceptability Criteria  . . . . . . . . . . . . . . . .   6
   2.3  User Expectations . . . . . . . . . . . . . . . . . . .   7
   2.4  Administrator Expectations  . . . . . . . . . . . . . .   7
   3  Overview of Approach  . . . . . . . . . . . . . . . . . .   7
   3.1  X.509 Version 3 Certificate . . . . . . . . . . . . . .   8
   3.2  Certification Paths and Trust . . . . . . . . . . . . .   9
   3.3  Revocation  . . . . . . . . . . . . . . . . . . . . . .  11
   3.4  Operational Protocols . . . . . . . . . . . . . . . . .  13
   3.5  Management Protocols  . . . . . . . . . . . . . . . . .  13
   4  Certificate and Certificate Extensions Profile  . . . . .  14
   4.1  Basic Certificate Fields  . . . . . . . . . . . . . . .  15
   4.1.1  Certificate Fields  . . . . . . . . . . . . . . . . .  16
   4.1.1.1  tbsCertificate  . . . . . . . . . . . . . . . . . .  16
   4.1.1.2  signatureAlgorithm  . . . . . . . . . . . . . . . .  16
   4.1.1.3  signatureValue  . . . . . . . . . . . . . . . . . .  16
   4.1.2  TBSCertificate  . . . . . . . . . . . . . . . . . . .  17
   4.1.2.1  Version . . . . . . . . . . . . . . . . . . . . . .  17
   4.1.2.2  Serial number . . . . . . . . . . . . . . . . . . .  17
   4.1.2.3  Signature . . . . . . . . . . . . . . . . . . . . .  18
   4.1.2.4  Issuer  . . . . . . . . . . . . . . . . . . . . . .  18
   4.1.2.5  Validity  . . . . . . . . . . . . . . . . . . . . .  22
   4.1.2.5.1  UTCTime . . . . . . . . . . . . . . . . . . . . .  22
   4.1.2.5.2  GeneralizedTime . . . . . . . . . . . . . . . . .  22
   4.1.2.6  Subject . . . . . . . . . . . . . . . . . . . . . .  23
   4.1.2.7  Subject Public Key Info . . . . . . . . . . . . . .  24
   4.1.2.8  Unique Identifiers  . . . . . . . . . . . . . . . .  24
   4.1.2.9 Extensions . . . . . . . . . . . . . . . . . . . . .  24
   4.2  Certificate Extensions  . . . . . . . . . . . . . . . .  24
   4.2.1  Standard Extensions . . . . . . . . . . . . . . . . .  25
   4.2.1.1  Authority Key Identifier  . . . . . . . . . . . . .  26
   4.2.1.2  Subject Key Identifier  . . . . . . . . . . . . . .  27
   4.2.1.3  Key Usage . . . . . . . . . . . . . . . . . . . . .  28
   4.2.1.4  Private Key Usage Period  . . . . . . . . . . . . .  29
   4.2.1.5  Certificate Policies  . . . . . . . . . . . . . . .  30
   4.2.1.6  Policy Mappings . . . . . . . . . . . . . . . . . .  33
   4.2.1.7  Subject Alternative Name  . . . . . . . . . . . . .  33
   4.2.1.8  Issuer Alternative Name . . . . . . . . . . . . . .  36
   4.2.1.9  Subject Directory Attributes  . . . . . . . . . . .  36
   4.2.1.10  Basic Constraints  . . . . . . . . . . . . . . . .  36
   4.2.1.11  Name Constraints . . . . . . . . . . . . . . . . .  37
   4.2.1.12  Policy Constraints . . . . . . . . . . . . . . . .  40
   4.2.1.13  Extended Key Usage . . . . . . . . . . . . . . . .  40
   4.2.1.14  CRL Distribution Points  . . . . . . . . . . . . .  42
   4.2.1.15  Inhibit Any-Policy . . . . . . . . . . . . . . . .  44
   4.2.1.16  Freshest CRL . . . . . . . . . . . . . . . . . . .  44
   4.2.2  Internet Certificate Extensions . . . . . . . . . . .  45
   4.2.2.1  Authority Information Access  . . . . . . . . . . .  45
   4.2.2.2  Subject Information Access  . . . . . . . . . . . .  46
   5  CRL and CRL Extensions Profile  . . . . . . . . . . . . .  48
   5.1  CRL Fields  . . . . . . . . . . . . . . . . . . . . . .  49
   5.1.1  CertificateList Fields  . . . . . . . . . . . . . . .  50
   5.1.1.1  tbsCertList . . . . . . . . . . . . . . . . . . . .  50
   5.1.1.2  signatureAlgorithm  . . . . . . . . . . . . . . . .  50
   5.1.1.3  signatureValue  . . . . . . . . . . . . . . . . . .  51
   5.1.2  Certificate List "To Be Signed" . . . . . . . . . . .  51
   5.1.2.1  Version . . . . . . . . . . . . . . . . . . . . . .  52
   5.1.2.2  Signature . . . . . . . . . . . . . . . . . . . . .  52
   5.1.2.3  Issuer Name . . . . . . . . . . . . . . . . . . . .  52
   5.1.2.4  This Update . . . . . . . . . . . . . . . . . . . .  52
   5.1.2.5  Next Update . . . . . . . . . . . . . . . . . . . .  53
   5.1.2.6  Revoked Certificates  . . . . . . . . . . . . . . .  53
   5.1.2.7  Extensions  . . . . . . . . . . . . . . . . . . . .  53
   5.2  CRL Extensions  . . . . . . . . . . . . . . . . . . . .  53
   5.2.1  Authority Key Identifier  . . . . . . . . . . . . . .  54
   5.2.2  Issuer Alternative Name . . . . . . . . . . . . . . .  54
   5.2.3  CRL Number  . . . . . . . . . . . . . . . . . . . . .  55
   5.2.4  Delta CRL Indicator . . . . . . . . . . . . . . . . .  55
   5.2.5  Issuing Distribution Point  . . . . . . . . . . . . .  58
   5.2.6  Freshest CRL  . . . . . . . . . . . . . . . . . . . .  59
   5.3  CRL Entry Extensions  . . . . . . . . . . . . . . . . .  60
   5.3.1  Reason Code . . . . . . . . . . . . . . . . . . . . .  60
   5.3.2  Hold Instruction Code . . . . . . . . . . . . . . . .  61
   5.3.3  Invalidity Date . . . . . . . . . . . . . . . . . . .  62
   5.3.4  Certificate Issuer  . . . . . . . . . . . . . . . . .  62
   6  Certificate Path Validation . . . . . . . . . . . . . . .  62
   6.1  Basic Path Validation . . . . . . . . . . . . . . . . .  63
   6.1.1  Inputs  . . . . . . . . . . . . . . . . . . . . . . .  66
   6.1.2  Initialization  . . . . . . . . . . . . . . . . . . .  67
   6.1.3  Basic Certificate Processing  . . . . . . . . . . . .  70
   6.1.4  Preparation for Certificate i+1 . . . . . . . . . . .  75
   6.1.5  Wrap-up procedure . . . . . . . . . . . . . . . . . .  78
   6.1.6  Outputs . . . . . . . . . . . . . . . . . . . . . . .  80
   6.2  Extending Path Validation . . . . . . . . . . . . . . .  80
   6.3  CRL Validation  . . . . . . . . . . . . . . . . . . . .  81
   6.3.1  Revocation Inputs . . . . . . . . . . . . . . . . . .  82
   6.3.2  Initialization and Revocation State Variables . . . .  82
   6.3.3  CRL Processing  . . . . . . . . . . . . . . . . . . .  83
   7  References  . . . . . . . . . . . . . . . . . . . . . . .  86
   8  Intellectual Property Rights  . . . . . . . . . . . . . .  88
   9  Security Considerations . . . . . . . . . . . . . . . . .  89
   Appendix A.  ASN.1 Structures and OIDs . . . . . . . . . . .  92
   A.1 Explicitly Tagged Module, 1988 Syntax  . . . . . . . . .  92
   A.2 Implicitly Tagged Module, 1988 Syntax  . . . . . . . . . 105
   Appendix B.  ASN.1 Notes . . . . . . . . . . . . . . . . . . 112
   Appendix C.  Examples  . . . . . . . . . . . . . . . . . . . 115
   C.1  DSA Self-Signed Certificate . . . . . . . . . . . . . . 115
   C.2  End Entity Certificate Using DSA  . . . . . . . . . . . 119
   C.3  End Entity Certificate Using RSA  . . . . . . . . . . . 122
   C.4  Certificate Revocation List . . . . . . . . . . . . . . 126
   Author Addresses . . . . . . . . . . . . . . . . . . . . . . 128
   Full Copyright Statement . . . . . . . . . . . . . . . . . . 129
```

---
# **1  Introduction**

이 사양은 인터넷용 X.509 공개 키 인프라\(PKI\) 표준 제품군의 일부입니다.

이 사양은 인터넷 PKI에 대한 인증서 및 인증서 해지 목록\(CRL\)의 형식과 의미를 프로파일링합니다. 인터넷 환경에서 인증경로를 처리하는 절차를 설명한다. 마지막으로 정의되거나 참조된 모든 데이터 구조에 대한 ASN.1 모듈이 부록에 제공됩니다.

섹션 2에서는 인터넷 PKI 요구 사항과 이 문서의 범위에 영향을 미치는 가정에 대해 설명합니다. 섹션 3에서는 아키텍처 모델을 제시하고 이전 IETF 및 ISO/IEC/ITU-T 표준과의 관계를 설명합니다. 특히, 이 문서와 IETF PEM 사양 및 ISO/IEC/ITU-T X.509 문서와의 관계가 설명되어 있습니다.

섹션 4에서는 X.509 버전 3 인증서를 프로파일링하고, 섹션 5에서는 X.509 버전 2 CRL을 프로파일링합니다. 프로필에는 인터넷 PKI에 유용할 수 있는 ISO/IEC/ITU-T 및 ANSI 확장의 식별이 포함됩니다. 프로필은 최신 ISO/IEC/ITU-T 표준에 사용되는 1997 ASN.1 구문이 아닌 1988 ASN.1\(Abstract Syntax Notation One\)으로 표시됩니다.

섹션 6에는 인증 경로 검증 절차가 포함되어 있습니다. 이러한 절차는 ISO/IEC/ITU-T 정의를 기반으로 합니다. 구현은 동일한 결과를 도출해야 하지만 지정된 절차를 사용할 필요는 없습니다.\(MUST\)

공개 키 자료와 디지털 서명의 식별 및 인코딩 절차는 \[PKIXALGS\]에 정의되어 있습니다. 이 사양의 구현에는 특정 암호화 알고리즘을 사용할 필요가 없습니다. 그러나 \[PKIXALGS\]에서 식별된 알고리즘을 사용하는 구현은 해당 사양에 설명된 대로 공개 키 자료와 디지털 서명을 식별하고 인코딩해야 합니다.\(MUST\)

마지막으로 구현자를 돕기 위해 세 가지 부록이 제공됩니다. 부록 A에는 이 사양 내에서 정의되거나 참조된 모든 ASN.1 구조가 포함되어 있습니다. 위와 같이 자료는 1988 ASN.1에 제시되어 있습니다. 부록 B에는 이 사양 내에서 사용되는 ASN.1 표기법의 덜 친숙한 기능에 대한 참고 사항이 포함되어 있습니다. 부록 C에는 적합한 인증서와 적합한 CRL의 예가 포함되어 있습니다.

이 사양은 RFC 2459를 폐기합니다. 이 사양은 5가지 기본 영역에서 RFC 2459와 다릅니다.

- \* 상호 운용 가능한 구현을 촉진하기 위해 인증 경로 유효성 검사를 위한 자세한 알고리즘이 이 사양의 섹션 6.1에 포함되어 있습니다. RFC 2459는 경로 유효성 검사에 대한 높은 수준의 설명만 제공했습니다.

- \* CRL을 사용하여 인증서 상태를 결정하는 알고리즘은 이 사양의 섹션 6.3에 제공됩니다. 이 자료는 RFC 2459에 없습니다.

- \* 새로운 사용 모델을 수용하기 위해 델타 CRL의 사용을 설명하는 자세한 정보가 이 사양의 섹션 5에 제공됩니다.

- \* 공개 키 자료 및 디지털 서명의 식별 및 인코딩은 이 사양에 포함되지 않았지만 이제 동반 사양 \[PKIXALGS\]에 설명되어 있습니다.

- \* 4개의 추가 확장이 지정됩니다: 3개의 인증서 확장과 1개의 CRL 확장. 인증서 확장은 주제 정보 액세스, 모든 정책 금지 및 최신 CRL입니다. 최신 CRL 확장은 CRL 확장으로도 정의됩니다.

\* 사양 전반에 걸쳐 설명이 이루어졌습니다.

- ITU-T X.509 사양과의 일관성을 강화하기 위해 도입되었습니다. X.509는 인증서와 CRL 형식뿐만 아니라 이 사양에 나타나는 많은 확장도 정의합니다. 이러한 변경 사항은 ITU-T 사양을 기반으로 한 구현과 이 사양을 기반으로 한 구현 간의 상호 운용 가능성을 향상시키기 위해 도입되었습니다.

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119에 설명된 대로 해석됩니다.\(MUST NOT\)

---
# **2  Requirements and Assumptions**

이 사양의 목표는 X.509 기술을 사용하려는 커뮤니티를 위해 인터넷 애플리케이션 내에서 X.509 인증서의 사용을 용이하게 하는 프로필을 개발하는 것입니다. 이러한 응용 프로그램에는 WWW, 전자 메일, 사용자 인증 및 IPsec이 포함될 수 있습니다. X.509 사용에 대한 몇 가지 장애물을 완화하기 위해

인증서에 대해 이 문서는 인증서 관리 시스템 개발을 촉진하기 위한 프로필을 정의합니다. 응용 도구 개발; 정책에 따라 상호 운용성이 결정됩니다.

일부 커뮤니티에서는 추가 인증, 보증 또는 운영 요구 사항이 있는 특수 응용 프로그램 도메인 또는 환경의 요구 사항을 충족하기 위해 이 프로필을 보완하거나 대체해야 합니다. 그러나 기본 애플리케이션의 경우 자주 사용되는 속성에 대한 공통 표현을 정의하여 애플리케이션 개발자가 특정 인증서 발급자나 CRL\(인증서 해지 목록\)의 발급자에 구애받지 않고 필요한 정보를 얻을 수 있도록 합니다.

인증서 사용자는 특정 인증서의 공개 키와 관련된 인증 또는 부인 방지 서비스에 의존하기 전에 인증 기관\(CA\)에서 생성한 인증서 정책을 검토해야 합니다. 이를 위해 이 표준은 법적 구속력이 있는 규칙이나 의무를 규정하지 않습니다.

속성 인증서와 같은 추가 인증 및 속성 관리 도구가 등장함에 따라 인증서에 포함되는 인증된 속성을 제한하는 것이 적절할 수 있습니다. 이러한 다른 관리 도구는 인증된 많은 속성을 전달하는 보다 적절한 방법을 제공할 수 있습니다.

---
## **2.1  Communication and Topology**

인증서 사용자는 통신 토폴로지, 특히 보안 전자 메일 사용자와 관련하여 광범위한 환경에서 작업합니다. 이 프로필은 고대역폭, 실시간 IP 연결 또는 높은 연결 가용성이 없는 사용자를 지원합니다. 또한 프로필은 방화벽이나 기타 필터링된 통신의 존재를 허용합니다.

이 프로필은 X.500 디렉토리 시스템 또는 LDAP 디렉토리 시스템의 배포를 가정하지 않습니다. 프로필은 X.500 디렉토리 또는 LDAP 디렉토리의 사용을 금지하지 않습니다. 그러나 인증서 및 CRL\(인증서 해지 목록\)을 배포하는 모든 방법을 사용할 수 있습니다.

---
## **2.2  Acceptability Criteria**

인터넷 공개 키 인프라\(PKI\)의 목표는 결정적이고 자동화된 식별, 인증, 액세스 제어 및 권한 부여 기능에 대한 요구 사항을 충족하는 것입니다. 이러한 서비스에 대한 지원은 인증서에 포함된 속성뿐만 아니라 정책 데이터 및 인증 경로 제약 조건과 같은 인증서의 보조 제어 정보를 결정합니다.

---
## **2.3  User Expectations**

인터넷 PKI 사용자는 클라이언트 소프트웨어를 사용하는 사람과 프로세스이며 인증서에 명명된 주체입니다. 이러한 용도에는 전자 메일의 리더 및 작성자, WWW 브라우저용 클라이언트, WWW 서버 및 라우터 내 IPsec용 키 관리자가 포함됩니다. 이 프로필은 이러한 사용자가 사용하는 플랫폼의 한계와 사용자 자신의 정교함 및 주의력의 한계를 인식합니다. 이는 최소한의 사용자 구성 책임\(예: 신뢰할 수 있는 CA 키, 규칙\), 인증서 내의 명시적인 플랫폼 사용 제약, 많은 악의적인 작업으로부터 사용자를 보호하는 인증 경로 제약, 유효성 검사 기능을 현명하게 자동화하는 애플리케이션에서 나타납니다.

---
## **2.4  Administrator Expectations**

사용자 기대와 마찬가지로 인터넷 PKI 프로필은 일반적으로 CA를 운영하는 개인을 지원하도록 구성되었습니다. 관리자에게 무한한 선택권을 제공하면 CA 관리자의 미묘한 실수로 인해 광범위한 손상이 발생할 가능성이 높아집니다. 또한 무제한적인 선택은 CA에서 생성한 인증서를 처리하고 유효성을 검사하는 소프트웨어를 크게 복잡하게 만듭니다.

---
# **3  Overview of Approach**

다음은 PKIX 사양에서 가정하는 아키텍처 모델을 간략하게 나타낸 것입니다.

이 모델의 구성 요소는 다음과 같습니다.

최종 엔터티: PKI 인증서의 사용자 및/또는 인증서의 주체인 최종 사용자 시스템. CA: 인증 기관; RA: 등록 기관, 즉 CA가 특정 관리 기능을 위임하는 선택적 시스템입니다. CRL 발급자: CA가 인증서 폐기 목록 게시를 위임하는 선택적 시스템입니다. 저장소: 인증서와 CRL을 저장하고 이러한 인증서와 CRL을 최종 엔터티에 배포하는 수단으로 사용되는 시스템 또는 분산 시스템 모음입니다.

AA\(특성 기관\)는 CRL 발행자에게 CRL 게시를 위임하도록 선택할 수도 있습니다.

```text
   +---+
   | C |                       +------------+
   | e | <-------------------->| End entity |
   | r |       Operational     +------------+
   | t |       transactions          ^
   | i |      and management         |  Management
   | f |       transactions          |  transactions        PKI
   | i |                             |                     users
   | c |                             v
   | a | =======================  +--+------------+  ==============
   | t |                          ^               ^
   | e |                          |               |         PKI
   |   |                          v               |      management
   | & |                       +------+           |       entities
   |   | <---------------------|  RA  |<----+     |
   | C |  Publish certificate  +------+     |     |
   | R |                                    |     |
   | L |                                    |     |
   |   |                                    v     v
   | R |                                +------------+
   | e | <------------------------------|     CA     |
   | p |   Publish certificate          +------------+
   | o |   Publish CRL                     ^      ^
   | s |                                   |      |  Management
   | i |                +------------+     |      |  transactions
   | t | <--------------| CRL Issuer |<----+      |
   | o |   Publish CRL  +------------+            v
   | r |                                      +------+
   | y |                                      |  CA  |
   +---+                                      +------+

                      Figure 1 - PKI Entities
```

---
## **3.1  X.509 Version 3 Certificate**

공개 키 사용자는 암호화 또는 디지털 서명 메커니즘을 사용할 올바른 원격 주체\(사람 또는 시스템\)가 관련 개인 키를 소유하고 있다는 확신이 필요합니다. 이러한 신뢰는 공개 키 값을 주체에 바인딩하는 데이터 구조인 공개 키 인증서를 사용하여 얻습니다. 바인딩은 신뢰할 수 있는 CA가 각 인증서에 디지털 서명을 함으로써 확인됩니다. CA는 기술적 수단\(즉, 도전-응답 프로토콜을 통한 소유 증명\), 개인 키 제시 또는 주체의 주장을 바탕으로 이 주장을 기반으로 할 수 있습니다. 인증서에는 서명된 내용에 표시된 제한된 유효 수명이 있습니다. 인증서를 사용하는 클라이언트는 인증서의 서명과 적시성을 독립적으로 확인할 수 있으므로 인증서를 다음을 통해 배포할 수 있습니다.

신뢰할 수 없는 통신 및 서버 시스템이며 인증서 사용 시스템의 보안되지 않은 저장소에 캐시될 수 있습니다.

X.500 디렉토리 권장 사항의 일부로 1988년에 처음 게시된 ITU-T X.509\(이전 CCITT X.509\) 또는 ISO/IEC 9594-8은 표준 인증서 형식\[X.509\]을 정의합니다. 1988 표준의 인증서 형식을 버전 1\(v1\) 형식이라고 합니다. 1993년 X.500이 개정되었을 때 두 개의 필드가 더 추가되어 버전 2\(v2\) 형식이 되었습니다.

1993년에 게시된 PEM\(Internet Privacy Enhanced Mail\) RFC에는 X.509 v1 인증서\[RFC 1422\]를 기반으로 하는 공개 키 인프라에 대한 사양이 포함되어 있습니다. RFC 1422를 배포하려고 시도하면서 얻은 경험을 통해 v1 및 v2 인증서 형식이 여러 측면에서 부족하다는 것이 분명해졌습니다. 가장 중요한 것은 PEM 설계 및 구현 경험이 필요하다고 입증된 정보를 전달하기 위해 더 많은 필드가 필요하다는 것입니다. 이러한 새로운 요구 사항에 대응하여 ISO/IEC, ITU-T 및 ANSI X9는 X.509 버전 3\(v3\) 인증서 형식을 개발했습니다. v3 형식은 추가 확장 필드에 대한 규정을 추가하여 v2 형식을 확장합니다. 특정 확장 필드 유형은 표준에 지정되거나 조직이나 커뮤니티에서 정의 및 등록될 수 있습니다. 1996년 6월 기본 v3 형식의 표준화가 완료되었다\[X.509\].

ISO/IEC, ITU-T 및 ANSI X9도 v3 확장 필드 \[X.509\]\[X9.55\]에서 사용하기 위한 표준 확장을 개발했습니다. 이러한 확장은 추가 주체 식별 정보, 주요 속성 정보, 정책 정보 및 인증 경로 제약 조건과 같은 데이터를 전달할 수 있습니다.

그러나 ISO/IEC, ITU-T 및 ANSI X9 표준 확장은 적용 범위가 매우 넓습니다. 인터넷 사용을 위한 X.509 v3 시스템의 상호 운용 가능한 구현을 개발하려면 인터넷에 맞게 조정된 X.509 v3 확장 사용을 위한 프로필을 지정해야 합니다. 이 문서의 목표 중 하나는 인터넷 WWW, 전자 메일 및 IPsec 응용 프로그램에 대한 프로필을 지정하는 것입니다. 추가 요구 사항이 있는 환경에서는 이 프로필을 기반으로 구축하거나 대체할 수 있습니다.

---
## **3.2  Certification Paths and Trust**

공개 키에 대한 지식이 필요한 보안 서비스 사용자는 일반적으로 필요한 공개 키가 포함된 인증서를 획득하고 유효성을 검사해야 합니다. 공개 키 사용자가 인증서에 서명한 CA 공개 키의 보증된 사본, CA 이름 및 관련 정보\(예: 유효 기간 또는 이름 제약 조건\)를 아직 보유하지 않은 경우 추가 인증서가 필요할 수 있습니다. 해당 공개 키를 얻으세요. 일반적으로 여러 인증서의 체인

하나의 CA가 서명한 공개 키 소유자\(최종 엔터티\)의 인증서와 다른 CA가 서명한 0개 이상의 추가 CA 인증서로 구성됩니다. 공개 키 사용자는 제한된 수의 보장된 CA 공개 키로만 초기화되므로 인증 경로라고 하는 이러한 체인이 필요합니다.

공개 키 사용자가 인증 경로를 찾을 수 있도록 CA를 구성하는 방법에는 여러 가지가 있습니다. PEM의 경우 RFC 1422는 CA의 엄격한 계층 구조를 정의했습니다. PEM 인증 기관에는 세 가지 유형이 있습니다.

\(a\) IPRA\(인터넷 정책 등록 기관\): 이

- Internet Society의 후원으로 운영되는 기관은 레벨 1에서 PEM 인증 계층의 루트 역할을 합니다. 이는 다음 레벨의 기관인 PCA에 대해서만 인증서를 발급합니다. 모든 인증 경로는 IPRA로 시작됩니다.

- \(b\) 정책 인증 기관\(PCA\): PCA는 계층 구조의 레벨 2에 있으며, 각 PCA는 IPRA의 인증을 받습니다. PCA는 인증 사용자 또는 하위 인증 기관과 관련된 정책 설명을 수립하고 게시해야 합니다. 서로 다른 PCA는 다양한 사용자 요구를 충족시키는 것을 목표로 합니다. 예를 들어, 한 PCA\(조직 PCA\)는 상업 조직의 일반적인 전자 메일 요구 사항을 지원할 수 있고 다른 PCA\(고보증 PCA\)는 법적 구속력이 있는 디지털 서명 요구 사항을 충족하기 위해 고안된 보다 엄격한 정책을 가질 수 있습니다.

- \(c\) 인증 기관\(CA\): CA는 계층 구조의 레벨 3에 있으며 더 낮은 레벨에 있을 수도 있습니다. 레벨 3의 인증은 PCA의 인증을 받았습니다. CA는 예를 들어 특정 조직, 특정 조직 단위\(예: 부서, 그룹, 섹션\) 또는 특정 지리적 영역을 나타냅니다.

또한 RFC 1422에는 CA가 이름이 CA 자체 이름에 종속된\(X.500 명명 트리에서\) 엔터티에 대해서만 인증서를 발급할 수 있도록 요구하는 이름 종속 규칙이 있습니다. PEM 인증 경로와 연관된 신뢰는 PCA 이름으로 암시됩니다. 이름 종속 규칙은 PCA 아래의 CA가 인증할 수 있는 하위 엔터티 집합에 대해 합리적으로 제한되도록 보장합니다\(예: 조직의 CA는 해당 조직의 이름 트리에 있는 엔터티만 인증할 수 있음\). 인증서 사용자 시스템은 이름 종속 규칙이 준수되었는지 기계적으로 확인할 수 있습니다.

RFC 1422는 X.509 v1 인증서 형식을 사용합니다. X.509 v1의 제한 사항으로 인해 정책 정보를 명확하게 연결하거나 인증서의 유용성을 제한하기 위해 몇 가지 구조적 제한 사항을 적용해야 했습니다. 이러한 제한 사항에는 다음이 포함됩니다.

```text
      (a)  a pure top-down hierarchy, with all certification paths
      starting from IPRA;
```

- \(b\) CA 주체의 이름을 제한하는 명명 종속 규칙; 그리고

\(c\) 다음 사항에 대한 지식이 필요한 PCA 개념의 사용

- 개별 PCA는 인증서 체인 확인 논리에 내장됩니다. 체인이 허용되는지 여부를 결정하려면 개별 PCA에 대한 지식이 필요했습니다.

X.509 v3을 사용하면 사용되는 CA 구조를 제한할 필요 없이 RFC 1422에서 다루는 대부분의 요구 사항을 인증서 확장을 사용하여 해결할 수 있습니다. 특히, 인증서 정책과 관련된 인증서 확장은 PCA의 필요성을 제거하고 제약 확장은 이름 종속 규칙의 필요성을 제거합니다. 결과적으로 이 문서는 다음을 포함하여 보다 유연한 아키텍처를 지원합니다.

- \(a\) 인증 경로는 사용자 자신의 도메인에 있는 CA의 공개키 또는 계층 구조 최상위의 공개키로 시작됩니다. 사용자 자신의 도메인에 있는 CA의 공개 키로 시작하면 몇 가지 이점이 있습니다. 일부 환경에서는 로컬 도메인이 가장 신뢰할 수 있습니다.

- \(b\) 이름 제약은 인증서에 이름 제약 확장을 명시적으로 포함함으로써 부과될 수 있지만 필수는 아닙니다.

- \(c\) 정책 확장 및 정책 매핑은 더 높은 수준의 자동화를 허용하는 PCA 개념을 대체합니다. 애플리케이션은 PCA에 대한 사전 지식 대신 ​​인증서 내용을 기반으로 인증 경로가 허용되는지 여부를 결정할 수 있습니다. 이를 통해 인증 경로 처리를 자동화할 수 있습니다.

---
## **3.3  Revocation**

인증서가 발급되면 전체 유효 기간 동안 사용되는 것으로 예상됩니다. 그러나 다양한 상황에 따라 유효기간이 만료되기 전에 인증서가 무효화될 수 있습니다. 이러한 상황에는 이름 변경, 주체와 CA 간의 연결 변경\(예: 직원이 조직에서 고용을 종료하는 경우\), 해당 개인 키의 손상 또는 손상이 의심되는 경우가 포함됩니다. 이러한 상황에서는 CA가 인증서를 취소해야 합니다.

X.509는 인증서 해지의 한 가지 방법을 정의합니다. 이 방법에는 각 CA가 CRL\(인증서 해지 목록\)이라는 서명된 데이터 구조를 주기적으로 발행하는 작업이 포함됩니다. CRL은 CA 또는 CRL 발급자가 서명하고 공용 저장소에서 무료로 사용할 수 있는 해지된 인증서를 식별하는 타임 스탬프 목록입니다. 해지된 각 인증서는 인증서 일련 번호로 CRL에서 식별됩니다. 인증서 사용 시스템이 인증서를 사용하는 경우\(예: 원격 사용자의 디지털 서명 확인\) 해당 시스템은 인증서 서명 및 유효성을 확인할 뿐만 아니라 적절한 최신 CRL을 획득하고 인증서 일련번호가 해당 시스템에 없는지 확인합니다. CRL. "적절하게 최근"의 의미는 지역 정책에 따라 다를 수 있지만 일반적으로 가장 최근에 발급된 CRL을 의미합니다. 새로운 CRL은 정기적으로\(예: 매시간, 매일 또는 매주\) 발행됩니다. 해지 알림 후 다음 업데이트의 일부로 항목이 CRL에 추가됩니다. 해지된 인증서의 유효 기간 이후에 발행된 정기적으로 예약된 하나의 CRL에 항목이 나타날 때까지 CRL에서 항목을 제거해서는 안 됩니다.\(MUST NOT\)

이 해지 방법의 장점은 CRL이 인증서 자체와 정확히 동일한 수단, 즉 신뢰할 수 없는 서버 및 신뢰할 수 없는 통신을 통해 배포될 수 있다는 것입니다.

신뢰할 수 없는 통신 및 서버를 사용하는 CRL 해지 방법의 한 가지 제한 사항은 해지 시간 단위가 CRL 발급 기간으로 제한된다는 것입니다. 예를 들어, 지금 취소가 보고되면 현재 발행된 모든 CRL이 업데이트될 때까지 해당 취소는 인증서 사용 시스템에 안정적으로 통보되지 않습니다. 이는 빈도에 따라 최대 1시간, 1일 또는 1주일이 될 수 있습니다. CRL이 발행됩니다.

X.509 v3 인증서 형식과 마찬가지로 여러 공급업체의 상호 운용 가능한 구현을 용이하게 하려면 인터넷 사용을 위해 X.509 v2 CRL 형식을 프로파일링해야 합니다. 해당 프로필을 지정하는 것이 이 문서의 목표 중 하나입니다. 그러나 이 프로필에는 CRL 발급이 필요하지 않습니다. 온라인 폐기 알림을 지원하는 메시지 형식과 프로토콜은 다른 PKIX 사양에 정의되어 있습니다. 일부 환경에서는 X.509 CRL 대신 온라인 취소 알림 방법을 적용할 수 있습니다. 온라인 해지 확인은 해지 보고서와 신뢰 당사자에게 정보 배포 사이의 대기 시간을 크게 줄일 수 있습니다. CA가 해지 보고서를 신뢰할 수 있고 유효한 것으로 수락하면 온라인 서비스에 대한 모든 쿼리는 해지의 인증서 유효성 검사 영향을 올바르게 반영합니다. 그러나 이러한 방법은 새로운 보안 요구 사항을 부과합니다. 즉, 인증서 유효성 검사기는 온라인 유효성 검사 서비스를 신뢰해야 하지만 저장소는 신뢰할 필요가 없습니다.

---
## **3.4  Operational Protocols**

클라이언트 시스템을 사용하여 인증서와 CRL\(또는 상태 정보\)을 인증서에 전달하려면 운영 프로토콜이 필요합니다. LDAP, HTTP, FTP 및 X.500을 기반으로 한 배포 절차를 포함하여 다양한 인증서 및 CRL 전달 수단에 대한 규정이 필요합니다. 이러한 기능을 지원하는 작동 프로토콜은 다른 PKIX 사양에 정의되어 있습니다. 이러한 사양에는 적절한 MIME 콘텐츠 유형에 대한 정의 또는 참조를 포함하여 위의 모든 운영 환경을 지원하기 위한 메시지 형식 및 절차에 대한 정의가 포함될 수 있습니다.

---
## **3.5  Management Protocols**

PKI 사용자와 관리 엔터티 간의 온라인 상호 작용을 지원하려면 관리 프로토콜이 필요합니다. 예를 들어, CA와 키 쌍이 연결된 클라이언트 시스템 간에 또는 서로 교차 인증하는 두 CA 간에 관리 프로토콜이 사용될 수 있습니다. 관리 프로토콜이 잠재적으로 지원해야 하는 기능 세트는 다음과 같습니다.

- \(a\) 등록: CA가 해당 사용자에게 인증서를 발급하기 전에 사용자가 먼저 CA에\(직접 또는 RA를 통해\) 자신을 알리는 프로세스입니다.

- \(b\) 초기화: 클라이언트 시스템이 안전하게 작동하려면 인프라의 다른 곳에 저장된 키와 적절한 관계가 있는 키 자료를 설치해야 합니다. 예를 들어 인증서 경로의 유효성을 검사하는 데 사용하려면 신뢰할 수 있는 CA의 공개 키와 기타 보장된 정보를 사용하여 클라이언트를 안전하게 초기화해야 합니다.

- 또한 클라이언트는 일반적으로 자체 키 쌍을 사용하여 초기화해야 합니다.

- \(c\) 인증: 이는 CA가 사용자의 공개 키에 대한 인증서를 발급하고 해당 인증서를 사용자의 클라이언트 시스템에 반환하거나 해당 인증서를 저장소에 게시하는 프로세스입니다.

- \(d\) 키 쌍 복구: 선택적으로 사용자 클라이언트 키 자료\(예: 암호화 목적으로 사용되는 사용자의 개인 키\)는 CA 또는 키 백업 시스템을 통해 백업될 수 있습니다. 사용자가 백업된 키 자료를 복구해야 하는 경우\(예: 비밀번호를 잊어버렸거나 키 체인 파일을 잃어버렸기 때문에\) 그러한 복구를 지원하기 위해 온라인 프로토콜 교환이 필요할 수 있습니다.

- \(e\) 키 쌍 업데이트: 모든 키 쌍은 정기적으로 업데이트되어야 합니다. 즉, 새 키 쌍으로 교체하고 새 인증서를 발급해야 합니다.

- \(f\) 철회 요청: 권한 있는 사람이 CA에 인증서 철회가 필요한 비정상적인 상황을 알립니다.

- \(g\) 교차 인증: 두 CA는 교차 인증서 설정에 사용되는 정보를 교환합니다. 교차 인증서는 인증서 발급에 사용되는 CA 서명 키를 포함하는 한 CA에서 다른 CA로 발급한 인증서입니다.

온라인 프로토콜이 위 기능을 구현하는 유일한 방법은 아닙니다. 모든 기능에 대해 동일한 결과를 달성하는 오프라인 방법이 있으며 이 사양은 온라인 프로토콜의 사용을 요구하지 않습니다. 예를 들어, 하드웨어 토큰을 사용하는 경우 많은 기능이 물리적 토큰 전달의 일부로 달성될 수 있습니다. 또한, 위의 기능 중 일부는 하나의 프로토콜 교환으로 결합될 수 있습니다. 특히 등록, 초기화, 인증 기능 중 둘 이상이 하나의 프로토콜 교환으로 결합될 수 있습니다.

PKIX 시리즈 사양은 위 기능을 지원하는 표준 메시지 형식 세트를 정의합니다. 다양한 환경\(예: 이메일, 파일 전송 및 WWW\)에서 이러한 메시지를 전달하기 위한 프로토콜은 해당 사양에 설명되어 있습니다.

---
# **4  Certificate and Certificate Extensions Profile**

이 섹션에서는 상호 운용성과 재사용 가능한 PKI를 촉진하는 공개 키 인증서에 대한 프로필을 제공합니다. 이 섹션은 X.509 v3 인증서 형식과 \[X.509\]에 정의된 표준 인증서 확장을 기반으로 합니다. ISO/IEC 및 ITU-T 문서는 ASN.1의 1997 버전을 사용합니다. 이 문서에서는 1988 ASN.1 구문을 사용하지만 인코딩된 인증서와 표준 확장은 동일합니다. 이 섹션에서는 인터넷 커뮤니티에 대한 PKI를 지원하는 데 필요한 개인 확장도 정의합니다.

인증서는 광범위한 상호 운용성 목표와 운영 및 보증 요구 사항을 포괄하는 광범위한 응용 프로그램 및 환경에서 사용될 수 있습니다. 이 문서의 목표는 광범위한 상호 운용성과 제한된 특수 목적 요구 사항이 필요한 일반 응용 프로그램에 대한 공통 기준을 설정하는 것입니다. 특히, 비공식 인터넷 전자 메일, IPsec 및 WWW 응용 프로그램에 대한 X.509 v3 인증서 사용 지원에 중점을 둘 것입니다.

---
## **4.1  Basic Certificate Fields**

X.509 v3 인증서 기본 구문은 다음과 같습니다. 서명 계산을 위해 서명될 데이터는 ASN.1 DER\(고유 인코딩 규칙\) \[X.690\]을 사용하여 인코딩됩니다. ASN.1 DER 인코딩은 각 요소에 대한 태그, 길이, 값 인코딩 시스템입니다.

```text
   Certificate  ::=  SEQUENCE  {
        tbsCertificate       TBSCertificate,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }

   TBSCertificate  ::=  SEQUENCE  {
        version         [0]  EXPLICIT Version DEFAULT v1,
        serialNumber         CertificateSerialNumber,
        signature            AlgorithmIdentifier,
        issuer               Name,
        validity             Validity,
        subject              Name,
        subjectPublicKeyInfo SubjectPublicKeyInfo,
        issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,
                             -- If present, version MUST be v2 or v3
        subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,
                             -- If present, version MUST be v2 or v3
        extensions      [3]  EXPLICIT Extensions OPTIONAL
                             -- If present, version MUST be v3
        }

   Version  ::=  INTEGER  {  v1(0), v2(1), v3(2)  }

   CertificateSerialNumber  ::=  INTEGER

   Validity ::= SEQUENCE {
        notBefore      Time,
        notAfter       Time }

   Time ::= CHOICE {
        utcTime        UTCTime,
        generalTime    GeneralizedTime }

   UniqueIdentifier  ::=  BIT STRING

   SubjectPublicKeyInfo  ::=  SEQUENCE  {
        algorithm            AlgorithmIdentifier,
        subjectPublicKey     BIT STRING  }
```

확장 ::= 확장의 시퀀스 크기\(1..MAX\)

```text
   Extension  ::=  SEQUENCE  {
        extnID      OBJECT IDENTIFIER,
        critical    BOOLEAN DEFAULT FALSE,
        extnValue   OCTET STRING  }
```

다음 항목은 인터넷에서 사용하기 위한 X.509 v3 인증서에 대해 설명합니다.

---
### **4.1.1  Certificate Fields**

인증서는 세 가지 필수 필드로 구성된 시퀀스입니다. 해당 필드는 다음 하위 섹션에 자세히 설명되어 있습니다.

---
#### **4.1.1.1  tbsCertificate**

필드에는 주체 및 발급자의 이름, 주체와 연결된 공개 키, 유효 기간 및 기타 관련 정보가 포함됩니다. 필드는 섹션 4.1.2에 자세히 설명되어 있습니다. tbsCertificate에는 일반적으로 섹션 4.2에 설명된 확장이 포함됩니다.

---
#### **4.1.1.2  signatureAlgorithm**

SignatureAlgorithm 필드에는 CA가 이 인증서에 서명하는 데 사용하는 암호화 알고리즘에 대한 식별자가 포함되어 있습니다. \[PKIXALGS\]에는 지원되는 서명 알고리즘이 나열되어 있지만 다른 서명 알고리즘도 지원될 수 있습니다.\(MAY\)

알고리즘 식별자는 다음 ASN.1 구조로 정의됩니다.

```text
   AlgorithmIdentifier  ::=  SEQUENCE  {
        algorithm               OBJECT IDENTIFIER,
        parameters              ANY DEFINED BY algorithm OPTIONAL  }
```

알고리즘 식별자는 암호화 알고리즘을 식별하는 데 사용됩니다. OBJECT IDENTIFIER 구성 요소는 알고리즘\(예: SHA-1을 사용하는 DSA\)을 식별합니다. 선택적 매개변수 필드의 내용은 식별된 알고리즘에 따라 달라집니다.

이 필드는 tbsCertificate 시퀀스\(섹션 4.1.2.3\)의 서명 필드와 동일한 알고리즘 식별자를 포함해야 합니다.\(MUST\)

---
#### **4.1.1.3  signatureValue**

SignatureValue 필드에는 ASN.1 DER로 인코딩된 tbsCertificate에 대해 계산된 디지털 서명이 포함되어 있습니다. ASN.1 DER로 인코딩된 tbsCertificate는 서명 기능에 대한 입력으로 사용됩니다. 이것

서명 값은 BIT STRING으로 인코딩되어 서명 필드에 포함됩니다. 이 프로세스의 세부 사항은 \[PKIXALGS\]에 나열된 각 알고리즘에 대해 지정됩니다.

CA는 이 서명을 생성하여 tbsCertificate 필드에 있는 정보의 유효성을 인증합니다. 특히 CA는 공개 키 자료와 인증서 주체 간의 바인딩을 인증합니다.

---
### **4.1.2  TBSCertificate**

TBSCertificate 시퀀스에는 인증서 주체 및 이를 발급한 CA와 관련된 정보가 포함됩니다. 모든 TBSCertificate에는 주체 및 발급자의 이름, 주체와 관련된 공개 키, 유효 기간, 버전 번호 및 일련 번호가 포함되어 있습니다. 일부는 선택적 고유 식별자 필드를 포함할 수 있습니다. 이 섹션의 나머지 부분에서는 이러한 필드의 구문과 의미를 설명합니다. TBSCertificate에는 일반적으로 확장이 포함됩니다. 인터넷 PKI의 확장은 섹션 4.2에 설명되어 있습니다.\(MAY\)

---
#### **4.1.2.1  Version**

이 필드는 인코딩된 인증서의 버전을 설명합니다. 확장이 사용되는 경우 이 프로필에서 예상되는 대로 버전은 3\(값은 2\)이어야 합니다. 확장은 없지만 UniqueIdentifier가 있는 경우 버전은 2\(값은 1\)여야 합니다. 그러나 버전은 3일 수 있습니다. 기본 필드만 있는 경우 버전은 1이어야 합니다\(값은 기본값으로 인증서에서 생략됩니다\). 그러나 버전은 2 또는 3일 수 있습니다.\(MUST, SHOULD, SHOULD\)

구현은 모든 버전 인증서를 수락할 준비를 해야 합니다. 최소한 준수 구현은 버전 3 인증서를 인식해야 합니다.\(SHOULD, MUST\)

이 프로필을 기반으로 한 구현에서는 버전 2 인증서 생성이 예상되지 않습니다.

---
#### **4.1.2.2  Serial number**

일련 번호는 CA가 각 인증서에 할당한 양의 정수여야 합니다. 이는 특정 CA에서 발급한 각 인증서에 대해 고유해야 합니다. 즉, 발급자 이름과 일련 번호는 고유한 인증서를 식별합니다. CA는 serialNumber가 음수가 아닌 정수가 되도록 강제해야 합니다.\(MUST, MUST, MUST\)

위의 고유성 요구 사항을 고려하면 일련 번호에는 긴 정수가 포함될 것으로 예상됩니다. 인증서 사용자는 최대 20옥텟의 serialNumber 값을 처리할 수 있어야 합니다. 준수 CA는 20옥텟보다 긴 serialNumber 값을 사용해서는 안 됩니다.\(MUST, MUST NOT\)

참고: 비준수 CA는 음수 또는 0인 일련 번호로 인증서를 발급할 수 있습니다. 인증서 사용자는 그러한 인증서를 적절하게 처리할 준비가 되어 있어야 합니다.\(SHOULD\)

---
#### **4.1.2.3  Signature**

이 필드에는 CA가 인증서에 서명하는 데 사용하는 알고리즘에 대한 알고리즘 식별자가 포함되어 있습니다.

이 필드는 시퀀스 인증서\(섹션 4.1.1.2\)의 서명 알고리즘 필드와 동일한 알고리즘 식별자를 포함해야 합니다. 선택적 매개변수 필드의 내용은 식별된 알고리즘에 따라 달라집니다. \[PKIXALGS\]에는 지원되는 서명 알고리즘이 나열되어 있지만 다른 서명 알고리즘도 지원될 수 있습니다.\(MUST, MAY\)

---
#### **4.1.2.4  Issuer**

발급자 필드는 인증서에 서명하고 발급한 엔터티를 식별합니다. 발급자 필드에는 비어 있지 않은 고유 이름\(DN\)이 포함되어야 합니다. 발행자 필드는 X.501 유형 이름 \[X.501\]로 정의됩니다. 이름은 다음 ASN.1 구조로 정의됩니다.\(MUST\)

```text
   Name ::= CHOICE {
     RDNSequence }
```

RDNSequence ::= RelativeDistinguishedName의 시퀀스

RelativeDistinguishedName ::= AttributeTypeAndValue 세트

```text
   AttributeTypeAndValue ::= SEQUENCE {
     type     AttributeType,
     value    AttributeValue }

   AttributeType ::= OBJECT IDENTIFIER
```

AttributeValue ::= AttributeType에 의해 정의된 모든 것

```text
   DirectoryString ::= CHOICE {
         teletexString           TeletexString (SIZE (1..MAX)),
         printableString         PrintableString (SIZE (1..MAX)),
         universalString         UniversalString (SIZE (1..MAX)),
         utf8String              UTF8String (SIZE (1..MAX)),
         bmpString               BMPString (SIZE (1..MAX)) }
```

이름은 국가 이름과 같은 속성과 US와 같은 해당 값으로 구성된 계층적 이름을 설명합니다. AttributeValue 구성요소의 유형은 AttributeType에 의해 결정됩니다. 일반적으로 이는 DirectoryString이 됩니다.

DirectoryString 유형은 PrintableString, TeletexString, BMPString, UTF8String 및 UniversalString을 선택하여 정의됩니다. UTF8String 인코딩 \[RFC 2279\]이 선호되는 인코딩이며, 2003년 12월 31일 이후에 발행된 모든 인증서는 반드시 DirectoryString의 UTF8String 인코딩을 사용해야 합니다\(아래 명시된 경우 제외\). 해당 날짜까지 CA를 준수하는 CA는 고유 이름을 포함하여 고유 이름을 생성할 때 다음 옵션 중에서 선택해야 합니다.\(MUST, MUST\)

```text
      (a)  if the character set is sufficient, the string MAY be
      represented as a PrintableString;
```

- \(b\) 실패 \(a\), BMPString 문자 세트가 충분하면 문자열은 BMPString으로 표시될 수 있습니다. 그리고\(MAY\)

- \(c\) \(a\)와 \(b\)가 실패하면 문자열은 UTF8String으로 표시되어야 합니다. \(a\) 또는 \(b\)가 충족되면 CA는 여전히 문자열을 UTF8String으로 표시하도록 선택할 수 있습니다.\(MUST, MAY\)

2003년 12월 31일 UTF8 인코딩 요구 사항에 대한 예외는 다음과 같습니다.

- \(a\) CA는 UTF8String 인코딩으로의 순차적인 마이그레이션을 지원하기 위해 "이름 롤오버" 인증서를 발행할 수 있습니다. 이러한 인증서에는 CA의 UTF8String 인코딩된 이름이 발급자로 포함되고 이전 이름 ​​인코딩이 주체로 포함되거나 그 반대의 경우도 마찬가지입니다.\(MAY\)

- \(b\) 섹션 4.1.2.6에 명시된 대로 주제 필드는 인코딩에 관계없이 주제 CA가 발급한 모든 인증서의 발급자 필드 내용과 일치하는 비어 있지 않은 고유 이름으로 채워져야 합니다.\(MUST\)

TeletexString 및 UniversalString은 이전 버전과의 호환성을 위해 포함되며 새 주체에 대한 인증서에 사용해서는 안 됩니다. 그러나 이러한 유형은 이름이 이전에 설정된 인증서에 사용될 수 있습니다. 인증서 사용자는 이러한 유형의 인증서를 받을 준비를 해야 합니다.\(SHOULD NOT, MAY, SHOULD\)

또한 많은 레거시 구현에서는 ISO 8859-1 문자 집합\(Latin1String\)\[ISO 8859-1\]으로 인코딩된 이름을 지원하지만 TeletexString으로 태그를 지정합니다. TeletexString은 ISO 8859-1보다 더 큰 문자 세트를 인코딩하지만 일부 문자를 다르게 인코딩합니다. 구현은 두 인코딩을 모두 처리할 수 있도록 준비되어야 합니다.\(SHOULD\)

위에서 언급한 것처럼 고유 이름은 속성으로 구성됩니다. 이 사양은 이름에 나타날 수 있는 속성 유형 집합을 제한하지 않습니다. 그러나 준수 구현은 아래에 정의된 속성 유형 집합을 포함하는 발급자 이름이 있는 인증서를 수신하도록 준비해야 합니다\(MUST\). 이 사양은 추가 속성 유형에 대한 지원을 권장합니다.\(MUST\)

표준 속성 세트는 X.500 사양 \[X.520\] 시리즈에 정의되어 있습니다. 이 사양의 구현은 발행자 및 주체\(섹션 4.1.2.6\) 이름에서 다음 표준 속성 유형을 수신하도록 준비되어야 합니다.\(MUST\)

\* 국가,

- \* 조직, \* 조직 단위, \* 고유 이름 한정자, \* 시/도 이름, \* 일반 이름\(예: "Susan Housley"\) 및 \* 일련 번호.

또한, 이 사양의 구현은 발급자 및 주체 이름에서 다음 표준 속성 유형을 수신하도록 준비되어야 합니다.\(SHOULD\)

\* 지역,

- \* 직위, \* 성, \* 이름, \* 이니셜, \* 가명 및 \* 세대 한정자\(예: "Jr.", "3rd" 또는 "IV"\).

이러한 속성 유형에 대한 구문 및 관련 개체 식별자\(OID\)는 부록 A의 ASN.1 모듈에 제공됩니다.

또한, 이 사양의 구현은 \[RFC 2247\]에 정의된 대로 domainComponent 속성을 수신하도록 준비되어야 합니다. DNS\(Domain Name System\)는 계층적 리소스 레이블 지정 시스템을 제공합니다. 이 속성은 DNS 이름과 유사한 DN을 사용하려는 조직에 편리한 메커니즘을 제공합니다. 이는 dNSName 구성 요소를 대체하지 않습니다.\(MUST\)

대체 이름 필드. 구현에서는 이러한 이름을 DNS 이름으로 변환할 필요가 없습니다. 이 속성 유형에 대한 구문 및 관련 OID는 부록 A의 ASN.1 모듈에 제공됩니다.

인증서 사용자는 인증 경로 유효성 검사\(섹션 6\)를 위한 이름 체인을 수행하기 위해 발급자 고유 이름 및 주체 고유 이름\(섹션 4.1.2.6\) 필드를 처리할 준비를 해야 합니다. 이름 체인화는 한 인증서의 발급자 고유 이름을 CA 인증서의 주체 이름과 일치시켜 수행됩니다.\(MUST\)

이 사양에는 X.500 사양 시리즈에 지정된 이름 비교 기능의 하위 집합만 필요합니다. 다음 이름 비교 규칙을 구현하려면 준수 구현이 필요합니다.\(MUST\)

```text
      (a)  attribute values encoded in different types (e.g.,
      PrintableString and BMPString) MAY be assumed to represent
      different strings;

      (b) attribute values in types other than PrintableString are case
      sensitive (this permits matching of attribute values as binary
      objects);
```

- \(c\) PrintableString의 속성 값은 대소문자를 구분하지 않습니다\(예: "Marianne Swanson"은 "MARIANNE SWANSON"과 동일합니다\). 그리고

- \(d\) PrintableString의 속성 값은 선행 및 후행 공백을 제거하고 하나 이상의 연속 공백 문자의 내부 하위 문자열을 단일 공백으로 변환한 후 비교됩니다.

이러한 이름 비교 규칙을 통해 인증서 사용자는 자신에게 익숙하지 않은 언어나 인코딩을 사용하여 발급된 인증서의 유효성을 검사할 수 있습니다.

또한, 이 사양의 구현은 이러한 비교 규칙을 사용하여 이름 연결에 대한 익숙하지 않은 속성 유형을 처리할 수 있습니다. 이를 통해 구현에서는 발급자 이름에 익숙하지 않은 속성이 있는 인증서를 처리할 수 있습니다.\(MAY\)

X.500 사양 시리즈에 정의된 비교 규칙은 고유 이름으로 데이터를 인코딩하는 데 사용되는 문자 집합이 관련이 없음을 나타냅니다. 문자 자체는 인코딩과 관계없이 비교됩니다. 이 프로필의 구현에서는 X.500 시리즈에 정의된 비교 알고리즘을 사용할 수 있습니다. 이러한 구현은 위에 지정된 알고리즘에 의해 인식되는 이름 일치의 상위 집합을 인식합니다.

---
#### **4.1.2.5  Validity**

인증서 유효 기간은 CA가 인증서 상태에 대한 정보를 유지함을 보증하는 기간입니다. 필드는 인증서 유효 기간이 시작되는 날짜\(notBefore\)와 인증서 유효 기간이 끝나는 날짜\(notAfter\)라는 두 날짜의 SEQUENCE로 표시됩니다. notBefore와 notAfter는 모두 UTCTime 또는 GeneralizedTime으로 인코딩될 수 있습니다.

이 프로필을 준수하는 CA는 항상 2049년까지 인증서 유효 날짜를 UTCTime으로 인코딩해야 합니다. 2050년 이후의 인증서 유효 날짜는 GeneralizedTime으로 인코딩되어야 합니다.\(MUST\)

인증서의 유효 기간은 notBefore부터 notAfter까지의 기간입니다.

---
##### **4.1.2.5.1  UTCTime**

표준시 유형인 UTCTime은 날짜 및 시간 표시를 위한 표준 ASN.1 유형입니다. UTCTime은 두 개의 하위 숫자를 통해 연도를 지정하고 시간은 1분 또는 1초의 정밀도로 지정됩니다. UTCTime에는 Z\(Zulu 또는 그리니치 표준시\) 또는 시차가 포함됩니다.

이 프로필의 목적을 위해 UTCTime 값은 그리니치 표준시\(Zulu\)로 표현되어야 하며 초 수가 0인 경우에도 초를 포함해야 합니다\(즉, 시간은 YYMMDDHHMMSSZ임\). 준수 시스템은 연도 필드\(YY\)를 다음과 같이 해석해야 합니다.\(MUST, MUST\)

- YY가 50보다 크거나 같은 경우 연도는 19YY로 해석됩니다. 그리고\(MUST\)

- YY가 50보다 작은 경우 연도는 20YY로 해석됩니다.\(MUST\)

---
##### **4.1.2.5.2  GeneralizedTime**

일반화된 시간 유형인 GeneralizedTime은 시간의 가변 정밀도 표현을 위한 표준 ASN.1 유형입니다. 선택적으로 GeneralizedTime 필드에는 현지 표준시와 그리니치 표준시 간의 시간 차이 표현이 포함될 수 있습니다.

이 프로필의 목적을 위해 GeneralizedTime 값은 그리니치 표준시\(Zulu\)로 표현되어야 하며 초 수가 0인 경우에도 초를 포함해야 합니다\(즉, 시간은 YYYYMMDDHHMMSSZ임\). GeneralizedTime 값은 소수 초를 포함해서는 안 됩니다.\(MUST, MUST NOT\)

---
#### **4.1.2.6  Subject**

제목 필드는 제목 공개 키 필드에 저장된 공개 키와 연관된 엔터티를 식별합니다. 제목 이름은 제목 필드 및/또는 subjectAltName 확장에 포함될 수 있습니다. 주제가 CA인 경우\(예: 4.2.1.10에서 논의된 기본 제약 확장이 존재하고 cA 값이 TRUE인 경우\) 주제 필드는 CA의 내용과 일치하는 비어 있지 않은 고유 이름으로 채워져야 합니다. 주체 CA가 발급한 모든 인증서의 발급자 필드\(섹션 4.1.2.4\). 주체가 CRL 발급자인 경우\(예: 4.2.1.3에서 설명한 키 사용 확장이 존재하고 cRLSign 값이 TRUE인 경우\) 주체 필드는 내용과 일치하는 비어 있지 않은 고유 이름으로 채워져야 합니다. 주제 CRL 발급자가 발급한 모든 CRL의 발급자 필드\(섹션 4.1.2.4\). 주체 이름 지정 정보가 subjectAltName 확장\(예: 이메일 주소 또는 URI에만 바인딩된 키\)에만 존재하는 경우 주체 이름은 빈 시퀀스여야 하며 subjectAltName 확장은 중요해야 합니다\(MUST\).\(MAY, MUST, MUST, MUST\)

비어 있지 않은 경우 제목 필드에는 X.500 고유 이름\(DN\)이 포함되어야 합니다. DN은 발급자 이름 필드에 정의된 대로 하나의 CA에서 인증한 각 주체 엔터티에 대해 고유해야 합니다. CA는 동일한 주체 엔터티에 대해 동일한 DN을 가진 두 개 이상의 인증서를 발급할 수 있습니다.\(MUST, MUST, MAY\)

주체 이름 필드는 X.501 유형의 이름으로 정의됩니다. 이 필드에 대한 구현 요구 사항은 발급자 필드\(섹션 4.1.2.4\)에 대해 정의된 요구 사항입니다. DirectoryString 유형의 속성 값을 인코딩할 때 발행자 필드에 대한 인코딩 규칙을 구현해야 합니다. 이 사양의 구현은 발급자 필드에 필요한 속성 유형이 포함된 주체 이름을 수신하도록 준비되어야 합니다. 이 사양의 구현은 발급자 필드에 권장되는 속성 유형이 포함된 주체 이름을 수신할 준비를 해야 합니다. 이러한 속성 유형에 대한 구문 및 관련 개체 식별자\(OID\)는 부록 A의 ASN.1 모듈에 제공됩니다. 이 사양의 구현에서는 이러한 비교 규칙을 사용하여 익숙하지 않은 속성 유형\(예: 이름 연결\)을 처리할 수 있습니다. 이를 통해 구현에서는 주체 이름에 익숙하지 않은 속성이 있는 인증서를 처리할 수 있습니다.\(MUST, MUST, SHOULD, MAY\)

또한 RFC 822 이름이 주체 고유 이름에 EmailAddress 속성으로 포함된 레거시 구현이 존재합니다. EmailAddress의 속성 값은 PrintableString 문자 세트의 일부가 아닌 문자 '@'의 포함을 허용하는 IA5String 유형입니다. EmailAddress 속성 값은 대소문자를 구분하지 않습니다\(예: "fanfeedback@redsox.com"은 "FANFEEDBACK@REDSOX.COM"과 동일함\).

전자 메일 주소로 새 인증서를 생성하는 구현을 준수하는 경우 이러한 ID를 설명하기 위해 주체 대체 이름 필드\(섹션 4.2.1.7\)에서 rfc822Name을 사용해야 합니다. 레거시 구현을 지원하기 위해 주체 고유 이름에 EmailAddress 속성을 동시에 포함하는 것은 더 이상 사용되지 않지만 허용됩니다.\(MUST\)

---
#### **4.1.2.7  Subject Public Key Info**

이 필드는 공개 키를 전달하고 키가 사용되는 알고리즘\(예: RSA, DSA 또는 Diffie-Hellman\)을 식별하는 데 사용됩니다. 알고리즘은 섹션 4.1.1.2에 지정된 AlgorithmIdentifier 구조를 사용하여 식별됩니다. 지원되는 알고리즘에 대한 객체 식별자와 공개 키 자료\(공개 키 및 매개변수\)를 인코딩하는 방법은 \[PKIXALGS\]에 지정됩니다.

---
#### **4.1.2.8  Unique Identifiers**

이 필드는 버전이 2 또는 3인 경우에만 나타나야 합니다\(섹션 4.1.2.1\). 버전이 1인 경우 이러한 필드는 표시되어서는 안 됩니다. 주체 및 발급자 고유 식별자는 시간이 지남에 따라 주체 및/또는 발급자 이름의 재사용 가능성을 처리하기 위해 인증서에 존재합니다. 이 프로필은 이름이 다른 엔터티에 재사용되지 않고 인터넷 인증서가 고유 식별자를 사용하지 않을 것을 권장합니다. 이 프로필을 준수하는 CA는 고유 식별자가 있는 인증서를 생성해서는 안 됩니다. 이 프로필을 준수하는 애플리케이션은 고유 식별자를 구문 분석할 수 있어야 합니다.\(MUST, MUST NOT, SHOULD NOT, SHOULD\)

---
#### **4.1.2.9  Extensions**

이 필드는 버전이 3\(섹션 4.1.2.1\)인 경우에만 나타나야 합니다. 존재하는 경우 이 필드는 하나 이상의 인증서 확장의 SEQUENCE입니다. 인터넷 PKI의 인증서 확장 형식과 내용은 섹션 4.2에 정의되어 있습니다.\(MUST\)

---
## **4.2  Certificate Extensions**

X.509 v3 인증서에 대해 정의된 확장은 추가 속성을 사용자 또는 공개 키와 연결하고 인증 계층을 관리하는 방법을 제공합니다. X.509 v3 인증서 형식을 사용하면 커뮤니티에서 해당 커뮤니티에 고유한 정보를 전달하는 개인 확장 기능을 정의할 수도 있습니다. 인증서의 각 확장은 중요 또는 중요하지 않음으로 지정됩니다. 시스템을 사용하는 인증서는 인식할 수 없는 중요한 확장이 발견되면 인증서를 거부해야 합니다. 그러나 중요하지 않은 확장은 인식되지 않으면 무시될 수 있습니다. 다음 섹션에서는 인터넷 내에서 사용되는 권장 확장을 제시합니다.\(MUST\)

정보를 위한 인증서 및 표준 위치. 커뮤니티는 추가 확장 기능을 사용하도록 선택할 수 있습니다. 그러나 일반적인 상황에서 사용을 방해할 수 있는 인증서의 중요한 확장을 채택할 때는 주의를 기울여야 합니다.

각 확장에는 OID와 ASN.1 구조가 포함됩니다. 확장이 인증서에 나타나면 OID는 extnID 필드로 나타나고 해당 ASN.1 인코딩 구조는 옥텟 문자열 extnValue의 값입니다. 인증서에는 특정 확장의 인스턴스가 두 개 이상 포함되어서는 안 됩니다. 예를 들어, 인증서에는 하나의 기관 키 식별자 확장\(섹션 4.2.1.1\)만 포함될 수 있습니다. 확장에는 기본값이 FALSE인 부울 임계값이 포함됩니다. 각 확장에 대한 텍스트는 중요 필드에 허용되는 값을 지정합니다.\(MUST NOT\)

준수 CA는 키 식별자\(섹션 4.2.1.1 및 4.2.1.2\), 기본 제약 조건\(섹션 4.2.1.10\), 키 사용\(섹션 4.2.1.3\) 및 인증서 정책\(섹션 4.2.1.5\) 확장을 지원해야 합니다. CA가 주체 필드에 대해 빈 시퀀스로 인증서를 발급하는 경우 CA는 주체 대체 이름 확장\(섹션 4.2.1.7\)을 지원해야 합니다. 나머지 확장에 대한 지원은 선택사항입니다. 준수 CA는 이 사양 내에서 식별되지 않은 확장을 지원할 수 있습니다. 인증서 발급자는 이러한 확장을 중요로 표시하면 상호 운용성이 저하될 수 있다는 점에 주의해야 합니다.\(MUST, MUST, MAY, MAY\)

최소한 이 프로필을 준수하는 애플리케이션은 키 사용\(섹션 4.2.1.3\), 인증서 정책\(섹션 4.2.1.5\), 주체 대체 이름\(섹션 4.2.1.7\), 기본 제약 조건\(섹션 4.2. 1.10\), 이름 제약 조건\(섹션 4.2.1.11\), 정책 제약 조건\(섹션 4.2.1.12\), 확장 키 사용\(섹션 4.2.1.13\) 및 모든 정책 금지\(섹션 4.2.1.15\).\(MUST\)

또한 이 프로필을 준수하는 애플리케이션은 권한 및 주체 키 식별자\(섹션 4.2.1.1 및 4.2.1.2\)와 정책 매핑\(섹션 4.2.1.6\) 확장을 인식해야 합니다.\(SHOULD\)

---
### **4.2.1  Standard Extensions**

이 섹션에서는 인터넷 PKI에서 사용하기 위해 \[X.509\]에 정의된 표준 인증서 확장을 식별합니다. 각 확장은 \[X.509\]에 정의된 OID와 연관됩니다. 이러한 OID는 다음과 같이 정의되는 id-ce 아크의 구성원입니다.

```text
   id-ce   OBJECT IDENTIFIER ::=  { joint-iso-ccitt(2) ds(5) 29 }
```

---
#### **4.2.1.1  Authority Key Identifier**

기관 키 식별자 확장은 인증서 서명에 사용된 개인 키에 해당하는 공개 키를 식별하는 수단을 제공합니다. 이 확장은 발급자가 여러 개의 서명 키를 가지고 있는 경우\(여러 개의 동시 키 쌍 또는 전환으로 인해\) 사용됩니다. 식별은 키 식별자\(발급자 인증서의 주체 키 식별자\) 또는 발급자 이름 및 일련 번호를 기반으로 할 수 있습니다.\(MAY\)

AuthorityKeyIdentifier 확장의 keyIdentifier 필드는 인증 경로 구성을 용이하게 하기 위해 CA를 준수하여 생성된 모든 인증서에 포함되어야 합니다. 한 가지 예외가 있습니다. CA가 "자체 서명" 인증서 형식으로 공개 키를 배포하는 경우 기관 키 식별자는 생략될 수 있습니다. 자체 서명된 인증서의 서명은 인증서의 주체 공개 키와 연결된 개인 키를 사용하여 생성됩니다. \(이는 발급자가 공개키와 개인키를 모두 보유하고 있음을 증명합니다.\) 이 경우 주체키 식별자와 권한키 식별자는 동일하지만, 인증 경로 구축에는 주체키 식별자만 필요합니다.\(MUST, MAY\)

keyIdentifier 필드의 값은 인증서의 서명을 확인하는 데 사용되는 공개 키 또는 고유한 값을 생성하는 방법에서 파생되어야 합니다. 공개 키에서 키 식별자를 생성하는 두 가지 일반적인 방법과 고유 값을 생성하는 한 가지 일반적인 방법이 섹션 4.2.1.2에 설명되어 있습니다. 키 식별자가 이전에 설정되지 않은 경우 이 사양에서는 keyIdentifier를 생성하기 위해 이러한 방법 중 하나를 사용할 것을 권장합니다. 키 식별자가 이전에 설정된 경우 CA는 이전에 설정된 식별자를 사용해야 합니다.\(SHOULD, SHOULD\)

이 프로필은 모든 인증서 사용자가 키 식별자 방법을 지원할 것을 권장합니다.

이 확장은 중요로 표시되어서는 안 됩니다.\(MUST NOT\)

```text
   id-ce-authorityKeyIdentifier OBJECT IDENTIFIER ::=  { id-ce 35 }

   AuthorityKeyIdentifier ::= SEQUENCE {
      keyIdentifier             [0] KeyIdentifier           OPTIONAL,
      authorityCertIssuer       [1] GeneralNames            OPTIONAL,
      authorityCertSerialNumber [2] CertificateSerialNumber OPTIONAL  }

   KeyIdentifier ::= OCTET STRING
```

---
#### **4.2.1.2  Subject Key Identifier**

주체 키 식별자 확장은 특정 공개 키가 포함된 인증서를 식별하는 수단을 제공합니다.

인증 경로 구성을 용이하게 하기 위해 이 확장은 모든 준수 CA 인증서, 즉 cA 값이 TRUE인 기본 제약 확장\(섹션 4.2.1.10\)을 포함하는 모든 인증서에 나타나야 합니다. 주체 키 식별자의 값은 이 인증서의 주체가 발행한 인증서의 기관 키 식별자 확장\(섹션 4.2.1.1\)의 키 식별자 필드에 있는 값이어야 합니다.\(MUST, MUST\)

CA 인증서의 경우 주체 키 식별자는 공개 키 또는 고유한 값을 생성하는 방법에서 파생되어야 합니다. 공개 키에서 키 식별자를 생성하는 두 가지 일반적인 방법은 다음과 같습니다.\(SHOULD\)

- \(1\) keyIdentifier는 BIT STRING subjectPublicKey 값의 160비트 SHA-1 해시로 구성됩니다\(태그, 길이 및 사용되지 않은 비트 수 제외\).

- \(2\) keyIdentifier는 값 0100과 BIT STRING subjectPublicKey 값의 SHA-1 해시 중 최하위 60비트가 뒤따르는 4비트 유형 필드로 구성됩니다\(태그, 길이 및 사용되지 않은 키 수 제외\). 비트 문자열 비트\).

고유한 값을 생성하는 일반적인 방법 중 하나는 단조롭게 증가하는 정수 시퀀스입니다.

최종 엔터티 인증서의 경우 주체 키 식별자 확장은 애플리케이션에 사용되는 특정 공개 키가 포함된 인증서를 식별하는 수단을 제공합니다. 최종 엔터티가 특히 여러 CA로부터 여러 인증서를 얻은 경우 주체 키 식별자는 특정 공개 키가 포함된 인증서 집합을 신속하게 식별하는 수단을 제공합니다. 애플리케이션이 적절한 최종 엔터티 인증서를 식별하는 데 도움을 주기 위해 이 확장은 모든 최종 엔터티 인증서에 포함되어야 합니다.\(SHOULD\)

최종 엔터티 인증서의 경우 주체 키 식별자는 공개 키에서 파생되어야 합니다. 공개 키에서 키 식별자를 생성하는 두 가지 일반적인 방법은 위에서 식별되었습니다.\(SHOULD\)

키 식별자가 이전에 설정되지 않은 경우 이 사양에서는 keyIdentifier를 생성하기 위해 이러한 방법 중 하나를 사용할 것을 권장합니다. 키 식별자가 이전에 설정된 경우 CA는 이전에 설정된 식별자를 사용해야 합니다.\(SHOULD\)

이 확장은 중요로 표시되어서는 안 됩니다.\(MUST NOT\)

```text
   id-ce-subjectKeyIdentifier OBJECT IDENTIFIER ::=  { id-ce 14 }

   SubjectKeyIdentifier ::= KeyIdentifier
```

---
#### **4.2.1.3  Key Usage**

키 사용 확장은 인증서에 포함된 키의 목적\(예: 암호화, 서명, 인증서 서명\)을 정의합니다. 둘 이상의 작업에 사용할 수 있는 키를 제한하려는 경우 사용 제한을 사용할 수 있습니다. 예를 들어 RSA 키를 공개 키 인증서 및 CRL이 아닌 개체의 서명을 확인하는 데에만 사용해야 하는 경우 digitalSignature 및/또는 nonRepudiation 비트가 어설션됩니다. 마찬가지로 RSA 키를 키 관리에만 사용해야 하는 경우 keyEncipherment 비트가 어설션됩니다.

이 확장은 다른 공개 키 인증서 또는 CRL의 디지털 서명을 검증하는 데 사용되는 공개 키가 포함된 인증서에 나타나야 합니다. 이 확장이 나타나면 중요로 표시되어야 합니다.\(MUST, SHOULD\)

```text
      id-ce-keyUsage OBJECT IDENTIFIER ::=  { id-ce 15 }

      KeyUsage ::= BIT STRING {
           digitalSignature        (0),
           nonRepudiation          (1),
           keyEncipherment         (2),
           dataEncipherment        (3),
           keyAgreement            (4),
           keyCertSign             (5),
           cRLSign                 (6),
           encipherOnly            (7),
           decipherOnly            (8) }
```

KeyUsage 유형의 비트는 다음과 같이 사용됩니다.

- 인증서 서명\(비트 5\) 또는 CRL 서명\(비트 6\) 이외의 보안 서비스를 지원하기 위해 주체 공개 키가 디지털 서명 메커니즘과 함께 사용될 때 digitalSignature 비트가 어설션됩니다. 디지털 서명 메커니즘은 무결성을 갖춘 엔터티 인증 및 데이터 출처 인증에 자주 사용됩니다.

- 부인 방지 비트는 서명 엔터티가 인증서 또는 CRL 서명을 제외한 일부 작업을 거짓으로 거부하는 것을 방지하는 부인 방지 서비스를 제공하는 데 사용되는 디지털 서명을 확인하는 데 주체 공개 키가 사용될 때 주장됩니다. 나중에 충돌이 발생하는 경우 신뢰할 수 있는 제3자가 서명된 데이터의 진위 여부를 확인할 수 있습니다.

digitalSignature와 Signature의 추가 차이점

- 부인 방지 비트는 특정 인증서 정책에 제공될 수 있습니다.

- 주체 공개 키가 키 전송에 사용될 때 keyEncipherment 비트가 어설션됩니다. 예를 들어 RSA 키를 키 관리에 사용하는 경우 이 비트가 설정됩니다.

- 주체 공개 키가 암호화 키 이외의 사용자 데이터를 암호화하는 데 사용될 때 dataEncipherment 비트가 어설션됩니다.

- keyAgreement 비트는 주체 공개키가 키 합의에 사용될 때 주장됩니다. 예를 들어 Diffie-Hellman 키를 키 관리에 사용하는 경우 이 비트가 설정됩니다.

- 주체 공개 키가 공개 키 인증서의 서명을 확인하는 데 사용될 때 keyCertSign 비트가 어설션됩니다. keyCertSign 비트가 주장되면 기본 제약 확장\(섹션 4.2.1.10\)의 cA 비트도 주장되어야 합니다.\(MUST\)

- 인증서 해지 목록\(예: CRL, 델타 CRL 또는 ARL\)의 서명을 확인하기 위해 주체 공개 키가 사용될 때 cRLSign 비트가 어설션됩니다. 이 비트는 CRL의 서명을 확인하는 데 사용되는 인증서에서 주장되어야 합니다.\(MUST\)

- keyAgreement 비트가 없으면 encipherOnly 비트의 의미가 정의되지 않습니다. encipherOnly 비트가 어설션되고 keyAgreement 비트도 설정된 경우 대상 공개키는 키 합의를 수행하는 동안 데이터 암호화에만 사용될 수 있습니다.

- keyAgreement 비트가 없으면 decipherOnly 비트의 의미가 정의되지 않습니다. decipherOnly 비트가 어설션되고 keyAgreement 비트도 설정된 경우 대상 공개 키는 키 합의를 수행하는 동안 데이터를 해독하는 데에만 사용될 수 있습니다.

이 프로필은 keyUsage 확장의 인스턴스화에 설정될 수 있는 비트 조합을 제한하지 않습니다. 그러나 특정 알고리즘에 대한 keyUsage 확장의 적절한 값은 \[PKIXALGS\]에 지정됩니다.

---
#### **4.2.1.4  Private Key Usage Period**

이 확장은 인터넷 PKI 내에서 사용되어서는 안 됩니다. 이 프로필을 준수하는 CA는 중요한 개인 키 사용 기간 연장을 포함하는 인증서를 생성해서는 안 됩니다.\(SHOULD NOT, MUST NOT\)

개인 키 사용 기간 연장을 통해 인증서 발급자는 개인 키에 대해 인증서와 다른 유효 기간을 지정할 수 있습니다. 이 확장은 디지털 서명 키와 함께 사용하기 위한 것입니다. 이 확장은 notBefore 및 notAfter라는 두 가지 선택적 구성 요소로 구성됩니다. 인증서와 관련된 개인 키는 두 구성 요소가 각각 지정한 시간 전후에 개체에 서명하는 데 사용되어서는 안 됩니다. 이 프로필을 준수하는 CA는 두 구성 요소 중 하나 이상이 존재하고 확장이 중요하지 않은 경우를 제외하고 개인 키 사용 기간 확장이 포함된 인증서를 생성해서는 안 됩니다.\(SHOULD NOT, MUST NOT\)

사용되는 경우 notBefore 및 notAfter는 GeneralizedTime으로 표시되며 섹션 4.1.2.5.2에 정의된 대로 지정되고 해석되어야 합니다.\(MUST\)

```text
   id-ce-privateKeyUsagePeriod OBJECT IDENTIFIER ::=  { id-ce 16 }

   PrivateKeyUsagePeriod ::= SEQUENCE {
        notBefore       [0]     GeneralizedTime OPTIONAL,
        notAfter        [1]     GeneralizedTime OPTIONAL }
```

---
#### **4.2.1.5  Certificate Policies**

인증서 정책 확장에는 하나 이상의 정책 정보 용어 시퀀스가 ​​포함되어 있으며, 각 정책 정보 용어는 OID\(객체 식별자\)와 선택적 한정자로 구성됩니다. 존재할 수 있는 선택적 한정자는 정책 정의를 변경하지 않을 것으로 예상됩니다.\(MAY\)

최종 엔터티 인증서에서 이러한 정책 정보 용어는 인증서가 발급된 정책과 인증서가 사용될 수 있는 목적을 나타냅니다. CA 인증서에서 이러한 정책 정보 용어는 이 인증서를 포함하는 인증 경로에 대한 정책 집합을 제한합니다. CA가 이 인증서를 포함하는 인증 경로에 대한 정책 집합을 제한하지 않으려면 {2 5 29 32 0 } 값을 사용하여 특수 정책 anyPolicy를 주장할 수 있습니다.\(MAY\)

특정 정책 요구 사항이 있는 응용 프로그램에는 허용할 정책 목록이 있고 인증서의 정책 OID를 해당 목록과 비교할 것으로 예상됩니다. 이 확장이 중요한 경우 경로 유효성 검사 소프트웨어는 이 확장\(선택적 한정자 포함\)을 해석할 수 있거나 인증서를 거부해야 합니다\(MUST\).\(MUST\)

상호 운용성을 높이기 위해 이 프로필에서는 정책 정보 용어가 OID로만 구성되도록 권장합니다. OID만으로는 불충분한 경우 이 프로필에서는 한정자를 사용할 것을 강력히 권장합니다.

이 섹션에 명시된 항목으로 제한됩니다. 한정자가 특별 정책 anyPolicy와 함께 사용되는 경우 이 섹션에서 식별된 한정자로 제한되어야 합니다.\(MUST\)

이 사양은 인증서 정책 작성자와 인증서 발급자가 사용할 두 가지 정책 한정자 유형을 정의합니다. 한정자 유형은 CPS 포인터 및 사용자 알림 한정자입니다.

CPS 포인터 한정자에는 CA가 게시한 CPS\(인증 업무 기술서\)에 대한 포인터가 포함되어 있습니다. 포인터는 URI 형식입니다. 이 한정자에 대한 처리 요구 사항은 지역적 문제입니다. 확장에 대해 주장된 중요도 값에 관계없이 이 사양에서는 어떤 조치도 요구하지 않습니다.

사용자 알림은 인증서를 사용할 때 신뢰 당사자에게 표시하기 위한 것입니다. 애플리케이션 소프트웨어는 사용된 인증 경로의 모든 인증서에 있는 모든 사용자 알림을 표시해야 합니다. 단, 알림이 중복되는 경우 사본 하나만 표시하면 됩니다. 이러한 중복을 방지하려면 이 한정자는 최종 엔터티 인증서와 다른 조직에 발급된 CA 인증서에만 있어야 합니다.\(SHOULD, SHOULD\)

사용자 알림에는 두 가지 선택 필드\(noticeRef 필드와explicitText 필드\)가 있습니다.

공지사항 필드\(사용된 경우\)는 조직의 이름을 지정하고

- 해당 조직이 준비한 특정 텍스트 진술을 숫자로 식별합니다. 예를 들어 조직 "CertsRUs"와 공지 번호 1을 식별할 수 있습니다. 일반적인 구현에서 응용 프로그램 소프트웨어에는 CertsRU에 대한 현재 공지 세트가 포함된 공지 파일이 있습니다. 애플리케이션은 파일에서 알림 텍스트를 추출하여 표시합니다. 메시지는 다국어일 수 있으며, 이를 통해 소프트웨어는 자체 환경에 맞는 특정 언어 메시지를 선택할 수 있습니다.\(MAY\)

-explicitText 필드에는 인증서에 직접 텍스트 설명이 포함됩니다. explicitText 필드는 최대 크기가 200자인 문자열입니다.

주의사항Ref 및explicitText 옵션이 모두 하나의 한정자에 포함되어 있고 응용 프로그램 소프트웨어가 주의사항Ref 옵션에 의해 표시된 주의사항 텍스트를 찾을 수 있는 경우 해당 텍스트가 표시되어야 합니다. 그렇지 않으면,explicitText 문자열이 표시되어야 합니다.\(SHOULD\)

참고:explicitText의 최대 크기는 200자이지만 일부 비준수 CA는 이 제한을 초과합니다. 따라서 인증서 사용자는 200자가 넘는 명시적 텍스트를 적절하게 처리해야 합니다.\(SHOULD\)

```text
   id-ce-certificatePolicies OBJECT IDENTIFIER ::=  { id-ce 32 }

   anyPolicy OBJECT IDENTIFIER ::= { id-ce-certificate-policies 0 }
```

CertificatePolicies ::= 정책 정보의 시퀀스 크기\(1..MAX\)

```text
   PolicyInformation ::= SEQUENCE {
        policyIdentifier   CertPolicyId,
        policyQualifiers   SEQUENCE SIZE (1..MAX) OF
                                PolicyQualifierInfo OPTIONAL }

   CertPolicyId ::= OBJECT IDENTIFIER

   PolicyQualifierInfo ::= SEQUENCE {
        policyQualifierId  PolicyQualifierId,
        qualifier          ANY DEFINED BY policyQualifierId }
```

-- 인터넷 정책 한정자를 위한policyQualifierIds

```text
   id-qt          OBJECT IDENTIFIER ::=  { id-pkix 2 }
   id-qt-cps      OBJECT IDENTIFIER ::=  { id-qt 1 }
   id-qt-unotice  OBJECT IDENTIFIER ::=  { id-qt 2 }

   PolicyQualifierId ::=
        OBJECT IDENTIFIER ( id-qt-cps | id-qt-unotice )

   Qualifier ::= CHOICE {
        cPSuri           CPSuri,
        userNotice       UserNotice }

   CPSuri ::= IA5String

   UserNotice ::= SEQUENCE {
        noticeRef        NoticeReference OPTIONAL,
        explicitText     DisplayText OPTIONAL}

   NoticeReference ::= SEQUENCE {
        organization     DisplayText,
        noticeNumbers    SEQUENCE OF INTEGER }

   DisplayText ::= CHOICE {
        ia5String        IA5String      (SIZE (1..200)),
        visibleString    VisibleString  (SIZE (1..200)),
        bmpString        BMPString      (SIZE (1..200)),
        utf8String       UTF8String     (SIZE (1..200)) }
```

---
#### **4.2.1.6  Policy Mappings**

이 확장은 CA 인증서에 사용됩니다. 하나 이상의 OID 쌍을 나열합니다. 각 쌍에는 issuerDomainPolicy와 subjectDomainPolicy가 포함되어 있습니다. 페어링은 발급 CA가 IssuerDomainPolicy를 주체 CA의 subjectDomainPolicy와 동일하다고 간주함을 나타냅니다.

발급 CA의 사용자는 특정 애플리케이션에 대해 issuerDomainPolicy를 수락할 수 있습니다. 정책 매핑은 issuerDomainPolicy와 비교할 수 있는 것으로 허용될 수 있는 주체 CA와 관련된 정책 목록을 정의합니다.

정책 매핑 확장에 명명된 각 issuerDomainPolicy는 동일한 인증서의 인증서 정책 확장에서도 주장되어야 합니다. 정책은 특수 값 anyPolicy\(섹션 4.2.1.5\)에 매핑되어서는 안 됩니다.\(SHOULD, SHOULD NOT\)

이 확장은 CA 및/또는 애플리케이션에서 지원될 수 있으며 중요하지 않아야 합니다\(MUST\).\(MUST\)

```text
   id-ce-policyMappings OBJECT IDENTIFIER ::=  { id-ce 33 }

   PolicyMappings ::= SEQUENCE SIZE (1..MAX) OF SEQUENCE {
        issuerDomainPolicy      CertPolicyId,
        subjectDomainPolicy     CertPolicyId }
```

---
#### **4.2.1.7  Subject Alternative Name**

주체 대체 이름 확장을 사용하면 추가 ID를 인증서 주체에 바인딩할 수 있습니다. 정의된 옵션에는 인터넷 전자 메일 주소, DNS 이름, IP 주소 및 URI\(Uniform Resource Identifier\)가 포함됩니다. 완전히 로컬 정의를 포함하여 다른 옵션도 존재합니다. 여러 이름 형식과 각 이름 형식의 여러 인스턴스가 포함될 수 있습니다. 이러한 ID를 인증서에 바인딩할 때마다 주체 대체 이름\(또는 발급자 대체 이름\) 확장을 사용해야 합니다. 그러나 DNS 이름은 섹션 4.1.2.4에 설명된 대로 domainComponent 속성을 사용하여 제목 필드에 표시될 수 있습니다.\(MAY, MUST\)

주체 대체 이름은 공개 키에 확실히 바인딩된 것으로 간주되므로 주체 대체 이름의 모든 부분은 CA에서 확인되어야 합니다.\(MUST\)

또한 인증서에 포함된 유일한 주체 신원이 대체 이름 형식\(예: 전자 메일 주소\)인 경우 주체 고유 이름은 비어 있어야 하며\(빈 시퀀스\)\(MUST\)

subjectAltName 확장이 있어야 합니다. 제목 필드에 빈 시퀀스가 ​​포함된 경우 subjectAltName 확장은 중요로 표시되어야 합니다.\(MUST, MUST\)

subjectAltName 확장에 인터넷 메일 주소가 포함된 경우 주소는 rfc822Name으로 포함되어야 합니다. rfc822Name의 형식은 RFC 822 \[RFC 822\]에 정의된 "addr-spec"입니다. addr-spec의 형식은 "local-part@domain"입니다. addr-spec에는 앞에 문구\(예: 일반 이름\)가 없고 뒤에 주석\(괄호로 묶인 텍스트\)이 없으며 "<" 및 "\>"로 둘러싸여 있지 않습니다. RFC 822 addr-spec에서는 대문자와 소문자가 허용되지만 대소문자에 아무런 의미가 없습니다.\(MUST\)

subjectAltName 확장에 iPAddress가 포함된 경우 주소는 RFC 791 \[RFC 791\]에 지정된 대로 "네트워크 바이트 순서"로 옥텟 문자열에 저장되어야 합니다. 각 옥텟의 최하위 비트\(LSB\)는 네트워크 주소에서 해당 바이트의 LSB입니다. RFC 791에 지정된 대로 IP 버전 4의 경우 옥텟 문자열은 정확히 4개의 옥텟을 포함해야 합니다. IP 버전 6의 경우 RFC 1883에 지정된 대로 옥텟 문자열은 정확히 16개의 옥텟을 포함해야 합니다\[RFC 1883\].\(MUST, MUST, MUST\)

subjectAltName 확장에 도메인 이름 시스템 레이블이 포함된 경우 도메인 이름은 dNSName\(IA5String\)에 저장되어야 합니다. 이름은 RFC 1034 \[RFC 1034\]에 지정된 대로 "기본 이름 구문"에 있어야 합니다. 도메인 이름에는 대문자와 소문자가 허용되지만 대소문자에 아무런 의미도 부여되지 않습니다. 또한 문자열 " "은 합법적인 도메인 이름이지만 dNSName이 " "인 subjectAltName 확장자는 사용하면 안 됩니다. 마지막으로 인터넷 메일 주소에 대한 DNS 표현\(wpolk@nist.gov 대신 wpolk.nist.gov\)을 사용해서는 안 됩니다. 이러한 ID는 rfc822Name으로 인코딩됩니다.\(MUST, MUST, MUST NOT, MUST NOT\)

참고: 현재 국제 문자 집합으로 도메인 이름을 지정하는 작업이 진행 중입니다. 이러한 이름은 IA5String에서 수용되지 않을 가능성이 높습니다. 이 작업이 완료되면 이 프로필을 다시 검토하고 적절한 기능이 추가될 것입니다.

subjectAltName 확장에 URI가 포함되어 있는 경우 이름은uniformResourceIdentifier\(IA5String\)에 저장되어야 합니다. 이름은 상대 URL이 아니어야 하며 \[RFC 1738\]에 지정된 URL 구문 및 인코딩 규칙을 따라야 합니다. 이름에는 구성표\(예: "http" 또는 "ftp"\)와 구성표별 부분이 모두 포함되어야 합니다. 스키마별 부분에는 호스트로서 정규화된 도메인 이름 또는 IP 주소가 포함되어야 합니다.\(MUST, MUST NOT, MUST, MUST\)

\[RFC 1738\]에 지정된 대로 체계 이름은 대소문자를 구분하지 않습니다\(예: "http"는 "HTTP"와 동일함\). 호스트 부분도 대소문자를 구분하지 않지만 구성표별 부분의 다른 구성 요소는 대소문자를 구분할 수 있습니다. URI를 비교할 때, 준수 구현은 대소문자에 관계없이 체계와 호스트를 비교해야 하지만 체계별 부분의 나머지 부분은 대소문자를 구분한다고 가정합니다.\(MUST\)

subjectAltName 확장이 DirectoryName에 DN을 포함하는 경우 DN은 발급자 이름 필드에 정의된 대로 하나의 CA에서 인증한 각 주체 엔터티에 대해 고유해야 합니다. CA는 동일한 주체 엔터티에 대해 동일한 DN을 가진 두 개 이상의 인증서를 발급할 수 있습니다.\(MUST, MAY\)

subjectAltName은 otherName 필드를 사용하여 추가 이름 유형을 전달할 수 있습니다. 이름의 형식과 의미는 type-id 필드의 OBJECT IDENTIFIER를 통해 표시됩니다. 이름 자체는 otherName의 값 필드로 전달됩니다. 예를 들어, Kerberos \[RFC 1510\] 형식 이름은 Kerberos 5 주체 이름 OID와 영역 및 PrincipalName의 SEQUENCE를 사용하여 otherName으로 인코딩될 수 있습니다.\(MAY\)

주체 대체 이름은 섹션 4.2.1.11에 설명된 이름 제약 확장을 사용하여 주체 고유 이름과 동일한 방식으로 제한될 수 있습니다.\(MAY\)

subjectAltName 확장이 있는 경우 시퀀스에는 최소한 하나의 항목이 포함되어야 합니다. 제목 필드와 달리, 준수 CA는 빈 GeneralName 필드가 포함된 subjectAltNames가 있는 인증서를 발급해서는 안 됩니다. 예를 들어 rfc822Name은 IA5String으로 표시됩니다. 빈 문자열은 유효한 IA5String이지만 이러한 rfc822Name은 이 프로필에서 허용되지 않습니다. 인증 경로를 처리할 때 이러한 인증서를 발견하는 클라이언트의 동작은 이 프로필에 의해 정의되지 않습니다.\(MUST, MUST NOT\)

마지막으로, 와일드카드 문자\(예: 이름 집합에 대한 자리 표시자\)를 포함하는 주체 대체 이름의 의미는 이 사양에서 다루지 않습니다. 특정 요구 사항이 있는 애플리케이션은 이러한 이름을 사용할 수 있지만 의미를 정의해야 합니다.\(MAY\)

```text
   id-ce-subjectAltName OBJECT IDENTIFIER ::=  { id-ce 17 }

   SubjectAltName ::= GeneralNames
```

GeneralNames ::= GeneralName의 시퀀스 크기\(1..MAX\)

```text
   GeneralName ::= CHOICE {
        otherName                       [0]     OtherName,
        rfc822Name                      [1]     IA5String,
        dNSName                         [2]     IA5String,
        x400Address                     [3]     ORAddress,
        directoryName                   [4]     Name,
        ediPartyName                    [5]     EDIPartyName,
        uniformResourceIdentifier       [6]     IA5String,
        iPAddress                       [7]     OCTET STRING,
        registeredID                    [8]     OBJECT IDENTIFIER }

   OtherName ::= SEQUENCE {
        type-id    OBJECT IDENTIFIER,
        value      [0] EXPLICIT ANY DEFINED BY type-id }

   EDIPartyName ::= SEQUENCE {
        nameAssigner            [0]     DirectoryString OPTIONAL,
        partyName               [1]     DirectoryString }
```

---
#### **4.2.1.8  Issuer Alternative Names**

4.2.1.7과 마찬가지로 이 확장은 인터넷 스타일 ID를 인증서 발급자와 연결하는 데 사용됩니다. 발급자 대체 이름은 4.2.1.7과 같이 인코딩되어야 합니다.\(MUST\)

존재하는 경우 이 확장은 중요로 표시되어서는 안 됩니다.\(SHOULD NOT\)

```text
   id-ce-issuerAltName OBJECT IDENTIFIER ::=  { id-ce 18 }

   IssuerAltName ::= GeneralNames
```

---
#### **4.2.1.9  Subject Directory Attributes**

주체 디렉토리 속성 확장은 주체의 식별 속성\(예: 국적\)을 전달하는 데 사용됩니다. 확장은 하나 이상의 속성의 시퀀스로 정의됩니다. 이 확장은 중요하지 않아야 합니다.\(MUST\)

```text
   id-ce-subjectDirectoryAttributes OBJECT IDENTIFIER ::=  { id-ce 9 }
```

SubjectDirectoryAttributes ::= SEQUENCE SIZE \(1..MAX\) OF 속성

---
#### **4.2.1.10  Basic Constraints**

기본 제약 조건 확장은 인증서의 주체가 CA인지 여부와 이 인증서를 포함하는 유효한 인증 경로의 최대 깊이를 식별합니다.

cA 부울은 인증된 공개 키가 CA에 속하는지 여부를 나타냅니다. CA 부울이 주장되지 않으면 키 사용 확장의 keyCertSign 비트가 주장되어서는 안 됩니다.\(MUST NOT\)

pathLenConstraint 필드는 cA 부울이 주장되고 키 사용 확장이 keyCertSign 비트\(섹션 4.2.1.3\)를 주장하는 경우에만 의미가 있습니다. 이 경우 유효한 인증 경로에서 이 인증서를 따를 수 있는 자체 발급되지 않은 중간 인증서의 최대 수를 제공합니다. 제목 및 발급자 필드에 나타나는 DN이 ​​동일하고 비어 있지 않으면 인증서가 자체 발급됩니다. \(참고: 인증 경로의 마지막 인증서는 중간 인증서가 아니며 이 제한에 포함되지 않습니다. 일반적으로 마지막 인증서는 최종 엔터티 인증서이지만 CA 인증서일 수도 있습니다.\) pathLenConstraint가 0이면 다음을 나타냅니다. 유효한 인증 경로에는 인증서가 하나만 더 올 수 있습니다. 나타나는 경우 pathLenConstraint 필드는 0보다 크거나 같아야 합니다. pathLenConstraint가 나타나지 않는 경우에는 제한이 적용되지 않습니다.\(MUST\)

이 확장은 인증서의 디지털 서명을 검증하는 데 사용되는 공개 키를 포함하는 모든 CA 인증서에서 중요한 확장으로 표시되어야 합니다. 이 확장은 인증서의 디지털 서명 유효성 검사 이외의 목적으로만 사용되는 공개 키를 포함하는 CA 인증서에서 중요하거나 중요하지 않은 확장으로 나타날 수 있습니다. 이러한 CA 인증서에는 CRL의 디지털 서명을 검증하는 데만 사용되는 공개 키가 포함된 인증서와 인증서 등록 프로토콜에 사용되는 키 관리 공개 키가 포함된 인증서가 포함됩니다. 이 확장은 최종 엔터티 인증서에서 중요하거나 중요하지 않은 확장으로 나타날 수 있습니다.\(MUST, MAY, MAY\)

CA는 CA 부울이 주장되고 키 사용 확장이 keyCertSign 비트를 주장하지 않는 한 pathLenConstraint 필드를 포함해서는 안 됩니다.\(MUST NOT\)

```text
   id-ce-basicConstraints OBJECT IDENTIFIER ::=  { id-ce 19 }

   BasicConstraints ::= SEQUENCE {
        cA                      BOOLEAN DEFAULT FALSE,
        pathLenConstraint       INTEGER (0..MAX) OPTIONAL }
```

---
#### **4.2.1.11  Name Constraints**

CA 인증서에서만 사용해야 하는 이름 제약 확장은 인증 경로에 있는 후속 인증서의 모든 주체 이름이 위치해야 하는 네임스페이스를 나타냅니다. 제한 사항은 주체 고유 이름에 적용되고 주체 대체 이름에도 적용됩니다. 제한사항은 다음과 같은 경우에만 적용됩니다.\(MUST\)

지정된 이름 형식이 존재합니다. 인증서에 해당 유형의 이름이 없으면 인증서가 허용됩니다.

발급자와 주체가 동일한 인증서에는 이름 제약 조건이 적용되지 않습니다\(인증서가 경로의 최종 인증서가 아닌 경우\). \(이렇게 하면 이름 제약 조건을 사용하는 CA가 자체 발급 인증서를 사용하여 키 롤오버를 구현하는 것을 방지할 수 있습니다.\)

제한사항은 허용되거나 제외된 이름 하위 트리 측면에서 정의됩니다. ExceptSubtrees 필드의 제한 사항과 일치하는 모든 이름은 allowedSubtrees에 나타나는 정보에 관계없이 유효하지 않습니다. 이 확장은 반드시 중요해야 합니다.\(MUST\)

이 프로필 내에서 최소 및 최대 필드는 어떤 이름 형식에도 사용되지 않으므로 최소값은 0이어야 하고 최대값은 없어야 합니다\(MUST\).\(MUST\)

URI의 경우 제약조건은 이름의 호스트 부분에 적용됩니다. 제약조건은 호스트나 도메인을 지정할 수 있습니다. 예를 들면 "foo.bar.com"입니다. 및 ".xyz.com". 제약 조건이 마침표로 시작되면 하나 이상의 하위 도메인으로 확장될 수 있습니다. 즉, 제약 조건 ".xyz.com"은 abc.xyz.com과 abc.def.xyz.com 모두에서 충족됩니다. 그러나 ".xyz.com" 제약조건은 "xyz.com"에 의해 충족되지 않습니다. 제약 조건이 마침표로 시작하지 않으면 호스트를 지정합니다.\(MAY, MAY\)

인터넷 메일 주소에 대한 이름 제약은 특정 메일함, 특정 호스트의 모든 주소 또는 도메인의 모든 메일함을 지정할 수 있습니다. 특정 사서함을 나타내기 위한 제약 조건은 전체 메일 주소입니다. 예를 들어 "root@xyz.com"은 "xyz.com" 호스트의 루트 사서함을 나타냅니다. 특정 호스트의 모든 인터넷 메일 주소를 나타내기 위해 제약 조건은 호스트 이름으로 지정됩니다. 예를 들어, "xyz.com" 제약조건은 "xyz.com" 호스트의 모든 메일 주소에 의해 충족됩니다. 도메인 내의 주소를 지정하려면 URI와 마찬가지로 선행 마침표를 사용하여 제약 조건을 지정합니다. 예를 들어, ".xyz.com"은 "xyz.com" 도메인의 모든 인터넷 메일 주소를 나타내지만 호스트 "xyz.com"의 인터넷 메일 주소는 아닙니다.\(MAY\)

DNS 이름 제한은 foo.bar.com으로 표현됩니다. 이름 왼쪽에 간단히 추가하여 구성할 수 있는 모든 DNS 이름은 이름 제약 조건을 충족합니다. 예를 들어, www.foo.bar.com은 제약 조건을 충족하지만 foo1.bar.com은 그렇지 않습니다.

RFC 822 이름이 EmailAddress\(섹션 4.1.2.6\) 유형 속성의 주제 고유 이름에 포함된 레거시 구현이 존재합니다. rfc822 이름이 제한되어 있지만

인증서에 주체 대체 이름이 포함되어 있지 않으면 rfc822 이름 제약 조건이 주체 고유 이름의 EmailAddress 유형 속성에 적용되어야 합니다. EmailAddress에 대한 ASN.1 구문과 해당 OID는 부록 A에 제공됩니다.\(MUST\)

디렉토리 이름 형식의 제한 사항은 인증서의 제목 필드와 디렉토리 이름 유형의 subjectAltName 확장에 적용되어야 합니다. x400Address 형식의 제한 사항은 x400Address 유형의 subjectAltName 확장에 적용되어야 합니다.\(MUST, MUST\)

DirectoryName 형식의 제한 사항을 적용할 때 구현에서는 DN 속성을 비교해야 합니다. 최소한 구현은 섹션 4.1.2.4에 지정된 DN 비교 규칙을 수행해야 합니다. DirectoryName 형식의 제한이 있는 인증서를 발급하는 CA는 전체 ISO DN 이름 비교 알고리즘의 구현에 의존해서는 안 됩니다. 이는 이름 제한이 제목 필드 또는 subjectAltName 확장에 사용된 인코딩과 동일하게 명시되어야 함을 의미합니다.\(MUST, MUST, SHOULD NOT, MUST\)

iPAddress의 구문은 특히 이름 제약 조건에 대해 다음 추가 사항을 포함하여 섹션 4.2.1.7에 설명된 것과 같아야 합니다. IPv4 주소의 경우, GeneralName의 ipAddress 필드는 주소 범위\[RFC 1519\]를 나타내기 위해 RFC 1519\(CIDR\) 스타일로 인코딩된 8개의 옥텟을 포함해야 합니다. IPv6 주소의 경우 ipAddress 필드는 유사하게 인코딩된 32옥텟을 포함해야 합니다. 예를 들어 "클래스 C" 서브넷 10.9.8.0에 대한 이름 제약 조건은 CIDR 표기법 10.9.8.0/255.255.255.0을 나타내는 옥텟 0A 09 08 00 FF FF FF 00으로 표시됩니다.\(MUST, MUST, MUST\)

otherName, ediPartyName 및 RegisteredID에 대한 이름 제약 조건의 구문 및 의미는 이 사양에서 정의되지 않습니다.

```text
      id-ce-nameConstraints OBJECT IDENTIFIER ::=  { id-ce 30 }

      NameConstraints ::= SEQUENCE {
           permittedSubtrees       [0]     GeneralSubtrees OPTIONAL,
           excludedSubtrees        [1]     GeneralSubtrees OPTIONAL }
```

- GeneralSubtrees ::= GeneralSubtree의 시퀀스 크기\(1..MAX\)

```text
      GeneralSubtree ::= SEQUENCE {
           base                    GeneralName,
           minimum         [0]     BaseDistance DEFAULT 0,
           maximum         [1]     BaseDistance OPTIONAL }

      BaseDistance ::= INTEGER (0..MAX)
```

---
#### **4.2.1.12  Policy Constraints**

정책 제약 확장은 CA에 발급된 인증서에 사용될 수 있습니다. 정책 제약 확장은 두 가지 방법으로 경로 유효성 검사를 제한합니다. 정책 매핑을 금지하거나 경로의 각 인증서에 허용 가능한 정책 식별자가 포함되도록 요구하는 데 사용할 수 있습니다.

InhibitPolicyMapping 필드가 있는 경우 값은 정책 매핑이 더 이상 허용되지 않기 전에 경로에 나타날 수 있는 추가 인증서 수를 나타냅니다. 예를 들어, 값 1은 정책 매핑이 이 인증서의 주체가 발급한 인증서에서 처리될 수 있지만 경로의 추가 인증서에서는 처리될 수 없음을 나타냅니다.

requireExplicitPolicy 필드가 있는 경우 requireExplicitPolicy 값은 전체 경로에 대해 명시적 정책이 필요하기 전에 경로에 나타날 수 있는 추가 인증서 수를 나타냅니다. 명시적인 정책이 필요한 경우 경로의 모든 인증서는 인증서 정책 확장에 허용 가능한 정책 식별자를 포함해야 합니다. 허용 가능한 정책 식별자는 인증 경로의 사용자가 요구하는 정책 식별자 또는 정책 매핑을 통해 동등하다고 선언된 정책 식별자입니다.

준수 CA는 정책 제약 조건이 빈 시퀀스인 인증서를 발행해서는 안 됩니다. 즉,hibitPolicyMapping 필드 또는 requireExplicitPolicy 필드 중 적어도 하나가 존재해야 합니다. 빈 정책 제약 조건 필드가 나타나는 클라이언트의 동작은 이 프로필에서 다루어지지 않습니다.\(MUST NOT, MUST\)

이 확장은 중요하거나 중요하지 않을 수 있습니다.\(MAY\)

```text
   id-ce-policyConstraints OBJECT IDENTIFIER ::=  { id-ce 36 }

   PolicyConstraints ::= SEQUENCE {
        requireExplicitPolicy           [0] SkipCerts OPTIONAL,
        inhibitPolicyMapping            [1] SkipCerts OPTIONAL }

   SkipCerts ::= INTEGER (0..MAX)
```

---
#### **4.2.1.13  Extended Key Usage**

이 확장은 키 사용 확장에 표시된 기본 목적에 추가로 또는 대신하여 인증된 공개 키를 사용할 수 있는 하나 이상의 목적을 나타냅니다. 일반적으로 이 확장은 최종 엔터티 인증서에만 나타납니다. 이 확장은 다음과 같이 정의됩니다.

```text
   id-ce-extKeyUsage OBJECT IDENTIFIER ::= { id-ce 37 }
```

ExtKeyUsageSyntax ::= KeyPurposeId의 시퀀스 크기\(1..MAX\)

```text
   KeyPurposeId ::= OBJECT IDENTIFIER
```

주요 목적은 필요한 모든 조직에서 정의할 수 있습니다. 키 목적을 식별하는 데 사용되는 객체 식별자는 IANA 또는 ITU-T 권고사항 X.660 \[X.660\]에 따라 할당되어야 합니다.\(MUST\)

이 확장은 인증서 발급자의 선택에 따라 중요하거나 중요하지 않을 수 있습니다.\(MAY\)

확장이 있는 경우 인증서는 표시된 목적 중 하나로만 사용해야 합니다. 여러 목적이 표시된 경우 의도된 목적이 존재하는 한 애플리케이션은 표시된 모든 목적을 인식할 필요가 없습니다. 애플리케이션을 사용하는 인증서는 해당 애플리케이션에 인증서가 허용되도록 하기 위해 특정 목적이 표시되도록 요구할 수 있습니다.\(MUST, MAY\)

CA가 이러한 애플리케이션을 충족하기 위해 확장 키 사용을 포함하지만 키 사용을 제한하지 않으려는 경우 CA는 특수 keyPurposeID anyExtendedKeyUsage를 포함할 수 있습니다. anyExtendedKeyUsage keyPurposeID가 존재하는 경우 확장은 중요하지 않아야 합니다.\(SHOULD NOT\)

인증서에 키 사용 확장과 확장된 키 사용 확장이 모두 포함되어 있는 경우 두 확장은 모두 독립적으로 처리되어야 하며 인증서는 두 확장과 일치하는 목적으로만 사용해야 합니다. 두 확장 모두와 일치하는 목적이 없으면 인증서를 어떤 목적으로도 사용해서는 안 됩니다.\(MUST, MUST NOT\)

다음과 같은 주요 사용 목적이 정의됩니다.

```text
   anyExtendedKeyUsage OBJECT IDENTIFIER ::= { id-ce-extKeyUsage 0 }

   id-kp OBJECT IDENTIFIER ::= { id-pkix 3 }

   id-kp-serverAuth             OBJECT IDENTIFIER ::= { id-kp 1 }
   -- TLS WWW server authentication
   -- Key usage bits that may be consistent: digitalSignature,
   -- keyEncipherment or keyAgreement

   id-kp-clientAuth             OBJECT IDENTIFIER ::= { id-kp 2 }
   -- TLS WWW client authentication
   -- Key usage bits that may be consistent: digitalSignature
   -- and/or keyAgreement

   id-kp-codeSigning             OBJECT IDENTIFIER ::= { id-kp 3 }
   -- Signing of downloadable executable code
   -- Key usage bits that may be consistent: digitalSignature

   id-kp-emailProtection         OBJECT IDENTIFIER ::= { id-kp 4 }
   -- E-mail protection
   -- Key usage bits that may be consistent: digitalSignature,
   -- nonRepudiation, and/or (keyEncipherment or keyAgreement)

   id-kp-timeStamping            OBJECT IDENTIFIER ::= { id-kp 8 }
   -- Binding the hash of an object to a time
   -- Key usage bits that may be consistent: digitalSignature
   -- and/or nonRepudiation

   id-kp-OCSPSigning            OBJECT IDENTIFIER ::= { id-kp 9 }
   -- Signing OCSP responses
   -- Key usage bits that may be consistent: digitalSignature
   -- and/or nonRepudiation
```

---
#### **4.2.1.14  CRL Distribution Points**

CRL 배포 지점 확장은 CRL 정보를 얻는 방법을 식별합니다. 확장은 중요하지 않아야 하지만 이 프로필은 CA 및 애플리케이션에서 이 확장을 지원할 것을 권장합니다. CRL 관리에 대한 추가 논의는 섹션 5에 포함되어 있습니다.\(SHOULD\)

cRLDistributionPoints 확장은 DistributionPoint의 SEQUENCE입니다. DistributionPoint는 distributionPoint, 이유 및 cRLIssuer의 세 가지 필드로 구성되며 각 필드는 선택 사항입니다. 이러한 각 필드는 선택 사항이지만 DistributionPoint는 이유 필드로만 구성되어서는 안 됩니다. distributionPoint 또는 cRLIssuer가 있어야 합니다. 인증서 발급자가 CRL 발급자가 아닌 경우 cRLIssuer 필드가 있어야 하며 CRL 발급자의 이름을 포함해야 합니다. 인증서 발급자가 CRL 발급자이기도 한 경우 cRLIssuer 필드는 생략되어야 하며 distributionPoint 필드는 반드시 존재해야 합니다. distributionPoint 필드가 생략된 경우 cRLIssuer가 있어야 하며 CRL이 있는 X.500 또는 LDAP 디렉터리 항목에 해당하는 이름을 포함해야 합니다.\(MUST NOT, MUST, MUST, MUST\)

distributionPoint 필드가 있는 경우 일반 이름의 SEQUENCE 또는 단일 값 nameRelativeToCRLIssuer가 포함됩니다. cRLDistributionPoints 확장에 URI 유형의 일반 이름이 포함되어 있는 경우 다음 의미 체계를 가정해야 합니다. URI는 관련 이유로 인해 현재 CRL에 대한 포인터이며 관련 cRLIssuer에 의해 발급됩니다. URI의 예상 값은 4.2.1.7에 정의된 값입니다. 다른 값에 대한 처리 규칙은 이 사양에서 정의되지 않습니다.\(MUST\)

DistributionPointName에 여러 값이 포함된 경우 각 이름은 동일한 CRL을 얻기 위한 서로 다른 메커니즘을 설명합니다. 예를 들어, LDAP와 HTTP를 통해 동일한 CRL을 검색하는 데 사용할 수 있습니다.

DistributionPointName에 단일 값 nameRelativeToCRLIssuer가 포함되어 있는 경우 해당 값은 고유 이름 조각을 제공합니다. 배포 지점 이름을 얻기 위해 CRL 발급자의 X.500 고유 이름에 조각이 추가됩니다. DistributionPoint에 cRLIssuer 필드가 있으면 이름 조각이 포함된 고유 이름에 추가됩니다. 그렇지 않으면 이름 조각이 인증서 발급자 고유 이름에 추가됩니다. cRLIssuer에 둘 이상의 고유 이름이 포함된 경우 DistributionPointName은 nameRealtiveToCRLIssuer 대안을 사용해서는 안 됩니다.\(MUST NOT\)

DistributionPoint가 이유 필드를 생략하는 경우 CRL은 모든 이유에 대한 해지 정보를 포함해야 합니다.\(MUST\)

cRLIssuer는 CRL에 서명하고 발급하는 엔터티를 식별합니다. 존재하는 경우 cRLIssuer는 최소한 하나의 X.500 고유 이름\(DN\)을 포함해야 하며 다른 이름 형식도 포함할 수 있습니다. cRLIssuer는 CRL 발급자 이름과 비교되므로 X.501 유형 이름은 인증서의 발급자 이름 필드에 대한 인코딩 규칙을 따라야 합니다\(섹션 4.1.2.4\).\(MUST, MUST\)

```text
   id-ce-cRLDistributionPoints OBJECT IDENTIFIER ::=  { id-ce 31 }
```

CRLDistributionPoints ::= DistributionPoint의 시퀀스 크기\(1..MAX\)

```text
   DistributionPoint ::= SEQUENCE {
        distributionPoint       [0]     DistributionPointName OPTIONAL,
        reasons                 [1]     ReasonFlags OPTIONAL,
        cRLIssuer               [2]     GeneralNames OPTIONAL }

   DistributionPointName ::= CHOICE {
        fullName                [0]     GeneralNames,
        nameRelativeToCRLIssuer [1]     RelativeDistinguishedName }

   ReasonFlags ::= BIT STRING {
        unused                  (0),
        keyCompromise           (1),
        cACompromise            (2),
        affiliationChanged      (3),
        superseded              (4),
        cessationOfOperation    (5),
        certificateHold         (6),
        privilegeWithdrawn      (7),
        aACompromise            (8) }
```

---
#### **4.2.1.15  Inhibit Any-Policy**

모든 정책 금지 확장은 CA에 발급된 인증서에 사용될 수 있습니다. Inhibit any-policy는 값이 { 2 5 29 32 0 }인 특수 anyPolicy OID가 다른 인증서 정책과 명시적으로 일치하는 것으로 간주되지 않음을 나타냅니다. 값은 anyPolicy가 더 이상 허용되지 않기 전에 경로에 나타날 수 있는 추가 인증서 수를 나타냅니다. 예를 들어 값 1은 anyPolicy가 이 인증서의 주체가 발급한 인증서에서 처리될 수 있지만 경로의 추가 인증서에서는 처리될 수 없음을 나타냅니다.

이 확장은 반드시 중요해야 합니다.\(MUST\)

```text
   id-ce-inhibitAnyPolicy OBJECT IDENTIFIER ::=  { id-ce 54 }

   InhibitAnyPolicy ::= SkipCerts

   SkipCerts ::= INTEGER (0..MAX)
```

---
#### **4.2.1.16  Freshest CRL (a.k.a. Delta CRL Distribution Point)**

최신 CRL 확장은 델타 CRL 정보를 얻는 방법을 식별합니다. 확장은 중요하지 않아야 합니다. CRL 관리에 대한 추가 논의는 섹션 5에 포함되어 있습니다.\(MUST\)

이 확장과 cRLDistributionPoints 확장에 동일한 구문이 사용되며 섹션 4.2.1.14에 설명되어 있습니다. 두 확장 모두에 동일한 규칙이 적용됩니다.

```text
   id-ce-freshestCRL OBJECT IDENTIFIER ::=  { id-ce 46 }

   FreshestCRL ::= CRLDistributionPoints
```

---
### **4.2.2  Private Internet Extensions**

이 섹션에서는 인터넷 공개 키 인프라에서 사용할 두 가지 확장을 정의합니다. 이러한 확장은 응용 프로그램을 발급 CA 또는 주제에 대한 온라인 정보로 안내하는 데 사용될 수 있습니다. 정보는 여러 형식으로 제공될 수 있으므로 각 확장은 각각 URI를 나타내는 IA5String 값의 시퀀스입니다. URI는 정보의 위치와 형식, 정보를 얻는 방법을 암시적으로 지정합니다.

개인 확장에 대해 개체 식별자가 정의됩니다. 개인 확장과 연관된 객체 식별자는 arc id-pkix 내의 arc id-pe 아래에 정의됩니다. 인터넷 PKI에 대해 정의된 향후 확장도 arc id-pe 아래에 정의될 것으로 예상됩니다.

```text
      id-pkix  OBJECT IDENTIFIER  ::=
               { iso(1) identified-organization(3) dod(6) internet(1)
                       security(5) mechanisms(5) pkix(7) }

      id-pe  OBJECT IDENTIFIER  ::=  { id-pkix 1 }
```

---
#### **4.2.2.1  Authority Information Access**

기관정보 접근 확장은 확장이 나타나는 인증서 발급자의 CA 정보 및 서비스에 접근하는 방법을 나타낸다. 정보 및 서비스에는 온라인 검증 서비스 및 CA 정책 데이터가 포함될 수 있습니다. \(CRL의 위치는 이 확장에 지정되지 않습니다. 해당 정보는 cRLDistributionPoints 확장에 의해 제공됩니다.\) 이 확장은 최종 엔터티 또는 CA 인증서에 포함될 수 있으며 중요하지 않아야 합니다.\(MUST\)

```text
   id-pe-authorityInfoAccess OBJECT IDENTIFIER ::= { id-pe 1 }
```

AuthorityInfoAccessSyntax ::=

- 액세스 설명의 시퀀스 크기\(1..MAX\)

```text
   AccessDescription  ::=  SEQUENCE {
           accessMethod          OBJECT IDENTIFIER,
           accessLocation        GeneralName  }

   id-ad OBJECT IDENTIFIER ::= { id-pkix 48 }

   id-ad-caIssuers OBJECT IDENTIFIER ::= { id-ad 2 }

   id-ad-ocsp OBJECT IDENTIFIER ::= { id-ad 1 }
```

AuthorityInfoAccessSyntax 시퀀스의 각 항목은 이 확장이 나타나는 인증서를 발급한 CA에서 제공하는 추가 정보의 형식과 위치를 설명합니다. 정보의 유형과 형식은 accessMethod 필드에 의해 지정됩니다. accessLocation 필드는 정보의 위치를 ​​지정합니다. 검색 메커니즘은 accessMethod에 의해 암시되거나 accessLocation에 의해 지정될 수 있습니다.

이 프로필은 id-ad-caIssuers 및 id-ad-ocsp라는 두 가지 accessMethod OID를 정의합니다.

id-ad-caIssuers OID는 이 확장이 포함된 인증서를 발급한 CA보다 상위에 있는 인증서를 발급한 CA를 추가 정보에 나열할 때 사용됩니다. 참조된 CA 발급자 설명은 인증서 사용자가 인증서 사용자가 신뢰하는 지점에서 종료되는 인증 경로를 선택하는 데 도움을 주기 위한 것입니다.

id-ad-caIssuers가 accessMethod로 나타나면 accessLocation 필드는 참조된 설명 서버와 참조된 설명을 얻기 위한 액세스 프로토콜을 설명합니다. accessLocation 필드는 여러 형식을 취할 수 있는 GeneralName으로 정의됩니다. http, ftp 또는 ldap을 통해 정보를 사용할 수 있는 경우 accessLocation은uniformResourceIdentifier여야 합니다. DAP\(디렉터리 액세스 프로토콜\)를 통해 정보를 사용할 수 있는 경우 accessLocation은 반드시 디렉토리 이름이어야 합니다. 해당 디렉토리 이름 항목의 crossCertificatePair 속성에 CA 인증서가 포함되어 있습니다. 전자 메일을 통해 정보를 사용할 수 있는 경우 accessLocation은 rfc822Name이어야 합니다. 다른 id-ad-caIssuers accessLocation 이름 형식의 의미는 정의되지 않습니다.\(MUST, MUST, MUST\)

id-ad-ocsp OID는 이 확장이 포함된 인증서에 대한 해지 정보가 온라인 인증서 상태 프로토콜\(OCSP\) \[RFC 2560\]을 사용하여 제공될 때 사용됩니다.

id-ad-ocsp가 accessMethod로 나타나는 경우 accessLocation 필드는 \[RFC 2560\]에 정의된 규칙을 사용하는 OCSP 응답자의 위치입니다.

추가 액세스 설명자는 다른 PKIX 사양에서 정의될 수 있습니다.

---
#### **4.2.2.2  Subject Information Access**

주체정보 접근 확장자는 확장자가 나타나는 인증서의 주체에 대한 정보 및 서비스에 접근하는 방법을 나타낸다. 주체가 CA인 경우 정보 및 서비스에는 인증서 유효성 검사 서비스 및 CA 정책이 포함될 수 있습니다.

데이터. 주체가 최종 엔터티인 경우 정보는 제공되는 서비스 유형과 해당 서비스에 액세스하는 방법을 설명합니다. 이 경우 이 확장의 내용은 지원되는 서비스의 프로토콜 사양에 정의되어 있습니다. 이 확장은 주체 또는 CA 인증서에 포함될 수 있으며 중요하지 않아야 합니다.\(MUST\)

```text
   id-pe-subjectInfoAccess OBJECT IDENTIFIER ::= { id-pe 11 }
```

SubjectInfoAccessSyntax ::=

- 액세스 설명의 시퀀스 크기\(1..MAX\)

```text
   AccessDescription  ::=  SEQUENCE {
           accessMethod          OBJECT IDENTIFIER,
           accessLocation        GeneralName  }
```

SubjectInfoAccessSyntax 시퀀스의 각 항목은 이 확장이 나타나는 인증서의 제목이 제공하는 추가 정보의 형식과 위치를 설명합니다. 정보의 유형과 형식은 accessMethod 필드에 의해 지정됩니다. accessLocation 필드는 정보의 위치를 ​​지정합니다. 검색 메커니즘은 accessMethod에 의해 암시되거나 accessLocation에 의해 지정될 수 있습니다.

이 프로파일은 주체가 CA일 때 사용할 액세스 방법과 주체가 최종 엔터티일 때 사용할 액세스 방법을 정의합니다. 향후 다른 서비스의 프로토콜 사양에서 추가적인 액세스 방법이 정의될 수 있습니다.

id-ad-caRepository OID는 주체가 CA일 때 사용되며 해당 인증서와 CRL\(발행된 경우\)을 저장소에 게시합니다. accessLocation 필드는 여러 형식을 취할 수 있는 GeneralName으로 정의됩니다. http, ftp 또는 ldap을 통해 정보를 사용할 수 있는 경우 accessLocation은uniformResourceIdentifier여야 합니다. 디렉터리 액세스 프로토콜\(dap\)을 통해 정보를 사용할 수 있는 경우 accessLocation은 반드시 디렉터리 이름이어야 합니다. 전자 메일을 통해 정보를 사용할 수 있는 경우 accessLocation은 rfc822Name이어야 합니다. accessLocation의 다른 이름 형식\(accessMethod가 id-ad-caRepository인 경우\)의 의미는 이 사양에서 정의되지 않습니다.\(MUST, MUST, MUST\)

id-ad-timeStamping OID는 주체가 \[PKIXTSA\]에 정의된 타임 스탬프 프로토콜을 사용하여 타임 스탬프 서비스를 제공할 때 사용됩니다. http 또는 ftp를 통해 타임스탬프 서비스를 사용할 수 있는 경우 accessLocation은uniformResourceIdentifier여야 합니다. 전자 메일을 통해 타임스탬프 서비스를 사용할 수 있는 경우 accessLocation은 rfc822Name이어야 합니다. 타임스탬프 서비스\(MUST, MUST\)

TCP/IP를 사용하여 사용할 수 있는 경우 dNSName 또는 ipAddress 이름 형식을 사용할 수 있습니다. accessLocation의 다른 이름 형식\(accessMethod가 id-ad-timeStamping인 경우\)의 의미는 이 사양에서 정의되지 않습니다.

추가 액세스 설명자는 다른 PKIX 사양에서 정의될 수 있습니다.

```text
   id-ad OBJECT IDENTIFIER ::= { id-pkix 48 }

   id-ad-caRepository OBJECT IDENTIFIER ::= { id-ad 5 }

   id-ad-timeStamping OBJECT IDENTIFIER ::= { id-ad 3 }
```

---
# **5  CRL and CRL Extensions Profile**

위에서 설명한 대로 이 X.509 v2 CRL 프로필의 목표 중 하나는 상호 운용 가능하고 재사용 가능한 인터넷 PKI 생성을 촉진하는 것입니다. 이 목표를 달성하기 위해 확장 사용에 대한 지침이 지정되고 CRL에 포함된 정보의 특성에 대한 몇 가지 가정이 이루어집니다.

CRL은 광범위한 상호 운용성 목표와 훨씬 더 광범위한 운영 및 보증 요구 사항을 포괄하는 광범위한 응용 프로그램 및 환경에서 사용될 수 있습니다. 이 프로필은 광범위한 상호 운용성을 요구하는 일반 애플리케이션에 대한 공통 기준을 설정합니다. 프로필은 모든 CRL에서 예상할 수 있는 정보 집합을 정의합니다. 또한 프로필은 자주 사용되는 속성에 대한 CRL 내 공통 위치와 이러한 속성에 대한 공통 표현을 정의합니다.

CRL 발급자는 CRL을 발급합니다. 일반적으로 CRL 발급자는 CA입니다. CA는 CRL을 게시하여 자신이 발급한 인증서에 대한 상태 정보를 제공합니다. 그러나 CA는 이 책임을 다른 신뢰할 수 있는 기관에 위임할 수 있습니다. CRL 발급자가 인증서를 발급한 CA가 아닐 때마다 CRL을 간접 CRL이라고 합니다.

각 CRL에는 특정 범위가 있습니다. CRL 범위는 특정 CRL에 나타날 수 있는 인증서 집합입니다. 예를 들어 범위는 "CA X에서 발급한 모든 인증서", "CA X에서 발급한 모든 CA 인증서", "키 손상 및 CA 손상으로 인해 취소된 CA X에서 발급한 모든 인증서"일 수 있습니다. "Boulder에 위치한 NIST 직원에게 발급된 모든 인증서"와 같은 임의의 지역 정보를 기반으로 한 인증서 세트입니다.

완전한 CRL은 해당 범위 내에서 CRL 범위에 포함된 해지 이유 중 하나로 인해 해지된 만료되지 않은 모든 인증서를 나열합니다. CRL 발급자는 델타 CRL을 생성할 수도 있습니다. 델타 CRL은 해당 범위 내에서 참조된 전체 CRL 발행 이후 해지 상태가 변경된 인증서만 나열합니다. 참조된 전체 CRL을 기본 CRL이라고 합니다. 델타 CRL의 범위는 참조하는 기본 CRL과 동일해야 합니다.\(MAY, MUST\)

이 프로필은 개인 인터넷 CRL 확장이나 CRL 항목 확장을 정의하지 않습니다.

추가 또는 특수 목적 요구 사항이 있는 환경에서는 이 프로필을 기반으로 구축하거나 대체할 수 있습니다.

다른 해지 또는 인증서 상태 메커니즘이 제공되는 경우 준수 CA는 CRL을 발급할 필요가 없습니다. CRL이 발행되면 CRL은 버전 2 CRL이어야 하며 nextUpdate 필드\(섹션 5.1.2.5\)에 다음 CRL이 발행될 날짜를 포함하고 CRL 번호 확장\(섹션 5.2.3\)을 포함하며 다음을 포함해야 합니다. 기관 키 식별자 확장\(섹션 5.2.1\). CRL을 지원하는 애플리케이션을 준수하려면 하나의 CA에서 발급한 모든 인증서에 대한 해지 정보를 제공하는 버전 1 및 버전 2 전체 CRL을 모두 처리해야 합니다. 델타 CRL, 간접 CRL 또는 하나의 CA에서 발급한 모든 인증서 이외의 범위를 가진 CRL의 처리를 지원하기 위해 적합한 응용 프로그램이 필요하지 않습니다.\(MUST, MUST, MUST\)

---
## **5.1  CRL Fields**

X.509 v2 CRL 구문은 다음과 같습니다. 서명 계산을 위해 서명할 데이터는 ASN.1 DER로 인코딩됩니다. ASN.1 DER 인코딩은 각 요소에 대한 태그, 길이, 값 인코딩 시스템입니다.

```text
   CertificateList  ::=  SEQUENCE  {
        tbsCertList          TBSCertList,
        signatureAlgorithm   AlgorithmIdentifier,
        signatureValue       BIT STRING  }

   TBSCertList  ::=  SEQUENCE  {
        version                 Version OPTIONAL,
                                     -- if present, MUST be v2
        signature               AlgorithmIdentifier,
        issuer                  Name,
        thisUpdate              Time,
        nextUpdate              Time OPTIONAL,
        revokedCertificates     SEQUENCE OF SEQUENCE  {
             userCertificate         CertificateSerialNumber,
             revocationDate          Time,
             crlEntryExtensions      Extensions OPTIONAL
                                           -- if present, MUST be v2
                                  }  OPTIONAL,
        crlExtensions           [0]  EXPLICIT Extensions OPTIONAL
                                           -- if present, MUST be v2
                                  }
```

-- 버전, 시간, 인증서 일련 번호 및 확장자 -- 모두 섹션 4.1의 ASN.1에 정의되어 있습니다.

-- AlgorithmIdentifier는 섹션 4.1.1.2에 정의되어 있습니다.

다음 항목에서는 인터넷 PKI에서 X.509 v2 CRL을 사용하는 방법을 설명합니다.

---
### **5.1.1  CertificateList Fields**

CertificateList는 세 개의 필수 필드로 구성된 시퀀스입니다. 해당 필드는 다음 하위 섹션에 자세히 설명되어 있습니다.

---
#### **5.1.1.1  tbsCertList**

시퀀스의 첫 번째 필드는 tbsCertList입니다. 이 필드 자체는 발급자 이름, 발급 날짜, 다음 목록의 발급 날짜, 해지된 인증서의 선택적 목록 및 선택적 CRL 확장을 포함하는 시퀀스입니다. 해지된 인증서가 없으면 해지된 인증서 목록이 없습니다. 하나 이상의 인증서가 해지되면 해지된 인증서 목록의 각 항목은 사용자 인증서 일련 번호, 해지 날짜 및 선택적 CRL 항목 확장의 순서로 정의됩니다.

---
#### **5.1.1.2  signatureAlgorithm**

SignatureAlgorithm 필드에는 CRL 발급자가 CertificateList에 서명하는 데 사용하는 알고리즘에 대한 알고리즘 식별자가 포함되어 있습니다. 필드는 섹션 4.1.1.2에 정의된 AlgorithmIdentifier 유형입니다. \[PKIXALGS\]에는 이 사양에 대해 지원되는 알고리즘이 나열되어 있지만 다른 서명 알고리즘도 지원될 수 있습니다.\(MAY\)

이 필드는 tbsCertList 시퀀스\(섹션 5.1.2.2\)의 서명 필드와 동일한 알고리즘 식별자를 포함해야 합니다.\(MUST\)

---
#### **5.1.1.3  signatureValue**

SignatureValue 필드에는 ASN.1 DER로 인코딩된 tbsCertList에 따라 계산된 디지털 서명이 포함되어 있습니다. ASN.1 DER로 인코딩된 tbsCertList는 서명 기능에 대한 입력으로 사용됩니다. 이 서명 값은 BIT STRING으로 인코딩되며 CRL SignatureValue 필드에 포함됩니다. 이 프로세스의 세부 사항은 \[PKIXALGS\]에서 지원되는 각 알고리즘에 대해 지정됩니다.

CRL 발급자이기도 한 CA는 하나의 개인 키를 사용하여 인증서 및 CRL에 디지털 서명하거나 별도의 개인 키를 사용하여 인증서 및 CRL에 디지털 서명할 수 있습니다. 별도의 개인 키가 사용되는 경우 이러한 개인 키와 연결된 각 공개 키는 별도의 인증서에 배치됩니다. 하나는 키 사용 확장에 keyCertSign 비트가 설정되어 있고 다른 하나는 키 사용 확장에 cRLSign 비트가 설정되어 있습니다\(섹션 4.2.1.3\). 별도의 개인 키가 사용되는 경우 CA에서 발급한 인증서에는 하나의 기관 키 식별자가 포함되고 해당 CRL에는 다른 기관 키 식별자가 포함됩니다. 인증서 서명 및 CRL 서명의 유효성 검사를 위해 별도의 CA 인증서를 사용하면 향상된 보안 특성을 제공할 수 있습니다. 그러나 이는 애플리케이션에 부담을 주고 상호 운용성을 제한할 수 있습니다. 많은 애플리케이션이 인증 경로를 구성한 다음 인증 경로의 유효성을 검사합니다\(섹션 6\). CRL 검사를 위해서는 CA의 CRL 서명 확인 인증서에 대해 별도의 인증 경로를 구성하고 확인해야 합니다. CRL 확인을 수행하는 애플리케이션은 인증서와 CRL이 동일한 CA 개인 키로 디지털 서명된 경우 인증 경로 유효성 검사를 지원해야 합니다. 이러한 애플리케이션은 인증서와 CRL이 다른 CA 개인 키를 사용하여 디지털 서명된 경우 인증 경로 유효성 검사를 지원해야 합니다.\(MAY, MUST, SHOULD\)

---
### **5.1.2  Certificate List "To Be Signed"**

서명할 인증서 목록 또는 TBSCertList는 필수 및 선택 필드의 시퀀스입니다. 필수 필드는 CRL 발급자, CRL 서명에 사용된 알고리즘, CRL이 발급된 날짜와 시간, CRL 발급자가 다음 CRL을 발급하는 날짜와 시간을 식별합니다.

선택 필드에는 해지된 인증서 및 CRL 확장 목록이 포함됩니다. 해지된 인증서 목록은 CA가 만료되지 않은 인증서를 해지하지 않은 경우를 지원하기 위한 선택 사항입니다.

발행했습니다. 프로필에서는 발행된 모든 CRL에서 CRL 번호 및 기관 키 식별자 CRL 확장을 사용하기 위해 CRL 발행자를 준수해야 합니다.

---
#### **5.1.2.1  Version**

이 선택적 필드는 인코딩된 CRL의 버전을 설명합니다. 이 프로필에서 요구하는 대로 확장이 사용되는 경우 이 필드가 있어야 하며 버전 2\(정수 값은 1\)를 지정해야 합니다.\(MUST\)

---
#### **5.1.2.2  Signature**

이 필드에는 CRL 서명에 사용된 알고리즘에 대한 알고리즘 식별자가 포함되어 있습니다. \[PKIXALGS\]는 인터넷 PKI에서 사용되는 가장 널리 사용되는 서명 알고리즘에 대한 OID를 나열합니다.

이 필드는 CertificateList 시퀀스\(섹션 5.1.1.2\)의 SignatureAlgorithm 필드와 동일한 알고리즘 식별자를 포함해야 합니다.\(MUST\)

---
#### **5.1.2.3  Issuer Name**

발급자 이름은 CRL에 서명하고 발급한 엔터티를 식별합니다. 발급자 ID는 발급자 이름 필드에 포함됩니다. 대체 이름 형식은 issuerAltName 확장\(섹션 5.2.2\)에도 나타날 수 있습니다. 발급자 이름 필드에는 X.500 고유 이름\(DN\)이 포함되어야 합니다. 발급자 이름 필드는 X.501 유형 이름으로 정의되며 인증서의 발급자 이름 필드에 대한 인코딩 규칙을 따라야 합니다\(섹션 4.1.2.4\).\(MUST, MUST\)

---
#### **5.1.2.4  This Update**

이 필드는 이 CRL의 발행 날짜를 나타냅니다. ThisUpdate는 UTCTime 또는 GeneralizedTime으로 인코딩될 수 있습니다.

이 프로필을 준수하는 CRL 발급자는 2049년까지 날짜에 대해 thisUpdate를 UTCTime으로 인코딩해야 합니다. 이 프로필을 준수하는 CRL 발급자는 2050년 이후 날짜에 대해 thisUpdate를 GeneralizedTime으로 인코딩해야 합니다.\(MUST, MUST\)

UTCTime으로 인코딩된 경우 thisUpdate는 섹션 4.1.2.5.1에 ​​정의된 대로 지정되고 해석되어야 합니다. GeneralizedTime으로 인코딩된 경우 thisUpdate는 섹션 4.1.2.5.2에 정의된 대로 지정되고 해석되어야 합니다.\(MUST, MUST\)

---
#### **5.1.2.5  Next Update**

이 필드는 다음 CRL이 발행되는 날짜를 나타냅니다. 다음 CRL은 지정된 날짜 이전에 발행될 수 있지만 지정된 날짜 이후에는 발행되지 않습니다. CRL 발급자는 이전의 모든 CRL과 같거나 이후의 nextUpdate 시간으로 CRL을 발급해야 합니다. nextUpdate는 UTCTime 또는 GeneralizedTime으로 인코딩될 수 있습니다.\(SHOULD\)

이 프로필에는 CRL 발급자가 발급한 모든 CRL에 nextUpdate가 포함되어야 합니다. TBSCertList의 ASN.1 구문은 이 필드를 \[X.509\]에 정의된 ASN.1 구조와 일치하는 OPTIONAL로 설명합니다. nextUpdate를 생략한 CRL을 처리하는 클라이언트의 동작은 이 프로필에 의해 지정되지 않습니다.\(MAY\)

이 프로필을 준수하는 CRL 발급자는 2049년까지 날짜에 대해 nextUpdate를 UTCTime으로 인코딩해야 합니다. 이 프로필을 준수하는 CRL 발급자는 2050년 이후 날짜에 대해 nextUpdate를 GeneralizedTime으로 인코딩해야 합니다.\(MUST, MUST\)

UTCTime으로 인코딩된 경우 nextUpdate는 섹션 4.1.2.5.1에 ​​정의된 대로 지정되고 해석되어야 합니다. GeneralizedTime으로 인코딩된 경우 nextUpdate는 섹션 4.1.2.5.2에 정의된 대로 지정되고 해석되어야 합니다.\(MUST, MUST\)

---
#### **5.1.2.6  Revoked Certificates**

폐기된 인증서가 없으면 폐기된 인증서 목록이 없어야 합니다. 그렇지 않으면 해지된 인증서가 일련 번호별로 나열됩니다. CA가 해지한 인증서는 인증서 일련번호로 고유하게 식별됩니다. 철회가 발생한 날짜가 지정됩니다. revocationDate의 시간은 섹션 5.1.2.4에 설명된 대로 표현되어야 합니다. 추가 정보는 CRL 항목 확장에 제공될 수 있습니다. CRL 항목 확장은 섹션 5.3에서 논의됩니다.\(MUST, MUST\)

---
#### **5.1.2.7  Extensions**

이 필드는 버전이 2\(섹션 5.1.2.1\)인 경우에만 나타날 수 있습니다. 존재하는 경우 이 필드는 하나 이상의 CRL 확장의 시퀀스입니다. CRL 확장은 섹션 5.2에서 논의됩니다.

---
## **5.2  CRL Extensions**

X.509 v2 CRL \[X.509\] \[X9.55\]에 대해 ANSI X9, ISO/IEC 및 ITU-T에서 정의한 확장은 추가 속성을 CRL과 연결하는 방법을 제공합니다. 또한 X.509 v2 CRL 형식을 사용하면 커뮤니티에서 해당 커뮤니티에 고유한 정보를 전달하는 개인 확장을 정의할 수 있습니다. CRL의 각 확장은 다음과 같이 지정될 수 있습니다.

중요하거나 중요하지 않습니다. 처리 방법을 모르는 중요한 확장이 발견되면 CRL 유효성 검사가 실패해야 합니다. 그러나 인식할 수 없는 중요하지 않은 확장은 무시될 수 있습니다. 다음 하위 섹션에서는 인터넷 CRL 내에서 사용되는 확장을 제시합니다. 커뮤니티는 이 사양에 정의되지 않은 CRL에 확장을 포함하도록 선택할 수 있습니다. 그러나 일반적인 상황에서 사용될 수 있는 CRL의 중요한 확장을 채택할 때는 주의가 필요합니다.\(MUST\)

CRL을 준수하는 발급자는 발행된 모든 CRL에 기관 키 식별자\(섹션 5.2.1\)와 CRL 번호\(섹션 5.2.3\) 확장을 포함해야 합니다.\(MUST\)

---
### **5.2.1  Authority Key Identifier**

기관 키 식별자 확장은 CRL 서명에 사용된 개인 키에 해당하는 공개 키를 식별하는 수단을 제공합니다. 식별은 키 식별자\(CRL 서명자 인증서의 주체 키 식별자\) 또는 발급자 이름 및 일련 번호를 기반으로 할 수 있습니다. 이 확장은 여러 동시 키 쌍 또는 전환으로 인해 발급자가 두 개 이상의 서명 키를 갖고 있는 경우에 특히 유용합니다.

준수하는 CRL 발급자는 반드시 키 식별자 방법을 사용해야 하며, 발급된 모든 CRL에 이 확장을 포함해야 합니다.\(MUST\)

이 CRL 확장의 구문은 섹션 4.2.1.1에 정의되어 있습니다.

---
### **5.2.2  Issuer Alternative Name**

발급자 대체 이름 확장을 사용하면 추가 ID를 CRL 발급자와 연결할 수 있습니다. 정의된 옵션에는 rfc822 이름\(전자 메일 주소\), DNS 이름, IP 주소 및 URI가 포함됩니다. 이름의 여러 인스턴스와 여러 이름 형식이 포함될 수 있습니다. 이러한 ID가 사용될 때마다 발급자 대체 이름 확장을 사용해야 합니다. 그러나 DNS 이름은 섹션 4.1.2.4에 설명된 대로 domainComponent 속성을 사용하여 발급자 필드에 표시될 수 있습니다.\(MUST\)

issuerAltName 확장은 중요로 표시되어서는 안 됩니다.\(SHOULD NOT\)

이 CRL 확장의 OID와 구문은 섹션 4.2.1.8에 정의되어 있습니다.

---
### **5.2.3  CRL Number**

CRL 번호는 지정된 CRL 범위 및 CRL 발급자에 대해 단조롭게 증가하는 시퀀스 번호를 전달하는 중요하지 않은 CRL 확장입니다. 이 확장을 통해 사용자는 특정 CRL이 다른 CRL을 대체하는 시기를 쉽게 결정할 수 있습니다. CRL 번호는 보완적인 전체 CRL 및 델타 CRL의 식별도 지원합니다. 이 프로필을 준수하는 CRL 발급자는 모든 CRL에 이 확장을 포함해야 합니다.\(MUST\)

CRL 발급자가 특정 범위에 대한 전체 CRL 외에 델타 CRL을 생성하는 경우 전체 CRL과 델타 CRL은 하나의 번호 지정 순서를 공유해야 합니다. 동일한 범위를 포괄하는 델타 CRL과 전체 CRL이 동시에 발행되는 경우 동일한 CRL 번호를 갖고 동일한 해지 정보를 제공해야 합니다. 즉, 델타 CRL과 허용 가능한 완전한 CRL의 조합은 동시에 발행된 완전한 CRL과 동일한 취소 정보를 제공해야 합니다.\(MUST, MUST, MUST\)

CRL 발급자가 서로 다른 시간에 동일한 범위에 대해 두 개의 CRL\(두 개의 완전한 CRL, 두 개의 델타 CRL 또는 완전한 CRL과 델타 CRL\)을 생성하는 경우 두 CRL은 동일한 CRL 번호를 가져서는 안 됩니다. 즉, 두 CRL의 이 업데이트 필드\(섹션 5.1.2.4\)가 동일하지 않은 경우 CRL 번호는 달라야 합니다.\(MUST NOT, MUST\)

위의 요구 사항을 고려하면 CRL 번호에는 긴 정수가 포함될 것으로 예상할 수 있습니다. CRL 검증자는 최대 20옥텟의 CRLNumber 값을 처리할 수 있어야 합니다. 적합한 CRL 발급자는 20옥텟보다 긴 CRLNumber 값을 사용해서는 안 됩니다.\(MUST, MUST NOT\)

```text
   id-ce-cRLNumber OBJECT IDENTIFIER ::= { id-ce 20 }

   CRLNumber ::= INTEGER (0..MAX)
```

---
### **5.2.4  Delta CRL Indicator**

델타 CRL 표시기는 CRL을 델타 CRL로 식별하는 중요한 CRL 확장입니다. 델타 CRL에는 전체 CRL에 표시되는 모든 정보가 아닌 이전에 배포된 해지 정보에 대한 업데이트가 포함되어 있습니다. 델타 CRL을 사용하면 일부 환경에서 네트워크 로드 및 처리 시간을 크게 줄일 수 있습니다. 델타 CRL은 일반적으로 업데이트하는 CRL보다 작으므로 델타 CRL을 얻는 응용 프로그램은 해당하는 전체 CRL을 얻는 응용 프로그램보다 네트워크 대역폭을 덜 소비합니다. CRL 구조가 아닌 형식으로 해지 정보를 저장하는 애플리케이션은 정보를 재처리하지 않고도 로컬 데이터베이스에 새 해지 정보를 추가할 수 있습니다.

델타 CRL 표시기 확장에는 BaseCRLNumber 유형의 단일 값이 포함되어 있습니다. CRL 번호는 해당 범위에 대해 완전한 CRL을 식별하며 이 델타 CRL 생성의 시작점으로 사용되었습니다. 적합한 CRL 발급자는 참조된 기본 CRL을 완전한 CRL로 게시해야 합니다. 델타 CRL에는 동일한 범위에 대한 해지 상태에 대한 모든 업데이트가 포함됩니다. 델타 CRL과 참조된 기본 CRL의 조합은 델타 CRL 게시 당시 해당 범위에 대한 완전한 CRL과 동일합니다.\(MUST\)

적합한 CRL 발급자가 델타 CRL을 생성할 때 델타 CRL은 중요한 델타 CRL 표시기 확장을 포함해야 합니다.\(MUST\)

델타 CRL이 발급되면 참조하는 기본 CRL에서 다루는 것과 동일한 이유 집합과 동일한 인증서 집합을 다루어야 합니다. 즉, 델타 CRL의 범위는 기본으로 참조되는 전체 CRL의 범위와 동일해야 합니다. 참조된 기본 CRL과 델타 CRL은 발급 배포 지점 확장을 생략하거나 동일한 발급 배포 지점 확장을 포함해야 합니다. 또한 CRL 발급자는 동일한 개인 키를 사용하여 업데이트하는 데 사용할 수 있는 델타 CRL 및 전체 CRL에 서명해야 합니다.\(MUST, MUST, MUST, MUST\)

델타 CRL을 지원하는 응용 프로그램은 해당 범위에 대한 델타 CRL을 해당 범위에 대해 완전한 발급 CRL 또는 해당 범위에 대해 완전한 로컬로 생성된 CRL과 결합하여 해당 범위에 대해 완전한 CRL을 생성할 수 있습니다.

델타 CRL이 전체 CRL 또는 로컬로 구성된 CRL과 결합되면 결과적으로 로컬로 구성된 CRL은 구성에 사용된 델타 CRL에 있는 CRL 번호 확장에 지정된 CRL 번호를 갖습니다. 또한 결과적으로 로컬로 생성된 CRL에는 생성에 사용된 델타 CRL의 해당 필드에 지정된 thisUpdate 및 nextUpdate 시간이 있습니다. 또한 로컬로 생성된 CRL은 델타 CRL에서 발급 배포 지점을 상속합니다.

다음 네 가지 조건이 충족되면 완전한 CRL과 델타 CRL을 결합할 수 있습니다.\(MAY\)

- \(a\) 전체 CRL과 델타 CRL의 발급자는 동일합니다.

- \(b\) 전체 CRL과 델타 CRL은 동일한 범위를 갖습니다. 다음 조건 중 하나가 충족되면 두 CRL의 범위는 동일합니다.

- \(1\) issuingDistributionPoint 확장은 전체 CRL과 델타 CRL 모두에서 생략됩니다.

- \(2\) issuingDistributionPoint 확장은 전체 CRL과 델타 CRL 모두에 존재하며 확장의 각 필드 값은 두 CRL에서 동일합니다.

- \(c\) 전체 CRL의 CRL 번호는 델타 CRL에 지정된 BaseCRLNumber와 같거나 큽니다. 즉, 전체 CRL에는 참조된 기본 CRL이 보유하는 모든 해지 정보가 최소한으로 포함됩니다.

- \(d\) 전체 CRL의 CRL 번호는 델타 CRL의 CRL 번호보다 작습니다. 즉, 델타 CRL은 번호 지정 순서에서 전체 CRL을 따릅니다.

CRL 발급자는 델타 CRL과 적절한 전체 CRL의 조합이 현재 해지 상태를 정확하게 반영하는지 확인해야 합니다. CRL 발급자는 참조된 기본 CRL 생성 이후 상태가 변경된 델타 CRL 범위 내의 각 인증서에 대해 델타 CRL에 항목을 포함해야 합니다.\(MUST, MUST\)

- \(a\) CRL 범위에 포함된 이유로 인증서가 취소된 경우 해당 인증서를 취소됨으로 나열합니다.

- \(b\) 인증서가 유효하고 참조된 기본 CRL 또는 이유 코드 CertificateHold가 있는 후속 CRL에 나열되어 있고 이유 코드 CertificateHold가 CRL 범위에 포함되어 있는 경우 이유 코드 제거FromCRL과 함께 인증서를 나열합니다.

- \(c\) CRL 범위 밖의 이유로 인증서가 폐기되었지만 인증서가 참조된 기본 CRL 또는 이 CRL 범위에 포함된 이유 코드와 함께 후속 CRL에 나열되어 있는 경우 인증서를 폐기된 것으로 나열합니다. 그러나 이유 코드를 생략합니다.

- \(d\) CRL 범위를 벗어난 이유로 인증서가 폐기되고 인증서가 참조된 기본 CRL이나 이 CRL 범위에 포함된 이유 코드가 있는 후속 CRL에 나열되지 않은 경우 인증서를 나열하지 마십시오. 이 CRL에.

인증서가 해지되거나, 보류되거나, 보류가 해제되거나, 해지 사유가 변경되면 인증서 상태가 변경된 것으로 간주됩니다.

참조된 기본 CRL에 인증서가 보류되지 않은 경우에도 델타 CRL에 이유 코드 제거FromCRL이 포함된 인증서를 나열하는 것이 적절합니다. 인증서가 보류된 경우

기본 이후에 발행되었지만 이 델타 CRL 이전에 발행된 후 보류에서 해제된 모든 CRL은 취소 사유인 RemoveFromCRL과 함께 델타 CRL에 나열되어야 합니다.\(MUST\)

인증서에 지정된 notAfter 시간이 델타 CRL에 지정된 thisUpdate 시간보다 이전이고 인증서가 참조된 기본 CRL 또는 이후에 발행된 CRL에 나열된 경우 CRL 발급자는 선택적으로 이유 코드 제거FromCRL과 함께 델타 CRL에 인증서를 나열할 수 있습니다. 기본이지만 이 델타 CRL 이전입니다.\(MAY\)

인증서 해지 알림이 델타 CRL에 처음 나타나는 경우 동일한 범위에 대한 다음 완전한 CRL이 발급되기 전에 인증서 유효 기간이 만료될 수 있습니다. 이 경우, 취소 알림은 이 범위에 대해 명시적으로 발행된 하나 이상의 완전한 CRL에 취소 알림이 포함될 때까지 모든 후속 델타 CRL에 포함되어야 합니다.\(MUST\)

델타 CRL을 지원하는 애플리케이션은 이전에 발행된 전체 CRL과 최신 델타 CRL을 결합하여 현재 전체 CRL을 구성할 수 있어야 합니다. 델타 CRL을 지원하는 애플리케이션은 이전에 로컬로 생성된 완전한 CRL과 현재 델타 CRL을 결합하여 현재의 완전한 CRL을 생성할 수도 있습니다. 현재 시간이 thisUpdate 및 nextUpdate 필드에 포함된 시간 사이에 있는 경우 델타 CRL은 현재 CRL로 간주됩니다. 일부 상황에서는 CRL 발급자가 nextUpdate 필드에 표시되기 전에 하나 이상의 델타 CRL을 게시할 수 있습니다. 주어진 범위에 대해 둘 이상의 현재 델타 CRL이 발견되면 애플리케이션은 thisUpdate에서 최신 값을 가진 항목을 최신 항목으로 간주해야 합니다.\(MUST, MAY, SHOULD\)

```text
   id-ce-deltaCRLIndicator OBJECT IDENTIFIER ::= { id-ce 27 }

   BaseCRLNumber ::= CRLNumber
```

---
### **5.2.5  Issuing Distribution Point**

발급 배포 지점은 특정 CRL에 대한 CRL 배포 지점과 범위를 식별하는 중요한 CRL 확장이며 CRL이 최종 엔터티 인증서만, CA 인증서만, 속성 인증서만,

또는 제한된 이유 코드 세트. 확장이 중요하기는 하지만 이 확장을 지원하기 위해 구현을 준수할 필요는 없습니다.

CRL은 CRL 발급자의 개인 키를 사용하여 서명됩니다. CRL 배포 지점에는 자체 키 쌍이 없습니다. CRL이 X.500 디렉토리에 저장되는 경우 CRL 배포 지점에 해당하는 디렉토리 항목에 저장되며 이는 CRL 발급자의 디렉토리 항목과 다를 수 있습니다.

배포 지점과 관련된 이유 코드는 onlySomeReasons에 지정되어야 합니다. onlySomeReasons가 표시되지 않으면 배포 지점에 모든 이유 코드에 대한 취소가 포함되어야 합니다. CA는 CRL 배포 지점을 사용하여 손상 및 일상적인 해지를 기준으로 CRL을 분할할 수 있습니다. 이 경우 이유 코드 keyCompromise \(1\), cACompromise \(2\) 및 aACompromise \(8\)가 있는 취소는 하나의 배포 지점에 나타나고 다른 이유 코드가 있는 취소는 다른 배포 지점에 나타납니다.\(MUST, MUST\)

distributionPoint 필드가 존재하고 URI를 포함하는 경우 다음 의미를 가정해야 합니다. 객체는 이 CRL 발급자가 발급한 최신 CRL에 대한 포인터입니다. 이러한 목적으로 URI 체계 ftp, http, mailto \[RFC1738\] 및 ldap \[RFC1778\]이 정의됩니다. URI는 상대 경로 이름이 아닌 절대 경로 이름이어야 하며 호스트를 지정해야 합니다.\(MUST, MUST\)

distributionPoint 필드가 없는 경우 CRL에는 CRL 범위 내에서 CRL 발급자가 발급한 모든 취소되고 만료되지 않은 인증서에 대한 항목이 포함되어야 합니다\(있는 경우\).\(MUST\)

CRL 발급자는 CRL 발급자가 아닌 기관에서 발급한 인증서가 CRL의 범위에 포함된 경우 indirectCRL 부울을 주장해야 합니다. 각 항목을 담당하는 기관은 인증서 발급자 CRL 항목 확장\(섹션 5.3.4\)으로 표시됩니다.\(MUST\)

```text
   id-ce-issuingDistributionPoint OBJECT IDENTIFIER ::= { id-ce 28 }

   issuingDistributionPoint ::= SEQUENCE {
        distributionPoint          [0] DistributionPointName OPTIONAL,
        onlyContainsUserCerts      [1] BOOLEAN DEFAULT FALSE,
        onlyContainsCACerts        [2] BOOLEAN DEFAULT FALSE,
        onlySomeReasons            [3] ReasonFlags OPTIONAL,
        indirectCRL                [4] BOOLEAN DEFAULT FALSE,
        onlyContainsAttributeCerts [5] BOOLEAN DEFAULT FALSE }
```

---
### **5.2.6  Freshest CRL (a.k.a. Delta CRL Distribution Point)**

최신 CRL 확장은 이 전체 CRL에 대한 델타 CRL 정보를 얻는 방법을 식별합니다. 확장은 중요하지 않아야 합니다. 이 확장은 델타 CRL에 표시되어서는 안 됩니다.\(MUST, MUST NOT\)

이 확장에는 cRLDistributionPoints 인증서 확장과 동일한 구문이 사용되며 섹션 4.2.1.14에 설명되어 있습니다. 그러나 이 컨텍스트에서는 배포 지점 필드만 의미가 있습니다. 이유 및 CRLIssuer 필드는 이 CRL 확장에서 생략되어야 합니다.\(MUST\)

각 배포 지점 이름은 이 전체 CRL에 대한 델타 CRL을 찾을 수 있는 위치를 제공합니다. 이러한 델타 CRL의 범위는 이 전체 CRL의 범위와 동일해야 합니다. 이 CRL 확장의 내용은 델타 CRL을 찾는 데에만 사용됩니다. 내용은 CRL 또는 참조된 델타 CRL의 유효성을 검사하는 데 사용되지 않습니다. 섹션 4.2.1.14의 배포 지점에 대해 정의된 인코딩 규칙이 이 확장에 적용됩니다.\(MUST\)

```text
   id-ce-freshestCRL OBJECT IDENTIFIER ::=  { id-ce 46 }

   FreshestCRL ::= CRLDistributionPoints
```

---
## **5.3  CRL Entry Extensions**

X.509 v2 CRL에 대해 ISO/IEC, ITU-T 및 ANSI X9에서 정의한 CRL 항목 확장은 추가 속성을 CRL 항목 \[X.509\] \[X9.55\]과 연결하는 방법을 제공합니다. 또한 X.509 v2 CRL 형식을 사용하면 커뮤니티에서 해당 커뮤니티에 고유한 정보를 전달하는 개인 CRL 항목 확장을 정의할 수 있습니다. CRL 항목의 각 확장은 중요 또는 중요하지 않음으로 지정될 수 있습니다. 처리 방법을 모르는 중요한 CRL 항목 확장이 발견되면 CRL 유효성 검사가 실패해야 합니다. 그러나 인식할 수 없는 중요하지 않은 CRL 항목 확장은 무시될 수 있습니다. 다음 하위 섹션에서는 인터넷 CRL 항목 및 정보의 표준 위치에 사용되는 권장 확장을 제시합니다. 커뮤니티는 추가 CRL 항목 확장을 사용하도록 선택할 수 있습니다. 그러나 일반적인 상황에서 사용될 수 있는 CRL 항목에 중요한 확장을 채택할 때는 주의해야 합니다.\(MUST\)

이 사양에 사용된 모든 CRL 항목 확장은 중요하지 않습니다. 이러한 확장에 대한 지원은 CRL 발급자 및 응용 프로그램을 준수하기 위한 선택 사항입니다. 그러나 CRL 발급자는 이 정보가 제공될 때마다 이유 코드\(섹션 5.3.1\) 및 무효 날짜\(섹션 5.3.3\)를 포함해야 합니다.\(SHOULD\)

---
### **5.3.1  Reason Code**

ReasonCode는 인증서 해지 이유를 식별하는 중요하지 않은 CRL 항목 확장입니다. CRL 발급자는 CRL 항목에 의미 있는 이유 코드를 포함하는 것이 좋습니다. 그러나 지정되지 않은\(0\) ReasonCode 값을 사용하는 대신 이유 코드 CRL 항목 확장이 없어야 합니다.\(SHOULD\)

```text
   id-ce-cRLReason OBJECT IDENTIFIER ::= { id-ce 21 }

   -- reasonCode ::= { CRLReason }

   CRLReason ::= ENUMERATED {
        unspecified             (0),
        keyCompromise           (1),
        cACompromise            (2),
        affiliationChanged      (3),
        superseded              (4),
        cessationOfOperation    (5),
        certificateHold         (6),
        removeFromCRL           (8),
        privilegeWithdrawn      (9),
        aACompromise           (10) }
```

---
### **5.3.2  Hold Instruction Code**

보류 명령 코드는 보류된 인증서를 발견한 후 취해야 할 조치를 나타내는 등록된 명령 식별자를 제공하는 중요하지 않은 CRL 항목 확장입니다.

```text
   id-ce-holdInstructionCode OBJECT IDENTIFIER ::= { id-ce 23 }

   holdInstructionCode ::= OBJECT IDENTIFIER
```

다음 명령어 코드가 정의되었습니다. 이 확장을 처리하는 애플리케이션을 준수하려면 다음 명령어 코드를 인식해야 합니다.\(MUST\)

```text
   holdInstruction    OBJECT IDENTIFIER ::=
                    { iso(1) member-body(2) us(840) x9-57(10040) 2 }

   id-holdinstruction-none   OBJECT IDENTIFIER ::= {holdInstruction 1}
   id-holdinstruction-callissuer
                             OBJECT IDENTIFIER ::= {holdInstruction 2}
   id-holdinstruction-reject OBJECT IDENTIFIER ::= {holdInstruction 3}
```

id-holdinstruction-callissuer를 만나는 애플리케이션을 준수하는 경우 반드시 인증서 발급자를 호출하거나 인증서를 거부해야 합니다. id-holdinstruction-reject가 발생하는 준수 애플리케이션은 인증서를 거부해야 합니다. 보류 명령 id-holdinstruction-none은 의미상으로 HoldInstructionCode가 없는 것과 동일하며 인터넷 PKI에서는 해당 사용을 강력히 권장하지 않습니다.\(MUST, MUST\)

---
### **5.3.3  Invalidity Date**

무효 날짜는 개인 키가 손상되었거나 인증서가 무효화되었다는 사실이 알려지거나 의심되는 날짜를 제공하는 중요하지 않은 CRL 항목 확장입니다. 이 날짜는 CA가 해지를 처리한 날짜인 CRL 항목의 해지 날짜보다 이전일 수 있습니다. CRL 발급자가 CRL에 철회를 처음 게시하는 경우 무효 날짜는 이전 CRL의 발급 날짜보다 앞설 수 있지만, 철회 날짜는 이전 CRL의 발급 날짜보다 앞서서는 안 됩니다. 이 정보를 사용할 수 있을 때마다 CRL 발급자는 이를 CRL 사용자와 공유할 것을 적극 권장합니다.\(SHOULD NOT\)

이 필드에 포함된 GeneralizedTime 값은 그리니치 표준시\(Zulu\)로 표현되어야 하며 섹션 4.1.2.5.2에 정의된 대로 지정 및 해석되어야 합니다.\(MUST\)

```text
   id-ce-invalidityDate OBJECT IDENTIFIER ::= { id-ce 24 }

   invalidityDate ::=  GeneralizedTime
```

---
### **5.3.4  Certificate Issuer**

이 CRL 항목 확장은 간접 CRL, 즉 발급 배포 지점 확장에 indirectCRL 표시기가 설정된 CRL의 항목과 연결된 인증서 발급자를 식별합니다. 이 확장이 간접 CRL의 첫 번째 항목에 없으면 인증서 발급자는 기본적으로 CRL 발급자를 사용합니다. 간접 CRL의 후속 항목에 이 확장이 없으면 해당 항목의 인증서 발급자는 이전 항목의 인증서 발급자와 동일합니다. 이 필드는 다음과 같이 정의됩니다.

```text
   id-ce-certificateIssuer   OBJECT IDENTIFIER ::= { id-ce 29 }

   certificateIssuer ::=     GeneralNames
```

CRL 발급자를 준수하여 사용하는 경우 이 확장은 항상 중요해야 합니다. 구현이 이 확장을 무시하면 CRL 항목을 인증서에 올바르게 지정할 수 없습니다. 이 사양에서는 구현 시 이 확장을 인식할 것을 권장합니다.\(MUST\)

---
# **6  Certification Path Validation**

인터넷 PKI에 대한 인증 경로 유효성 검사 절차는 \[X.509\]에 제공된 알고리즘을 기반으로 합니다. 인증 경로 처리는 주체 고유 이름 및/또는 주체 대체 이름과 주체 공개 키 간의 바인딩을 확인합니다. 바인딩은 다음에 지정된 제약 조건에 의해 제한됩니다.

신뢰 당사자가 지정한 경로와 입력으로 구성된 인증서입니다. 기본 제약 조건 및 정책 제약 조건 확장을 통해 인증 경로 처리 논리를 통해 의사 결정 프로세스를 자동화할 수 있습니다.

이 섹션에서는 인증 경로의 유효성을 검사하는 알고리즘을 설명합니다. 이 사양을 준수하는 구현은 이 알고리즘을 구현하는 데 필요하지 않지만 이 절차에서 발생하는 외부 동작과 동일한 기능을 제공해야 합니다. 올바른 결과를 도출하는 한 특정 구현에서는 모든 알고리즘을 사용할 수 있습니다.\(MUST\)

섹션 6.1의 텍스트에서는 기본 경로 유효성 검사에 대해 설명합니다. 유효한 경로는 트러스트 앵커에서 발급한 인증서로 시작됩니다. 알고리즘에는 CA의 공개 키, CA 이름 및 이 키를 사용하여 유효성을 검사할 수 있는 경로 집합에 대한 제약 조건이 필요합니다.

트러스트 앵커의 선택은 정책의 문제입니다. 이는 계층적 PKI의 최상위 CA일 수 있습니다. 검증자의 자체 인증서를 발행한 CA 또는 네트워크 PKI의 다른 CA. 경로 검증 절차는 트러스트 앵커 선택에 관계없이 동일합니다. 또한, 다양한 애플리케이션은 다양한 트러스트 앵커에 의존하거나 트러스트 앵커 세트로 시작하는 경로를 허용할 수 있습니다.

섹션 6.2에서는 특정 구현에서 경로 유효성 검사 알고리즘을 사용하는 방법을 설명합니다. 두 가지 구체적인 사례가 논의됩니다. 경로가 여러 신뢰할 수 있는 CA 중 하나로 시작될 수 있는 경우; PEM 아키텍처와의 호환성이 필요한 경우.

섹션 6.3에서는 CRL이 인증서 발급자가 사용하는 해지 메커니즘인 경우 인증서가 해지되었는지 또는 보류 상태인지 확인하는 데 필요한 단계를 설명합니다.

---
## **6.1  Basic Path Validation**

이 텍스트는 X.509 경로 처리를 위한 알고리즘을 설명합니다. 적합한 구현에는 이 알고리즘의 외부 동작과 기능적으로 동일한 X.509 경로 처리 절차가 포함되어야 합니다. 그러나 이 알고리즘에서 처리되는 일부 인증서 확장에 대한 지원은 호환 구현을 위한 선택 사항입니다. 이러한 확장을 지원하지 않는 클라이언트는 경로 유효성 검사 알고리즘에서 해당 단계를 생략할 수 있습니다.\(MUST, MAY, MAY\)

예를 들어 클라이언트는 정책 매핑 확장을 지원할 필요가 없습니다. 이 확장을 지원하지 않는 클라이언트는 정책 매핑이 처리되는 경로 유효성 검사 단계를 생략할 수 있습니다. 지원되지 않는 중요한 확장이 포함된 경우 클라이언트는 인증서를 거부해야 합니다.\(MUST, MAY, MUST\)

이 섹션에 제시된 알고리즘은 현재 날짜 및 시간을 기준으로 인증서의 유효성을 검사합니다. 적합한 구현은 과거의 특정 시점에 대한 유효성 검사도 지원할 수 있습니다. 인증서 유효 기간을 벗어난 시간에 대해서는 인증서를 검증하는 메커니즘을 사용할 수 없습니다.\(MAY\)

트러스트 앵커는 알고리즘에 대한 입력입니다. 모든 인증 경로를 검증하는 데 동일한 트러스트 앵커를 사용해야 한다는 요구 사항은 없습니다. 섹션 6.2에서 자세히 설명하는 것처럼 다양한 경로를 검증하기 위해 다양한 신뢰 앵커를 사용할 수 있습니다.\(MAY\)

경로 검증의 주요 목표는 트러스트 앵커의 공개 키를 기반으로 최종 엔터티 인증서에 표시된 주체 고유 이름 또는 주체 대체 이름과 주체 공개 키 간의 바인딩을 확인하는 것입니다. 이를 위해서는 해당 바인딩을 지원하는 일련의 인증서를 얻어야 합니다. 이 인증서 시퀀스를 얻기 위해 수행되는 절차는 이 사양의 범위를 벗어납니다.

이 목표를 달성하기 위해 경로 유효성 검사 프로세스에서는 무엇보다도 예상 인증 경로\(n개의 인증서 시퀀스\)가 다음 조건을 충족하는지 확인합니다.

```text
      (a)  for all x in {1, ..., n-1}, the subject of certificate x is
      the issuer of certificate x+1;

      (b)  certificate 1 is issued by the trust anchor;
```

- \(c\) 인증서 n은 검증할 인증서입니다. 그리고

- \(d\) {1, ..., n}의 모든 x에 대해 인증서는 해당 시점에 유효했습니다.

트러스트 앵커가 자체 서명된 인증서 형식으로 제공되는 경우 이 자체 서명된 인증서는 예상 인증 경로의 일부로 포함되지 않습니다. 트러스트 앵커에 대한 정보는 인증 경로 유효성 검사 알고리즘\(섹션 6.1.1\)에 대한 입력으로 제공됩니다.

그러나 특정 인증 경로가 모든 응용 프로그램에 적합하지 않을 수도 있습니다. 따라서 애플리케이션은 이 알고리즘을 확장하여 유효한 경로 집합을 추가로 제한할 수 있습니다. 또한 경로 유효성 검사 프로세스에서는 인증서 정책 확장, 정책 매핑 확장, 정책 제약 조건 확장 및 모든 정책 확장 금지를 기반으로 이 경로에 유효한 인증서 정책 집합을 결정합니다. 이를 달성하기 위해 경로 유효성 검사 알고리즘은 유효한 정책 트리를 구성합니다. 이 경로에 유효한 인증서 정책 집합이 비어 있지 않으면 결과는 깊이 n의 유효한 정책 트리가 되고, 그렇지 않으면 결과는 null 유효한 정책 트리가 됩니다.\(MAY\)

제목 및 발급자 필드에 나타나는 DN이 ​​동일하고 비어 있지 않으면 인증서가 자체 발급됩니다. 일반적으로 경로를 구성하는 인증서의 발급자와 주체는 인증서마다 다릅니다. 그러나 CA는 키 롤오버 또는 인증서 정책 변경을 지원하기 위해 자체적으로 인증서를 발급할 수 있습니다. 이러한 자체 발급 인증서는 경로 길이 또는 이름 제약 조건을 평가할 때 계산되지 않습니다.

이 섹션에서는 \(1\) 초기화, \(2\) 기본 인증서 처리, \(3\) 다음 인증서 준비, \(4\) 마무리의 네 가지 기본 단계로 알고리즘을 제시합니다. \(1\)과 \(4\)단계는 정확히 한 번만 수행됩니다. \(2\) 단계는 경로의 모든 인증서에 대해 수행됩니다. \(3\) 단계는 최종 인증서를 제외한 경로의 모든 인증서에 대해 수행됩니다. 그림 2는 이 알고리즘의 상위 수준 흐름도를 제공합니다.

```text
                           +-------+
                           | START |
                           +-------+
                               |
                               V
                       +----------------+
                       | Initialization |
                       +----------------+
                               |
                               +<--------------------+
                               |                     |
                               V                     |
                       +----------------+            |
                       |  Process Cert  |            |
                       +----------------+            |
                               |                     |
                               V                     |
                       +================+            |
                       |  IF Last Cert  |            |
                       |    in Path     |            |
                       +================+            |
                         |            |              |
                    THEN |            | ELSE         |
                         V            V              |
              +----------------+ +----------------+  |
              |    Wrap up     | |  Prepare for   |  |
              +----------------+ |   Next Cert    |  |
                      |          +----------------+  |
                      V               |              |
                  +-------+           +--------------+
                  | STOP  |
                  +-------+

         Figure 2.  Certification Path Processing Flowchart
```

---
### **6.1.1  Inputs**

이 알고리즘은 경로 처리 로직에 다음 7개의 입력이 제공된다고 가정합니다.

- \(a\) 길이 n의 장래 인증 경로.

- \(b\) 현재 날짜/시간.

- \(c\) user-initial-policy-set: 인증서 사용자가 허용하는 정책의 이름을 지정하는 인증서 정책 식별자 집합입니다. 사용자가 인증서 정책에 관심이 없는 경우 user-initial-policy-set에는 특수 값 any-policy가 포함되어 있습니다.

- \(d\) 인증 경로에 대한 신뢰 앵커 역할을 하는 CA를 설명하는 신뢰 앵커 정보. 트러스트 앵커 정보에는 다음이 포함됩니다.

- \(1\) 신뢰할 수 있는 발급자 이름,

- \(2\) 신뢰할 수 있는 공개 키 알고리즘,

- \(3\) 신뢰할 수 있는 공개 키, 그리고

- \(4\) 선택적으로 공개 키와 연관된 신뢰할 수 있는 공개 키 매개변수.

트러스트 앵커 정보는 경로에 제공될 수 있습니다.

- 자체 서명된 인증서 형태의 처리 절차입니다. 신뢰할 수 있는 앵커 정보는 신뢰할 수 있는 대역 외 절차에 의해 경로 처리 절차에 전달되었기 때문에 신뢰할 수 있습니다. 신뢰할 수 있는 공개 키 알고리즘에 매개변수가 필요한 경우 매개변수는 신뢰할 수 있는 공개 키와 함께 제공됩니다.

- \(e\) 정책 매핑이 인증 경로에서 허용되는지 여부를 나타내는 초기 정책 매핑 금지.

- \(f\) 사용자 초기 정책 세트의 인증서 정책 중 적어도 하나에 대해 경로가 유효해야 하는지 여부를 나타내는 초기 명시적 정책.

- \(g\) 인증서에 포함된 경우 anyPolicy OID를 처리해야 하는지 여부를 나타내는initial-any-policy-inhibit.

---
### **6.1.2  Initialization**

이 초기화 단계에서는 7개의 입력을 기반으로 11개의 상태 변수를 설정합니다.

- \(a\) valid\_policy\_tree: 선택적 한정자가 있는 인증서 정책 트리입니다. 트리의 각 잎은 인증 경로 유효성 검사의 이 단계에서 유효한 정책을 나타냅니다. 인증 경로 유효성 검사의 이 단계에서 유효한 정책이 존재하는 경우 트리의 깊이는

- 처리된 체인의 인증서입니다. 인증 경로 유효성 검사의 이 단계에서 유효한 정책이 존재하지 않으면 트리가 NULL로 설정됩니다. 트리가 NULL로 설정되면 정책 처리가 중단됩니다.

- valid\_policy\_tree의 각 노드에는 유효한 정책, 관련 정책 한정자 집합, 하나 이상의 예상 정책 값 집합 및 중요도 표시기 등 4개의 데이터 개체가 포함됩니다. 노드가 깊이 x에 있는 경우 노드의 구성 요소는 다음과 같은 의미를 갖습니다.

- \(1\) valid\_policy는 길이 x의 경로에 대한 유효한 정책을 나타내는 단일 정책 OID입니다.

- \(2\) qualifier\_set은 인증서 x의 유효한 정책과 연관된 정책 한정자의 집합입니다.

\(3\) important\_indicator는 다음 여부를 나타냅니다.

- 인증서 x의 인증서 정책 확장이 중요로 표시되었습니다.

- \(4\) Expect\_policy\_set에는 인증서 x+1에서 이 정책을 만족시키는 하나 이상의 정책 OID가 포함되어 있습니다.

- valid\_policy\_tree의 초기 값은 valid\_policy anyPolicy가 포함된 단일 노드, 빈 qualifier\_set, 단일 값 anyPolicy가 포함된 Expect\_policy\_set 및 FALSE인 important\_indicator입니다. 이 노드는 깊이 0에 있는 것으로 간주됩니다.

- 그림 3은 valid\_policy\_tree의 초기 상태를 그래픽으로 표현한 것입니다. 추가 그림에서는 이 형식을 사용하여 경로 처리 중 valid\_policy\_tree의 변경 사항을 설명합니다.

```text
              +----------------+
              |   anyPolicy    |   <---- valid_policy
              +----------------+
              |       {}       |   <---- qualifier_set
              +----------------+
              |     FALSE      |   <---- criticality_indicator
              +----------------+
              |  {anyPolicy}   |   <---- expected_policy_set
              +----------------+
```

- 그림 3. valid\_policy\_tree 상태 변수의 초기값

- \(b\) allowed\_subtrees: 인증 경로의 후속 인증서에 있는 모든 주체 이름이 반드시 포함되어야 하는 하위 트리 집합을 정의하는 각 이름 유형\(예: X.500 고유 이름, 이메일 주소 또는 IP 주소\)에 대한 루트 이름 집합 . 이 변수에는 각 이름 유형에 대한 세트가 포함됩니다. 고유 이름 세트의 초기 값은 모든 고유 이름 세트입니다. RFC822 이름 집합의 초기 값은 모든 RFC822 이름 집합입니다.\(MUST\)

- \(c\) 제외\_하위 트리: 인증 경로의 후속 인증서에 있는 주체 이름이 포함될 수 없는 하위 트리 집합을 정의하는 각 이름 유형\(예: X.500 고유 이름, 이메일 주소 또는 IP 주소\)에 대한 루트 이름 집합 . 이 변수에는 각 이름 유형에 대한 집합이 포함되어 있으며 각 집합의 초기 값은 비어 있습니다.

- \(d\)explicit\_policy: NULL이 아닌 valid\_policy\_tree가 필요한지 여부를 나타내는 정수입니다. 정수는 이 요구 사항이 적용되기 전에 처리될 자체 발급되지 않은 인증서의 수를 나타냅니다. 일단 설정되면 이 변수는 줄어들 수 있지만 늘릴 수는 없습니다. 즉, 경로의 인증서에 NULL이 아닌 valid\_policy\_tree가 필요한 경우 이후 인증서는 이 요구 사항을 제거할 수 없습니다. initial-explicit-policy가 설정된 경우 초기값은 0이고, 그렇지 않은 경우 초기값은 n+1입니다.

- \(e\)inhibit\_any-policy: anyPolicy 정책 식별자가 일치하는 것으로 간주되는지 여부를 나타내는 정수입니다. 정수는 인증서에서 어설션된 경우 anyPolicy OID가 무시되기 전에 처리될 자체 발급되지 않은 인증서의 수를 나타냅니다. 일단 설정되면 이 변수는 줄어들 수 있지만 늘릴 수는 없습니다. 즉, 경로의 인증서가 anyPolicy 처리를 금지하는 경우 이후 인증서는 이를 허용할 수 없습니다. initial-any-policy-inhibit가 설정된 경우 초기 값은 0이고, 그렇지 않은 경우 초기 값은 n+1입니다.

- \(f\)policy\_mapping: 정책 매핑이 허용되는지 여부를 나타내는 정수. 정수는 정책 매핑이 금지되기 전에 처리될 자체 발급되지 않은 인증서 수를 나타냅니다. 일단 설정되면 이 변수는 줄어들 수 있지만 늘릴 수는 없습니다. 즉, 경로의 인증서가 정책 매핑이 허용되지 않음을 지정하는 경우 이후 인증서로 재정의될 수 없습니다. initial-policy-mapping-inhibit가 설정된 경우 초기 값은 0이고, 그렇지 않은 경우 초기 값은 n+1입니다.

- \(g\) Working\_public\_key\_algorithm: 인증서의 서명을 확인하는 데 사용되는 디지털 서명 알고리즘입니다. Working\_public\_key\_algorithm은 트러스트 앵커 정보에 제공된 신뢰할 수 있는 공개 키 알고리즘에서 초기화됩니다.

\(h\) Working\_public\_key: 작업을 검증하는 데 사용되는 공개 키

- 인증서 서명. Working\_public\_key는 트러스트 앵커 정보에 제공된 신뢰할 수 있는 공개 키에서 초기화됩니다.

- \(i\) Working\_public\_key\_parameters: 현재 공개 키와 관련된 매개변수로, 서명을 확인하는 데 필요할 수 있습니다\(알고리즘에 따라 다름\). Working\_public\_key\_parameters 변수는 트러스트 앵커 정보에 제공된 신뢰할 수 있는 공개 키 매개변수에서 초기화됩니다.

- \(j\) Working\_issuer\_name: 체인의 다음 인증서에서 예상되는 발급자 고유 이름입니다. Working\_issuer\_name은 트러스트 앵커 정보에 제공된 신뢰할 수 있는 발급자로 초기화됩니다.

- \(k\) max\_path\_length: 이 정수는 n으로 초기화되고, 경로의 자체 발급되지 않은 인증서마다 감소하며, CA 인증서의 기본 제약 확장 내의 경로 길이 제약 필드의 값으로 줄어들 수 있습니다.

초기화 단계가 완료되면 6.1.3에 지정된 기본 인증서 처리 단계를 수행합니다.

---
### **6.1.3  Basic Certificate Processing**

인증서 i\(\[1..n\]의 모든 i에 대해\)에 대해 수행되는 기본 경로 처리 작업은 다음과 같습니다.

- \(a\) 기본 인증서 정보를 확인합니다. 인증서는 다음 각 항목을 충족해야 합니다.\(MUST\)

\(1\) 인증서는 다음과 같이 서명되었습니다.

- Working\_public\_key 및 Working\_public\_key\_parameters를 사용하는 Working\_public\_key\_algorithm.

- \(2\) 인증서 유효기간에는 현재 시간이 포함됩니다.

- \(3\) 현재 인증서는 취소되지 않았으며 보류상태도 아닙니다. 이는 적절한 CRL\(6.3절\), 상태 정보 또는 대역 외 메커니즘을 얻음으로써 결정될 수 있습니다.

- \(4\) 인증서 발급자 이름은 Working\_issuer\_name입니다.

- \(b\) 인증서 i가 자체 발급되고 경로의 최종 인증서가 아닌 경우 인증서 i에 대해 이 단계를 건너뜁니다. 그렇지 않으면 주체 이름이 X.500 고유 이름에 대한 allowed\_subtrees 중 하나 내에 있는지 확인하고 subjectAltName 확장\(중요 또는 중요하지 않음\)의 각 대체 이름이 해당 이름 유형에 대한 allowed\_subtrees 중 하나 내에 있는지 확인하세요.

- \(c\) 인증서 i가 자체 발급되고 경로의 최종 인증서가 아닌 경우 인증서 i에 대해 이 단계를 건너뜁니다. 그렇지 않으면 주체 이름이 X.500 고유 이름에 대한 제외\_하위 트리 중 하나에 없는지 확인하고 subjectAltName 확장\(중요 또는 중요하지 않음\)의 각 대체 이름이 해당 이름에 대한 제외\_하위 트리 중 하나에 없는지 확인하세요. 유형.

- \(d\) 인증서에 인증서 정책 확장이 존재하고 valid\_policy\_tree가 NULL이 아닌 경우 다음 단계를 순서대로 수행하여 정책 정보를 처리합니다.

\(1\) 각 정책 P에 대해 다음의 anyPolicy와 동일하지 않습니다.

- 인증서 정책 확장에서 P-OID는 정책 P의 OID를 나타내고 P-Q는 정책 P에 대해 설정된 한정자를 나타냅니다. 다음 단계를 순서대로 수행합니다.

- \(i\) valid\_policy\_tree에 P-OID가 예상\_policy\_set에 있는 i-1 깊이의 노드가 포함된 경우 다음과 같이 하위 노드를 생성합니다. valid\_policy를 OID-P로 설정합니다. qualifier\_set을 P-Q로 설정하고, Expect\_policy\_set을 {P-OID}로 설정하세요.

- 예를 들어, Expect\_policy\_set이 {Gold, White}인 깊이 i-1의 노드가 있는 valid\_policy\_tree를 생각해 보세요. 인증서 정책 Gold 및 Silver가 인증서 i의 인증서 정책 확장에 나타난다고 가정합니다. 골드 정책은 일치하지만 실버 정책은 일치하지 않습니다. 이 규칙은 Gold 정책에 대해 깊이 i의 하위 노드를 생성합니다. 그 결과는 그림 4와 같다.

```text
                             +-----------------+
                             |       Red       |
                             +-----------------+
                             |       {}        |
                             +-----------------+   node of depth i-1
                             |      FALSE      |
                             +-----------------+
                             |  {Gold, White}  |
                             +-----------------+
                                      |
                                      |
                                      |
                                      V
                             +-----------------+
                             |      Gold       |
                             +-----------------+
                             |       {}        |
                             +-----------------+ node of depth i
                             |  uninitialized  |
                             +-----------------+
                             |     {Gold}      |
                             +-----------------+

                    Figure 4.  Processing an exact match
```

\(ii\) \(i\) 단계에서 일치하는 항목이 없었고,

- valid\_policy\_tree에는 유효한 정책 anyPolicy가 있는 깊이 i-1의 노드가 포함되어 있으며 다음 값을 사용하여 하위 노드를 생성합니다. valid\_policy를 P-OID로 설정합니다. qualifier\_set을 P-Q로 설정하고, Expect\_policy\_set을 {P-OID}로 설정하세요.

- 예를 들어, valid\_policy가 anyPolicy인 깊이 i-1의 노드가 있는 valid\_policy\_tree를 생각해 보세요. 인증서 정책 Gold 및 Silver가 인증서 i의 인증서 정책 확장에 나타난다고 가정합니다. 골드 보험에는 한정자가 없지만 실버 보험에는 Q-실버 한정자가 있습니다. 위의 \(i\)에서 금과 은이 일치하지 않는 경우 이 규칙은 각 정책에 대해 하나씩 깊이 i의 두 하위 노드를 생성합니다. 그 결과는 그림 5와 같다.

```text
                             +-----------------+
                             |    anyPolicy    |
                             +-----------------+
                             |       {}        |
                             +-----------------+ node of depth i-1
                             |      FALSE      |
                             +-----------------+
                             |   {anyPolicy}   |
                             +-----------------+
                                /           \
                               /             \
                              /               \
                             /                 \
               +-----------------+          +-----------------+
               |      Gold       |          |     Silver      |
               +-----------------+          +-----------------+
               |       {}        |          |   {Q-Silver}    |
               +-----------------+ nodes of +-----------------+
               | uninitialized   | depth i  | uninitialized   |
               +-----------------+          +-----------------+
               |     {Gold}      |          |    {Silver}     |
               +-----------------+          +-----------------+
```

- 그림 5. 리프 노드가 anyPolicy를 지정할 때 일치하지 않는 정책 처리

- \(2\) 인증서 정책 확장에 AP-Q 한정자가 설정된 정책 anyPolicy가 포함되어 있고 \(a\) Inhibit\_any-policy가 0보다 크거나 \(b\) i<n이고 인증서가 자체 발급된 경우:

- 깊이 i-1의 valid\_policy\_tree에 있는 각 노드에 대해 하위 노드에 나타나지 않는 Expect\_policy\_set\(anyPolicy 포함\)의 각 값에 대해 다음 값을 사용하여 하위 노드를 생성합니다. valid\_policy를 Expect\_policy\_set의 값으로 설정합니다. 상위 노드에서; qualifier\_set를 AP-Q로 설정하고, Expect\_policy\_set를 이 노드의 valid\_policy 값으로 설정하세요.

- 예를 들어, Expect\_policy\_set이 {Gold, Silver}인 깊이 i-1의 노드가 있는 valid\_policy\_tree를 생각해 보세요. anyPolicy가 인증서 i의 인증서 정책 확장에 나타나지만 Gold와 Silver는 그렇지 않다고 가정합니다. 이 규칙은 각 정책마다 하나씩, 깊이 i의 두 하위 노드를 생성합니다. 그 결과는 아래 그림 6과 같다.

```text
                          +-----------------+
                          |      Red        |
                          +-----------------+
                          |       {}        |
                          +-----------------+ node of depth i-1
                          |      FALSE      |
                          +-----------------+
                          |  {Gold, Silver} |
                          +-----------------+
                             /           \
                            /             \
                           /               \
                          /                 \
            +-----------------+          +-----------------+
            |      Gold       |          |     Silver      |
            +-----------------+          +-----------------+
            |       {}        |          |       {}        |
            +-----------------+ nodes of +-----------------+
            |  uninitialized  | depth i  |  uninitialized  |
            +-----------------+          +-----------------+
            |     {Gold}      |          |    {Silver}     |
            +-----------------+          +-----------------+
```

- 그림 6. 인증서 정책 확장이 anyPolicy를 지정할 때 일치하지 않는 정책 처리

- \(3\) valid\_policy\_tree에 깊이 i-1 이하의 노드가 있고 자식 노드가 없으면 해당 노드를 삭제합니다. 자식이 없는 깊이 i-1 이하의 노드가 없을 때까지 이 단계를 반복합니다.

- 예를 들어 아래 그림 7에 표시된 valid\_policy\_tree를 생각해 보세요. 'X'로 표시된 깊이 i-1의 두 노드에는 하위 노드가 없으므로 삭제됩니다. 결과 트리에 이 규칙을 적용하면 'Y'로 표시된 깊이 i-2의 노드가 삭제됩니다. 다음 규칙 적용으로 인해 노드가 삭제되지 않으며 이 단계가 완료됩니다.

```text
                              +-----------+
                              |           | node of depth i-3
                              +-----------+
                              /     |     \
                             /      |      \
                            /       |       \
                +-----------+ +-----------+ +-----------+
                |           | |           | |     Y     | nodes of
                +-----------+ +-----------+ +-----------+ depth i-2
                /   \               |             |
               /     \              |             |
              /       \             |             |
   +-----------+ +-----------+ +-----------+ +-----------+ nodes of
   |           | |     X     | |           | |    X      |  depth
   +-----------+ +-----------+ +-----------+ +-----------+   i-1
         |                      /    |    \
         |                     /     |     \
         |                    /      |      \
   +-----------+ +-----------+ +-----------+ +-----------+ nodes of
   |           | |           | |           | |           |  depth
   +-----------+ +-----------+ +-----------+ +-----------+   i

          Figure 7.  Pruning the valid_policy_tree
```

- \(4\) 인증서 정책 확장이 중요로 표시된 경우 깊이 i의 모든 노드에서 important\_indicator를 TRUE로 설정합니다. 인증서 정책 확장이 중요로 표시되지 않은 경우 깊이 i의 모든 노드에서 important\_indicator를 FALSE로 설정합니다.

- \(e\) 인증서 정책 확장이 없으면 valid\_policy\_tree를 NULL로 설정합니다.

```text
      (f)  Verify that either explicit_policy is greater than 0 or the
      valid_policy_tree is not equal to NULL;
```

\(a\), \(b\), \(c\) 또는 \(f\) 단계 중 하나라도 실패하면 절차가 종료되고 실패 표시와 적절한 이유가 반환됩니다.

i가 n과 같지 않으면 6.1.4에 나열된 준비 단계를 수행하여 계속합니다. i가 n과 같으면 6.1.5에 나열된 마무리 단계를 수행합니다.

---
### **6.1.4  Preparation for Certificate i+1**

인증서 i+1 처리를 준비하려면 인증서 i에 대해 다음 단계를 수행하십시오.

- \(a\) 정책 매핑 확장이 있는 경우 특수 값 anyPolicy가 issuerDomainPolicy 또는 subjectDomainPolicy로 표시되지 않는지 확인합니다.

- \(b\) 정책 매핑 확장이 있는 경우 정책 매핑 확장의 각 issuerDomainPolicy ID-P에 대해 다음을 수행합니다.

- \(1\)policy\_mapping 변수가 0보다 큰 경우 ID-P가 valid\_policy인 깊이 i의 valid\_policy\_tree의 각 노드에 대해 Expect\_policy\_set를 정책에 의해 ID-P와 동일하게 지정된 subjectDomainPolicy 값 집합으로 설정합니다. 매핑 확장.

valid\_policy\_tree에 깊이 i의 노드가 없는 경우

- ID-P의 valid\_policy이지만 anyPolicy의 valid\_policy를 갖는 깊이 i의 노드가 있는 경우 다음과 같이 anyPolicy의 valid\_policy를 갖는 깊이 i-1 노드의 하위 노드를 생성합니다.

```text
            (i)  set the valid_policy to ID-P;

            (ii)  set the qualifier_set to the qualifier set of the
            policy anyPolicy in the certificate policies extension of
            certificate i;

            (iii)  set the criticality_indicator to the criticality of
            the certificate policies extension of certificate i;
```

\(iv\) Expect\_policy\_set를 다음 세트로 설정합니다.

- 정책 매핑 확장에 의해 ID-P와 동일하게 지정된 subjectDomainPolicy 값입니다.

- \(2\)policy\_mapping 변수가 0인 경우:

- \(i\) ID-P가 valid\_policy인 valid\_policy\_tree에서 깊이 i의 각 노드를 삭제합니다.

- \(ii\) valid\_policy\_tree에 깊이 i-1 이하의 노드가 자식 노드 없이 존재하는 경우 해당 노드를 삭제합니다. 자식이 없는 깊이 i-1 이하의 노드가 없을 때까지 이 단계를 반복합니다.

- \(c\) Working\_issuer\_name에 인증서 주체 이름을 할당합니다.

\(d\) subjectPublicKey 인증서를 다음에 할당합니다.

-working\_public\_key.

- \(e\) 인증서의 subjectPublicKeyInfo 필드에 null이 아닌 매개변수가 있는 알고리즘 필드가 포함되어 있는 경우 매개변수를 Working\_public\_key\_parameters 변수에 할당합니다.

- 인증서의 subjectPublicKeyInfo 필드에 null 매개변수가 있는 알고리즘 필드가 포함되어 있거나 매개변수가 생략된 경우 인증서 subjectPublicKey 알고리즘을 Working\_public\_key\_algorithm과 비교하세요. 인증서 subjectPublicKey 알고리즘과 Working\_public\_key\_algorithm이 다른 경우에는 Working\_public\_key\_parameters를 null로 설정하세요.

- \(f\) 인증서 subjectPublicKey 알고리즘을 Working\_public\_key\_algorithm 변수에 할당합니다.

\(g\) 이름 제약 확장이 포함된 경우

- 인증서의 경우 allowed\_subtrees 및 제외\_subtrees 상태 변수를 다음과 같이 수정합니다.

- \(1\) allowedSubtrees가 인증서에 있는 경우 allowed\_subtrees 상태 변수를 이전 값과 확장 필드에 표시된 값의 교차점으로 설정합니다. allowedSubtrees에 특정 이름 유형이 포함되지 않은 경우 allowed\_subtrees 상태 변수는 해당 이름 유형에 대해 변경되지 않습니다. 예를 들어, nist.gov와 csrc.nist.gov의 교차점은 csrc.nist.gov입니다. 그리고 nist.gov와 rsasecurity.com의 교차점은 빈 집합입니다.

- \(2\) ExcludedSubtrees가 인증서에 있는 경우 Excluded\_subtrees 상태 변수를 이전 값과 확장 필드에 표시된 값의 합집합으로 설정합니다. 제외된 하위 트리에 특정 이름 유형이 포함되어 있지 않으면 해당 이름 유형에 대해 제외\_하위 트리 상태 변수가 변경되지 않습니다. 예를 들어 nist.gov와 csrc.nist.gov 네임스페이스의 결합은 nist.gov입니다. 그리고 nist.gov와 rsasecurity.com의 결합은 둘 다 네임스페이스입니다.

- \(h\) 발행자와 주체명이 동일하지 않은 경우:

- \(1\)explicit\_policy가 0이 아닌 경우,explicit\_policy를 1씩 감소시킵니다.

- \(2\)policy\_mapping이 0이 아닌 경우,policy\_mapping을 1씩 감소시킵니다.

- \(3\) Inhibit\_any-policy가 0이 아닌 경우, Inhibit\_any-policy를 1만큼 감소시킵니다.

\(i\) 정책 제약 확장이

- 인증서의 경우,licit\_policy 및policy\_mapping 상태 변수를 다음과 같이 수정합니다.

- \(1\) requireExplicitPolicy가 존재하고explicit\_policy보다 작은 경우,explicit\_policy를 requireExplicitPolicy 값으로 설정합니다.

- \(2\) InhibitPolicyMapping이 존재하고policy\_mapping보다 작은 경우,policy\_mapping을 InhibitPolicyMapping의 값으로 설정합니다.

\(j\) InhibitAnyPolicy 확장이 포함된 경우

- 인증서가 Inhibit\_any-policy보다 작으면, Inhibit\_any-policy를 InhibitAnyPolicy 값으로 설정합니다.

- \(k\) 인증서가 CA 인증서인지 확인합니다\(basicConstraints 확장에 지정되거나 대역 외에서 확인됨\).

\(l\) 인증서가 자체 발급되지 않은 경우 다음 사항을 확인하십시오.

- max\_path\_length가 0보다 크고 max\_path\_length를 1씩 감소시킵니다.

- \(m\) pathLengthConstraint가 인증서에 존재하고 max\_path\_length보다 작은 경우 max\_path\_length를 pathLengthConstraint 값으로 설정합니다.

\(n\) 키 사용 확장이 있는 경우

- keyCertSign 비트가 설정되었습니다.

- \(o\) 인증서에 있는 기타 중요한 확장을 인식하고 처리합니다. 인증서에 있는 다른 인식된 중요하지 않은 확장을 처리합니다.

검사 \(a\), \(k\), \(l\), \(n\) 또는 \(o\)가 실패하면 절차가 종료되고 실패 표시와 적절한 이유가 반환됩니다.

\(a\), \(k\), \(l\), \(n\) 및 \(o\)가 성공적으로 완료되면 i를 증가시키고 6.1.3에 지정된 기본 인증서 처리를 수행합니다.

---
### **6.1.5  Wrap-up procedure**

최종 엔터티 인증서 처리를 완료하려면 인증서 n에 대해 다음 단계를 수행합니다.

- \(a\) 인증서 n이 자체 발급되지 않았고explicit\_policy가 0이 아닌 경우,explicit\_policy를 1만큼 감소시킵니다.

\(b\) 정책 제약 확장이

- 인증서 및 requireExplicitPolicy가 존재하고 값이 0인 경우,explicit\_policy 상태 변수를 0으로 설정합니다.

\(c\) 인증서 subjectPublicKey를 다음에 할당합니다.

-working\_public\_key.

- \(d\) 인증서의 subjectPublicKeyInfo 필드에 null이 아닌 매개변수가 있는 알고리즘 필드가 포함되어 있는 경우 매개변수를 Working\_public\_key\_parameters 변수에 할당합니다.

- 인증서의 subjectPublicKeyInfo 필드에 null 매개변수가 있는 알고리즘 필드가 포함되어 있거나 매개변수가 생략된 경우 인증서 subjectPublicKey 알고리즘을 Working\_public\_key\_algorithm과 비교하세요. 인증서 subjectPublicKey 알고리즘과 Working\_public\_key\_algorithm이 다른 경우에는 Working\_public\_key\_parameters를 null로 설정하세요.

- \(e\) 인증서 subjectPublicKey 알고리즘을 Working\_public\_key\_algorithm 변수에 할당합니다.

- \(f\) 인증서 n에 존재하는 기타 중요한 확장을 인식하고 처리합니다. 인증서 n에 있는 다른 인식된 중요하지 않은 확장을 처리합니다.

- \(g\) 다음과 같이 valid\_policy\_tree와 user-initial-policy-set의 교차점을 계산합니다.

- \(i\) valid\_policy\_tree가 NULL이면 교차점은 NULL입니다.

- \(ii\) valid\_policy\_tree가 NULL이 아니고 user-initial-policy-set이 any-policy인 경우 교차점은 전체 valid\_policy\_tree입니다.

- \(iii\) valid\_policy\_tree가 NULL이 아니고 user-initial-policy-set이 any-policy가 아닌 경우 다음과 같이 valid\_policy\_tree와 user-initial-policy-set의 교차점을 계산합니다.

- 1. 상위 노드가 anyPolicy의 valid\_policy를 갖는 정책 노드 세트를 결정합니다. 이것은 valid\_policy\_node\_set입니다.

2. 해당 노드의 valid\_policy가

- valid\_policy\_node\_set는 user-initial-policy-set에 없고 anyPolicy도 아닙니다. 이 노드와 모든 하위 항목을 삭제합니다.

- 3. valid\_policy\_tree에 valid\_policy anyPolicy가 있는 깊이 n의 노드가 포함되어 있고 user-initial-policy-set이 any-policy가 아닌 경우 다음 단계를 수행합니다.

-           ㅏ. valid\_policy anyPolicy를 사용하여 깊이 n 노드의 qualifier\_set에 P-Q를 설정합니다.

-ㄴ. valid\_policy\_node\_set에 있는 노드의 valid\_policy가 아닌 user-initial-policy-set의 각 P-OID에 대해 부모가 valid\_policy anyPolicy를 사용하여 깊이 n-1의 노드인 하위 노드를 생성합니다. 다음과 같이 하위 노드의 값을 설정합니다. valid\_policy를 P-OID로 설정합니다. qualifier\_set를 P-Q로 설정합니다. valid\_policy anyPolicy를 사용하여 깊이 n의 노드에서 important\_indicator를 복사합니다. Expect\_policy\_set을 {P-OID}로 설정하세요.

-           씨. valid\_policy anyPolicy를 사용하여 깊이 n의 노드를 삭제합니다.

- 4. valid\_policy\_tree에 깊이 n-1 이하의 노드가 있고 하위 노드가 없으면 해당 노드를 삭제합니다. 자식 없이 깊이 n-1 이하의 노드가 없을 때까지 이 단계를 반복합니다.

\(1\)explicit\_policy 변수의 값이 0보다 크거나 \(2\)valid\_policy\_tree가 NULL이 아닌 경우 경로 처리가 성공한 것입니다.

---
### **6.1.6  Outputs**

경로 처리가 성공하면 프로시저가 종료되고 valid\_policy\_tree,working\_public\_key,working\_public\_key\_algorithm 및 Working\_public\_key\_parameters의 최종 값과 함께 성공 표시가 반환됩니다.

---
## **6.2  Using the Path Validation Algorithm**

경로 유효성 검사 알고리즘은 단일 인증 경로의 유효성을 검사하는 프로세스를 설명합니다. 각 인증 경로는 특정 트러스트 앵커로 시작되지만 특정 시스템에서 검증된 모든 인증 경로가 단일 트러스트 앵커를 공유해야 한다는 요구 사항은 없습니다. 여러 트러스트 앵커를 지원하는 구현은 섹션 6.1에 제시된 알고리즘을 강화하여 특정 트러스트 앵커로 시작하는 유효한 인증 경로 집합을 추가로 제한할 수 있습니다. 예를 들어, 구현은 초기화 단계에서 특정 트러스트 앵커에 이름 제약 조건을 적용하도록 알고리즘을 수정할 수도 있고, 애플리케이션이 존재를 요구할 수도 있습니다.\(MAY, MAY\)

최종 엔터티 인증서에 특정 대체 이름 형식을 지정하거나 응용 프로그램이 응용 프로그램별 확장에 대한 요구 사항을 부과할 수 있습니다. 따라서 섹션 6.1에 제시된 경로 유효성 검사 알고리즘은 경로가 유효한 것으로 간주되는 최소 조건을 정의합니다.\(MAY\)

하나 이상의 신뢰할 수 있는 CA 선택은 지역적으로 결정됩니다. 시스템은 신뢰할 수 있는 CA 중 하나를 특정 경로에 대한 신뢰 앵커로 제공할 수 있습니다. 경로 유효성 검사 알고리즘에 대한 입력은 경로마다 다를 수 있습니다. 경로를 처리하는 데 사용되는 입력은 특정 트러스트 앵커에 부여된 신뢰의 애플리케이션별 요구 사항이나 제한 사항을 반영할 수 있습니다. 예를 들어, 신뢰할 수 있는 CA는 특정 인증서 정책에 대해서만 신뢰할 수 있습니다. 이 제한은 경로 유효성 검사 절차에 대한 입력을 통해 표현될 수 있습니다.

PEM \[RFC 1422\]의 규칙과 동일한 기본 동작을 초래하는 위의 인증 경로 처리 절차의 확장된 버전을 지정하는 것도 가능합니다. 이 확장 버전에서 프로시저에 대한 추가 입력은 하나 이상의 PCA\(정책 인증 기관\) 이름 목록과 PCA가 예상되는 인증 경로의 위치 표시입니다. 지명된 PCA 위치에서 CA 이름이 이 목록과 비교됩니다. 인식된 PCA 이름이 발견되면 인증 경로의 나머지 부분에 대해 SubordinateToCA 제한조건이 내재적으로 가정되고 처리가 계속됩니다. 유효한 PCA 이름이 발견되지 않고 식별된 정책을 기반으로 인증 경로의 유효성을 검사할 수 없는 경우 인증 경로는 유효하지 않은 것으로 간주됩니다.

---
## **6.3  CRL Validation**

이 섹션에서는 CRL이 인증서 발급자가 사용하는 해지 메커니즘인 경우 인증서가 해지되었는지 또는 보류 상태인지 확인하는 데 필요한 단계에 대해 설명합니다. CRL을 지원하는 구현을 준수하는 것은 이 알고리즘을 구현하는 데 필요하지 않지만 이 절차로 인해 발생하는 외부 동작과 기능적으로 동일해야 합니다. 올바른 결과를 도출하는 한 특정 구현에서는 모든 알고리즘을 사용할 수 있습니다.\(MUST\)

이 알고리즘은 필요한 모든 CRL을 로컬 캐시에서 사용할 수 있다고 가정합니다. 또한 CRL의 다음 업데이트 시간이 지나면 알고리즘은 현재 CRL을 가져와 로컬 CRL 캐시에 저장하는 메커니즘을 가정합니다.

이 알고리즘은 경로의 각 인증서에 대해 수행되는 입력 집합, 상태 변수 집합 및 처리 단계를 정의합니다. 알고리즘 출력은 인증서의 해지 상태입니다.

---
### **6.3.1  Revocation Inputs**

해지 처리를 지원하려면 알고리즘에 다음 두 가지 입력이 필요합니다.

- \(a\) 인증서: 알고리즘에서는 인증서가 특정 CRL에 있는지 여부를 확인하기 위해 인증서 일련 번호와 발급자 이름이 필요합니다. basicConstraints 확장은 제공된 인증서가 CA 또는 최종 엔터티와 연결되어 있는지 확인하는 데 사용됩니다. 존재하는 경우 알고리즘은 cRLDistributionsPoint 및 freshestCRL 확장을 사용하여 해지 상태를 결정합니다.

- \(b\) use-deltas: 이 부울 입력은 델타 CRL이 CRL에 적용되는지 여부를 결정합니다.

- RFC 1422 및 X.509 버전 1과 같은 레거시 PKI를 지원하는 구현에는 제공된 인증서가 CA 또는 최종 엔터티와 연결되어 있는지 여부를 나타내는 추가 입력이 필요합니다.

---
### **6.3.2  Initialization and Revocation State Variables**

CRL 처리를 지원하려면 알고리즘에 다음 상태 변수가 필요합니다.

- \(a\) 이유\_마스크: 이 변수에는 지금까지 처리된 CRL 및 델타 CRL에서 지원하는 취소 이유 집합이 포함됩니다. 집합의 합법적인 멤버는 가능한 취소 이유 값\(unspecified, keyCompromise, caCompromise, affiliationChanged, superseded, cessationOfOperation, CertificateHold,privilegeWithdraft 및 aACompromise\)입니다. 특수 값 all-reasons는 모든 법적 구성원 집합을 나타내는 데 사용됩니다. 이 변수는 빈 세트로 초기화됩니다.

- \(b\) cert\_status: 이 변수에는 인증서의 상태가 포함됩니다. 이 변수에는 다음 값 중 하나가 할당될 수 있습니다: unspecified, keyCompromise, caCompromise, affiliationChanged, superseded, cessationOfOperation,certificateHold, RemoveFromCRL,privilegeWithdraft, aACompromise, 특수 값 UNREVOKED 또는 특수 값 UNDETERMINED. 이 변수는 특수 값 UNREVOKED로 초기화됩니다.

- \(c\) interim\_reasons\_mask: 현재 처리 중인 CRL 또는 델타 CRL에서 지원하는 취소 이유 집합이 포함됩니다.

참고: 일부 환경에서는 모든 이유 코드를 확인할 필요가 없습니다. 예를 들어 일부 환경은 CA 인증서에 대한 caCompromise 및 keyCompromise에만 관련됩니다. 이 알고리즘은 모든 이유 코드를 확인합니다. 검사를 이유 코드의 하위 집합으로 제한하려면 추가 처리 및 상태 변수가 필요할 수 있습니다.

---
### **6.3.3  CRL Processing**

이 알고리즘은 인증서가 해지되지 않았다고 가정하여 시작됩니다. 알고리즘은 인증서 상태가 해지된 것으로 확인되거나 모든 이유 코드를 포괄하기에 충분한 CRL이 확인될 때까지 하나 이상의 CRL을 확인합니다.

인증서 CRL 배포 지점 확장의 각 배포 지점\(DP\)에 대해, 로컬 CRL 캐시의 각 해당 CRL에 대해 \(\(reasons\_mask는 모든 이유가 아님\) 및 \(cert\_status는 UNREVOKED입니다\)\) 다음을 수행합니다.

- \(a\) 필요에 따라 전체 CRL, 델타 CRL 또는 둘 다를 획득하여 로컬 CRL 캐시를 업데이트합니다.

- \(1\) 현재 시간이 CRL 다음 업데이트 필드 값 이후인 경우 다음 중 하나를 수행합니다.

- \(i\) use-deltas가 설정되고 인증서 또는 CRL에 최신 CRL 확장이 포함되어 있는 경우 현재 시간 이후의 다음 업데이트 값으로 델타 CRL을 얻고 로컬로 캐시된 CRL을 다음과 같이 업데이트하는 데 사용할 수 있습니다. 섹션 5.2.4에 명시되어 있습니다.

- \(ii\) 현재 완전한 CRL로 로컬 CRL 캐시를 업데이트하고 현재 시간이 새 CRL의 다음 업데이트 값 이전인지 확인한 다음 새 CRL로 계속 처리합니다. use-deltas가 설정된 경우 섹션 5.2.4에 지정된 대로 로컬에 캐시된 새 전체 CRL을 업데이트하는 데 사용할 수 있는 현재 델타 CRL을 가져옵니다.

- \(2\) 현재 시간이 다음 업데이트 필드 값 이전이고 use-deltas가 설정된 경우 섹션 5.2.4에 지정된 대로 로컬로 캐시된 전체 CRL을 업데이트하는 데 사용할 수 있는 현재 델타 CRL을 얻습니다.

- \(b\) 다음과 같이 전체 CRL의 발행자와 범위를 확인합니다.

- \(1\) DP에 cRLIssuer가 포함되어 있는 경우 전체 CRL의 발급자 필드가 DP의 cRLIssuer와 일치하는지, 그리고 전체 CRL에 indectCRL 부울 어설션이 포함된 발급 배포 지점 확장이 포함되어 있는지 확인하세요. 그렇지 않은 경우에는 CRL 발급자가 인증서 발급자와 일치하는지 확인하세요.

- \(2\) 전체 CRL에 발급 배포 지점\(IDP\) CRL 확장이 포함된 경우 다음을 확인하세요.

- \(i\) 배포 지점 이름이 IDP CRL 확장에 있고 배포 필드가 DP에 있는 경우 IDP의 이름 중 하나가 DP의 이름 중 하나와 일치하는지 확인합니다. IDP CRL 확장에 배포 지점 이름이 있고 DP에서 배포 필드가 생략된 경우 IDP의 이름 중 하나가 DP의 cRLIssuer 필드에 있는 이름 중 하나와 일치하는지 확인하세요.

- \(ii\) IDP CRL 확장에서 onlyContainsUserCerts 부울이 어설션된 경우 인증서에 cA 부울이 어설션된 기본 제약 조건 확장이 포함되어 있지 않은지 확인하세요.

- \(iii\) IDP CRL 확장에서 onlyContainsCACerts 부울이 주장되는 경우 인증서에 CA 부울이 주장된 기본 제약 조건 확장이 포함되어 있는지 확인합니다.

- \(iv\) onlyContainsAttributeCerts 부울이 주장되지 않았는지 확인합니다.

- \(c\) use-deltas가 설정된 경우 다음과 같이 델타 CRL의 발급자와 범위를 확인합니다.

- \(1\) 델타 CRL 발급자가 전체 CRL 발급자와 일치하는지 확인합니다.

- \(2\) 전체 CRL에 발급 배포 지점\(IDP\) CRL 확장이 포함된 경우 델타 CRL에 일치하는 IDP CRL 확장이 포함되어 있는지 확인합니다. 전체 CRL이 IDP CRL 확장을 생략하는 경우 델타 CRL도 IDP CRL 확장을 생략하는지 확인하십시오.

- \(3\) 델타 CRL 기관 키 식별자 확장이 전체 CRL 기관 키 식별자 확장과 일치하는지 확인합니다.

\(d\) 이 CRL에 대한 interim\_reasons\_mask를 다음과 같이 계산합니다.

- \(1\) 발급 배포 지점\(IDP\) CRL 확장이 존재하고 onlySomeReasons를 포함하고 DP에 이유가 포함된 경우 interim\_reasons\_mask를 DP의 이유와 IDP CRL 확장의 onlySomeReasons의 교차점으로 설정합니다.

- \(2\) IDP CRL 확장에는 SomeReasons만 포함되어 있지만 DP에서는 이유가 생략된 경우 interim\_reasons\_mask를 IDP CRL 확장의 onlySomeReasons 값으로 설정합니다.

\(3\) IDP CRL 확장자가 없거나 누락된 경우

- SomeReasons만 있지만 DP에 이유가 포함된 경우 interim\_reasons\_mask를 DP 이유 값으로 설정합니다.

\(4\) IDP CRL 확장자가 없거나 누락된 경우

- onlySomeReasons 및 DP가 이유를 생략한 다음 interim\_reasons\_mask를 특수 값 all-reasons로 설정합니다.

\(e\) interim\_reasons\_mask에 Reason\_mask에 포함되지 않은 하나 이상의 이유가 포함되어 있는지 확인합니다.

\(f\) 완전한 CRL 발급자에 대한 인증 경로를 획득하고 검증합니다. CRL 발급자의 인증서에 키 사용 확장이 있는 경우 cRLSign 비트가 설정되어 있는지 확인하세요.

\(g\) \(f\) 단계에서 검증된 공개 키를 사용하여 전체 CRL의 서명을 검증합니다.

\(h\) use-deltas가 설정된 경우 \(f\) 단계에서 검증된 공개 키를 사용하여 델타 CRL의 서명을 검증합니다.

\(i\) use-deltas가 설정된 경우 델타 CRL에서 인증서를 검색합니다. 섹션 5.3.4에 설명된 대로 인증서 발급자 및 일련 번호와 일치하는 항목이 발견되면 다음과 같이 cert\_status 변수를 표시된 이유로 설정합니다.

- \(1\) 이유 코드 CRL 항목 확장이 있는 경우 cert\_status 변수를 이유 코드 CRL 항목 확장의 값으로 설정합니다.

- \(2\) 이유 코드 CRL 항목 확장이 없는 경우 cert\_status 변수를 지정되지 않은 값으로 설정합니다.

\(j\) \(cert\_status가 UNREVOKED인 경우\) 다음을 검색합니다.

- 전체 CRL에 대한 인증서. 섹션 5.3.4에 설명된 대로 인증서 발급자 및 일련 번호와 일치하는 항목이 발견되면 단계 \(i\)에 설명된 대로 cert\_status 변수를 표시된 이유로 설정합니다.

- \(k\) \(cert\_status가 RemoveFromCRL인 경우\) cert\_status를 UNREVOKED로 설정합니다.

\(\(reasons\_mask가 모든 이유임\) OR \(cert\_status가 UNREVOKED가 아님\)\)인 경우 해지 상태가 결정되었으므로 cert\_status를 반환합니다.

해지 상태가 확인되지 않은 경우 배포 지점에 지정되지 않았지만 인증서 발급자가 발급한 사용 가능한 CRL을 사용하여 위 프로세스를 반복합니다. 이러한 CRL을 처리하려면 이유와 cRLIssuer 필드가 모두 생략된 DP와 인증서 발급자의 배포 지점 이름을 가정합니다. 즉, fullName의 이름 시퀀스는 인증서 발급자 필드와 인증서 발급자AltName 확장에서 생성됩니다. 해지 상태가 미확인으로 남아 있으면 cert\_status UNDETERMINED를 반환합니다.

---
# **7  References**

\[ISO 10646\] ISO/IEC 10646-1:1993. 국제 표준 --

- 정보 기술 - 범용 다중 옥텟 코드 문자 집합\(UCS\) - 1부: 아키텍처 및 기본 다국어 평면.

```text
   [RFC 791]   Postel, J.,  "Internet Protocol", STD 5, RFC 791,
               September 1981.
```

\[RFC 822\] Crocker, D., "ARPA 인터넷 문자 메시지 형식에 대한 표준", STD 11, RFC 822, 1982년 8월.

\[RFC 1034\] Mockapetris, P., "도메인 이름 - 개념 및

- 시설", STD 13, RFC 1034, 1987년 11월.

\[RFC 1422\] Kent, S., "인터넷 전자 메일의 개인정보 보호 강화: 파트 II: 인증서 기반 키 관리", RFC 1422, 1993년 2월.

\[RFC 1423\] Balenson, D., "인터넷의 개인 정보 보호 강화

- 전자 메일: 파트 III: 알고리즘, 모드 및 식별자," RFC 1423, 1993년 2월.

\[RFC 1510\] Kohl, J. 및 C. Neuman, "Kerberos 네트워크

- 인증 서비스\(V5\)," RFC 1510, 1993년 9월.

\[RFC 1519\] Fuller, V., T. Li, J. Yu 및 K. Varadhan, "클래스 없는 도메인 간 라우팅\(CIDR\): 주소 할당 및 집계 전략", RFC 1519, 1993년 9월.

\[RFC 1738\] Berners-Lee, T., L. Masinter 및 M. McCahill, "Uniform Resource Locators\(URL\)", RFC 1738, 1994년 12월.

\[RFC 1778\] Howes, T., S. Kille, W. Young 및 C. Robbins, "표준 속성 구문의 문자열 표현", RFC 1778, 1995년 3월.

\[RFC 1883\] Deering, S. 및 R. Hinden. "인터넷 프로토콜, 버전 6\(IPv6\) 사양", RFC 1883, 1995년 12월.

\[RFC 2044\] F. Yergeau, F., "UTF-8, 유니코드 및 ISO 10646의 변환 형식", RFC 2044, 1996년 10월.

\[RFC 2119\] Bradner, S., "요구 사항 수준을 나타내기 위해 RFC에 사용되는 키워드", BCP 14, RFC 2119, 1997년 3월.

\[RFC 2247\] Kille, S., M. Wahl, A. Grimstad, R. Huber 및 S.

- Sataluri, "LDAP/X.500 고유 이름에서 도메인 사용", RFC 2247, 1998년 1월.

\[RFC 2252\] Wahl, M., A. Coulbeck, T. Howes 및 S. Kille,

- "경량 디렉터리 액세스 프로토콜\(v3\): 속성 구문 정의", RFC 2252, 1997년 12월.

\[RFC 2277\] Alvestrand, H., "문자 집합 및 언어에 대한 IETF 정책", BCP 18, RFC 2277, 1998년 1월.

\[RFC 2279\] Yergeau, F., "UTF-8, ISO 10646의 변환 형식", RFC 2279, 1998년 1월.

\[RFC 2459\] Housley, R., W. Ford, W. Polk 및 D. Solo, "인터넷 X.509 공개 키 인프라: 인증서 및 CRL 프로필", RFC 2459, 1999년 1월.

\[RFC 2560\] Myers, M., R. Ankney, A. Malpani, S. Galperin 및 C. Adams, "온라인 인증서 상태 프로토콜 - OCSP", 1999년 6월.

```text
   [SDN.701]   SDN.701, "Message Security Protocol 4.0", Revision A,
               1997-02-06.
```

\[X.501\] ITU-T 권장 사항 X.501: 정보 기술 - 개방형 시스템 상호 연결 - 디렉토리: 모델, 1993.

\[X.509\] ITU-T 권고사항 X.509\(1997 E\): 정보

- 기술 - 개방형 시스템 상호 연결 - 디렉토리: 인증 프레임워크, 1997년 6월.

\[X.520\] ITU-T 권장 사항 X.520: 정보 기술 - 개방형 시스템 상호 연결 - 디렉토리: 선택된 속성 유형, 1993.

\[X.660\] ITU-T 권장사항 X.660 정보 기술 - ASN.1 인코딩 규칙: BER\(기본 인코딩 규칙\), CER\(정규 인코딩 규칙\) 및 DER\(고유 인코딩 규칙\) 사양, 1997.

\[X.690\] ITU-T 권장 사항 X.690 정보 기술 - 개방형 시스템 상호 연결 - OSI 등록 기관 운영 절차: 일반 절차, 1992.

\[X9.55\] ANSI X9.55-1995, 공개 키 암호화

- 금융 서비스 산업: 공개 키 인증서 및 인증서 취소 목록 확장, 1995년 12월 8일.

\[PKIXALGS\] Bassham, L., Polk, W. 및 R. Housley, "인터넷 X.509 공개 키 인프라 인증서 및 CRL\(인증서 해지 목록\) 프로필용 알고리즘 및 식별자", RFC 3279, 2002년 4월.

\[PKIXTSA\] Adams, C., Cain, P., Pinkas, D. 및 R. Zuccherato, "인터넷 X.509 공개 키 인프라 타임스탬프 프로토콜\(TSP\)", RFC 3161, 2001년 8월.

---
# **8  Intellectual Property Rights**

IETF는 본 문서에 포함된 사양의 일부 또는 전부와 관련하여 주장된 지적 재산권에 대해 통보 받았습니다. 자세한 내용은 청구된 권리의 온라인 목록을 참조하십시오\(http://www.ietf.org/ipr.html 참조\).

IETF는 이 문서에 설명된 기술의 구현 또는 사용과 관련이 있다고 주장될 수 있는 지적 재산권 또는 기타 권리의 유효성이나 범위 또는 그러한 권리에 따른 라이센스가 적용되거나 적용되지 않을 수 있는 범위에 대해 어떠한 입장도 취하지 않습니다. 사용 가능; 또한 그러한 권리를 확인하기 위해 어떠한 노력도 했다는 뜻도 아닙니다. 표준 트랙 및 권리에 관한 IETF 절차에 대한 정보

표준 관련 문서는 BCP 11에서 찾을 수 있습니다. 출판할 수 있는 권리 주장의 사본 및 사용 가능한 라이센스에 대한 보증, 또는 그러한 독점 사용에 대한 일반 라이센스나 허가를 얻으려는 시도의 결과 이 사양의 구현자 또는 사용자의 권리는 IETF 사무국에서 얻을 수 있습니다.

---
# **9  Security Considerations**

이 사양의 대부분은 인증서 및 CRL의 형식과 내용에 전념합니다. 인증서와 CRL은 디지털 서명되므로 추가 무결성 서비스가 필요하지 않습니다. 인증서나 CRL은 비밀로 유지될 필요가 없으며 인증서와 CRL에 대한 무제한 및 익명 액세스는 보안에 영향을 미치지 않습니다.

그러나 이 사양의 범위를 벗어나는 보안 요소는 인증서 사용자에게 제공되는 보증에 영향을 미칩니다. 이 섹션에서는 구현자, 관리자 및 사용자가 고려해야 할 중요한 문제를 강조합니다.

주체의 신원과 공개 키의 바인딩을 검증하기 위해 CA 및 RA가 수행하는 절차는 인증서에 포함되어야 하는 보증에 큰 영향을 미칩니다. 신뢰 당사자는 CA의 인증서 업무 정책을 검토할 수 있습니다. 이는 다른 CA에 인증서를 발급할 때 특히 중요합니다.

서명 및 기타 목적으로 단일 키 쌍을 사용하는 것은 강력히 권장되지 않습니다. 서명 및 키 관리를 위해 별도의 키 쌍을 사용하면 사용자에게 여러 가지 이점을 제공합니다. 서명 키의 분실 또는 공개와 관련된 결과는 키 관리 키의 분실 또는 공개와 다릅니다. 별도의 키 쌍을 사용하면 균형 있고 유연한 응답이 가능합니다. 마찬가지로, 일부 애플리케이션 환경에서는 각 키 쌍에 대해 서로 다른 유효 기간이나 키 길이가 적절할 수 있습니다. 불행하게도 일부 레거시 애플리케이션\(예: SSL\)은 서명 및 키 관리를 위해 단일 키 쌍을 사용합니다.

개인 키를 보호하는 것은 중요한 보안 요소입니다. 소규모에서는 사용자가 개인 키를 보호하지 못하면 공격자가 개인 키를 가장하거나 개인 정보를 해독할 수 있습니다. 더 큰 규모로 CA의 개인 서명 키가 손상되면 치명적인 영향을 미칠 수 있습니다. 공격자가 몰래 개인 키를 획득하면 공격자는 가짜 인증서와 CRL을 발급할 수 있습니다. 가짜 인증서와 CRL이 존재하면 시스템에 대한 신뢰가 약화됩니다. 그러한 손상이 감지되면 손상된 CA에 발급된 모든 인증서를 취소해야 합니다.\(MUST\)

해당 사용자와 다른 CA 사용자 간의 서비스. 이러한 손상 후 재구축하는 것은 문제가 될 수 있으므로 CA는 이러한 사고를 방지하기 위해 강력한 기술적 조치\(예: 변조 방지 암호화 모듈\)와 적절한 관리 절차\(예: 직무 분리\)를 조합하여 구현하는 것이 좋습니다.

CA의 개인 서명 키가 손실되는 경우에도 문제가 발생할 수 있습니다. CA는 CRL을 생성하거나 일반적인 키 롤오버를 수행할 수 없습니다. CA는 서명 키에 대한 보안 백업을 유지해야 합니다. 키 백업 절차의 보안은 키 손상을 방지하는 데 중요한 요소입니다.\(SHOULD\)

해지 정보의 가용성과 최신성은 인증서에 포함되어야 하는 보증 수준에 영향을 미칩니다. 인증서는 자연적으로 만료되지만, 자연 수명 동안 주체와 공개 키 간의 바인딩을 무효화하는 이벤트가 발생할 수 있습니다. 철회 정보가 시의적절하지 않거나 이용할 수 없는 경우 바인딩과 관련된 보증은 명백히 감소됩니다. 신뢰 당사자는 CRL에 나타날 수 있는 모든 중요한 확장을 처리하지 못할 수도 있습니다. CA는 중요한 확장이 포함된 CRL을 통해서만 해지 정보를 제공할 때 특히 주의해야 합니다. 특히 해당 확장에 대한 지원이 이 프로필에서 요구되지 않는 경우 더욱 그렇습니다. 예를 들어, 취소 정보가 델타 CRL과 전체 CRL의 조합을 사용하여 제공되고 델타 CRL이 전체 CRL보다 더 자주 발행되는 경우 델타 CRL 처리와 관련된 중요한 확장을 처리할 수 없는 신뢰 당사자는 다음을 수행할 수 없습니다. 가장 최근의 해지 정보를 얻으세요. 또는 델타 CRL이 발급될 때마다 전체 CRL이 발급되면 모든 신뢰 당사자가 적시에 해지 정보를 사용할 수 있습니다. 마찬가지로, 해지 확인을 생략하는 섹션 6에 설명된 인증 경로 유효성 검사 메커니즘의 구현은 이를 지원하는 것보다 낮은 보증을 제공합니다.\(SHOULD\)

인증 경로 유효성 검사 알고리즘은 하나 이상의 신뢰할 수 있는 CA에 대한 공개 키\(및 기타 정보\)에 대한 특정 지식에 따라 달라집니다. CA를 신뢰하기로 한 결정은 궁극적으로 인증서에 부여되는 신뢰를 결정하므로 중요한 결정입니다. 신뢰할 수 있는 CA 공개 키\(일반적으로 "자체 서명" 인증서 형식\)의 인증된 배포는 이 사양의 범위를 벗어나는 보안에 중요한 대역 외 프로세스입니다.

또한 신뢰할 수 있는 CA에 대해 키 손상이나 CA 오류가 발생하는 경우 사용자는 경로 유효성 검사 루틴에 제공된 정보를 수정해야 합니다. 신뢰할 수 있는 CA를 너무 많이 선택하면

신뢰할 수 있는 CA 정보를 유지 관리하기가 어렵습니다. 반면에 신뢰할 수 있는 CA를 하나만 선택하면 사용자가 폐쇄된 사용자 커뮤니티로 제한될 수 있습니다.

인증서를 처리하는 구현의 품질도 제공되는 보증 수준에 영향을 미칩니다. 섹션 6에 설명된 경로 유효성 검사 알고리즘은 신뢰할 수 있는 CA 정보의 무결성, 특히 신뢰할 수 있는 CA와 관련된 공개 키의 무결성에 의존합니다. 공격자는 개인 키를 가지고 있는 것을 공개 키로 대체함으로써 사용자가 거짓 인증서를 수락하도록 속일 수 있습니다.

키와 인증서 주체 간의 바인딩은 서명을 생성하는 데 사용되는 암호화 모듈 구현 및 알고리즘보다 강력할 수 없습니다. 키 길이가 짧거나 해시 알고리즘이 약하면 인증서의 유용성이 제한됩니다. CA는 강력한 암호화 기술을 사용할 수 있도록 암호화의 발전에 주목하는 것이 좋습니다. 또한 CA는 약한 서명을 생성하는 CA 또는 최종 엔터티에 대한 인증서 발급을 거부해야 합니다\(SHOULD\).\(SHOULD\)

이름 비교 규칙을 일관되지 않게 적용하면 유효하지 않은 X.509 인증 경로가 승인되거나 유효한 경로가 거부될 수 있습니다. X.500 사양 시리즈는 대소문자, 문자 집합, 다중 문자 공백 하위 문자열 또는 선행 및 후행 공백에 관계 없이 문자열을 비교해야 하는 고유 이름을 비교하기 위한 규칙을 정의합니다. 이 사양은 이러한 요구 사항을 완화하여 최소한 이진 비교에 대한 지원을 요구합니다.

CA는 CA 인증서의 제목 필드에 있는 고유 이름을 해당 CA가 발급한 인증서의 발급자 필드에 있는 고유 이름과 동일하게 인코딩해야 합니다. CA가 다른 인코딩을 사용하는 경우 구현 시 이 인증서가 포함된 경로의 이름 체인을 인식하지 못할 수 있습니다. 결과적으로 유효한 경로가 거부될 수 있습니다.\(MUST\)

또한 고유 이름에 대한 이름 제약 조건은 제목 필드 또는 subjectAltName 확장에 사용된 인코딩과 동일하게 명시되어야 합니다. 그렇지 않은 경우 ExcludedSubTrees로 명시된 이름 제약 조건은 일치하지 않고 잘못된 경로는 허용되며 allowedSubtrees로 표현된 이름 제약 조건은 일치하지 않으며 유효한 경로는 거부됩니다. 유효하지 않은 경로의 승인을 피하기 위해 CA는 가능한 경우 고유 이름에 대한 이름 제약 조건을 allowedSubtree로 명시해야 합니다.\(MUST, SHOULD\)

---
# **Appendix A.  Psuedo-ASN.1 Structures and OIDs**

이 섹션에서는 "ASN.1과 유사한" 구문으로 PKI 구성 요소를 준수하는 데 사용되는 데이터 개체에 대해 설명합니다. 이 구문은 1988 및 1993 ASN.1 구문을 혼합한 것입니다. 1988 ASN.1 구문은 1993 UNIVERSAL 유형 UniversalString, BMPString 및 UTF8String으로 확장되었습니다.

ASN.1 구문은 ASN.1 모듈에 유형 문을 포함하는 것을 허용하지 않으며, 1993 ASN.1 표준은 1988 구문을 사용하는 모듈에서 새로운 UNIVERSAL 유형의 사용을 허용하지 않습니다. 결과적으로 이 모듈은 ASN.1 표준의 두 버전 모두를 준수하지 않습니다.

이 부록은 UNIVERSAL 유형에 대한 정의를 1988 포괄적인 "ANY"로 대체하여 1988 ASN.1로 변환될 수 있습니다.

---
## **A.1 Explicitly Tagged Module, 1988 Syntax**

```text
PKIX1Explicit88 { iso(1) identified-organization(3) dod(6) internet(1)
  security(5) mechanisms(5) pkix(7) id-mod(0) id-pkix1-explicit(18) }
```

---
# **DEFINITIONS EXPLICIT TAGS ::=**
---
# **BEGIN**

```text
-- EXPORTS ALL --

-- IMPORTS NONE --
```

-- 1993년과 1998년 ASN.1에 정의된 UNIVERSAL 유형
-- 이 사양에서 요구하는 사항

UniversalString ::= \[UNIVERSAL 28\] IMPLICIT OCTET STRING -- UniversalString은 ASN.1:1993에 정의되어 있습니다.

BMPString ::= \[UNIVERSAL 30\] IMPLICIT OCTET STRING -- BMPString은 UniversalString 및 모델의 하위 유형입니다 -- ISO/IEC/ITU 10646-1의 기본 다국어 평면

UTF8String ::= \[UNIVERSAL 12\] IMPLICIT OCTET STRING -- 이 유형의 콘텐츠는 RFC 2279를 준수합니다.

```text
-- PKIX specific OIDs

id-pkix  OBJECT IDENTIFIER  ::=
         { iso(1) identified-organization(3) dod(6) internet(1)
                    security(5) mechanisms(5) pkix(7) }

-- PKIX arcs
```

id-pe OBJECT IDENTIFIER ::= { id-pkix 1 } -- 개인 인증서 확장을 위한 호
id-qt OBJECT IDENTIFIER ::= { id-pkix 2 } -- 정책 한정자 유형에 대한 호
id-kp OBJECT IDENTIFIER ::= { id-pkix 3 } -- 확장된 키 목적을 위한 호 OIDS
id-ad OBJECT IDENTIFIER ::= { id-pkix 48 } -- 액세스 설명자의 호

-- 인터넷 정책 한정자를 위한policyQualifierIds

```text
id-qt-cps      OBJECT IDENTIFIER ::=  { id-qt 1 }
      -- OID for CPS qualifier
id-qt-unotice  OBJECT IDENTIFIER ::=  { id-qt 2 }
      -- OID for user notice qualifier

-- access descriptor definitions

id-ad-ocsp         OBJECT IDENTIFIER ::= { id-ad 1 }
id-ad-caIssuers    OBJECT IDENTIFIER ::= { id-ad 2 }
id-ad-timeStamping OBJECT IDENTIFIER ::= { id-ad 3 }
id-ad-caRepository OBJECT IDENTIFIER ::= { id-ad 5 }

-- attribute data types

Attribute       ::=     SEQUENCE {
      type              AttributeType,
      values    SET OF AttributeValue }
            -- at least one value is required
```

---
# **AttributeType           ::=  OBJECT IDENTIFIER**
---
# **AttributeValue          ::=  ANY**

```text
AttributeTypeAndValue           ::=     SEQUENCE {
        type    AttributeType,
        value   AttributeValue }

-- suggested naming attributes: Definition of the following
--   information object set may be augmented to meet local
--   requirements.  Note that deleting members of the set may
--   prevent interoperability with conforming implementations.
-- presented in pairs: the AttributeType followed by the
--   type definition for the corresponding AttributeValue
--Arc for standard naming attributes
id-at OBJECT IDENTIFIER ::= { joint-iso-ccitt(2) ds(5) 4 }
```

-- X520name 유형의 이름 지정 속성

```text
id-at-name              AttributeType ::= { id-at 41 }
id-at-surname           AttributeType ::= { id-at 4 }
id-at-givenName         AttributeType ::= { id-at 42 }
id-at-initials          AttributeType ::= { id-at 43 }
id-at-generationQualifier AttributeType ::= { id-at 44 }

X520name ::= CHOICE {
      teletexString     TeletexString   (SIZE (1..ub-name)),
      printableString   PrintableString (SIZE (1..ub-name)),
      universalString   UniversalString (SIZE (1..ub-name)),
      utf8String        UTF8String      (SIZE (1..ub-name)),
      bmpString         BMPString       (SIZE (1..ub-name)) }
```

-- X520CommonName 유형의 이름 지정 속성

---
# **id-at-commonName        AttributeType ::= { id-at 3 }**

```text
X520CommonName ::= CHOICE {
      teletexString     TeletexString   (SIZE (1..ub-common-name)),
      printableString   PrintableString (SIZE (1..ub-common-name)),
      universalString   UniversalString (SIZE (1..ub-common-name)),
      utf8String        UTF8String      (SIZE (1..ub-common-name)),
      bmpString         BMPString       (SIZE (1..ub-common-name)) }
```

-- X520LocalityName 유형의 이름 지정 속성

---
# **id-at-localityName      AttributeType ::= { id-at 7 }**

```text
X520LocalityName ::= CHOICE {
      teletexString     TeletexString   (SIZE (1..ub-locality-name)),
      printableString   PrintableString (SIZE (1..ub-locality-name)),
      universalString   UniversalString (SIZE (1..ub-locality-name)),
      utf8String        UTF8String      (SIZE (1..ub-locality-name)),
      bmpString         BMPString       (SIZE (1..ub-locality-name)) }
```

-- X520StateOrProvinceName 유형의 이름 지정 속성

---
# **id-at-stateOrProvinceName AttributeType ::= { id-at 8 }**

```text
X520StateOrProvinceName ::= CHOICE {
      teletexString     TeletexString   (SIZE (1..ub-state-name)),
      printableString   PrintableString (SIZE (1..ub-state-name)),
      universalString   UniversalString (SIZE (1..ub-state-name)),
      utf8String        UTF8String      (SIZE (1..ub-state-name)),
      bmpString         BMPString       (SIZE(1..ub-state-name)) }
```

-- X520OrganizationName 유형의 이름 지정 속성

---
# **id-at-organizationName  AttributeType ::= { id-at 10 }**

```text
X520OrganizationName ::= CHOICE {
      teletexString     TeletexString
                          (SIZE (1..ub-organization-name)),
      printableString   PrintableString
                          (SIZE (1..ub-organization-name)),
      universalString   UniversalString
                          (SIZE (1..ub-organization-name)),
      utf8String        UTF8String
                          (SIZE (1..ub-organization-name)),
      bmpString         BMPString
                          (SIZE (1..ub-organization-name))  }
```

-- X520OrganizationalUnitName 유형의 이름 지정 속성

---
# **id-at-organizationalUnitName AttributeType ::= { id-at 11 }**

```text
X520OrganizationalUnitName ::= CHOICE {
      teletexString     TeletexString
                          (SIZE (1..ub-organizational-unit-name)),
      printableString   PrintableString
                          (SIZE (1..ub-organizational-unit-name)),
      universalString   UniversalString
                          (SIZE (1..ub-organizational-unit-name)),
      utf8String        UTF8String
                          (SIZE (1..ub-organizational-unit-name)),
      bmpString         BMPString
                          (SIZE (1..ub-organizational-unit-name)) }
```

-- X520Title 유형의 이름 지정 속성

---
# **id-at-title             AttributeType ::= { id-at 12 }**

```text
X520Title ::= CHOICE {
      teletexString     TeletexString   (SIZE (1..ub-title)),
      printableString   PrintableString (SIZE (1..ub-title)),
      universalString   UniversalString (SIZE (1..ub-title)),
      utf8String        UTF8String      (SIZE (1..ub-title)),
      bmpString         BMPString       (SIZE (1..ub-title)) }
```

-- X520dnQualifier 유형의 이름 지정 속성

---
# **id-at-dnQualifier       AttributeType ::= { id-at 46 }**
---
# **X520dnQualifier ::=     PrintableString**

```text
-- Naming attributes of type X520countryName (digraph from IS 3166)
```

---
# **id-at-countryName       AttributeType ::= { id-at 6 }**
---
# **X520countryName ::=     PrintableString (SIZE (2))**

-- X520SerialNumber 유형의 이름 지정 속성

---
# **id-at-serialNumber      AttributeType ::= { id-at 5 }**
---
# **X520SerialNumber ::=    PrintableString (SIZE (1..ub-serial-number))**

-- X520Pseudonym 유형의 이름 지정 속성

---
# **id-at-pseudonym         AttributeType ::= { id-at 65 }**

```text
X520Pseudonym ::= CHOICE {
   teletexString     TeletexString   (SIZE (1..ub-pseudonym)),
   printableString   PrintableString (SIZE (1..ub-pseudonym)),
   universalString   UniversalString (SIZE (1..ub-pseudonym)),
   utf8String        UTF8String      (SIZE (1..ub-pseudonym)),
   bmpString         BMPString       (SIZE (1..ub-pseudonym)) }

-- Naming attributes of type DomainComponent (from RFC 2247)

id-domainComponent      AttributeType ::=
                          { 0 9 2342 19200300 100 1 25 }
```

---
# **DomainComponent ::=     IA5String**

```text
-- Legacy attributes

pkcs-9 OBJECT IDENTIFIER ::=
       { iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) 9 }
```

---
# **id-emailAddress          AttributeType ::= { pkcs-9 1 }**
---
# **EmailAddress ::=         IA5String (SIZE (1..ub-emailaddress-length))**

```text
-- naming data types --

Name ::= CHOICE { -- only one possibility for now --
      rdnSequence  RDNSequence }
```

---
# **RDNSequence ::= SEQUENCE OF RelativeDistinguishedName**
---
# **DistinguishedName ::=   RDNSequence**

RelativeDistinguishedName ::= AttributeTypeAndValue의 크기 설정\(1 .. MAX\)

```text
-- Directory string type --

DirectoryString ::= CHOICE {
      teletexString             TeletexString   (SIZE (1..MAX)),
      printableString           PrintableString (SIZE (1..MAX)),
      universalString           UniversalString (SIZE (1..MAX)),
      utf8String              UTF8String      (SIZE (1..MAX)),
      bmpString               BMPString       (SIZE (1..MAX)) }
```

-- 인증서 및 CRL 특정 구조가 여기에서 시작됩니다.

```text
Certificate  ::=  SEQUENCE  {
     tbsCertificate       TBSCertificate,
     signatureAlgorithm   AlgorithmIdentifier,
     signature            BIT STRING  }

TBSCertificate  ::=  SEQUENCE  {
     version         [0]  Version DEFAULT v1,
     serialNumber         CertificateSerialNumber,
     signature            AlgorithmIdentifier,
     issuer               Name,
     validity             Validity,
     subject              Name,
     subjectPublicKeyInfo SubjectPublicKeyInfo,
     issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,
                          -- If present, version MUST be v2 or v3
     subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL,
                          -- If present, version MUST be v2 or v3
     extensions      [3]  Extensions OPTIONAL
                          -- If present, version MUST be v3 --  }
```

---
# **Version  ::=  INTEGER  {  v1(0), v2(1), v3(2)  }**
---
# **CertificateSerialNumber  ::=  INTEGER**

```text
Validity ::= SEQUENCE {
     notBefore      Time,
     notAfter       Time  }

Time ::= CHOICE {
     utcTime        UTCTime,
     generalTime    GeneralizedTime }
```

---
# **UniqueIdentifier  ::=  BIT STRING**

```text
SubjectPublicKeyInfo  ::=  SEQUENCE  {
     algorithm            AlgorithmIdentifier,
     subjectPublicKey     BIT STRING  }
```

---
# **Extensions  ::=  SEQUENCE SIZE (1..MAX) OF Extension**

```text
Extension  ::=  SEQUENCE  {
     extnID      OBJECT IDENTIFIER,
     critical    BOOLEAN DEFAULT FALSE,
     extnValue   OCTET STRING  }

-- CRL structures

CertificateList  ::=  SEQUENCE  {
     tbsCertList          TBSCertList,
     signatureAlgorithm   AlgorithmIdentifier,
     signature            BIT STRING  }

TBSCertList  ::=  SEQUENCE  {
     version                 Version OPTIONAL,
                                  -- if present, MUST be v2
     signature               AlgorithmIdentifier,
     issuer                  Name,
     thisUpdate              Time,
     nextUpdate              Time OPTIONAL,
     revokedCertificates     SEQUENCE OF SEQUENCE  {
          userCertificate         CertificateSerialNumber,
          revocationDate          Time,
          crlEntryExtensions      Extensions OPTIONAL
                                         -- if present, MUST be v2
                               }  OPTIONAL,
     crlExtensions           [0] Extensions OPTIONAL }
                                         -- if present, MUST be v2
```

-- 버전, 시간, 인증서 일련번호 및 확장자는 다음과 같습니다.
-- 인증서 구조에 사용하기 위해 앞서 정의됨

```text
AlgorithmIdentifier  ::=  SEQUENCE  {
     algorithm               OBJECT IDENTIFIER,
     parameters              ANY DEFINED BY algorithm OPTIONAL  }
                                -- contains a value of the type
                                -- registered for use with the
                                -- algorithm object identifier value

-- X.400 address syntax starts here

ORAddress ::= SEQUENCE {
   built-in-standard-attributes BuiltInStandardAttributes,
   built-in-domain-defined-attributes
                   BuiltInDomainDefinedAttributes OPTIONAL,
   -- see also teletex-domain-defined-attributes
   extension-attributes ExtensionAttributes OPTIONAL }

-- Built-in Standard Attributes

BuiltInStandardAttributes ::= SEQUENCE {
   country-name                  CountryName OPTIONAL,
   administration-domain-name    AdministrationDomainName OPTIONAL,
   network-address           [0] IMPLICIT NetworkAddress OPTIONAL,
     -- see also extended-network-address
   terminal-identifier       [1] IMPLICIT TerminalIdentifier OPTIONAL,
   private-domain-name       [2] PrivateDomainName OPTIONAL,
   organization-name         [3] IMPLICIT OrganizationName OPTIONAL,
     -- see also teletex-organization-name
   numeric-user-identifier   [4] IMPLICIT NumericUserIdentifier
                                 OPTIONAL,
   personal-name             [5] IMPLICIT PersonalName OPTIONAL,
     -- see also teletex-personal-name
   organizational-unit-names [6] IMPLICIT OrganizationalUnitNames
                                 OPTIONAL }
     -- see also teletex-organizational-unit-names

CountryName ::= [APPLICATION 1] CHOICE {
   x121-dcc-code         NumericString
                           (SIZE (ub-country-name-numeric-length)),
   iso-3166-alpha2-code  PrintableString
                           (SIZE (ub-country-name-alpha-length)) }

AdministrationDomainName ::= [APPLICATION 2] CHOICE {
   numeric   NumericString   (SIZE (0..ub-domain-name-length)),
   printable PrintableString (SIZE (0..ub-domain-name-length)) }
```

---
# **NetworkAddress ::= X121Address  -- see also extended-network-address**
---
# **X121Address ::= NumericString (SIZE (1..ub-x121-address-length))**

```text
TerminalIdentifier ::= PrintableString (SIZE
(1..ub-terminal-id-length))

PrivateDomainName ::= CHOICE {
   numeric   NumericString   (SIZE (1..ub-domain-name-length)),
   printable PrintableString (SIZE (1..ub-domain-name-length)) }

OrganizationName ::= PrintableString
                            (SIZE (1..ub-organization-name-length))
  -- see also teletex-organization-name

NumericUserIdentifier ::= NumericString
                            (SIZE (1..ub-numeric-user-id-length))

PersonalName ::= SET {
   surname     [0] IMPLICIT PrintableString
                    (SIZE (1..ub-surname-length)),
   given-name  [1] IMPLICIT PrintableString
                    (SIZE (1..ub-given-name-length)) OPTIONAL,
   initials    [2] IMPLICIT PrintableString
                    (SIZE (1..ub-initials-length)) OPTIONAL,
   generation-qualifier [3] IMPLICIT PrintableString
                    (SIZE (1..ub-generation-qualifier-length))
                    OPTIONAL }
  -- see also teletex-personal-name
```

OrganizationalUnitNames ::= SEQUENCE SIZE \(1..ub-organizational-units\) OF OrganizationalUnitName -- teletex-organizational-unit-names도 참조하세요.

```text
OrganizationalUnitName ::= PrintableString (SIZE
                    (1..ub-organizational-unit-name-length))

-- Built-in Domain-defined Attributes
```

BuildInDomainDefinedAttributes ::= SEQUENCE SIZE \(1..ub-domain-defined-attributes\) OF BuildInDomainDefinedAttribute

```text
BuiltInDomainDefinedAttribute ::= SEQUENCE {
   type PrintableString (SIZE
                   (1..ub-domain-defined-attribute-type-length)),
   value PrintableString (SIZE
                   (1..ub-domain-defined-attribute-value-length)) }

-- Extension Attributes
```

ExtensionAttributes ::= SET SIZE\(1..ub-extension-attributes\) OF ExtensionAttribute

```text
ExtensionAttribute ::=  SEQUENCE {
   extension-attribute-type [0] IMPLICIT INTEGER
                   (0..ub-extension-attributes),
   extension-attribute-value [1]
                   ANY DEFINED BY extension-attribute-type }
```

-- 확장 유형 및 속성 값

---
# **common-name INTEGER ::= 1**
---
# **CommonName ::= PrintableString (SIZE (1..ub-common-name-length))**
---
# **teletex-common-name INTEGER ::= 2**
---
# **TeletexCommonName ::= TeletexString (SIZE (1..ub-common-name-length))**
---
# **teletex-organization-name INTEGER ::= 3**

```text
TeletexOrganizationName ::=
                TeletexString (SIZE (1..ub-organization-name-length))
```

---
# **teletex-personal-name INTEGER ::= 4**

```text
TeletexPersonalName ::= SET {
   surname     [0] IMPLICIT TeletexString
                    (SIZE (1..ub-surname-length)),
   given-name  [1] IMPLICIT TeletexString
                    (SIZE (1..ub-given-name-length)) OPTIONAL,
   initials    [2] IMPLICIT TeletexString
                    (SIZE (1..ub-initials-length)) OPTIONAL,
   generation-qualifier [3] IMPLICIT TeletexString
                    (SIZE (1..ub-generation-qualifier-length))
                    OPTIONAL }
```

---
# **teletex-organizational-unit-names INTEGER ::= 5**

TeletexOrganizationalUnitNames ::= TeletexOrganizationalUnitName의 시퀀스 크기\(1..ub-organizational-units\)

```text
TeletexOrganizationalUnitName ::= TeletexString
                  (SIZE (1..ub-organizational-unit-name-length))
```

---
# **pds-name INTEGER ::= 7**
---
# **PDSName ::= PrintableString (SIZE (1..ub-pds-name-length))**
---
# **physical-delivery-country-name INTEGER ::= 8**

```text
PhysicalDeliveryCountryName ::= CHOICE {
   x121-dcc-code NumericString (SIZE
(ub-country-name-numeric-length)),
   iso-3166-alpha2-code PrintableString
                  (SIZE (ub-country-name-alpha-length)) }
```

---
# **postal-code INTEGER ::= 9**

```text
PostalCode ::= CHOICE {
   numeric-code NumericString (SIZE (1..ub-postal-code-length)),
   printable-code PrintableString (SIZE (1..ub-postal-code-length)) }
```

---
# **physical-delivery-office-name INTEGER ::= 10**
---
# **PhysicalDeliveryOfficeName ::= PDSParameter**
---
# **physical-delivery-office-number INTEGER ::= 11**
---
# **PhysicalDeliveryOfficeNumber ::= PDSParameter**
---
# **extension-OR-address-components INTEGER ::= 12**
---
# **ExtensionORAddressComponents ::= PDSParameter**
---
# **physical-delivery-personal-name INTEGER ::= 13**
---
# **PhysicalDeliveryPersonalName ::= PDSParameter**
---
# **physical-delivery-organization-name INTEGER ::= 14**
---
# **PhysicalDeliveryOrganizationName ::= PDSParameter**
---
# **extension-physical-delivery-address-components INTEGER ::= 15**
---
# **ExtensionPhysicalDeliveryAddressComponents ::= PDSParameter**
---
# **unformatted-postal-address INTEGER ::= 16**

```text
UnformattedPostalAddress ::= SET {
   printable-address SEQUENCE SIZE (1..ub-pds-physical-address-lines)
         OF PrintableString (SIZE (1..ub-pds-parameter-length))
         OPTIONAL,
   teletex-string TeletexString
         (SIZE (1..ub-unformatted-address-length)) OPTIONAL }
```

---
# **street-address INTEGER ::= 17**
---
# **StreetAddress ::= PDSParameter**
---
# **post-office-box-address INTEGER ::= 18**
---
# **PostOfficeBoxAddress ::= PDSParameter**
---
# **poste-restante-address INTEGER ::= 19**
---
# **PosteRestanteAddress ::= PDSParameter**
---
# **unique-postal-name INTEGER ::= 20**
---
# **UniquePostalName ::= PDSParameter**
---
# **local-postal-attributes INTEGER ::= 21**
---
# **LocalPostalAttributes ::= PDSParameter**

```text
PDSParameter ::= SET {
   printable-string PrintableString
                (SIZE(1..ub-pds-parameter-length)) OPTIONAL,
   teletex-string TeletexString
                (SIZE(1..ub-pds-parameter-length)) OPTIONAL }
```

---
# **extended-network-address INTEGER ::= 22**

```text
ExtendedNetworkAddress ::= CHOICE {
   e163-4-address SEQUENCE {
      number      [0] IMPLICIT NumericString
                       (SIZE (1..ub-e163-4-number-length)),
      sub-address [1] IMPLICIT NumericString
                       (SIZE (1..ub-e163-4-sub-address-length))
                       OPTIONAL },
   psap-address [0] IMPLICIT PresentationAddress }

PresentationAddress ::= SEQUENCE {
    pSelector     [0] EXPLICIT OCTET STRING OPTIONAL,
    sSelector     [1] EXPLICIT OCTET STRING OPTIONAL,
    tSelector     [2] EXPLICIT OCTET STRING OPTIONAL,
    nAddresses    [3] EXPLICIT SET SIZE (1..MAX) OF OCTET STRING }
```

---
# **terminal-type  INTEGER ::= 23**

```text
TerminalType ::= INTEGER {
   telex (3),
   teletex (4),
   g3-facsimile (5),
   g4-facsimile (6),
   ia5-terminal (7),
   videotex (8) } (0..ub-integer-options)

-- Extension Domain-defined Attributes
```

---
# **teletex-domain-defined-attributes INTEGER ::= 6**

TeletexDomainDefinedAttributes ::= TeletexDomainDefinedAttribute의 SEQUENCE SIZE \(1..ub-domain-defined-attributes\)

```text
TeletexDomainDefinedAttribute ::= SEQUENCE {
        type TeletexString
               (SIZE (1..ub-domain-defined-attribute-type-length)),
        value TeletexString
               (SIZE (1..ub-domain-defined-attribute-value-length)) }
```

-- 상한의 사양은 필수 사항으로 간주되어야 합니다.
-- ITU-T X.411 부록 B의 MTS 매개변수 참조 정의
-- 상한\(MUST\)

```text
-- Upper Bounds
ub-name INTEGER ::= 32768
ub-common-name INTEGER ::= 64
ub-locality-name INTEGER ::= 128
ub-state-name INTEGER ::= 128
ub-organization-name INTEGER ::= 64
ub-organizational-unit-name INTEGER ::= 64
ub-title INTEGER ::= 64
ub-serial-number INTEGER ::= 64
ub-match INTEGER ::= 128
ub-emailaddress-length INTEGER ::= 128
ub-common-name-length INTEGER ::= 64
ub-country-name-alpha-length INTEGER ::= 2
ub-country-name-numeric-length INTEGER ::= 3
ub-domain-defined-attributes INTEGER ::= 4
ub-domain-defined-attribute-type-length INTEGER ::= 8
ub-domain-defined-attribute-value-length INTEGER ::= 128
ub-domain-name-length INTEGER ::= 16
ub-extension-attributes INTEGER ::= 256
ub-e163-4-number-length INTEGER ::= 15
ub-e163-4-sub-address-length INTEGER ::= 40
ub-generation-qualifier-length INTEGER ::= 3
ub-given-name-length INTEGER ::= 16
ub-initials-length INTEGER ::= 5
ub-integer-options INTEGER ::= 256
ub-numeric-user-id-length INTEGER ::= 32
ub-organization-name-length INTEGER ::= 64
ub-organizational-unit-name-length INTEGER ::= 32
ub-organizational-units INTEGER ::= 4
ub-pds-name-length INTEGER ::= 16
ub-pds-parameter-length INTEGER ::= 30
ub-pds-physical-address-lines INTEGER ::= 6
ub-postal-code-length INTEGER ::= 16
ub-pseudonym INTEGER ::= 128
ub-surname-length INTEGER ::= 40

ub-terminal-id-length INTEGER ::= 24
ub-unformatted-address-length INTEGER ::= 180
ub-x121-address-length INTEGER ::= 16
```

-- 참고 - TeletexString과 같은 문자열 유형의 상한은 다음과 같습니다.
-- 문자로 측정됩니다. PrintableString 또는 IA5String을 제외하고
-- 보유하려면 훨씬 더 많은 수의 옥텟이 필요합니다.
-- 그런 가치. 최소 16옥텟 또는 지정된 옥텟의 두 배
-- 상한값 중 더 큰 값이 허용되어야 합니다.
-- 텔레텍스스트링. UTF8String 또는 UniversalString의 경우 최소 4개
-- 시간 상한이 허용되어야 합니다.

---
# **END**
---
## **A.2 Implicitly Tagged Module, 1988 Syntax**

```text
PKIX1Implicit88 { iso(1) identified-organization(3) dod(6) internet(1)
  security(5) mechanisms(5) pkix(7) id-mod(0) id-pkix1-implicit(19) }
```

---
# **DEFINITIONS IMPLICIT TAGS ::=**
---
# **BEGIN**

```text
-- EXPORTS ALL --

IMPORTS
      id-pe, id-kp, id-qt-unotice, id-qt-cps,
      -- delete following line if "new" types are supported --
      BMPString, UTF8String,  -- end "new" types --
      ORAddress, Name, RelativeDistinguishedName,
      CertificateSerialNumber, Attribute, DirectoryString
      FROM PKIX1Explicit88 { iso(1) identified-organization(3)
            dod(6) internet(1) security(5) mechanisms(5) pkix(7)
            id-mod(0) id-pkix1-explicit(18) };
```

-- 표준 인증서 및 CRL 확장을 위한 ISO 아크

---
# **id-ce OBJECT IDENTIFIER  ::=  {joint-iso-ccitt(2) ds(5) 29}**

-- 권한 키 식별자 OID 및 구문

---
# **id-ce-authorityKeyIdentifier OBJECT IDENTIFIER ::=  { id-ce 35 }**

```text
AuthorityKeyIdentifier ::= SEQUENCE {
    keyIdentifier             [0] KeyIdentifier            OPTIONAL,
    authorityCertIssuer       [1] GeneralNames             OPTIONAL,
    authorityCertSerialNumber [2] CertificateSerialNumber  OPTIONAL }
    -- authorityCertIssuer and authorityCertSerialNumber MUST both
    -- be present or both be absent
```

---
# **KeyIdentifier ::= OCTET STRING**

-- 주체 키 식별자 OID 및 구문

---
# **id-ce-subjectKeyIdentifier OBJECT IDENTIFIER ::=  { id-ce 14 }**
---
# **SubjectKeyIdentifier ::= KeyIdentifier**

-- 키 사용 확장 OID 및 구문

---
# **id-ce-keyUsage OBJECT IDENTIFIER ::=  { id-ce 15 }**

```text
KeyUsage ::= BIT STRING {
     digitalSignature        (0),
     nonRepudiation          (1),
     keyEncipherment         (2),
     dataEncipherment        (3),
     keyAgreement            (4),
     keyCertSign             (5),
     cRLSign                 (6),
     encipherOnly            (7),
     decipherOnly            (8) }
```

-- 개인키 사용기간 연장 OID 및 구문

---
# **id-ce-privateKeyUsagePeriod OBJECT IDENTIFIER ::=  { id-ce 16 }**

```text
PrivateKeyUsagePeriod ::= SEQUENCE {
     notBefore       [0]     GeneralizedTime OPTIONAL,
     notAfter        [1]     GeneralizedTime OPTIONAL }
     -- either notBefore or notAfter MUST be present
```

-- 인증서 정책 확장 OID 및 구문

---
# **id-ce-certificatePolicies OBJECT IDENTIFIER ::=  { id-ce 32 }**
---
# **anyPolicy OBJECT IDENTIFIER ::= { id-ce-certificatePolicies 0 }**
---
# **CertificatePolicies ::= SEQUENCE SIZE (1..MAX) OF PolicyInformation**
---
# **PolicyInformation ::= SEQUENCE {**

```text
     policyIdentifier   CertPolicyId,
     policyQualifiers   SEQUENCE SIZE (1..MAX) OF
             PolicyQualifierInfo OPTIONAL }
```

---
# **CertPolicyId ::= OBJECT IDENTIFIER**

```text
PolicyQualifierInfo ::= SEQUENCE {
       policyQualifierId  PolicyQualifierId,
       qualifier        ANY DEFINED BY policyQualifierId }
```

-- 추가 정책 한정자를 인식하는 구현은 반드시
-- PolicyQualifierId에 대한 다음 정의를 보강합니다.\(MUST\)

```text
PolicyQualifierId ::=
    OBJECT IDENTIFIER ( id-qt-cps | id-qt-unotice )

-- CPS pointer qualifier
```

---
# **CPSuri ::= IA5String**

```text
-- user notice qualifier

UserNotice ::= SEQUENCE {
     noticeRef        NoticeReference OPTIONAL,
     explicitText     DisplayText OPTIONAL}

NoticeReference ::= SEQUENCE {
     organization     DisplayText,
     noticeNumbers    SEQUENCE OF INTEGER }

DisplayText ::= CHOICE {
     ia5String        IA5String      (SIZE (1..200)),
     visibleString    VisibleString  (SIZE (1..200)),
     bmpString        BMPString      (SIZE (1..200)),
     utf8String       UTF8String     (SIZE (1..200)) }
```

-- 정책 매핑 확장 OID 및 구문

---
# **id-ce-policyMappings OBJECT IDENTIFIER ::=  { id-ce 33 }**

```text
PolicyMappings ::= SEQUENCE SIZE (1..MAX) OF SEQUENCE {
     issuerDomainPolicy      CertPolicyId,
     subjectDomainPolicy     CertPolicyId }
```

-- 주체 대체 이름 확장자 OID 및 구문

---
# **id-ce-subjectAltName OBJECT IDENTIFIER ::=  { id-ce 17 }**
---
# **SubjectAltName ::= GeneralNames**
---
# **GeneralNames ::= SEQUENCE SIZE (1..MAX) OF GeneralName**

```text
GeneralName ::= CHOICE {
     otherName                       [0]     AnotherName,
     rfc822Name                      [1]     IA5String,
     dNSName                         [2]     IA5String,
     x400Address                     [3]     ORAddress,
     directoryName                   [4]     Name,
     ediPartyName                    [5]     EDIPartyName,
     uniformResourceIdentifier       [6]     IA5String,
     iPAddress                       [7]     OCTET STRING,
     registeredID                    [8]     OBJECT IDENTIFIER }
```

-- AnotherName은 OTHER-NAME ::= TYPE-IDENTIFIER를 대체합니다.
-- TYPE-IDENTIFIER는 '88 ASN.1 구문에서 지원되지 않습니다.

```text
AnotherName ::= SEQUENCE {
     type-id    OBJECT IDENTIFIER,
     value      [0] EXPLICIT ANY DEFINED BY type-id }

EDIPartyName ::= SEQUENCE {
     nameAssigner            [0]     DirectoryString OPTIONAL,
     partyName               [1]     DirectoryString }
```

-- 발급자 대체 이름 확장자 OID 및 구문

---
# **id-ce-issuerAltName OBJECT IDENTIFIER ::=  { id-ce 18 }**
---
# **IssuerAltName ::= GeneralNames**
---
# **id-ce-subjectDirectoryAttributes OBJECT IDENTIFIER ::=  { id-ce 9 }**
---
# **SubjectDirectoryAttributes ::= SEQUENCE SIZE (1..MAX) OF Attribute**

-- 기본 제약 확장 OID 및 구문

---
# **id-ce-basicConstraints OBJECT IDENTIFIER ::=  { id-ce 19 }**

```text
BasicConstraints ::= SEQUENCE {
     cA                      BOOLEAN DEFAULT FALSE,
     pathLenConstraint       INTEGER (0..MAX) OPTIONAL }
```

-- 이름 제약 확장 OID 및 구문

---
# **id-ce-nameConstraints OBJECT IDENTIFIER ::=  { id-ce 30 }**

```text
NameConstraints ::= SEQUENCE {
     permittedSubtrees       [0]     GeneralSubtrees OPTIONAL,
     excludedSubtrees        [1]     GeneralSubtrees OPTIONAL }
```

---
# **GeneralSubtrees ::= SEQUENCE SIZE (1..MAX) OF GeneralSubtree**

```text
GeneralSubtree ::= SEQUENCE {
     base                    GeneralName,
     minimum         [0]     BaseDistance DEFAULT 0,
     maximum         [1]     BaseDistance OPTIONAL }
```

---
# **BaseDistance ::= INTEGER (0..MAX)**

-- 정책 제약 확장 OID 및 구문

---
# **id-ce-policyConstraints OBJECT IDENTIFIER ::=  { id-ce 36 }**

```text
PolicyConstraints ::= SEQUENCE {
     requireExplicitPolicy           [0] SkipCerts OPTIONAL,
     inhibitPolicyMapping            [1] SkipCerts OPTIONAL }
```

---
# **SkipCerts ::= INTEGER (0..MAX)**

-- CRL 배포 지점 확장 OID 및 구문

---
# **id-ce-cRLDistributionPoints     OBJECT IDENTIFIER  ::=  {id-ce 31}**
---
# **CRLDistributionPoints ::= SEQUENCE SIZE (1..MAX) OF DistributionPoint**

```text
DistributionPoint ::= SEQUENCE {
     distributionPoint       [0]     DistributionPointName OPTIONAL,
     reasons                 [1]     ReasonFlags OPTIONAL,
     cRLIssuer               [2]     GeneralNames OPTIONAL }

DistributionPointName ::= CHOICE {
     fullName                [0]     GeneralNames,
     nameRelativeToCRLIssuer [1]     RelativeDistinguishedName }

ReasonFlags ::= BIT STRING {
     unused                  (0),
     keyCompromise           (1),
     cACompromise            (2),
     affiliationChanged      (3),
     superseded              (4),
     cessationOfOperation    (5),
     certificateHold         (6),
     privilegeWithdrawn      (7),
     aACompromise            (8) }
```

-- 확장된 키 사용 확장 OID 및 구문

---
# **id-ce-extKeyUsage OBJECT IDENTIFIER ::= {id-ce 37}**
---
# **ExtKeyUsageSyntax ::= SEQUENCE SIZE (1..MAX) OF KeyPurposeId**
---
# **KeyPurposeId ::= OBJECT IDENTIFIER**

```text
-- permit unspecified key uses
```

---
# **anyExtendedKeyUsage OBJECT IDENTIFIER ::= { id-ce-extKeyUsage 0 }**

```text
-- extended key purpose OIDs

id-kp-serverAuth             OBJECT IDENTIFIER ::= { id-kp 1 }
id-kp-clientAuth             OBJECT IDENTIFIER ::= { id-kp 2 }
id-kp-codeSigning            OBJECT IDENTIFIER ::= { id-kp 3 }
id-kp-emailProtection        OBJECT IDENTIFIER ::= { id-kp 4 }
id-kp-timeStamping           OBJECT IDENTIFIER ::= { id-kp 8 }
id-kp-OCSPSigning            OBJECT IDENTIFIER ::= { id-kp 9 }
```

-- 모든 정책 OID 및 구문을 금지합니다.

---
# **id-ce-inhibitAnyPolicy OBJECT IDENTIFIER ::=  { id-ce 54 }**
---
# **InhibitAnyPolicy ::= SkipCerts**

-- 최신 \(델타\)CRL 확장 OID 및 구문

---
# **id-ce-freshestCRL OBJECT IDENTIFIER ::=  { id-ce 46 }**
---
# **FreshestCRL ::= CRLDistributionPoints**

```text
-- authority info access
```

---
# **id-pe-authorityInfoAccess OBJECT IDENTIFIER ::= { id-pe 1 }**

AuthorityInfoAccessSyntax ::= AccessDescription의 시퀀스 크기\(1..MAX\)

```text
AccessDescription  ::=  SEQUENCE {
        accessMethod          OBJECT IDENTIFIER,
        accessLocation        GeneralName  }

-- subject info access
```

---
# **id-pe-subjectInfoAccess OBJECT IDENTIFIER ::= { id-pe 11 }**

SubjectInfoAccessSyntax ::= 액세스 설명의 시퀀스 크기\(1..MAX\)

-- CRL 번호 확장 OID 및 구문

---
# **id-ce-cRLNumber OBJECT IDENTIFIER ::= { id-ce 20 }**
---
# **CRLNumber ::= INTEGER (0..MAX)**

-- 배포 지점 확장 OID 및 구문 발급

---
# **id-ce-issuingDistributionPoint OBJECT IDENTIFIER ::= { id-ce 28 }**

```text
IssuingDistributionPoint ::= SEQUENCE {
     distributionPoint          [0] DistributionPointName OPTIONAL,
     onlyContainsUserCerts      [1] BOOLEAN DEFAULT FALSE,
     onlyContainsCACerts        [2] BOOLEAN DEFAULT FALSE,
     onlySomeReasons            [3] ReasonFlags OPTIONAL,
     indirectCRL                [4] BOOLEAN DEFAULT FALSE,
     onlyContainsAttributeCerts [5] BOOLEAN DEFAULT FALSE }
```

---
# **id-ce-deltaCRLIndicator OBJECT IDENTIFIER ::= { id-ce 27 }**
---
# **BaseCRLNumber ::= CRLNumber**

-- CRL 이유 확장 OID 및 구문

---
# **id-ce-cRLReasons OBJECT IDENTIFIER ::= { id-ce 21 }**

```text
CRLReason ::= ENUMERATED {
     unspecified             (0),
     keyCompromise           (1),
     cACompromise            (2),
     affiliationChanged      (3),
     superseded              (4),
     cessationOfOperation    (5),
     certificateHold         (6),
     removeFromCRL           (8),
     privilegeWithdrawn      (9),
     aACompromise           (10) }
```

-- 인증서 발급자 CRL 항목 확장 OID 및 구문

---
# **id-ce-certificateIssuer OBJECT IDENTIFIER ::= { id-ce 29 }**
---
# **CertificateIssuer ::= GeneralNames**

-- 명령어 확장 OID 및 구문 보유

---
# **id-ce-holdInstructionCode OBJECT IDENTIFIER ::= { id-ce 23 }**
---
# **HoldInstructionCode ::= OBJECT IDENTIFIER**

```text
-- ANSI x9 holdinstructions

-- ANSI x9 arc holdinstruction arc

holdInstruction OBJECT IDENTIFIER ::=
          {joint-iso-itu-t(2) member-body(2) us(840) x9cm(10040) 2}
```

-- 이 표준에서 참조하는 ANSI X9 홀드 명령어

```text
id-holdinstruction-none OBJECT IDENTIFIER  ::=
                {holdInstruction 1} -- deprecated

id-holdinstruction-callissuer OBJECT IDENTIFIER ::=
                {holdInstruction 2}

id-holdinstruction-reject OBJECT IDENTIFIER ::=
                {holdInstruction 3}
```

-- 무효 날짜 CRL 항목 확장 OID 및 구문

---
# **id-ce-invalidityDate OBJECT IDENTIFIER ::= { id-ce 24 }**
---
# **InvalidityDate ::=  GeneralizedTime**
---
# **END**
---
# **Appendix B.  ASN.1 Notes**

CA는 serialNumber가 음수가 아닌 정수가 되도록 강제해야 합니다. 즉, INTEGER 값의 DER 인코딩에 있는 부호 비트가 0이어야 합니다. 이는 필요한 경우 선행\(가장 왼쪽\) '00'H 옥텟을 추가하여 수행할 수 있습니다. 이는 옥텟 문자열과 정수 값 사이의 매핑에서 잠재적인 모호성을 제거합니다.\(MUST\)

섹션 4.1.2.2에 언급된 대로 일련번호에는 긴 정수가 포함될 것으로 예상됩니다. 인증서 사용자는 최대 20옥텟 길이의 serialNumber 값을 처리할 수 있어야 합니다. 준수 CA는 20옥텟보다 긴 serialNumber 값을 사용해서는 안 됩니다.\(MUST, MUST NOT\)

섹션 5.2.3에서 설명한 대로 CRL 번호에는 긴 정수가 포함될 것으로 예상할 수 있습니다. CRL 유효성 검사기는 길이가 최대 20옥텟인 cRLNumber 값을 처리할 수 있어야 합니다. 적합한 CRL 발급자는 20옥텟보다 긴 cRLNumber 값을 사용해서는 안 됩니다.\(MUST, MUST NOT\)

"SEQUENCE SIZE \(1..MAX\) OF" 구조는 여러 ASN.1 구조에 나타납니다. 유효한 ASN.1 시퀀스에는 0개 이상의 항목이 있습니다. SIZE \(1..MAX\) 구성은 시퀀스에 항목이 하나 이상 있도록 제한합니다. MAX는 상한이 지정되지 않았음을 나타냅니다. 구현에서는 해당 환경에 적합한 상한을 자유롭게 선택할 수 있습니다.

"PositiveInt ::= INTEGER \(0..MAX\)" 구성은 positiveInt를 0보다 크거나 같은 정수를 포함하는 INTEGER의 하위 유형으로 정의합니다. 상한은 지정되지 않았습니다. 구현에서는 해당 환경에 적합한 상한을 자유롭게 선택할 수 있습니다.

문자열 유형 PrintableString은 매우 기본적인 라틴 문자 세트를 지원합니다. 즉, 소문자 'a'\~'z', 대문자 'A'\~'Z', 숫자 '0'\~'9', 11개의 특수 문자 ' = \( \) + , - . / : ? 그리고 공간.

구현자는 at 기호\('@'\) 및 밑줄\('\_'\) 문자가 ASN.1 유형 PrintableString에서 지원되지 않는다는 점에 유의해야 합니다. 이러한 문자는 인터넷 주소에 자주 나타납니다. 이러한 주소는 이를 지원하는 ASN.1 유형을 사용하여 인코딩되어야 합니다. 일반적으로 고유 이름 내의 emailAddress 속성 또는 GeneralName의 rfc822Name 필드에 IA5String으로 인코딩됩니다. 준수 구현은 at 기호나 밑줄 문자를 포함하는 문자열을 PrintableString으로 인코딩해서는 안 됩니다.\(MUST, MUST NOT\)

문자열 유형 TeletexString은 PrintableString의 상위 집합입니다. TeletexString은 상당히 표준적인\(ASCII와 같은\) 라틴 문자 세트, 간격 없는 악센트가 있는 라틴 문자 및 일본어 문자를 지원합니다.

명명된 비트 목록은 값에 이름이 할당된 BIT STRING입니다. 이 사양에서는 키 사용, CRL 배포 지점 및 최신 CRL 인증서 확장은 물론 최신 CRL 및 발급 배포 지점 CRL 확장에 대한 정의에서 명명된 비트 목록을 사용합니다. 명명된 비트 목록을 DER 인코딩할 때 후행 0은 생략되어야 합니다. 즉, 인코딩된 값은 1로 설정된 마지막 명명된 비트로 끝납니다.\(MUST\)

문자열 유형 UniversalString은 ISO 10646-1 \[ISO 10646\]에서 허용하는 모든 문자를 지원합니다. ISO 10646-1은 범용 다중 옥텟 코드 문자 집합\(UCS\)입니다. ISO 10646-1은 아키텍처와 모든 주요 세계 문자 표준을 포함하는 대규모 표준 문자 집합인 "기본 다국어 평면"을 지정합니다.

문자열 유형 UTF8String은 ASN.1의 1997 버전에서 도입되었으며 UTF8String은 X.520 \[X.520\]의 2001 버전에서 DirectoryString에 대한 선택 목록에 추가되었습니다. UTF8String은 범용 유형이며 태그 번호 12가 할당되었습니다. UTF8String의 내용은 RFC 2044 \[RFC 2044\]에 의해 정의되었으며 RFC 2279 \[RFC 2279\]에서 업데이트되었습니다.

이러한 변경을 예상하고 RFC 2277 \[RFC 2277\], 문자 집합 및 언어에 대한 IETF 정책에 성문화된 IETF 모범 사례를 준수하여 이 문서에는 DirectoryString 및 CPS 한정자 확장의 선택 항목으로 UTF8String이 포함되어 있습니다.

구현자는 SET OF 값의 DER 인코딩에는 값 인코딩의 순서가 필요하다는 점에 유의해야 합니다. 특히 이 문제는 고유 이름과 관련하여 발생합니다.

구현자는 값이 DEFAULT인 SET 또는 SEQUENCE 구성 요소의 DER 인코딩이 인코딩된 인증서 또는 CRL에서 구성 요소를 생략한다는 점에 유의해야 합니다. 예를 들어, cA 값이 FALSE인 BasicConstraints 확장은 인코딩된 인증서에서 cA 부울을 생략합니다.

개체 식별자\(OID\)는 인증서 정책, 공개 키 및 서명 알고리즘, 인증서 확장 등을 식별하기 위해 이 사양 전반에 걸쳐 사용됩니다. OID의 최대 크기는 없습니다. 이 사양에서는 값이 2^28보다 작은 arc 요소가 있는 OID에 대한 지원을 요구합니다. 즉, 값은 0에서 268,435,455 사이여야 합니다. 이를 통해 각 호 요소를 단일 32비트 워드 내에서 표현할 수 있습니다. 구현은 또한 점으로 구분된 십진수\(\[RFC 2252\], 섹션 4.1 참조\) 문자열 표현의 길이가 최대 100바이트\(포함\)일 수 있는 OID를 지원해야 합니다. 구현은 최대 20개 요소\(포함\)가 포함된 OID를 처리할 수 있어야 합니다\(MUST\). CA는 이러한 요구 사항을 초과하는 OID가 포함된 인증서를 발급해서는 안 됩니다. 마찬가지로 CRL 발급자는 이러한 요구 사항을 초과하는 OID가 포함된 CRL을 발급해서는 안 됩니다.\(MUST, MUST, MUST, SHOULD NOT, SHOULD NOT\)

구현자는 X.500 표준 커뮤니티가 일련의 확장성 규칙을 개발했다는 ​​경고를 받습니다. 이러한 규칙은 새 OID\(객체 식별자\)를 할당하지 않고 ASN.1 정의를 변경할 수 있는 시기를 결정합니다. 예를 들어, 이 프로파일 문서의 전신인 RFC 2459 \[RFC 2459\]에 포함된 적어도 두 개의 확장 정의는 본 사양에서는 서로 다른 ASN.1 정의를 가지지만 동일한 OID가 사용됩니다. 알 수 없는 요소가 확장 내에 나타나고 확장이 중요로 표시되지 않은 경우 다음과 같이 알 수 없는 요소를 무시해야 합니다.

```text
      (a)  ignore all unknown bit name assignments within a bit string;
```

- \(b\) 숫자가 SET 또는 SEQUENCE의 선택적 요소로 발생하는 경우 열거 스타일에서 사용되는 ENUMERATED 유형 또는 INTEGER 유형의 모든 알 수 없는 명명된 숫자를 무시합니다. 그리고

- \(c\) SET, SEQUENCE의 끝 또는 CHOICE 자체가 SET 또는 SEQUENCE의 선택적 요소인 CHOICE의 모든 알려지지 않은 요소를 무시합니다.

예상치 못한 값을 포함하는 확장이 중요로 표시된 경우 구현에서는 인식할 수 없는 확장이 포함된 인증서나 CRL을 거부해야 합니다.\(MUST\)

---
# **Appendix C.  Examples**

이 섹션에는 인증서 3개와 CRL 1개의 네 가지 예가 포함되어 있습니다. 처음 두 개의 인증서와 CRL은 최소 인증 경로를 구성합니다.

섹션 C.1에는 고유 이름이 cn=us,o=gov,ou=nist인 CA에서 발급한 "자체 서명" 인증서의 주석이 달린 16진수 덤프가 포함되어 있습니다. 인증서에는 매개변수가 포함된 DSA 공개 키가 포함되어 있으며 해당 DSA 개인 키로 서명됩니다.

섹션 C.2에는 최종 엔터티 인증서의 주석이 달린 16진수 덤프가 포함되어 있습니다. 최종 엔터티 인증서에는 DSA 공개 키가 포함되어 있으며 섹션 C.1의 "자체 서명" 인증서에 해당하는 개인 키로 서명됩니다.

섹션 C.3에는 RSA 공개 키를 포함하고 RSA 및 MD5로 서명된 최종 엔터티 인증서의 덤프가 포함되어 있습니다. 이 인증서는 최소 인증 경로의 일부가 아닙니다.

섹션 C.4에는 주석이 달린 CRL의 16진수 덤프가 포함되어 있습니다. CRL은 고유 이름이 cn=us,o=gov,ou=nist인 CA에 의해 발행되며 해지된 인증서 목록에는 C.2에 제시된 최종 엔터티 인증서가 포함됩니다.

```text
   The certificates were processed using Peter Gutman's dumpasn1 utility
   to generate the output.  The source for the dumpasn1 utility is
   available at <http://www.cs.auckland.ac.nz/~pgut001/dumpasn1.c>.  The
   binaries for the certificates and CRLs are available at
   <http://csrc.nist.gov/pki/pkixtools>.
```

---
## **C.1  Certificate**

```text
   This section contains an annotated hex dump of a 699 byte version 3
   certificate.  The certificate contains the following information:
   (a)  the serial number is 23 (17 hex);
```

\(b\) 인증서는 DSA 및 SHA-1 해시 알고리즘으로 서명됩니다. \(c\) 발급자의 고유 이름은 OU=NIST입니다. O=정부; C=US \(d\)이고 주체의 고유 이름은 OU=NIST입니다. O=정부; C=US \(e\) 인증서는 1997년 6월 30일에 발행되었으며 1997년 12월 31일에 만료됩니다. \(f\) 인증서에는 매개변수가 포함된 1024비트 DSA 공개 키가 포함되어 있습니다. \(g\) 인증서에는 섹션 4.2.1.2의 방법 \(1\)을 사용하여 생성된 주체 키 식별자 확장이 포함되어 있습니다. \(h\) 인증서는 CA 인증서입니다\(기본 제약 확장을 통해 표시됨\).

```text
  0 30  699: SEQUENCE {
  4 30  635:   SEQUENCE {
  8 A0    3:     [0] {
 10 02    1:       INTEGER 2
          :       }
 13 02    1:     INTEGER 17
 16 30    9:     SEQUENCE {
 18 06    7:       OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
          :       }
 27 30   42:     SEQUENCE {
 29 31   11:       SET {
 31 30    9:         SEQUENCE {
 33 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
 38 13    2:           PrintableString 'US'
          :           }
          :         }
 42 31   12:       SET {
 44 30   10:         SEQUENCE {
 46 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
 51 13    3:           PrintableString 'gov'
          :           }
          :         }
 56 31   13:       SET {
 58 30   11:         SEQUENCE {
 60 06    3:           OBJECT IDENTIFIER
          :             organizationalUnitName (2 5 4 11)
 65 13    4:           PrintableString 'NIST'
           :           }
           :         }
           :       }
 71 30   30:     SEQUENCE {
 73 17   13:       UTCTime '970630000000Z'
 88 17   13:       UTCTime '971231000000Z'
           :       }
103 30   42:     SEQUENCE {
105 31   11:       SET {

107 30    9:         SEQUENCE {
109 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
114 13    2:           PrintableString 'US'
           :           }
           :         }
118 31   12:       SET {
120 30   10:         SEQUENCE {
122 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
127 13    3:           PrintableString 'gov'
           :           }
           :         }
132 31   13:       SET {
134 30   11:         SEQUENCE {
136 06    3:           OBJECT IDENTIFIER
           :             organizationalUnitName (2 5 4 11)
141 13    4:           PrintableString 'NIST'
           :           }
           :         }
           :       }
147 30  440:     SEQUENCE {
151 30  300:       SEQUENCE {
155 06    7:         OBJECT IDENTIFIER dsa (1 2 840 10040 4 1)
164 30  287:         SEQUENCE {
168 02  129:           INTEGER
           :             00 B6 8B 0F 94 2B 9A CE A5 25 C6 F2 ED FC
           :             FB 95 32 AC 01 12 33 B9 E0 1C AD 90 9B BC
           :             48 54 9E F3 94 77 3C 2C 71 35 55 E6 FE 4F
           :             22 CB D5 D8 3E 89 93 33 4D FC BD 4F 41 64
           :             3E A2 98 70 EC 31 B4 50 DE EB F1 98 28 0A
           :             C9 3E 44 B3 FD 22 97 96 83 D0 18 A3 E3 BD
           :             35 5B FF EE A3 21 72 6A 7B 96 DA B9 3F 1E
           :             5A 90 AF 24 D6 20 F0 0D 21 A7 D4 02 B9 1A
           :             FC AC 21 FB 9E 94 9E 4B 42 45 9E 6A B2 48
           :             63 FE 43
300 02   21:           INTEGER
           :             00 B2 0D B0 B1 01 DF 0C 66 24 FC 13 92 BA
           :             55 F7 7D 57 74 81 E5
323 02  129:           INTEGER
           :             00 9A BF 46 B1 F5 3F 44 3D C9 A5 65 FB 91
           :             C0 8E 47 F1 0A C3 01 47 C2 44 42 36 A9 92
           :             81 DE 57 C5 E0 68 86 58 00 7B 1F F9 9B 77
           :             A1 C5 10 A5 80 91 78 51 51 3C F6 FC FC CC
           :             46 C6 81 78 92 84 3D F4 93 3D 0C 38 7E 1A
           :             5B 99 4E AB 14 64 F6 0C 21 22 4E 28 08 9C
           :             92 B9 66 9F 40 E8 95 F6 D5 31 2A EF 39 A2
           :             62 C7 B2 6D 9E 58 C4 3A A8 11 81 84 6D AF
           :             F8 B4 19 B4 C2 11 AE D0 22 3B AA 20 7F EE
           :             1E 57 18

           :           }
           :         }
455 03  133:       BIT STRING 0 unused bits, encapsulates {
459 02  129:           INTEGER
           :             00 B5 9E 1F 49 04 47 D1 DB F5 3A DD CA 04
           :             75 E8 DD 75 F6 9B 8A B1 97 D6 59 69 82 D3
           :             03 4D FD 3B 36 5F 4A F2 D1 4E C1 07 F5 D1
           :             2A D3 78 77 63 56 EA 96 61 4D 42 0B 7A 1D
           :             FB AB 91 A4 CE DE EF 77 C8 E5 EF 20 AE A6
           :             28 48 AF BE 69 C3 6A A5 30 F2 C2 B9 D9 82
           :             2B 7D D9 C4 84 1F DE 0D E8 54 D7 1B 99 2E
           :             B3 D0 88 F6 D6 63 9B A7 E2 0E 82 D4 3B 8A
           :             68 1B 06 56 31 59 0B 49 EB 99 A5 D5 81 41
           :             7B C9 55
           :           }
           :       }
591 A3   50:     [3] {
593 30   48:       SEQUENCE {
595 30   29:         SEQUENCE {
597 06    3:           OBJECT IDENTIFIER
           :             subjectKeyIdentifier (2 5 29 14)
602 04   22:           OCTET STRING, encapsulates {
604 04   20:               OCTET STRING
           :                 86 CA A5 22 81 62 EF AD 0A 89 BC AD 72 41
           :                 2C 29 49 F4 86 56
           :               }
           :           }
626 30   15:         SEQUENCE {
628 06    3:           OBJECT IDENTIFIER basicConstraints (2 5 29 19)
633 01    1:           BOOLEAN TRUE
636 04    5:           OCTET STRING, encapsulates {
638 30    3:               SEQUENCE {
640 01    1:                 BOOLEAN TRUE
           :                 }
           :               }
           :           }
           :         }
           :       }
           :     }
643 30    9:   SEQUENCE {
645 06    7:     OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
           :     }
654 03   47:   BIT STRING 0 unused bits, encapsulates {
657 30   44:       SEQUENCE {
659 02   20:         INTEGER
           :           43 1B CF 29 25 45 C0 4E 52 E7 7D D6 FC B1
           :           66 4C 83 CF 2D 77
681 02   20:         INTEGER

           :           0B 5B 9A 24 11 98 E8 F3 86 90 04 F6 08 A9
           :           E1 8D A5 CC 3A D4
           :         }
           :       }
           :   }
```

---
## **C.2  Certificate**

이 섹션에는 730바이트 버전 3 인증서의 주석이 달린 16진수 덤프가 포함되어 있습니다. 인증서에는 다음 정보가 포함되어 있습니다. \(a\) 일련 번호는 18\(12진수\)입니다. \(b\) 인증서는 DSA 및 SHA-1 해시 알고리즘으로 서명됩니다. \(c\) 발행자의 고유 이름은 OU=nist입니다. O=정부; C=US \(d\)이고 대상의 고유 이름은 CN=Tim Polk입니다. OU=니스트; O=정부; C=US \(e\) 인증서는 1997년 7월 30일부터 1997년 12월 1일까지 유효했습니다. \(f\) 인증서에는 1024비트 DSA 공개 키가 포함되어 있습니다. \(g\) 기본 제약 확장이 존재하지 않기 때문에 인증서는 최종 엔터티 인증서입니다. \(h\) 인증서에는 부록 C.1에 있는 인증서의 주체 키 식별자와 일치하는 기관 키 식별자 확장이 포함되어 있습니다. \(i\) 인증서에는 "wpolk@nist.gov"라는 RFC 822 주소라는 하나의 대체 이름이 포함되어 있습니다.

```text
     0 30  730: SEQUENCE {
     4 30  665:   SEQUENCE {
     8 A0    3:     [0] {
    10 02    1:       INTEGER 2
              :       }
    13 02    1:     INTEGER 18
    16 30    9:     SEQUENCE {
    18 06    7:       OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
              :       }
    27 30   42:     SEQUENCE {
    29 31   11:       SET {
    31 30    9:         SEQUENCE {
    33 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
    38 13    2:           PrintableString 'US'
              :           }
              :         }
    42 31   12:       SET {
    44 30   10:         SEQUENCE {
    46 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
    51 13    3:           PrintableString 'gov'
              :           }
              :         }

    56 31   13:       SET {
    58 30   11:         SEQUENCE {
    60 06    3:           OBJECT IDENTIFIER
              :             organizationalUnitName (2 5 4 11)
    65 13    4:           PrintableString 'NIST'
              :           }
              :         }
              :       }
    71 30   30:     SEQUENCE {
    73 17   13:       UTCTime '970730000000Z'
    88 17   13:       UTCTime '971201000000Z'
              :       }
   103 30   61:     SEQUENCE {
   105 31   11:       SET {
   107 30    9:         SEQUENCE {
   109 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
   114 13    2:           PrintableString 'US'
              :           }
              :         }
   118 31   12:       SET {
   120 30   10:         SEQUENCE {
   122 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
   127 13    3:           PrintableString 'gov'
              :           }
              :         }
   132 31   13:       SET {
   134 30   11:         SEQUENCE {
   136 06    3:           OBJECT IDENTIFIER
              :             organizationalUnitName (2 5 4 11)
   141 13    4:           PrintableString 'NIST'
              :           }
              :         }
   147 31   17:       SET {
   149 30   15:         SEQUENCE {
   151 06    3:           OBJECT IDENTIFIER commonName (2 5 4 3)
   156 13    8:           PrintableString 'Tim Polk'
              :           }
              :         }
              :       }
   166 30  439:     SEQUENCE {
   170 30  300:       SEQUENCE {
   174 06    7:         OBJECT IDENTIFIER dsa (1 2 840 10040 4 1)
   183 30  287:         SEQUENCE {
   187 02  129:           INTEGER
              :             00 B6 8B 0F 94 2B 9A CE A5 25 C6 F2 ED FC
              :             FB 95 32 AC 01 12 33 B9 E0 1C AD 90 9B BC
              :             48 54 9E F3 94 77 3C 2C 71 35 55 E6 FE 4F
              :             22 CB D5 D8 3E 89 93 33 4D FC BD 4F 41 64

              :             3E A2 98 70 EC 31 B4 50 DE EB F1 98 28 0A
              :             C9 3E 44 B3 FD 22 97 96 83 D0 18 A3 E3 BD
              :             35 5B FF EE A3 21 72 6A 7B 96 DA B9 3F 1E
              :             5A 90 AF 24 D6 20 F0 0D 21 A7 D4 02 B9 1A
              :             FC AC 21 FB 9E 94 9E 4B 42 45 9E 6A B2 48
              :             63 FE 43
   319 02   21:           INTEGER
              :             00 B2 0D B0 B1 01 DF 0C 66 24 FC 13 92 BA
              :             55 F7 7D 57 74 81 E5
   342 02  129:           INTEGER
              :             00 9A BF 46 B1 F5 3F 44 3D C9 A5 65 FB 91
              :             C0 8E 47 F1 0A C3 01 47 C2 44 42 36 A9 92
              :             81 DE 57 C5 E0 68 86 58 00 7B 1F F9 9B 77
              :             A1 C5 10 A5 80 91 78 51 51 3C F6 FC FC CC
              :             46 C6 81 78 92 84 3D F4 93 3D 0C 38 7E 1A
              :             5B 99 4E AB 14 64 F6 0C 21 22 4E 28 08 9C
              :             92 B9 66 9F 40 E8 95 F6 D5 31 2A EF 39 A2
              :             62 C7 B2 6D 9E 58 C4 3A A8 11 81 84 6D AF
              :             F8 B4 19 B4 C2 11 AE D0 22 3B AA 20 7F EE
              :             1E 57 18
              :           }
              :         }
   474 03  132:       BIT STRING 0 unused bits, encapsulates {
   478 02  128:           INTEGER
              :             30 B6 75 F7 7C 20 31 AE 38 BB 7E 0D 2B AB
              :             A0 9C 4B DF 20 D5 24 13 3C CD 98 E5 5F 6C
              :             B7 C1 BA 4A BA A9 95 80 53 F0 0D 72 DC 33
              :             37 F4 01 0B F5 04 1F 9D 2E 1F 62 D8 84 3A
              :             9B 25 09 5A 2D C8 46 8E 2B D4 F5 0D 3B C7
              :             2D C6 6C B9 98 C1 25 3A 44 4E 8E CA 95 61
              :             35 7C CE 15 31 5C 23 13 1E A2 05 D1 7A 24
              :             1C CB D3 72 09 90 FF 9B 9D 28 C0 A1 0A EC
              :             46 9F 0D B8 D0 DC D0 18 A6 2B 5E F9 8F B5
              :             95 BE
              :           }
              :       }
   609 A3   62:     [3] {
   611 30   60:       SEQUENCE {
   613 30   25:         SEQUENCE {
   615 06    3:           OBJECT IDENTIFIER subjectAltName (2 5 29 17)
   620 04   18:           OCTET STRING, encapsulates {
   622 30   16:               SEQUENCE {
   624 81   14:                 [1] 'wpolk@nist.gov'
              :                 }
              :               }
              :           }
   640 30   31:         SEQUENCE {
   642 06    3:           OBJECT IDENTIFIER

              :             authorityKeyIdentifier (2 5 29 35)
   647 04   24:           OCTET STRING, encapsulates {
   649 30   22:               SEQUENCE {
   651 80   20:                 [0]
              :                   86 CA A5 22 81 62 EF AD 0A 89 BC AD 72
              :                   41 2C 29 49 F4 86 56
              :                 }
              :               }
              :           }
              :         }
              :       }
              :     }
   673 30    9:   SEQUENCE {
   675 06    7:     OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
              :     }
   684 03   48:   BIT STRING 0 unused bits, encapsulates {
   687 30   45:       SEQUENCE {
   689 02   20:         INTEGER
              :           36 97 CB E3 B4 2C E1 BB 61 A9 D3 CC 24 CC
              :           22 92 9F F4 F5 87
   711 02   21:         INTEGER
              :           00 AB C9 79 AF D2 16 1C A9 E3 68 A9 14 10
              :           B4 A0 2E FF 22 5A 73
              :         }
              :       }
              :   }
```

---
## **C.3  End Entity Certificate Using RSA**

이 섹션에는 654바이트 버전 3 인증서의 주석이 달린 16진수 덤프가 포함되어 있습니다. 인증서에는 다음 정보가 포함되어 있습니다. \(a\) 일련 번호는 256입니다. \(b\) 인증서는 RSA 및 SHA-1 해시 알고리즘으로 서명됩니다. \(c\) 발급자의 고유 이름은 OU=NIST입니다. O=정부; C=US \(d\)이고 대상의 고유 이름은 CN=Tim Polk입니다. OU=NIST; O=정부; C=US \(e\) 인증서는 1996년 5월 21일 09:58:26에 발급되었으며 1997년 5월 21일 09:58:26에 만료되었습니다. \(f\) 인증서에는 1024비트 RSA 공개 키가 포함되어 있습니다. \(g\) 인증서가 최종 엔터티 인증서\(CA 인증서가 아님\)입니다. \(h\) 인증서에는 "<http://www.itl.nist.gov/div893/staff/polk/index.html\>"이라는 대체 주체 이름과 "<http://www. nist.gov/\>" - 둘 다 URL입니다. \(i\) 인증서에는 기관 키 식별자 확장과 정책 OID 2.16.840.1.101.3.2.1.48.9를 지정하는 인증서 정책 확장이 포함됩니다. 그리고

\(j\) 인증서에는 공개 키가 디지털 서명 확인용임을 지정하는 중요한 키 사용 확장이 포함되어 있습니다.

```text
  0 30  654: SEQUENCE {
  4 30  503:   SEQUENCE {
  8 A0    3:     [0] {
 10 02    1:       INTEGER 2
           :       }
 13 02    2:     INTEGER 256
 17 30   13:     SEQUENCE {
 19 06    9:       OBJECT IDENTIFIER
           :         sha1withRSAEncryption (1 2 840 113549 1 1 5)
 30 05    0:       NULL
           :       }
 32 30   42:     SEQUENCE {
 34 31   11:       SET {
 36 30    9:         SEQUENCE {
 38 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
 43 13    2:           PrintableString 'US'
           :           }
           :         }
 47 31   12:       SET {
 49 30   10:         SEQUENCE {
 51 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
 56 13    3:           PrintableString 'gov'
           :           }
           :         }
 61 31   13:       SET {
 63 30   11:         SEQUENCE {
 65 06    3:           OBJECT IDENTIFIER
           :             organizationalUnitName (2 5 4 11)
 70 13    4:           PrintableString 'NIST'
           :           }
           :         }
           :       }
 76 30   30:     SEQUENCE {
 78 17   13:       UTCTime '960521095826Z'
 93 17   13:       UTCTime '970521095826Z'
           :       }
108 30   61:     SEQUENCE {
110 31   11:       SET {
112 30    9:         SEQUENCE {
114 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
119 13    2:           PrintableString 'US'
           :           }
           :         }
123 31   12:       SET {

125 30   10:         SEQUENCE {
127 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
132 13    3:           PrintableString 'gov'
           :           }
           :         }
137 31   13:       SET {
139 30   11:         SEQUENCE {
141 06    3:           OBJECT IDENTIFIER
           :             organizationalUnitName (2 5 4 11)
146 13    4:           PrintableString 'NIST'
           :           }
           :         }
152 31   17:       SET {
154 30   15:         SEQUENCE {
156 06    3:           OBJECT IDENTIFIER commonName (2 5 4 3)
161 13    8:           PrintableString 'Tim Polk'
           :           }
           :         }
           :       }
171 30  159:     SEQUENCE {
174 30   13:       SEQUENCE {
176 06    9:         OBJECT IDENTIFIER
           :           rsaEncryption (1 2 840 113549 1 1 1)
187 05    0:         NULL
           :         }
189 03  141:       BIT STRING 0 unused bits, encapsulates {
193 30  137:           SEQUENCE {
196 02  129:             INTEGER
           :               00 E1 6A E4 03 30 97 02 3C F4 10 F3 B5 1E
           :               4D 7F 14 7B F6 F5 D0 78 E9 A4 8A F0 A3 75
           :               EC ED B6 56 96 7F 88 99 85 9A F2 3E 68 77
           :               87 EB 9E D1 9F C0 B4 17 DC AB 89 23 A4 1D
           :               7E 16 23 4C 4F A8 4D F5 31 B8 7C AA E3 1A
           :               49 09 F4 4B 26 DB 27 67 30 82 12 01 4A E9
           :               1A B6 C1 0C 53 8B 6C FC 2F 7A 43 EC 33 36
           :               7E 32 B2 7B D5 AA CF 01 14 C6 12 EC 13 F2
           :               2D 14 7A 8B 21 58 14 13 4C 46 A3 9A F2 16
           :               95 FF 23
328 02    3:             INTEGER 65537
           :             }
           :           }
           :       }
333 A3  175:     [3] {
336 30  172:       SEQUENCE {
339 30   63:         SEQUENCE {
341 06    3:           OBJECT IDENTIFIER subjectAltName (2 5 29 17)
346 04   56:           OCTET STRING, encapsulates {
348 30   54:               SEQUENCE {

350 86   52:                 [6]
           :                   'http://www.itl.nist.gov/div893/staff/'
           :                   'polk/index.html'
           :                 }
           :               }
           :           }
404 30   31:         SEQUENCE {
406 06    3:           OBJECT IDENTIFIER issuerAltName (2 5 29 18)
411 04   24:           OCTET STRING, encapsulates {
413 30   22:               SEQUENCE {
415 86   20:                 [6] 'http://www.nist.gov/'
           :                 }
           :               }
           :           }
437 30   31:         SEQUENCE {
439 06    3:           OBJECT IDENTIFIER
           :             authorityKeyIdentifier (2 5 29 35)
444 04   24:           OCTET STRING, encapsulates {
446 30   22:               SEQUENCE {
448 80   20:                 [0]
           :                   08 68 AF 85 33 C8 39 4A 7A F8 82 93 8E
           :                   70 6A 4A 20 84 2C 32
           :                 }
           :               }
           :           }
470 30   23:         SEQUENCE {
472 06    3:           OBJECT IDENTIFIER
           :             certificatePolicies (2 5 29 32)
477 04   16:           OCTET STRING, encapsulates {
479 30   14:               SEQUENCE {
481 30   12:                 SEQUENCE {
483 06   10:                   OBJECT IDENTIFIER
           :                            '2 16 840 1 101 3 2 1 48 9'
           :                   }
           :                 }
           :               }
           :           }
495 30   14:         SEQUENCE {
497 06    3:           OBJECT IDENTIFIER keyUsage (2 5 29 15)
502 01    1:           BOOLEAN TRUE
505 04    4:           OCTET STRING, encapsulates {
507 03    2:               BIT STRING 7 unused bits
           :                 '1'B (bit 0)
           :               }
           :           }
           :         }
           :       }
           :     }

511 30   13:   SEQUENCE {
513 06    9:     OBJECT IDENTIFIER
           :       sha1withRSAEncryption (1 2 840 113549 1 1 5)
524 05    0:     NULL
           :     }
526 03  129:   BIT STRING 0 unused bits
           :     1E 07 77 6E 66 B5 B6 B8 57 F0 03 DC 6F 77
           :     6D AF 55 1D 74 E5 CE 36 81 FC 4B C5 F4 47
           :     82 C4 0A 25 AA 8D D6 7D 3A 89 AB 44 34 39
           :     F6 BD 61 1A 78 85 7A B8 1E 92 A2 22 2F CE
           :     07 1A 08 8E F1 46 03 59 36 4A CB 60 E6 03
           :     40 01 5B 2A 44 D6 E4 7F EB 43 5E 74 0A E6
           :     E4 F9 3E E1 44 BE 1F E7 5F 5B 2C 41 8D 08
           :     BD 26 FE 6A A6 C3 2F B2 3B 41 12 6B C1 06
           :     8A B8 4C 91 59 EB 2F 38 20 2A 67 74 20 0B
           :     77 F3
           :   }
```

---
## **C.4  Certificate Revocation List**

이 섹션에는 하나의 확장자\(cRLNumber\)가 있는 버전 2 CRL의 주석이 달린 16진수 덤프가 포함되어 있습니다. CRL은 OU=NIST에서 발행되었습니다. O=정부; C=US, 1997년 8월 7일; 다음으로 예정된 발행일은 1997년 9월 7일이었습니다. CRL에는 취소된 인증서 하나가 포함되어 있습니다. 일련 번호 18\(12진수\)은 keyCompromise로 인해 1997년 7월 31일에 취소되었습니다. CRL 자체는 18번이며 DSA 및 SHA-1로 서명되었습니다.

```text
  0 30  203: SEQUENCE {
  3 30  140:   SEQUENCE {
  6 02    1:     INTEGER 1
  9 30    9:     SEQUENCE {
 11 06    7:       OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
           :       }
 20 30   42:     SEQUENCE {
 22 31   11:       SET {
 24 30    9:         SEQUENCE {
 26 06    3:           OBJECT IDENTIFIER countryName (2 5 4 6)
 31 13    2:           PrintableString 'US'
           :           }
           :         }
 35 31   12:       SET {
 37 30   10:         SEQUENCE {
 39 06    3:           OBJECT IDENTIFIER organizationName (2 5 4 10)
 44 13    3:           PrintableString 'gov'
           :           }
           :         }
 49 31   13:       SET {
 51 30   11:         SEQUENCE {

 53 06    3:           OBJECT IDENTIFIER
           :             organizationalUnitName (2 5 4 11)
 58 13    4:           PrintableString 'NIST'
           :           }
           :         }
           :       }
 64 17   13:     UTCTime '970807000000Z'
 79 17   13:     UTCTime '970907000000Z'
 94 30   34:     SEQUENCE {
 96 30   32:       SEQUENCE {
 98 02    1:         INTEGER 18
101 17   13:         UTCTime '970731000000Z'
116 30   12:         SEQUENCE {
118 30   10:           SEQUENCE {
120 06    3:             OBJECT IDENTIFIER cRLReason (2 5 29 21)
125 04    3:             OCTET STRING, encapsulates {
127 0A    1:                 ENUMERATED 1
           :                 }
           :             }
           :           }
           :         }
           :       }
130 A0   14:     [0] {
132 30   12:       SEQUENCE {
134 30   10:         SEQUENCE {
136 06    3:           OBJECT IDENTIFIER cRLNumber (2 5 29 20)
141 04    3:           OCTET STRING, encapsulates {
143 02    1:               INTEGER 12
           :               }
           :           }
           :         }
           :       }
           :     }
146 30    9:   SEQUENCE {
148 06    7:     OBJECT IDENTIFIER dsaWithSha1 (1 2 840 10040 4 3)
           :     }
157 03   47:   BIT STRING 0 unused bits, encapsulates {
160 30   44:       SEQUENCE {
162 02   20:         INTEGER
           :           22 4E 9F 43 BA 95 06 34 F2 BB 5E 65 DB A6
           :           80 05 C0 3A 29 47
184 02   20:         INTEGER
           :           59 1A 57 C9 82 D7 02 21 14 C3 D4 0B 32 1B
           :           96 16 B1 1F 46 5A
           :         }
           :       }
           :   }
```

---
# **Author Addresses**

```text
   Russell Housley
   RSA Laboratories
   918 Spring Knoll Drive
   Herndon, VA 20170
   USA

   EMail:  rhousley@rsasecurity.com

   Warwick Ford
   VeriSign, Inc.
   401 Edgewater Place
   Wakefield, MA 01880
   USA

   EMail:  wford@verisign.com

   Tim Polk
   NIST
   Building 820, Room 426
   Gaithersburg, MD 20899
   USA

   EMail:  wpolk@nist.gov

   David Solo
   Citigroup
   909 Third Ave, 16th Floor
   New York, NY 10043
   USA

   EMail:  dsolo@alum.mit.edu
```

---
# **Full Copyright Statement**

저작권\(C\)인터넷학회\(2002\). 판권 소유.

이 문서와 그 번역본은 복사되어 타인에게 제공될 수 있으며, 이에 대해 설명하거나 설명하거나 구현을 지원하는 파생물은 어떤 종류의 제한 없이 전체적으로 또는 부분적으로 준비, 복사, 출판 및 배포될 수 있습니다. , 단, 위의 저작권 표시와 이 단락은 그러한 모든 사본 및 파생물에 포함됩니다. 그러나 이 문서 자체는 인터넷 표준 개발 목적으로 필요한 경우를 제외하고는 저작권 표시를 제거하거나 Internet Society 또는 기타 인터넷 조직에 대한 참조를 제거하는 등 어떤 식으로든 수정할 수 없습니다. 인터넷 표준 프로세스를 따르거나 영어 이외의 언어로 번역하는 데 필요한 대로 따라야 합니다.

위에서 부여된 제한된 권한은 영구적이며 Internet Society 또는 그 승계자 또는 양수인에 의해 취소되지 않습니다.

이 문서와 여기에 포함된 정보는 "있는 그대로" 제공되며 인터넷 사회 및 인터넷 공학 태스크포스는 여기에 포함된 정보의 사용이 상품성 또는 특정 목적에의 적합성에 대한 권리 또는 묵시적 보증을 침해하는 행위.

---
# **Acknowledgement**

RFC 편집기 기능에 대한 자금은 현재 Internet Society에서 제공하고 있습니다.