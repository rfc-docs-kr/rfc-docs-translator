

```text
Network Working Group                                    J. van der Meer
Request for Comments: 3640                           Philips Electronics
Category: Standards Track                                      D. Mackie
                                                          Apple Computer
                                                          V. Swaminathan
                                                   Sun Microsystems Inc.
                                                               D. Singer
                                                          Apple Computer
                                                              P. Gentric
                                                     Philips Electronics
                                                           November 2003

     RTP Payload Format for Transport of MPEG-4 Elementary Streams
```

---
# **Status of this Memo**

이 문서는 인터넷 커뮤니티를 위한 인터넷 표준 추적 프로토콜을 지정하고 개선을 위한 토론 및 제안을 요청합니다. 이 프로토콜의 표준화 상태 및 상태에 대해서는 "Internet Official Protocol Standards"\(STD 1\) 최신판을 참조하십시오. 이 메모의 배포는 무제한입니다.

---
# **Copyright Notice**

저작권\(C\)인터넷학회\(2003\). 판권 소유.

---
# **Abstract**

MPEG\(Motion Picture Experts Group\) 위원회\(ISO/IEC JTC1/SC29 WG11\)는 MPEG-4 표준을 만든 ISO의 작업 그룹입니다. MPEG는 시청각 정보와 같은 콘텐츠를 기본 스트림으로 압축하는 도구를 정의합니다. 이 사양은 다중화되지 않은 MPEG-4 기본 스트림 전송을 위한 단순하지만 일반적인 RTP 페이로드 형식을 정의합니다.

---
# **Table of Contents**

```text
   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Carriage of MPEG-4 Elementary Streams Over RTP . . . . . . . .  4
       2.1.  Signaling by MIME Format Parameters  . . . . . . . . . .  4
       2.2.  MPEG Access Units  . . . . . . . . . . . . . . . . . . .  5
       2.3.  Concatenation of Access Units  . . . . . . . . . . . . .  5
       2.4.  Fragmentation of Access Units  . . . . . . . . . . . . .  6
       2.5.  Interleaving . . . . . . . . . . . . . . . . . . . . . .  6
       2.6.  Time Stamp Information . . . . . . . . . . . . . . . . .  7
       2.7.  State Indication of MPEG-4 System Streams  . . . . . . .  8
       2.8.  Random Access Indication . . . . . . . . . . . . . . . .  8
       2.9.  Carriage of Auxiliary Information  . . . . . . . . . . .  8
       2.10. MIME Format Parameters and Configuring Conditional Field  8
       2.11. Global Structure of Payload Format . . . . . . . . . . .  9
       2.12. Modes to Transport MPEG-4 Streams  . . . . . . . . . . .  9
       2.13. Alignment with RFC 3016  . . . . . . . . . . . . . . . . 10
   3.  Payload Format . . . . . . . . . . . . . . . . . . . . . . . . 10
       3.1.  Usage of RTP Header Fields and RTCP  . . . . . . . . . . 10
       3.2.  RTP Payload Structure  . . . . . . . . . . . . . . . . . 11
             3.2.1.  The AU Header Section  . . . . . . . . . . . . . 11
                     3.2.1.1.  The AU-header  . . . . . . . . . . . . 12
             3.2.2.  The Auxiliary Section . . . . . . . . . . . . .  14
             3.2.3.  The Access Unit Data Section . . . . . . . . . . 15
                     3.2.3.1.  Fragmentation. . . . . . . . . . . . . 16
                     3.2.3.2.  Interleaving . . . . . . . . . . . . . 16
                     3.2.3.3.  Constraints for Interleaving . . . . . 17
                     3.2.3.4.  Crucial and Non-Crucial AUs with
                               MPEG-4 System Data . . . . . . . . . . 20
       3.3.  Usage of this Specification. . . . . . . . . . . . . . . 21
             3.3.1.  General. . . . . . . . . . . . . . . . . . . . . 21
             3.3.2.  The Generic Mode . . . . . . . . . . . . . . . . 22
             3.3.3.  Constant Bit Rate CELP . . . . . . . . . . . . . 22
             3.3.4.  Variable Bit Rate CELP . . . . . . . . . . . . . 23
             3.3.5.  Low Bit Rate AAC . . . . . . . . . . . . . . . . 24
             3.3.6.  High Bit Rate AAC. . . . . . . . . . . . . . . . 25
             3.3.7.  Additional Modes . . . . . . . . . . . . . . . . 26
   4.  IANA Considerations. . . . . . . . . . . . . . . . . . . . . . 27
       4.1.  MIME Type Registration . . . . . . . . . . . . . . . . . 27
       4.2.  Registration of Mode Definitions with IANA . . . . . . . 33
       4.3.  Concatenation of Parameters. . . . . . . . . . . . . . . 33
       4.4.  Usage of SDP . . . . . . . . . . . . . . . . . . . . . . 34
             4.4.1.  The a=fmtp Keyword . . . . . . . . . . . . . . . 34
   5.  Security Considerations. . . . . . . . . . . . . . . . . . . . 34
   6.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 35
   APPENDIX: Usage of this Payload Format. . .  . . . . . . . . . . . 36
   Appendix A.  Interleave Analysis . . . . . . . . . . . . . . . . . 36
   A.  Examples of Delay Analysis with Interleave. . .  . . . . . . . 36
       A.1.  Introduction . . . . . . . . . . . . . . . . . . . . . . 36
       A.2.  De-interleaving and Error Concealment  . . . . . . . . . 36
       A.3.  Simple Group Interleave  . . . . . . . . . . . . . . . . 36
             A.3.1.  Introduction . . . . . . . . . . . . . . . . . . 36
             A.3.2.  Determining the De-interleave Buffer Size  . . . 37
             A.3.3.  Determining the Maximum Displacement . . . . . . 37
       A.4.  More Subtle Group Interleave . . . . . . . . . . . . . . 38
             A.4.1.  Introduction . . . . . . . . . . . . . . . . . . 38
             A.4.2.  Determining the De-interleave Buffer Size. . . . 38
             A.4.3.  Determining the Maximum Displacement . . . . . . 39
       A.5.  Continuous Interleave  . . . . . . . . . . . . . . . . . 39
             A.5.1.  Introduction . . . . . . . . . . . . . . . . . . 39
             A.5.2.  Determining the De-interleave Buffer Size  . . . 40
             A.5.3.  Determining the Maximum Displacement . . . . . . 40
   References . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41
   Normative References . . . . . . . . . . . . . . . . . . . . . . . 41
   Informative References . . . . . . . . . . . . . . . . . . . . . . 41
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 42
   Full Copyright Statement . . . . . . . . . . . . . . . . . . . . . 43
```

---
## **1.  Introduction**

MPEG 위원회는 MPEG-1, MPEG-2, 그리고 최근에는 MPEG-4 표준을 규정한 ISO/IEC JTC1 SC29의 작업 그룹 11\(WG11\)입니다\[1\]. MPEG-4 표준은 시청각 데이터를 오디오 또는 비디오 기본 스트림으로 압축하도록 지정합니다. MPEG-4 표준에서 이러한 스트림은 장면 설명을 통해 시청각 장면으로 배열될 수 있는 시청각 개체의 형태를 취합니다. 각 MPEG-4 기본 스트림은 일련의 액세스 단위로 구성됩니다. AU\(액세스 단위\)의 예로는 오디오 프레임과 비디오 사진이 있습니다.

이 사양은 MPEG-4 기본 스트림, 특히 MPEG-4 오디오\(음성 포함\) 스트림, MPEG-4 비디오 스트림 및 BIFS\(장면용 바이너리 형식\)와 같은 MPEG-4 시스템 스트림을 전송하기 위한 일반적이고 구성 가능한 페이로드 구조를 정의합니다. \), OCI\(개체 콘텐츠 정보\), OD\(개체 설명자\) 및 IPMP\(지적 재산 관리 및 보호\) 스트림입니다. 이 문서에 정의된 RTP 페이로드는 구현이 간단하고 합리적으로 효율적입니다. 이는 패킷 손실 시 오류 복원력을 높이기 위해 액세스 단위\(예: 오디오 프레임\)의 선택적 인터리빙을 허용합니다.

MPEG-4 기본 스트림의 일부 유형에는 손실이 허용되지 않는 "중요한" 정보가 포함되어 있습니다. 그러나 RTP는 안정적인 전송을 제공하지 않으므로 중요한 정보 수신이 보장되지 않습니다. 섹션 3.2.3.4에서는 수신기가 중요한 정보의 손실을 감지하고 다음 랜덤 액세스 포인트가 수신될 때까지 디코딩을 중단할 수 있도록 스트림 상태가 전달되는 방법을 지정합니다. OD 명령, BIFS 명령 또는 MPEG-J\(Java\) 및 ECMAScript와 같은 프로그래밍 콘텐츠와 같은 중요한 정보를 포함하는 스트림을 전송하는 애플리케이션에는 손실 가능성에 따라 적절한 주기로 무작위 액세스 포인트가 포함되어야 합니다. 스트림 손상을 허용 가능한 수준으로 줄입니다. ISO/IEC 14496-1 \[1\]의 MPEG에서 정의한 캐러셀 메커니즘이 그 예입니다.

이러한 애플리케이션은 손실 가능성을 줄이기 위해 추가 프로토콜이나 서비스를 사용할 수도 있습니다. RTP 계층에서 이러한 조치에는 반드시 사용해야 하는 재전송 또는 전달 오류 수정\(예: RFC 2733 \[10\]\)을 위한 페이로드 형식 및 프로필이 포함됩니다.

혼잡 제어를 적절히 고려합니다. 일부 애플리케이션에 적합할 수 있는 또 다른 솔루션은 TCP를 통해 RTP를 전달하는 것입니다\(예: RFC 2326 \[8\], 섹션 10.12\). 네트워크 계층에서는 손실 가능성을 줄이기 위해 자원 할당이나 우선 서비스를 사용할 수 있습니다. 스트리밍 미디어를 복구하는 방법에 대한 일반적인 설명은 RFC 2354 \[9\]를 참조하세요.

본 문서에 정의된 RTP 페이로드 형식은 모든 MPEG-4 스트림을 전송할 수 있지만 MPEG-4 비디오 전송을 위한 RFC 3016\[12\]\(ISO/IEC 14496\[1\]\)과 같은 보다 구체적인 다른 형식도 존재할 수 있습니다. 2 부\).

페이로드 구성은 가능한 모든 비트 전송률에서 MPEG-4 스트림의 전송을 수용할 수 있도록 제공됩니다. 그러나 특정 MPEG-4 기본 스트림의 경우 일반적으로 매우 적은 구성만 필요합니다. 단순화된 전용 수신기의 설계를 허용하기 위해 이 사양에서는 MPEG-4 스트림 전송에 대해 특정 모드를 정의해야 합니다. 이 문서에서는 MPEG-4 CELP 및 AAC 스트림에 대한 모드와 MPEG-4 스트림을 전송하는 데 사용할 수 있는 일반 모드를 정의합니다. 앞으로 새로운 RFC는 MPEG-4 스트림 전송을 위한 추가 모드를 지정할 것으로 예상됩니다.

이 문서에 정의된 RTP 페이로드 형식은 MPEG-4 시스템\[1\]에 정의된 MPEG-4 SL\(Sync Layer\)에 포함될 수 있는 정보와 동일한 시스템 관련 정보의 전달을 지정합니다. 이 문서에서는 SL의 정보를 RTP 페이로드 형식에 정의된 필드로 트랜스코딩하거나 매핑하는 방법을 규정하지 않습니다. 그러한 처리는 신청자의 재량에 달려 있습니다. 그러나 향후 추가적인 시스템 관련 정보 전송의 필요성을 예상하기 위해 그러한 데이터를 전달할 수 있는 보조 필드를 구성할 수 있습니다.

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. BCP 14, RFC 2119 \[4\]에 설명된 대로 해석됩니다.\(MUST NOT\)

---
## **2.  Carriage of MPEG-4 Elementary Streams over RTP**
---
### **2.1.  Signaling by MIME Format Parameters**

이 페이로드 형식을 사용하면 단일 MPEG-4 기본 스트림을 전송할 수 있습니다. 페이로드에 포함된 MPEG-4 스트림 유형에 대한 정보는 SDP\[5\] 메시지와 같은 MIME 형식 매개변수 또는 기타 수단을 통해 전달됩니다\(섹션 4 참조\). 이러한 MIME 형식 매개변수는 페이로드 구성을 지정합니다. 단순화된 전용 수신기를 허용하기 위해 MIME 형식 매개변수는 다음과 같습니다.

이 페이로드를 사용하는 특정 모드를 알리는 데 사용할 수 있습니다. 모드 정의에는 MPEG-4 기본 스트림 유형과 적용된 구성이 포함될 수 있으므로 수신기가 모든 MIME 형식 매개변수를 구문 분석할 필요가 없습니다. 적용된 모드는 반드시 신호를 받아야 합니다.\(MAY, MUST\)

---
### **2.2.  MPEG Access Units**

압축된 시청각 데이터 전송을 위해 MPEG는 액세스 단위를 정의합니다. MPEG AU\(Access Unit\)는 타이밍 정보가 귀속되는 가장 작은 데이터 개체입니다. Access Unit은 오디오의 경우 오디오 프레임을, 비디오의 경우 사진을 나타낼 수 있다. MPEG 액세스 단위는 정의에 따라 옥텟 정렬됩니다. 예를 들어, 오디오 프레임이 옥텟 정렬되지 않은 경우 MPEG-4 사양에서 요구하는 대로 옥텟 정렬 액세스 단위를 달성하기 위해 프레임 끝에 최대 7개의 제로 패딩 비트를 삽입해야 합니다. MPEG-4 디코더는 이러한 패딩이 적용되는 AU를 디코딩할 수 있어야 합니다.\(MUST, MUST\)

MPEG-4 사양에 따라 이 문서에서는 각 MPEG-4 파트 2 비디오 액세스 단위에 사진의 모든 코딩된 데이터, 코딩된 사진 데이터 앞에 올 수 있는 모든 비디오 스트림 헤더 및 뒤따를 수 있는 모든 비디오 스트림 스터핑이 포함되어야 함을 요구합니다. 새로운 비디오 스트림 또는 다음 액세스 단위의 시작을 나타내는 시작 코드를 포함하지 않습니다.

---
### **2.3.  Concatenation of Access Units**

하나의 RTP 패킷에 여러 액세스 유닛을 운반하는 것이 가능한 경우가 많습니다. 이는 특히 오디오에 유용합니다. 예를 들어 AAC가 64kbits/초의 속도로 스테레오 신호를 인코딩하는 데 사용되는 경우 AAC 프레임에는 평균 약 200옥텟이 포함됩니다. 1500옥텟 MTU를 사용하는 LAN에서는 RTP 패킷당 평균 7개의 완전한 AAC 프레임을 전송할 수 있습니다.

액세스 단위는 옥텟 단위로 고정된 크기를 가질 수 있지만 가변 크기도 가능합니다. 하나의 RTP 패킷에 여러 개의 연결된 AU가 있는 경우 구문 분석을 용이하게 하기 위해 각 AU의 크기가 수신자에게 알려집니다. AU 크기가 일정한 경우 연결하는 경우 이 크기는 MIME 형식 매개변수를 통해 "대역 외"로 전달됩니다. 가변 크기 AU의 경우 연결 시 RTP 페이로드는 포함된 각 AU에 대한 AU 크기 필드를 "대역 내"로 전달합니다.

RTP 페이로드 길이와 함께 크기 정보를 사용하면 RTP 페이로드가 수신기에 의해 개별 AU로 다시 분할될 수 있습니다.

RTP 수신기의 구현을 단순화하려면 RTP 패킷에 여러 AU가 전달될 때 각 AU가 완전해야 합니다. 즉, RTP 패킷의 AU 수가 통합되어야 합니다.\(MUST\)

또한 AU는 다른 RTP 패킷에서 반복되어서는 안 됩니다. 따라서 AU의 반복은 중복 RTP 패킷을 사용할 때만 가능합니다.\(MUST NOT\)

---
### **2.4.  Fragmentation of Access Units**

MPEG는 매우 큰 액세스 단위를 허용합니다. 대부분의 IP 네트워크는 MTU 크기가 상당히 작기 때문에 이 페이로드 형식을 사용하면 여러 RTP 패킷을 통해 액세스 단위를 조각화할 수 있습니다. 따라서 IP 수준 조각화 이후 IP 패킷이 손실되면 전체 AU가 아닌 AU 조각만 손실될 수 있습니다. RTP 수신기의 구현을 단순화하기 위해 RTP 패킷은 하나 이상의 완전한 액세스 단위 또는 하나의 AU의 단일 조각을 전달해야 합니다. 즉, 패킷은 여러 액세스 단위의 조각을 포함해서는 안 됩니다.\(MUST NOT\)

---
### **2.5.  Interleaving**

RTP 패킷이 연속된 액세스 단위 시퀀스를 전달하는 경우 이러한 패킷이 손실되면 사용자에게 "디코딩 간격"이 발생할 수 있습니다. 이 문제를 완화하는 한 가지 방법은 액세스 단위가 RTP 패킷에 인터리브되도록 허용하는 것입니다. 지연 시간과 구현 복잡성에 따른 적절한 비용으로 패킷 손실에 대한 상당한 오류 복원력을 달성할 수 있습니다.

액세스 단위의 선택적 인터리빙을 지원하기 위해 이 페이로드 형식을 사용하면 각 액세스 단위에 대해 인덱스 정보를 전송할 수 있습니다. 디인터리빙을 위해 할당할 버퍼 자원에 대해 수신자에게 알린 후 RTP 발신자는 이 정보를 수신자에게 선험적으로 전파하지 않고 인터리빙 패턴을 자유롭게 선택할 수 있습니다. 실제로 발신자는 액세스 단위 크기, 오류율 등에 따라 인터리빙 패턴을 동적으로 조정할 수 있습니다. RTP 수신자는 사용된 인터리빙 패턴을 알 필요가 없습니다. 액세스 유닛의 인덱스 정보를 추출하고 액세스 유닛을 디코딩 또는 렌더링 대기열의 적절한 시퀀스에 삽입하기만 하면 됩니다. 인터리빙의 예는 다음과 같습니다.

예를 들어, RTP 패킷에 3개의 AU가 포함되어 있고 AU의 번호가 0, 1, 2, 3, 4 등으로 지정되어 있고 인터리빙 그룹 길이가 9라고 가정하면 RTP 패킷\(i \)에는 다음 AU\(n\)이 포함됩니다.

```text
      RTP packet(0):  AU(0),  AU(3),  AU(6)
      RTP packet(1):  AU(1),  AU(4),  AU(7)
      RTP packet(2):  AU(2),  AU(5),  AU(8)
      RTP packet(3):  AU(9),  AU(12), AU(15)
      RTP packet(4):  AU(10), AU(13), AU(16)  Etc.
```

---
### **2.6.  Time Stamp Information**

RTP 타임스탬프는 RTP 패킷의 첫 번째 AU\(조각\)의 샘플링 순간을 전달해야 합니다. 여러 AU가 RTP 패킷 내에 전달되는 경우 각 AU의 프레임 기간을 알면 후속 AU의 타임 스탬프를 계산할 수 있습니다. 오디오 및 비디오의 경우 프레임 속도가 일정하면 가능합니다. 그러나 어떤 경우에는 그러한 계산을 할 수 없습니다\(예: 가변 프레임 속도 비디오 또는 구성 정보를 전달하는 MPEG-4 BIFS 스트림의 경우\). 이러한 경우를 지원하기 위해 포함된 각 액세스 단위에 대해 RTP 페이로드에 타임스탬프를 전달하도록 이 페이로드 형식을 구성할 수 있습니다. 타임 스탬프는 RTP 패킷의 첫 번째 AU가 아닌 AU에 대해서만 RTP 페이로드로 전달될 수 있으며, 첫 번째 AU\(조각\)에 대해서는 전달되지 않아야 합니다. RTP 타임스탬프.\(MUST, MUST NOT\)

MPEG-4는 두 가지 유형의 타임스탬프, 즉 CTS\(구성 타임스탬프\)와 DTS\(디코딩 타임스탬프\)를 정의합니다. CTS는 AU의 샘플링 순간을 나타내므로 CTS는 RTP 타임 스탬프와 동일합니다. DTS는 양방향 코딩을 사용하는 MPEG-4 비디오 스트림, 즉 과거의 참조 화면이나 미래의 참조 화면을 사용하여 화면을 순방향 및 역방향 모두에서 예측할 때 사용될 수 있습니다. DTS는 RTP 헤더에 포함될 수 없습니다. 어떤 경우에는 프레임 속도 정보를 사용하여 RTP 타임스탬프에서 DTS를 파생할 수 있습니다. 이를 위해서는 비디오 스트림의 심층적인 구문 분석이 필요하며 이는 불쾌한 것으로 간주될 수 있습니다. 비디오 프레임 속도가 가변적이면 필요한 정보가 비디오 스트림에 존재하지 않을 수도 있습니다. 두 가지 이유 모두 포함된 각 액세스 단위에 대해 RTP 페이로드에 DTS를 선택적으로 전달하도록 기능이 정의되었습니다.

타임스탬프 코딩을 효율적으로 유지하기 위해 RTP 페이로드에 포함된 각 타임스탬프는 차이로 코딩됩니다. CTS의 경우 RTP 타임스탬프의 오프셋이 제공되고, DTS의 경우 CTS의 오프셋이 제공됩니다.

---
### **2.7.  State Indication of MPEG-4 System Streams**

ISO/IEC 14496-1은 MPEG-4 시스템 스트림의 상태를 정의합니다. MPEG-4 시스템 스트림을 전송할 때 상태 정보를 전달하기 위해 이 페이로드 형식은 포함된 각 액세스 단위에 대한 스트림 상태의 RTP 페이로드에서 선택적 캐리지를 허용합니다. 스트림 상태는 손실이 허용될 수 없는 정보를 전달하는 "중요한" AU를 알리는 데 사용되며 ISO/IEC 14496-1에 정의된 캐러셀 메커니즘에 따라 AU를 반복할 때에도 유용합니다.

---
### **2.8.  Random Access Indication**

MPEG-4 기본 스트림의 콘텐츠에 대한 무작위 액세스는 일부 액세스 단위에서는 가능할 수 있지만 전체 액세스 단위에서는 가능하지 않습니다. 랜덤 액세스가 가능한 액세스 유닛에 신호를 보내기 위해 랜덤 액세스 포인트 플래그는 포함된 각 액세스 유닛에 대한 RTP 페이로드에 선택적으로 포함될 수 있습니다. 랜덤 액세스 포인트의 전달은 스트림 상태와 결합된 MPEG-4 시스템 스트림에 특히 유용합니다.

---
### **2.9.  Carriage of Auxiliary Information**

이 페이로드 형식은 보조 데이터를 전달하는 특정 필드를 정의합니다. 보조 데이터 필드 앞에는 보조 데이터의 길이를 지정하는 필드가 있으므로 데이터를 구문 분석하지 않고 건너뛸 수 있습니다. 보조 데이터의 코딩은 이 문서에 정의되어 있지 않습니다. 대신, 보조 정보의 형식, 의미 및 신호는 하나 이상의 향후 RFC에서 지정될 것으로 예상됩니다. 보조 정보는 형식, 의미 및 신호가 지정되고 그 사용이 신호를 받을 때까지 전송되어서는 안 됩니다. 보조 데이터에 대한 지식이 있는 수신기는 보조 데이터를 디코딩할 수 있지만, 그러한 데이터에 대한 지식이 없는 수신기는 보조 데이터 필드를 건너뛰어야 합니다.\(MUST NOT, MUST\)

---
### **2.10.  MIME Format Parameters and Configuring Conditional Fields**

이전 섹션에서 설명한 기능을 지원하기 위해 RTP 페이로드의 캐리지에 대해 여러 필드가 정의됩니다. 그러나 그 사용은 전송되는 MPEG-4 기본 스트림의 유형에 따라 크게 달라집니다. 때로는 특정 길이의 특정 필드가 필요한 반면, 다른 경우에는 그러한 필드가 필요하지 않습니다. 두 경우 모두 효율성을 높이기 위해 이러한 기능을 지원하는 필드는 MIME 형식 매개변수를 통해 구성 가능합니다. 일반적으로 MIME 형식 매개변수는 연관된 필드의 존재 여부와 길이를 정의합니다. 길이가 0이면 필드가 없음을 나타냅니다. 결과적으로 페이로드를 구문 분석하려면 MIME 형식 매개변수에 대한 지식이 필요합니다. MIME 형식 매개변수는 섹션 4.4.1에 지정된 대로 SDP\[5\] 메시지를 통해 또는 다른 수단을 통해 수신자에게 전달됩니다.

---
### **2.11.  Global Structure of Payload Format**

RTP 헤더 다음에 오는 RTP 페이로드에는 3개의 옥텟으로 정렬된 데이터 섹션이 포함되어 있으며, 그 중 처음 2개는 비어 있을 수 있습니다\(그림 1 참조\).\(MAY\)

```text
         +---------+-----------+-----------+---------------+
         | RTP     | AU Header | Auxiliary | Access Unit   |
         | Header  | Section   | Section   | Data Section  |
         +---------+-----------+-----------+---------------+

                   <----------RTP Packet Payload----------->
```

- 그림 1: RTP 패킷 내의 데이터 섹션

첫 번째 데이터 섹션은 하나 이상의 AU 헤더를 포함하는 AU\(액세스 단위\) 헤더 섹션입니다. 그러나 각 AU 헤더는 비어 있을 수 있으며, 이 경우 전체 AU 헤더 섹션이 비어 있습니다. 두 번째 섹션은 보조 데이터를 포함하는 보조 섹션입니다. 이 섹션은 비어 있도록 구성될 수도 있습니다. 세 번째 섹션은 액세스 단위 데이터 섹션으로, 하나의 액세스 단위의 단일 조각이나 하나 이상의 완전한 액세스 단위를 포함합니다. 액세스 단위 데이터 섹션은 비어 있어서는 안 됩니다.\(MAY, MAY, MUST NOT\)

---
### **2.12.  Modes to Transport MPEG-4 Streams**

모든 MPEG-4 스트림을 수신할 수 있는 완전히 구성 가능한 수신기를 구축하는 것이 가능하지만 이 사양을 사용하면 단순화된 설계도 가능하지만 한 가지 유형의 MPEG-4 스트림만 수신할 수 있는 전용 수신기도 가능합니다. 이는 이 사양을 사용하기 위해 특정 모드를 정의하도록 요구함으로써 달성됩니다. 각 모드는 예를 들어 페이로드 구성과 같이 하나 이상의 MPEG-4 스트림 유형 전송에 대한 제약 조건을 정의할 수 있습니다.

적용된 모드는 반드시 신호를 받아야 합니다. 모드 신호를 보내는 것은 하나 이상의 특정 모드만 디코딩할 수 있는 수신기의 경우 특히 중요합니다. 이러한 수신기는 수신기의 능력을 넘어서는 페이로드 처리 문제를 피하기 위해 적용된 모드가 지원되는지 여부를 결정해야 합니다.\(MUST\)

이 문서에는 MPEG-4 CELP 및 AAC 스트림 전송을 위한 여러 모드와 모든 MPEG-4 스트림에 사용할 수 있는 일반 모드가 정의되어 있습니다. 앞으로 새로운 RFC는 이 사양을 사용하는 다른 모드를 지정할 수 있습니다. 그러나 각 모드는 이 사양을 완전히 준수해야 합니다\(섹션 3.3.7 참조\).\(MUST\)

---
### **2.13.  Alignment with RFC 3016**

이 페이로드는 RFC 3016에서 권장되는 MPEG-4 비디오 구성에 대해 RFC 3016\[12\]에 정의된 페이로드 형식과 거의 동일하게 구성될 수 있습니다. 따라서 RFC 3016을 준수하는 수신기는 다음을 포함하는 추가 패킷이 있는 경우 이러한 RTP 페이로드를 디코딩할 수 있습니다. RFC 3016\[12\]에서 요구하는 대로 비디오 디코더 구성\(VO, VOL, VOSH\)이 스트림에 삽입됩니다. 반대로, 이 문서의 사양을 준수하는 수신기는 RFC 3016\[12\]에서 MPEG-4 비디오에 대해 정의된 페이로드, 이름 및 매개변수를 디코딩할 수 있어야 합니다. 이러한 점에서 구현에서는 RFC 3016 비디오 페이로드를 준수하는 스트림에서 발견될 수 있는 "대역 내" 비디오 디코더 구성 패킷을 무시하는 기능을 제공할 것을 강력히 권장합니다.\(SHOULD, SHOULD\)

비디오 디코더 구성의 "대역 외" 가용성은 RFC 3016 \[12\]에서 선택 사항입니다. 이 문서에 정의된 RTP 페이로드 형식과의 상호 운용성을 최대화하려면 RFC 3016을 사용하여 MPEG-4 비디오\(2부\)를 전송하는 애플리케이션에서 비디오 디코더 구성을 MIME 매개 변수로 사용할 수 있도록 하는 것이 좋습니다.

---
## **3.  Payload Format**
---
### **3.1.  Usage of RTP Header Fields and RTCP**

페이로드 유형\(PT\): 이 패킷 형식에 대한 RTP 페이로드 유형 할당은 이 문서의 범위를 벗어납니다. 이는 이 페이로드 형식이 사용되는 RTP 프로필에 의해 지정되거나 대역 외에서 동적으로 신호를 받습니다\(예: SDP 사용\).

마커\(M\) 비트: M 비트는 RTP 패킷 페이로드에 조각화된 액세스 단위의 최종 조각 또는 하나 이상의 완전한 액세스 단위가 포함되어 있음을 나타내기 위해 1로 설정됩니다.

확장\(X\) 비트: 사용된 RTP 프로필에 의해 정의됩니다.

시퀀스 번호: RTP 시퀀스 번호는 일정한 무작위 오프셋을 사용하여 일반적인 방식으로 발신자에 의해 생성되어야 합니다.\(SHOULD\)

타임스탬프: RTP 페이로드에 포함된 첫 번째 AU의 샘플링 순간을 나타냅니다. 이 샘플링 순간은 MPEG-4 시간 영역의 CTS와 동일합니다. SDP를 사용할 때 RTP 타임스탬프의 클럭 속도는 "rtpmap" 속성을 사용하여 표현되어야 합니다. MPEG-4 오디오 스트림이 전송되는 경우 속도는 오디오 스트림의 샘플링 속도와 동일한 값으로 설정되어야 합니다. MPEG-4 비디오 스트림이 전송되는 경우 속도를 90kHz로 설정하는 것이 좋습니다.\(MUST, SHOULD, SHOULD\)

모든 경우에 발신자는 RTP 타임스탬프가 동일한 액세스 단위의 조각을 참조하는 경우에만 RTP 타임스탬프가 동일한지 확인해야 합니다.\(MUST\)

RFC 3550 \[2\]\(섹션 5.1\)에 따르면 보안상의 이유로 RTP 타임스탬프가 임의의 값에서 시작하는 것이 권장됩니다. 이는 여러 RTP 스트림을 동기화하는 데에는 문제가 되지 않습니다. 그러나 여러 소스의 스트림을 동기화해야 하는 경우\(예: 로컬 저장소의 스트림 하나, RTP 스트리밍 서버의 스트림 하나\), 수신자가 원래 타임스탬프 관계만 알고 있으면 동기화가 불가능할 수 있습니다. 이러한 경우 동기화를 획득하는 데 필요한 타임스탬프 관계는 대역 외 수단을 통해 제공될 수 있습니다. 그러한 정보의 형식과 그러한 정보를 전달하는 방법은 이 사양의 범위를 벗어납니다.\(SHOULD\)

SSRC: RFC 3550 \[2\]에 설명된 대로 설정됩니다.

CC 및 CSRC 필드는 RFC 3550 \[2\]에 설명된 대로 사용됩니다.

RTCP는 RFC 3550 \[2\]에 정의된 대로 사용해야 합니다. RTCP 발신자 보고서의 타임스탬프는 여러 MPEG-4 기본 스트림을 동기화하고 MPEG-4 스트림을 비 MPEG-4 스트림과 동기화하는 데 사용될 수 있습니다\(해당 스트림 전달에 RTP가 사용되는 경우\).\(SHOULD\)

---
### **3.2.  RTP Payload Structure**
---
#### **3.2.1.  The AU Header Section**

AU 헤더 섹션이 있는 경우 AU 헤더 길이 필드와 그 뒤에 오는 여러 AU 헤더로 구성됩니다\(그림 2 참조\).

```text
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- .. -+-+-+-+-+-+-+-+-+-+
      |AU-headers-length|AU-header|AU-header|      |AU-header|padding|
      |                 |   (1)   |   (2)   |      |   (n)   | bits  |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- .. -+-+-+-+-+-+-+-+-+-+

                   Figure 2: The AU Header Section
```

AU-헤더는 MIME 형식 매개변수를 사용하여 구성되며 비어 있을 수 있습니다. AU-헤더가 비어 있도록 구성된 경우 AU-헤더 길이 필드는 존재하지 않아야 하며 결과적으로 AU 헤더 섹션은 비어 있습니다. AU-헤더가 비어 있지 않은 경우 AU-header-length는 패딩 비트를 제외하고 바로 다음 AU-헤더의 길이를 비트 단위로 지정하는 2옥텟 필드입니다.\(MAY, MUST NOT\)

각 AU 헤더는 동일한 RTP 패킷의 액세스 단위 데이터 섹션에 포함된 단일 액세스 단위\(조각\)와 연결됩니다.

포함된 각 액세스 단위\(조각\)에는 정확히 하나의 AU- 헤더가 있습니다. AU 헤더 섹션 내에서 AU 헤더는 액세스 단위가 액세스 단위 데이터 섹션에 포함된 순서대로 비트 방식으로 연결됩니다. 따라서 n번째 AU-헤더는 n번째 AU\(조각\)을 참조합니다. 연결된 AU 헤더가 정수가 아닌 옥텟 수를 소비하는 경우 AU 헤더 섹션의 옥텟 정렬을 달성하려면 끝에 최대 7개의 제로 패딩 비트를 삽입해야 합니다.\(MUST\)

---
##### **3.2.1.1.  The AU-header**

각 AU-헤더는 그림 3에 주어진 필드를 포함할 수 있습니다. CTS-플래그, DTS-플래그 및 RAP-플래그 필드를 제외한 필드의 비트 길이는 MIME 형식 매개변수에 의해 정의됩니다. 섹션 4.1을 참조하세요. MIME 형식 매개변수의 기본값이 0인 경우 관련 필드가 존재하지 않습니다. 존재하고 매개변수 값을 나타내는 필드의 비트 수는 세션 중에 해당 매개변수의 가장 큰 값을 올바르게 인코딩할 수 있을 만큼 충분히 크게 선택되어야 합니다.\(MUST\)

존재하는 경우 필드는 그림 3에 주어진 상호 순서로 발생해야 합니다. 일반적인 경우 CTS-delta 및 DTS-delta 필드의 존재는 다음과 같기 때문에 수신기는 AU-헤더를 구문 분석하여 크기를 발견할 수 있습니다. 각각 CTS 플래그와 DTS 플래그 값으로 표시됩니다.\(MUST\)

```text
      +---------------------------------------+
      |     AU-size                           |
      +---------------------------------------+
      |     AU-Index / AU-Index-delta         |
      +---------------------------------------+
      |     CTS-flag                          |
      +---------------------------------------+
      |     CTS-delta                         |
      +---------------------------------------+
      |     DTS-flag                          |
      +---------------------------------------+
      |     DTS-delta                         |
      +---------------------------------------+
      |     RAP-flag                          |
      +---------------------------------------+
      |     Stream-state                      |
      +---------------------------------------+
```

그림 3: AU 헤더의 필드. 사용되는 경우 AU-Index 필드는 AU 헤더 섹션 내의 첫 번째 AU-헤더에서만 발생합니다. 다른 AU-헤더에서는 AU-Index-delta 필드가 대신 발생합니다.

AU-크기: 동일한 RTP 패킷의 액세스 단위 데이터 섹션에 있는 연관된 액세스 단위의 크기\(옥텟\)를 나타냅니다. AU 크기가 AU 조각과 연결된 경우 AU 크기는 조각의 크기가 아니라 전체 AU의 크기를 나타냅니다. 이 경우 조각의 크기는 AU 데이터 섹션의 크기를 통해 알 수 있습니다. 이는 패킷에 전체 AU 또는 조각이 포함되어 있는지 여부를 결정하는 데 활용될 수 있으며, 이는 AU의 마지막 조각을 전달하는 패킷이 손실된 후 특히 유용합니다.

AU-Index: 연결된 액세스 단위\(조각\)의 일련 번호를 나타냅니다. 각각의 \(디코딩 순서대로\) 연속 AU 또는 AU 조각에 대해 일련 번호는 1씩 증가합니다. 존재하는 경우 AU-Index 필드는 AU 헤더 섹션의 첫 번째 AU-헤더에서 발생하지만 후속\( 첫 번째가 아닌\) 해당 섹션의 AU- 헤더. 첫 번째가 아닌 AU 헤더에 일련번호를 인코딩하려면 AU-Index-delta 필드가 사용됩니다.\(MUST NOT\)

AU-Index-delta: AU-Index-delta 필드는 이전 Access Unit의 일련번호와의 차이로 연관된 AU의 일련번호를 지정하는 부호 없는 정수입니다. 따라서 n번째\(n\>1\) AU의 경우 일련 번호는 다음에서 찾을 수 있습니다.

```text
      AU-Index(n) = AU-Index(n-1) + AU-Index-delta(n) + 1
```

- AU-Index 필드가 AU 헤더 섹션의 첫 번째 AU-헤더에 있으면 AU-Index-delta 필드는 후속\(첫 번째가 아닌\) AU-헤더에 있어야 합니다. AU-Index-delta가 0 값으로 코딩되면 Access Unit이 디코딩 순서에 따라 연속적임을 나타냅니다. AU-Index-delta 값이 0보다 크면 인터리빙이 적용된 신호입니다.\(MUST\)

CTS-flag: CTS-delta 필드가 있는지 여부를 나타냅니다. 값이 1이면 해당 필드가 있음을 나타내고, 값이 0이면 해당 필드가 없음을 나타냅니다.

- CTS-delta 필드의 길이가 0보다 크다고 신호되는 경우 CTS-flag 필드는 각 AU-헤더에 있어야 합니다. 이 경우 CTS-플래그 필드는 첫 번째 AU 헤더에서 값 0을 가져야 하며 첫 번째가 아닌 모든 AU 헤더에서 값 1을 가질 수 있습니다. CTS-플래그 필드는 액세스 유닛의 첫 번째가 아닌 조각에 대해 0이어야 합니다.\(MUST, MUST, SHOULD\)

CTS-delta: 이 RTP 패킷의 RTP 헤더에 있는 타임 스탬프로부터 CTS 값을 2의 보수 오프셋\(델타\)으로 지정하여 CTS를 인코딩합니다. CTS는 RTP 헤더의 타임스탬프와 동일한 클럭 속도를 사용해야 합니다.\(MUST\)

DTS-flag: DTS-delta 필드가 있는지 여부를 나타냅니다. 1의 값은 DTS-delta가 있음을 나타내고, 0의 값은 DTS-delta가 없음을 나타냅니다.

- DTS-delta 필드의 길이가 0보다 크다고 신호되는 경우 DTS-flag 필드는 각 AU-헤더에 있어야 합니다. DTS-플래그 필드는 액세스 단위의 모든 조각에 대해 동일한 값을 가져야 합니다.\(MUST, MUST\)

DTS-delta: DTS 값을 CTS로부터의 2의 보수 오프셋\(델타\)으로 지정합니다. DTS는 RTP 헤더의 타임스탬프와 동일한 클럭 속도를 사용해야 합니다. DTS-delta 필드는 액세스 단위의 모든 조각에 대해 동일한 값을 가져야 합니다.\(MUST, MUST\)

RAP-플래그: 1로 설정되면 연결된 액세스 단위가 스트림 콘텐츠에 대한 무작위 액세스 지점을 제공함을 나타냅니다. 액세스 단위가 조각화된 경우 RAP 플래그\(있는 경우\)는 AU의 첫 번째가 아닌 각 조각에 대해 0으로 설정되어야 합니다.\(MUST\)

스트림 상태: MPEG-4 시스템 스트림의 AU에 대한 스트림 상태를 지정합니다. 각 상태는 모듈로 카운터 값으로 식별됩니다. ISO/IEC 14496-1에서 MPEG-4 시스템 스트림은 AU\_SequenceNumber를 사용하여 스트림 상태를 알립니다. 스트림 상태가 변경되면 스트림 상태의 값은 1씩 증가해야 합니다.\(MUST\)

- 참고: 서로 다른 스트림의 스트림 상태 간에는 관계가 필요하지 않습니다.

---
#### **3.2.2.  The Auxiliary Section**

보조 섹션은 보조 데이터 크기 필드와 보조 데이터 필드로 구성됩니다. 수신기는 보조 데이터 필드를 구문 분석할 수 있지만 필수는 아닙니다. 수신기가 보조 데이터 필드를 쉽게 건너뛸 수 있도록 보조 데이터 크기 필드는 보조 데이터의 길이를 비트 단위로 나타냅니다. 보조 데이터 크기와 보조 데이터 필드의 연결이 정수가 아닌 수의 옥텟을 소비하는 경우 옥텟 정렬을 달성하기 위해 보조 데이터 바로 뒤에 최대 7개의 제로 패딩 비트를 삽입해야 합니다. 그림 4를 참조하세요.\(MAY, MUST\)

```text
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- .. -+-+-+-+-+-+-+-+-+
      | auxiliary-data-size   | auxiliary-data       |padding bits |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+- .. -+-+-+-+-+-+-+-+-+

           Figure 4: The fields in the Auxiliary Section
```

보조 데이터 크기 필드의 비트 길이는 MIME 형식 매개변수로 구성 가능합니다. 섹션 4.1을 참조하세요. 기본 길이 0은 전체 보조 섹션이 없음을 나타냅니다.

```text
   auxiliary-data-size: specifies the length in bits of the immediately
      following auxiliary-data field;
```

보조 데이터: 보조 데이터 필드에는 이 사양에서 정의되지 않은 형식의 데이터가 포함됩니다.

---
#### **3.2.3.  The Access Unit Data Section**

액세스 단위 데이터 섹션에는 완전한 액세스 단위의 정수 또는 하나의 AU의 단일 조각이 포함됩니다. 액세스 단위 데이터 섹션은 비어 있지 않습니다. 둘 이상의 액세스 단위 데이터가 존재하는 경우 AU는 연속적인 옥텟 문자열로 연결됩니다. 그림 5를 참조하십시오. 액세스 단위 데이터 섹션 내부의 AU는 디코딩 순서에 있어야 하지만 인터리빙의 경우 반드시 연속적일 필요는 없습니다.\(MUST\)

액세스 유닛의 크기와 수는 결과 RTP 패킷이 경로 MTU보다 크지 않도록 조정되어야 합니다. 더 큰 패킷을 처리하기 위해 이 페이로드 형식은 조각화를 위해 하위 계층을 사용하므로 성능이 저하될 수 있습니다.\(SHOULD\)

```text
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |AU(1)                                                          |
      +                                                               |
      |                                                               |
      |               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |               |AU(2)                                          |
      +-+-+-+-+-+-+-+-+                                               |
      |                                                               |
      |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                               | AU(n)                         |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |AU(n) continued|
      |-+-+-+-+-+-+-+-+
```

- 그림 5: 액세스 단위 데이터 섹션; 각 AU는 옥텟으로 정렬됩니다.

여러 액세스 유닛이 전송되는 경우 각 AU의 크기를 수신기에서 사용할 수 있어야 합니다. AU 크기가 가변적인 경우 각 AU의 크기는 해당 AU 헤더의 AU 크기 필드에 표시되어야 합니다. 그러나 AU 크기가 스트림에 대해 일정한 경우 이 메커니즘을 사용하면 안 됩니다. 대신 고정 크기는 MIME 형식 매개변수 "constantSize"에 의해 신호되어야 합니다. 섹션 4.1을 참조하세요.\(MUST, MUST, SHOULD NOT\)

AU-헤더에 AU-size와 ConstantSize MIME 형식 매개변수가 없으면 단일 AU\(조각\)의 전달, 즉 단일 액세스 단위\(조각\)가 해당 스트림에 대한 각 RTP 패킷으로 전송된다는 것을 나타냅니다.

---
##### **3.2.3.1.  Fragmentation**

패킷은 하나 이상의 완전한 액세스 단위 또는 액세스 단위의 단일 조각을 전달해야 합니다. 동일한 액세스 단위의 조각은 동일한 타임스탬프를 갖지만 RTP 시퀀스 번호는 다릅니다. RTP 헤더의 마커 비트는 액세스 단위의 마지막 조각에서는 1이고 다른 모든 조각에서는 0입니다.\(MUST\)

---
##### **3.2.3.2.  Interleaving**

신호 모드에 의해 금지되지 않는 한 발신자는 액세스 단위를 인터리브할 수 있습니다. 인터리빙을 지원하는 모드를 수신할 수 있는 수신기는 인터리빙된 액세스 유닛을 디코딩할 수 있어야 합니다.\(MAY, MUST\)

발신자가 액세스 단위를 인터리브할 때 순서가 잘못된 패킷, 패킷 손실 또는 중복의 경우에도 수신자가 원래 순서를 명확하게 재구성할 수 있도록 충분한 정보를 제공해야 합니다. 발신자가 제공해야 하는 정보는 액세스 단위가 일정한 기간을 갖는지 여부에 따라 다릅니다. 다음과 같은 경우 액세스 단위는 일정한 지속 시간을 갖습니다.

```text
   TS(i+1) - TS(i) = constant

       for any i, where:
          i indicates the index of the AU in the original order, and
          TS(i) denotes the time stamp of AU(i)
```

MIME 매개변수 "constantDuration"은 액세스 단위가 일정한 지속 시간을 갖고 있음을 알리는 데 사용되어야 합니다. 섹션 4.1을 참조하세요.\(SHOULD\)

"constantDuration" 매개변수가 존재하는 경우 수신기는 RTP 타임스탬프 및 AU-Index-delta만을 기반으로 원래 액세스 단위 타이밍을 재구성할 수 있습니다. 따라서 일정한 기간의 액세스 단위를 전송할 때 AU-Index는 존재하는 경우 다음으로 설정되어야 합니다.\(MUST\)

값은 0입니다. 일정 기간 액세스 단위의 수신기는 RTP 패킷의 첫 번째 AU 인덱스를 결정하기 위해 RTP 타임스탬프를 사용해야 합니다. AU-Index-delta 헤더와 신호된 "constantDuration"은 AU 타이밍을 재구성하는 데 사용됩니다.\(MUST\)

"constantDuration" 매개변수가 없으면 발신자는 각 RTP 패킷에서 AU-Index를 0으로 코딩하여 일정한 기간의 AU를 신호할 수 있습니다. ConstantDuration 매개변수가 없는 경우 수신기는 두 개의 연속 RTP 패킷에서 AU 인덱스가 0인 경우 AU가 일정한 지속 시간을 갖는다고 결론을 내려야 합니다.\(MAY, MUST\)

가변 기간의 액세스 단위를 전송할 때 "constantDuration" 매개변수가 존재해서는 안 되며, 송신기는 AU-Index를 사용하여 재정렬에 필요한 인덱스 정보를 인코딩해야 하며, 수신기는 해당 값을 사용하여 인덱스를 결정해야 합니다. RTP 패킷의 각 AU. AU-Index 필드의 비트 수는 AU-Index 필드의 롤오버로 인한 문제를 일으키지 않고 적용된 인터리빙 방식에서 유효한 인덱스 정보가 제공되도록 선택해야 합니다. 또한 CTS-델타는 RTP 패킷의 첫 번째가 아닌 각 AU에 대한 AU 헤더에 코딩되어야 합니다. 그래야 수신기가 시간에 맞춰 AU를 올바르게 배치할 수 있습니다.\(MUST NOT, MUST, MUST\)

인터리빙이 적용될 때, 액세스 유닛을 올바른 논리적 연속 디코딩 순서로 배치하기 위해 수신기에 디인터리브 버퍼가 필요합니다. 이를 위해서는 각 액세스 단위에 대한 타임스탬프 계산이 필요합니다. 액세스 단위당 일정한 지속 시간이 있는 경우 RTP 타임 스탬프 T가 있는 RTP 패킷의 i번째 액세스 단위의 타임 스탬프는 다음과 같이 계산됩니다.

타임스탬프\[0\] = T 타임스탬프\[i, i \> 0\] = T +\(Sum\(for k=1 to i of \(AU-Index-delta\[k\] + 1\)\)\) \* 액세스 단위 기간

AU-Index-delta가 항상 0일 때 이는 T + i \*\(액세스 단위 지속 기간\)로 감소합니다. 이는 프레임이 디코딩 순서에 따라 연속되는 비인터리브 경우입니다. AU-Index 필드\(첫 번째 액세스 단위에 대해 존재함\)는 실제로 이 계산에 필요하지 않습니다.

---
##### **3.2.3.3.  Constraints for Interleaving**

패킷의 크기는 경로 MTU와 수신기의 디인터리브 버퍼 용량 모두에 적합하도록 적절하게 선택되어야 합니다. 세션의 최대 패킷 크기는 경로 MTU를 초과하지 않도록 선택해야 합니다.\(SHOULD\)

수신자가 디인터리빙을 위해 충분한 자원을 할당할 수 있도록 하려면 발신자는 이 섹션에 지정된 대로 수신자에게 정보를 제공해야 합니다.\(MUST\)

AU는 디코딩 순서대로 디코더에 들어갑니다. 디인터리브 버퍼는 인터리빙된 AU의 스트림을 디코딩 순서로 다시 정렬하는 데 사용됩니다. 인터리빙이 적용될 때, "초기" AU의 디코딩은 디코딩 순서에서 그보다 앞선 모든 AU가 존재할 때까지 연기되어야 합니다. 따라서 이러한 "초기" AU는 디인터리브 버퍼에 저장됩니다. 그림 6의 예로서 섹션 2.5의 인터리빙 패턴을 고려합니다.

```text
                             +--+--+--+--+--+--+--+--+--+--+--+-
   Interleaved AUs           | 0| 3| 6| 1| 4| 7| 2| 5| 8| 9|12|..
                             +--+--+--+--+--+--+--+--+--+--+--+-
   Storage of "early" AUs         3  3  3  3  3  3
                                     6  6  6  6  6  6
                                           4  4  4
                                              7  7  7
                                                            12 12
```

그림 6: 인터리브된 AU당 디인터리브 버퍼의 "초기" AU 저장.

AU\(3\)은 AU\(0\), AU\(1\) 및 AU\(2\) 다음에 디코더로 전달됩니다. 이러한 AU 중 AU\(2\)는 네트워크에서 마지막으로 도착하므로 AU\(3\)는 AU\(2\)가 패턴에 나타날 때까지 저장되어야 합니다. 마찬가지로 AU\(6\)은 AU\(5\)가 나타날 때까지 저장되고, AU\(4\)와 AU\(7\)은 각각 AU\(2\)와 AU\(5\)가 나타날 때까지 저장됩니다. 디인터리브 버퍼의 용량은 시간에 따라 달라집니다. 그림 6에서 디인터리브 버퍼에는 최대 4개가 포함되지만 그보다 적은 AU가 포함되는 경우도 있습니다.

디인터리빙을 위해 수신기에 필요한 리소스를 대략적으로 표시하기 위해 AU의 시간상 최대 변위가 정의됩니다. 패턴의 모든 AU\(j\)에 대해 아직 존재하지 않는 i<j인 각 AU\(i\)를 결정할 수 있습니다. AU 시간의 최대 변위는 패턴에 있는 AU의 타임스탬프와 아직 존재하지 않는 가장 빠른 AU의 타임스탬프 간의 최대 차이입니다. 즉, 인터리브된 AU의 시퀀스를 고려할 때 다음과 같습니다.

```text
   Maximum displacement = max{TS(i) - TS(j)}
```

임의의 i 및 임의의 j\>i에 대해, 여기서:

- i와 j는 인터리빙 패턴에서 AU의 인덱스를 나타내고, TS는 AU의 타임 스탬프를 나타낸다.

그림 7의 예로서 섹션 2.5의 인터리빙 패턴을 고려합니다. 패턴의 각 AU에 대해 아직 존재하지 않는 이전 AU 중 가장 빠른 AU에 대한 인덱스가 제공됩니다. 따라서 인터리빙 패턴의 각 AU\(n\)에 대해 아직 전달되지 않은 AU의 가장 작은 인덱스 k\(k<n\)가 표시됩니다. "-"는 이전 AU가 모두 존재함을 나타냅니다. AU 기간이 일정한 경우 최대 변위는 AU\(6\) 및 AU\(7\)에서 발견된 것처럼 5 AU 기간과 같습니다.

```text
                                 +--+--+--+--+--+--+--+--+--+--+--+-
   Interleaved AUs               | 0| 3| 6| 1| 4| 7| 2| 5| 8| 9|12|..
                                 +--+--+--+--+--+--+--+--+--+--+--+-

   Earliest not yet present AU     -  1  1  -  2  2  -  -  -  - 10
```

그림 7: 인터리빙 패턴의 각 AU에 대해 아직 존재하지 않는 이전 AU 중 가장 빠른 것

인터리브할 때 발신자는 MIME 형식 매개변수 "maxDisplacement"를 통해 세션 동안 시간상 최대 변위를 신호해야 합니다. 섹션 4.1을 참조하세요.\(MUST\)

디인터리브 버퍼의 크기 추정치는 최대 변위와 최대 비트 전송률을 곱하여 구합니다.

```text
   size(de-interleave buffer) = {(maxDisplacement) * Rate(max)} / (RTP
                                clock frequency),
```

어디:

- Rate\(max\)는 전송되는 스트림의 최대 비트 전송률입니다.

수신자는 MIME 형식 매개변수 streamType, profile-level-id 및 config에서 Rate\(max\)를 파생할 수 있습니다.

그러나 이 계산은 디인터리브 버퍼의 크기를 추정한 것으로, 필요한 크기는 계산된 값과 다를 수 있습니다. 이 계산이 디인터리브 버퍼의 크기를 과소평가하는 경우 발신자는 인터리빙 시 MIME 형식 매개변수 "de-interleaveBufferSize"를 통해 디인터리브 버퍼의 크기를 알려야 합니다. 섹션 4.1을 참조하세요. 계산이 디인터리브 버퍼의 크기를 과대평가하는 경우 발신자는 인터리빙 시 MIME 형식 매개변수 "de-interleaveBufferSize"를 통해 디인터리브 버퍼의 크기를 알릴 수 있습니다.\(MUST, MAY\)

디인터리브 버퍼의 신호 크기는 세션 중 어느 시점에서나 모든 "초기" AU를 포함할 수 있을 만큼 충분히 커야 합니다. 그건:\(MUST\)

```text
   minimum de-interleave buffer size = max [sum {if TS(i) > TS(j) then
                                       AU-size(i) else 0}]
```

j 및 i<j에 대해 다음과 같습니다.

- i와 j는 인터리빙 패턴에서 AU의 인덱스를 나타내고, TS\(i\)는 AU\(i\)의 타임 스탬프를 나타내며, AU-size\(i\)는 AU\(i\)의 크기를 옥텟 수로 나타낸다.

"de-interleaveBufferSize" 매개변수가 있는 경우 수신기에서 디인터리빙을 위해 적용되는 버퍼는 적어도 디인터리브 버퍼의 신호 크기와 동일한 크기를 가져야 하며, 그렇지 않은 경우 적어도 동일한 크기를 가져야 합니다. 디인터리브 버퍼의 계산된 크기입니다.\(MUST\)

어떤 인터리빙 방식을 사용하든 해당 방식을 분석하여 적용 가능한 maxDisplacement 값과 필요한 디인터리브 버퍼 크기를 계산해야 합니다. 발신자는 엄격하게 요구되는 값보다 크지 않은 값을 신호로 보내야 합니다. 더 큰 값이 신호되면 수신기가 과도하게 버퍼링됩니다.\(SHOULD\)

비트 전송률이 낮은 자료의 경우 인터리빙을 적용하면 패킷이 MTU 크기보다 짧아질 수 있습니다.

---
##### **3.2.3.4.  Crucial and Non-Crucial AUs with MPEG-4 System Data**

"핵심" AU라고 불리는 MPEG-4 시스템 데이터가 포함된 일부 액세스 장치는 프레젠테이션이나 디코더에서 손실이 허용되지 않는 정보를 전달합니다. MPEG-4 시스템 스트림의 중요한 AU마다 스트림 상태가 변경됩니다. 스트림 상태는 중요하지 않은 AU에서 일정하게 유지될 수 있습니다. ISO/IEC 14496-1에서 MPEG-4 시스템 스트림은 AU\_SequenceNumber를 사용하여 스트림 상태를 알립니다.\(MAY\)

예: 세 개의 AU가 주어지면 AU1 = "노드 X의 삽입", AU2 = "노드 X의 위치 설정", AU3 = "노드 X의 위치 설정". AU1은 매우 중요합니다. 손실되면 AU2를 실행할 수 없기 때문입니다. 그러나 AU2가 손실되더라도 AU3은 실행될 수 있으므로 AU2는 중요하지 않습니다.

중요한 AU가 \(아마도\) 손실되면 스트림이 손상됩니다. 예를 들어, AU가 손실되고 다음 수신된 AU에서 스트림 상태가 변경된 경우 손실된 AU가 중요했을 가능성이 있습니다. 일단 손상되면 스트림은 다음 임의 액세스 지점까지 손상된 상태로 유지됩니다. 중요하지 않은 AU의 손실은 스트림을 손상시키지 않습니다. 디코더가 스트림 수신을 시작하면 디코더는 반드시\(MUST\)

랜덤 액세스 포인트를 제공하는 AU가 수신될 때까지 스트림이 손상된 것으로 간주하십시오.

RAP- 플래그로 표시되는 대로 임의 액세스 포인트를 제공하는 AU는 중요할 수도 있고 그렇지 않을 수도 있습니다. 중요하지 않은 RAP AU는 최근 스트림에 합류했거나 스트림 손상 후 디코딩을 다시 시작해야 하는 디코더가 사용할 수 있는 "반복적인" 무작위 액세스 포인트를 제공합니다. 중요하지 않은 RAP AU에는 마지막 중요한 RAP AU 이후의 모든 업데이트가 포함되어야 합니다.\(MUST\)

AU를 수신하면 디코더는 다음과 같이 반응해야 합니다.

a\) RAP 플래그가 1로 설정되고 스트림 상태가 변경되면 AU는 중요한 RAP AU이고 AU는 디코딩되어야 합니다.\(MUST\)

b\) RAP 플래그가 1로 설정되고 스트림 상태가 변경되지 않으면 AU는 중요하지 않은 RAP AU이고 스트림이 손상된 경우 수신기는 이를 디코딩해야 합니다. 그렇지 않으면 디코더는 AU를 무시해야 합니다.\(SHOULD, MUST\)

c\) RAP 플래그가 0으로 설정된 경우 스트림이 손상되지 않는 한 AU는 반드시 디코딩되어야 하며, 이 경우 AU는 무시되어야 합니다.\(MUST\)

---
### **3.3.  Usage of this Specification**
---
#### **3.3.1.  General**

이 사양을 사용하려면 모드 정의가 필요합니다. 모드는 적절하다고 판단되는 대로 이 사양을 사용하는 방법을 정의합니다. 발신자는 섹션 4.1에 지정된 대로 MIME 형식 매개변수 "mode"를 통해 적용된 모드를 신호해야 합니다. 이 사양은 ISO/IEC 14496-3\[1\]에 정의된 MPEG-4 CELP 및 MPEG-4 AAC 스트림 전송을 위한 특정 모드뿐만 아니라 모든 MPEG-4 스트림에 사용할 수 있는 일반 모드를 정의합니다.\(MUST\)

이 페이로드 형식의 사용이 SDP\[5\]를 사용하여 신호를 받을 때 "rtpmap" 속성은 해당 신호의 일부입니다. 이 사양을 준수하는 모든 모드에서 rtpmap 속성에 동일한 요구 사항이 적용됩니다. rtpmap 속성의 일반적인 형식은 다음과 같습니다.

```text
   a=rtpmap:<payload type> <encoding name>/<clock rate>[/<encoding
             parameters>]
```

오디오 스트림의 경우 <인코딩 매개변수\>는 오디오 채널 수를 지정합니다. 스테레오 자료의 경우 2개\(RFC 2327 \[5\] 참조\), 모노의 경우 1개입니다. 추가 매개변수가 필요하지 않은 경우 이 매개변수는 모노 재질에 대해 생략될 수 있으므로 기본값은 1입니다.

---
#### **3.3.2.  The Generic Mode**

일반 모드는 모든 MPEG-4 스트림에 사용할 수 있습니다. 이 모드에서는 모드별 제약이 적용되지 않습니다. 따라서 일반 모드에서는 이 사양의 전체 유연성을 활용할 수 있습니다. 일반 모드는 mode=generic으로 표시됩니다.

BIFS-Anim 스트림 전송에 대한 예가 아래에 나와 있습니다. 이 예에서는 하나의 RTP 패킷에 여러 BIFS-Anim 액세스 단위의 전달이 허용됩니다. AU 헤더에는 AU 크기 필드, CTS 플래그 및 CTS 플래그가 1로 설정된 경우 CTS-델타 필드가 포함됩니다. AU-size 및 CTS-delta 필드의 비트 수는 각각 10 및 16입니다. AU-헤더에는 RAP- 플래그와 4비트의 스트림 상태도 포함되어 있습니다. 결과적으로 BIFS-Anim AU당 총 크기가 2\~4옥텟인 AU 헤더가 생성됩니다. RTP 타임스탬프는 1kHz 클록을 사용합니다. BIFS-Anim 스트림은 시청각 프리젠테이션의 일부이므로 미디어 유형 이름은 비디오입니다. 미디어 유형 이름에 대한 규칙은 섹션 4.1을 참조하세요.

상세히:

```text
   m=video 49230 RTP/AVP 96
   a=rtpmap:96 mpeg4-generic/1000
   a=fmtp:96 streamtype=3; profile-level-id=1807; mode=generic;
   objectType=2; config=0842237F24001FB400094002C0; sizeLength=10;
   CTSDeltaLength=16; randomAccessIndication=1;
   streamStateIndication=4
```

참고: a=fmtp 행은 페이지에 맞게 줄바꿈되었으며 SDP 파일에서는 단일 행으로 구성됩니다.

"config" 매개변수의 16진수 값은 ISO/IEC 14496-1에 정의된 BIFSConfiguration\(\)입니다. BIFSConfiguration\(\)은 BIFS 스트림이 BIFS-Anim 스트림임을 지정합니다. MIME 매개변수에 대한 설명은 섹션 4.1을 참조하세요.

---
#### **3.3.3.  Constant Bit-rate CELP**

이 모드는 mode=CELP-cbr로 표시됩니다. 이 모드에서는 고정된 크기의 하나 이상의 완전한 CELP 프레임을 하나의 RTP 패킷으로 전송할 수 있습니다. 인터리빙은 이 모드에서 사용하면 안 됩니다. RTP 페이로드는 각각 동일한 크기를 갖는 하나 이상의 연결된 CELP 프레임으로 구성됩니다. 이 모드를 사용할 때 CELP 프레임은 조각화되어서는 안 됩니다. AU 헤더 섹션과 보조 섹션은 모두 비어 있어야 합니다.\(MUST NOT, MUST NOT, MUST\)

MIME 형식 매개변수 ConstantSize는 각 CELP 프레임의 길이를 지정하기 위해 제공되어야 합니다.\(MUST\)

예를 들어:

```text
   m=audio 49230 RTP/AVP 96
   a=rtpmap:96 mpeg4-generic/16000/1
   a=fmtp:96 streamtype=5; profile-level-id=14; mode=CELP-cbr; config=
   440E00; constantSize=27; constantDuration=240
```

참고: a=fmtp 행은 페이지에 맞게 줄바꿈되었으며 SDP 파일에서는 단일 행으로 구성됩니다.

"config" 매개변수의 16진수 값은 ISO/IEC 14496-3에 정의된 AudioSpecificConfig\(\)입니다. AudioSpecificConfig\(\)는 14.4kb/s의 고정 비트 전송률과 CELP 프레임당 6개의 하위 프레임에서 16kHz의 샘플링 속도로 모노 CELP 스트림을 지정합니다. MIME 매개변수에 대한 설명은 섹션 4.1을 참조하세요.

---
#### **3.3.4.  Variable Bit-rate CELP**

이 모드는 mode=CELP-vbr로 표시됩니다. 이 모드를 사용하면 가변 크기의 하나 이상의 완전한 CELP 프레임을 OPTIONAL 인터리빙을 사용하여 하나의 RTP 패킷으로 전송할 수 있습니다. 이 모드에서 AU 크기에 대해 가능한 가장 큰 값은 최대 CELP 프레임 크기보다 큽니다. CELP 프레임은 매우 작기 때문에 CELP 프레임 조각화는 지원되지 않습니다. 따라서 이 모드를 사용할 때 CELP 프레임은 조각화되어서는 안 됩니다.\(MAY, MUST NOT\)

이 모드에서 RTP 페이로드는 AU 헤더 섹션과 하나 이상의 연결된 CELP 프레임으로 구성됩니다. 보조 섹션은 비어 있어야 합니다. 페이로드에 포함된 각 CELP 프레임의 경우 AU 헤더 섹션에 다음을 제공하는 1옥텟 AU 헤더가 있어야 합니다.\(MUST, MUST\)

a\) 페이로드의 각 CELP 프레임 크기

b\) 각 CELP 프레임의 시퀀스\(따라서 타이밍\)를 계산하기 위한 인덱스 정보.

CELP 프레임을 전송하려면 AU 크기 필드가 6비트로 코딩되어야 합니다. 따라서 이 모드에서는 AU-size 필드에 6비트, AU-Index\(-delta\) 필드에 2비트가 할당됩니다. 각 AU-인덱스 필드는 값 0으로 코딩되어야 합니다. AU 헤더 섹션에서 연결된 AU-헤더 앞에는 섹션 3.2.1에 지정된 대로 16비트 AU-헤더 길이 필드가 옵니다.\(MUST\)

필수 MIME 형식 매개변수 외에도 sizeLength, indexLength 및 indexDeltaLength 매개변수가 있어야 합니다. CELP 프레임은 항상 액세스 단위당 고정된 기간을 갖습니다. 이 모드에서 인터리빙할 때 이 특정 기간은\(MUST\)

MIME 형식 매개변수 ConstantDuration으로 신호를 보내야 합니다. 또한 인터리브할 때 maxDisplacement 매개변수가 있어야 합니다.\(MUST, MUST\)

예를 들어:

```text
   m=audio 49230 RTP/AVP 96
   a=rtpmap:96 mpeg4-generic/16000/1
   a=fmtp:96 streamtype=5; profile-level-id=14; mode=CELP-vbr; config=
   440F20; sizeLength=6; indexLength=2; indexDeltaLength=2;
   constantDuration=160; maxDisplacement=5
```

참고: a=fmtp 행은 페이지에 맞게 줄 바꿈되었습니다. 이는 SDP 파일의 한 줄로 구성됩니다.

"config" 매개변수의 16진수 값은 ISO/IEC 14496-3에 정의된 AudioSpecificConfig\(\)입니다. AudioSpecificConfig\(\)는 16kHz의 샘플링 속도, 13.9\~16.2kb/s 사이의 비트 전송률 및 CELP 프레임당 4개의 하위 프레임을 사용하여 모노 CELP 스트림을 지정합니다. MIME 매개변수에 대한 설명은 섹션 4.1을 참조하세요.

---
#### **3.3.5.  Low Bit-rate AAC**

이 모드는 mode=AAC-lbr로 표시됩니다. 이 모드는 가변 크기의 하나 이상의 완전한 AAC 프레임 전송을 지원합니다. 이 모드에서는 AAC 프레임이 인터리빙될 수 있으므로 수신기는 디인터리빙을 지원해야 합니다. 이 모드에서 AAC 프레임의 최대 크기는 63옥텟입니다. 이 모드를 사용할 때 AAC 프레임은 조각화되어서는 안 됩니다. 따라서 이 모드를 사용할 때 인코더는 각 AAC 프레임의 크기가 최대 63옥텟인지 확인해야 합니다.\(MUST, MUST NOT, MUST\)

이 모드의 페이로드 구성은 3.3.4에 정의된 가변 비트 전송률 CELP 모드와 동일합니다. RTP 페이로드는 AU 헤더 섹션과 연결된 AAC 프레임으로 구성됩니다. 보조 섹션은 비어 있어야 합니다. 페이로드에 포함된 각 AAC 프레임에 대해 1옥텟 AU 헤더는 다음을 제공해야 합니다.\(MUST, MUST\)

a\) 페이로드의 각 AAC 프레임 크기

b\) 각 AAC 프레임의 시퀀스\(따라서 타이밍\)를 계산하기 위한 인덱스 정보.

AU-헤더 섹션에서 연결된 AU-헤더 앞에는 섹션 3.2.1에 지정된 대로 16비트 AU-헤더 길이 필드가 와야 합니다.\(MUST\)

필수 MIME 형식 매개변수 외에도 sizeLength, indexLength 및 indexDeltaLength 매개변수가 있어야 합니다. AAC 프레임은 항상 액세스 단위당 고정된 기간을 갖습니다. 이 모드에서 인터리브할 때 이 특정 지속 시간은 MIME 형식 매개변수 ConstantDuration에 의해 신호되어야 합니다. 또한 인터리브할 때 maxDisplacement 매개변수가 있어야 합니다.\(MUST, MUST, MUST\)

예를 들어:

```text
   m=audio 49230 RTP/AVP 96
   a=rtpmap:96 mpeg4-generic/22050/1
   a=fmtp:96 streamtype=5; profile-level-id=14; mode=AAC-lbr; config=
   1388; sizeLength=6; indexLength=2; indexDeltaLength=2;
   constantDuration=1024; maxDisplacement=5
```

참고: a=fmtp 행은 페이지에 맞게 줄 바꿈되었습니다. 이는 SDP 파일의 한 줄로 구성됩니다.

"config" 매개변수의 16진수 값은 ISO/IEC 14496-3에 정의된 AudioSpecificConfig\(\)입니다. AudioSpecificConfig\(\)는 샘플링 속도가 22.05kHz인 모노 AAC 스트림을 지정합니다. MIME 매개변수에 대한 설명은 섹션 4.1을 참조하세요.

---
#### **3.3.6.  High Bit-rate AAC**

이 모드는 mode=AAC-hbr로 표시됩니다. 이 모드는 가변 크기 AAC 프레임의 전송을 지원합니다. 하나의 RTP 패킷에는 하나 이상의 완전한 AAC 프레임이 전달되거나 AAC 프레임의 단일 조각이 전달됩니다. 이 모드에서는 AAC 프레임이 인터리빙될 수 있으므로 수신기는 디인터리빙을 지원해야 합니다. 이 모드에서 AAC 프레임의 최대 크기는 8191 옥텟입니다.\(MUST\)

이 모드에서 RTP 페이로드는 AU 헤더 섹션과 그 뒤에 하나의 AAC 프레임, 여러 개의 연결된 AAC 프레임 또는 하나의 조각화된 AAC 프레임으로 구성됩니다. 보조 섹션은 비어 있어야 합니다. 페이로드에 포함된 각 AAC 프레임의 경우 AU 헤더 섹션에 다음을 제공하는 AU 헤더가 있어야 합니다.\(MUST, MUST\)

a\) 페이로드의 각 AAC 프레임 크기

b\) 각 AAC 프레임의 시퀀스\(따라서 타이밍\)를 계산하기 위한 인덱스 정보.

AAC 프레임의 최대 크기를 코딩하려면 13비트가 필요합니다. 따라서 이 구성에서는 AU-size에 13비트, AU-Index\(-delta\) 필드에 3비트가 할당됩니다. 따라서 각 AU 헤더는

크기는 2옥텟이다. 각 AU-Index 필드는 값 0으로 코딩되어야 합니다. AU 헤더 섹션에서 연결된 AU-헤더 앞에는 섹션 3.2.1에 지정된 대로 16비트 AU-헤더 길이 필드가 와야 합니다.\(MUST, MUST\)

필수 MIME 형식 매개변수 외에도 sizeLength, indexLength 및 indexDeltaLength 매개변수가 있어야 합니다. AAC 프레임은 항상 액세스 단위당 고정된 기간을 갖습니다. 이 모드에서 인터리브할 때 이 특정 지속 시간은 MIME 형식 매개변수 ConstantDuration에 의해 신호되어야 합니다. 또한 인터리브할 때 maxDisplacement 매개변수가 있어야 합니다.\(MUST, MUST, MUST\)

예를 들어:

```text
   m=audio 49230 RTP/AVP 96
   a=rtpmap:96 mpeg4-generic/48000/6
   a=fmtp:96 streamtype=5; profile-level-id=16; mode=AAC-hbr;
   config=11B0; sizeLength=13; indexLength=3;
   indexDeltaLength=3; constantDuration=1024
```

참고: a=fmtp 행은 페이지에 맞게 줄 바꿈되었습니다. 이는 SDP 파일의 한 줄로 구성됩니다.

"config" 매개변수의 16진수 값은 ISO/IEC 14496-3에 정의된 AudioSpecificConfig\(\)입니다. AudioSpecificConfig\(\)는 샘플링 속도가 48kHz인 5.1 채널 AAC 스트림을 지정합니다. MIME 매개변수에 대한 설명은 섹션 4.1을 참조하세요.

---
#### **3.3.7.  Additional Modes**

이 사양은 섹션 3.3.2\~3.3.6에 지정된 모드만 정의합니다. 향후 RFC에서는 추가 모드가 정의될 ​​예정입니다. 각 추가 모드는 이 사양을 완전히 준수해야 합니다.\(MUST\)

모든 새로운 모드는 이 사양의 모든 기능을 포함하는 구현이 이 새로운 모드에 해당하는 페이로드 형식을 디코딩할 수 있도록 정의되어야 합니다. 이러한 이유로 모드는 MIME 매개변수에 대한 새로운 기본값을 지정해서는 안 됩니다. 특히, RTP 페이로드를 구성하는 MIME 매개변수는 모드가 매개변수에 고정 값을 할당하는 경우 존재가 중복되더라도 반드시 존재해야 합니다\(기본값이 없는 경우\). 모드에서는 일부 MIME 매개변수가 선택 사항이 아닌 필수 항목, 일부 MIME 매개변수에 고정된 값\(또는 범위\)이 있고 해당 사용을 제한하는 규칙이 있음을 추가로 정의할 수 있습니다.\(MUST, MUST NOT, MUST\)

---
## **4.  IANA Considerations**

이 섹션에서는 이 페이로드 형식과 관련된 MIME 유형 및 이름을 설명합니다. 섹션 4.1은 RFC 2048 \[3\]에 따라 MIME 유형을 등록합니다.

이 형식에서는 수신자가 사용할 수 있도록 매핑에 대한 추가 정보가 필요할 수 있습니다. 이는 다음 섹션에 설명된 매개변수를 사용하여 수행됩니다.

---
### **4.1.  MIME Type Registration**

```text
   MIME media type name: "video" or "audio" or "application"
```

"비디오"는 오디오/비주얼 프레젠테이션에 필요한 정보를 전달하는 MPEG-4 시각적 스트림\(ISO/IEC 14496-2\) 또는 MPEG-4 시스템 스트림\(ISO/IEC 14496-1\)에 사용해야 합니다.\(MUST\)

"오디오"는 오디오 전용 프레젠테이션에 필요한 정보를 전달하는 MPEG-4 오디오 스트림\(ISO/IEC 14496-3\) 또는 MPEG-4 시스템 스트림에 사용해야 합니다.\(MUST\)

"application"은 오디오/비주얼 프리젠테이션 이외의 목적으로 사용되는 MPEG-4 시스템 스트림\(ISO/IEC 14496-1\)에 사용해야 합니다\(예: MPEG-J\(Java\) 스트림이 전송되는 경우\).\(MUST\)

필요한 페이로드 구성에 따라 MIME 형식 매개변수를 수신자가 사용할 수 있어야 할 수도 있습니다. 이는 다음 섹션에 설명된 매개변수를 사용하여 수행됩니다. 필수 매개변수와 선택 매개변수가 있습니다.

선택적 매개변수에는 일반 매개변수와 구성 매개변수의 두 가지 유형이 있습니다. 구성 매개변수는 AU 헤더 섹션과 보조 섹션의 필드를 구성하는 데 사용됩니다. 구성 매개변수가 없다는 것은 연관된 필드가 기본값\(항상 0\)으로 설정된 것과 동일합니다. 모든 구성 매개변수가 없으면 각 RTP 패킷에 빈 AU 헤더 섹션과 빈 보조 섹션이 있는 기본 "기본" 구성이 생성됩니다.

```text
   MIME subtype name: mpeg4-generic

   Required parameters:
```

MIME 형식 매개변수는 대소문자에 의존하지 않습니다. 그러나 명확성을 위해 본 명세서에서 설명하는 매개변수의 이름에는 대문자와 소문자를 모두 사용합니다.

스트림 유형:

- 전송되는 MPEG-4 스트림의 유형을 나타내는 정수 값입니다. 해당 코딩은 ISO/IEC 14496-1의 표 9\(streamType 값\)에 정의된 streamType 값에 해당합니다.

프로필 수준 ID:

- MPEG-4 프로필 레벨 표시의 10진수 표현입니다. 이 매개변수는 관련 MPEG-4 미디어 코덱이 지원하는 MPEG-4 프로필 및 레벨 조합을 나타내기 위해 기능 교환 또는 세션 설정 절차에 사용되어야 합니다.\(MUST\)

- MPEG-4 오디오 스트림의 경우 이 매개변수는 오디오 스트림을 디코딩하는 데 필요한 MPEG-4 오디오 도구 하위 집합을 나타내는 ISO/IEC 14496-1의 표 5\(audioProfileLevelIndication 값\)에 있는 10진수 값입니다.

- MPEG-4 시각적 스트림의 경우 이 매개변수는 ISO/IEC 14496-2\[1\]의 표 G-1\(프로파일 및 레벨 표시에 대한 FLC 표\)의 10진수 값으로, MPEG-4 시각적 도구 하위 집합이 필요한지 나타냅니다. 시각적 스트림을 디코딩합니다.

- BIFS 스트림의 경우 이 매개변수는 \(SPLI + 256\*GPLI\)에서 얻은 10진수 값입니다. 여기서: SPLI는 sceneProfileLevelIndication이 적용된 ISO/IEC 14496-1의 표 4에 있는 10진수 값입니다. GPLI는 GraphicsProfileLevelIndication이 적용된 ISO/IEC 14496-1의 표 7에 있는 10진수 값입니다.

- MPEG-J 스트림의 경우 이 매개변수는 MPEG-J 스트림의 프로필과 레벨을 나타내는 ISO/IEC 14496-1의 표 13\(MPEGJProfileLevelIndication\)에 있는 10진수 값입니다.

- OD 스트림의 경우 이 매개변수는 ISO/IEC 14496-1의 표 3\(ODProfileLevelIndication\)에 있는 10진수 값으로, OD 스트림의 프로필과 수준을 나타냅니다.

- IPMP 스트림의 경우 이 매개변수는 10진수 값 0\(지정되지 않은 프로필 및 수준을 나타냄\) 또는 0보다 큰 값\(향후 MPEG-4 사양에 정의된 MPEG-4 IPMP 프로필 및 수준을 나타냄\)을 갖습니다.

- 시계 참조 스트림 및 객체 콘텐츠 정보 스트림의 경우 이 매개변수는 10진수 값 0을 가지며 이는 프로필 및 레벨 정보가 OD 프레임워크를 통해 전달됨을 나타냅니다.

구성:

- 미디어 페이로드 구성을 표현하는 옥텟 문자열의 16진수 표현입니다. 구성 데이터는 MSB 우선 기반으로 16진수 옥텟 문자열에 매핑됩니다. 구성 데이터의 첫 번째 비트는 첫 번째 옥텟의 MSB에 위치해야 합니다. 마지막 옥텟에서 옥텟 정렬을 달성하는 데 필요한 경우 최대 7개의 0 값 패딩 비트가 구성 데이터를 따라야 합니다.\(MUST\)

- MPEG-4 오디오 스트림의 경우 config는 ISO/IEC 14496-3에 정의된 오디오 개체 유형별 디코더 구성 데이터 AudioSpecificConfig\(\)입니다. 구조화된 오디오의 경우 AudioSpecificConfig\(\)는 이 사양에서 정의되지 않은 다른 방법으로 전달될 수 있습니다. AudioSpecificConfig\(\)가 구조적 오디오에 대한 다른 수단으로 전달되는 경우 구성은 다음과 같이 인용된 빈 16진수 옥텟 문자열이어야 합니다: config="".\(MUST\)

- 구조화된 오디오에 대해 이 RTP 페이로드 형식을 사용하는 향후 모드에서는 다른 수단을 정의할 수 있습니다.

MPEG-4 Visual 스트림의 경우 config는 MPEG-4 Visual입니다.

- 하위절 6.2.1, ISO/IEC 14496-2의 시작 코드에 정의된 구성 정보. 이 매개변수에 의해 표시된 구성 정보는 전반부 vbv-점유 및 후반-vbv-점유\(존재하는 경우\)를 제외하고 해당 MPEG-4 시각적 스트림의 구성 정보와 동일해야 합니다. MPEG-4 시각적 스트림 내에서 반복되는 구성 정보\(ISO/IEC 14496-2의 6.2.1 시작 코드 참조\).\(MUST\)

- BIFS 스트림의 경우 ISO/IEC 14496-1에 정의된 BIFSConfig\(\) 정보입니다. BIFSConfig 버전 1은 섹션 9.3.5.2에 정의되어 있으며, 버전 2는 섹션 9.3.5.3에 정의되어 있습니다. MIME 형식 매개변수 objectType은 BIFSConfig의 버전을 나타냅니다.

- IPMP 스트림의 경우 이는 디코더 구성 정보\(config=""\)가 없음을 나타내는 따옴표로 묶인 빈 16진수 옥텟 문자열이거나 향후 MPEG-4 IPMP 사양에 정의될 IPMPConfiguration\(\)입니다.

OCI\(객체 콘텐츠 정보\) 스트림의 경우 이는

- ISO/IEC 14496-1의 섹션 8.4.2.4에 정의된 OCI 스트림의 OCIDecoderConfiguration\(\) 정보.

- OD 스트림, 클럭 참조 스트림 및 MPEG-J 스트림의 경우 디코더 구성에 대한 정보가 필요하지 않으므로 따옴표로 묶인 빈 16진수 옥텟 문자열\(config=""\)입니다.

방법:

- 본 사양이 사용되는 모드입니다. 다음 모드를 신호할 수 있습니다.

모드=일반,

- 모드=CELP-cbr, 모드=CELP-vbr, 모드=AAC-lbr 및 모드=AAC-hbr.

- 기타 모드는 향후 RFC에서 정의될 예정입니다. RFC 3640의 섹션 3.3.7 및 4.2도 참조하세요.

```text
   Optional general parameters:
```

객체 유형:

- 전송된 스트림의 objectTypeIndication 값을 나타내는 ISO/IEC 14496-1의 표 8에 있는 10진수 값입니다. BIFS 스트림의 경우 BIFSConfiguration\(\) 버전을 알리기 위해 이 매개변수가 있어야 합니다. objectTypeIndication은 MPEG-4가 아닌 스트림을 신호할 수 있으며 이 문서에 정의된 RTP 페이로드 형식은 MPEG-4에 의해 정의되지 않은 스트림을 전달하는 데 적합하지 않을 수 있습니다. objectType 매개변수는 이 페이로드 형식으로 전달할 수 없는 스트림을 신호하는 값으로 설정되어서는 안 됩니다.\(MUST, SHOULD NOT\)

상수크기:

- 이 스트림에 대한 각 액세스 단위의 일정한 크기\(옥텟\)입니다. ConstantSize 및 sizeLength 매개변수는 동시에 존재해서는 안 됩니다.\(MUST NOT\)

상수기간:

- RTP 타임스탬프와 동일한 단위로 측정된 이 스트림에 대한 각 액세스 단위의 일정한 기간입니다.

최대 변위:

- 섹션 3.2.3.3에 정의된 대로 인터리브된 AU의 시간에 따른 최대 변위를 십진수로 표현한 것으로 RTP 타임스탬프 시계 단위로 표시됩니다.

- 이 매개변수는 인터리빙이 적용될 때 존재해야 합니다.\(MUST\)

디인터리브버퍼 크기:

- 섹션 3.2.3.3에 설명된 디인터리브 버퍼 크기를 옥텟 수로 표현한 십진수입니다. 인터리빙 시, 3.2.3.3에 주어진 디인터리브 버퍼 크기 계산이 maxDisplacement 및 rate\(max\)에 기반하여 디인터리브 버퍼의 크기를 과소평가하는 경우 이 매개변수가 있어야 합니다. 이 계산이 디인터리브 버퍼의 크기를 과소평가하지 않는 경우 de-interleaveBufferSize 매개변수가 존재해서는 안 됩니다.\(MUST, SHOULD NOT\)

```text
   Optional configuration parameters:
```

크기길이:

- AU 크기 필드가 AU 헤더에서 인코딩되는 비트 수입니다. sizeLength 및 ConstantSize 매개변수는 동시에 존재해서는 안 됩니다.\(MUST NOT\)

색인길이:

- AU-Index가 첫 번째 AU-헤더에서 인코딩되는 비트 수입니다. 기본값 0은 각 첫 번째 AU-헤더에 AU-Index 필드가 없음을 나타냅니다.

인덱스델타길이:

- AU-Index-delta 필드가 첫 번째가 아닌 AU-헤더에서 인코딩되는 비트 수입니다. 기본값 0은 첫 번째가 아닌 각 AU 헤더에 AU-Index-delta 필드가 없음을 나타냅니다.

CTS델타길이:

- CTS-delta 필드가 AU-헤더에서 인코딩되는 비트 수입니다.

DTS델타길이:

- DTS-델타 필드가 AU-헤더에서 인코딩되는 비트 수입니다.

무작위접근표시:

- AU 헤더에 RAP 플래그가 있는지 여부를 나타내는 0 또는 1의 10진수 값입니다. 10진수 값 1은 RAP 플래그가 있음을 나타내고 기본값 0은 RAP 플래그가 없음을 나타냅니다.

streamState표시:

- 스트림 상태 필드가 AU 헤더에서 인코딩되는 비트 수입니다. 이 매개변수는 MPEG-4 시스템 스트림을 전송할 때 존재할 수 있으며 MPEG-4 오디오 및 MPEG-4 비디오 스트림에는 존재하지 않습니다.\(MUST NOT\)

보조데이터크기길이:

- 보조 데이터 크기 필드를 인코딩하는 데 사용되는 비트 수입니다.

애플리케이션은 위에 정의된 매개변수 외에도 더 많은 매개변수를 사용할 수 있습니다. 이름이 충돌하지 않도록 각 추가 매개변수를 IANA에 등록해야 합니다. 각각의 추가 매개변수에는 RFC, MPEG 표준 또는 기타 영구적이고 쉽게 사용할 수 있는 참조 형식의 사양이 수반되어야 합니다\(RFC 2434 \[6\]에 정의된 "사양 필수" 정책\). 수신기는 이러한 추가 매개변수의 존재를 허용해야 하지만 이러한 매개변수는 이 사양을 준수하는 수신기의 디코딩에 영향을 주어서는 안 됩니다.\(MAY, MUST, MUST, MUST NOT\)

인코딩 고려사항: 이 MIME 하위 유형은 RTP 전송용으로만 정의됩니다. 시스템 비트스트림은 MPEG-4 시스템 사양\(ISO/IEC 14496-1\)에 따라 생성되어야 합니다. 비디오 비트스트림은 MPEG-4 시각적 사양\(ISO/IEC 14496-2\)에 따라 생성되어야 합니다. 오디오 비트스트림은 MPEG-4 오디오 사양\(ISO/IEC 14496-3\)에 따라 생성되어야 합니다. RTP 패킷은 RFC 3640에 정의된 RTP 페이로드 형식에 따라 패킷화되어야 합니다.\(MUST, MUST, MUST, MUST\)

보안 고려 사항: RFC 3640의 섹션 5에 정의되어 있습니다.

상호 운용성 고려 사항: MPEG-4는 시각적 개체 코딩을 위한 크고 풍부한 도구 세트를 제공합니다. 표준의 효과적인 구현을 위해 MPEG-4 도구 세트의 하위 세트가 특정 응용 프로그램에서 사용할 수 있도록 제공되었습니다. '프로필'이라고 하는 이러한 하위 집합은 디코더가 구현하는 데 필요한 도구 세트의 크기를 제한합니다. 계산 복잡성을 제한하기 위해 각 프로필에 하나 이상의 '수준'이 설정됩니다. Profile@Level 조합을 사용하면 다음이 가능합니다.

- . 동일한 조합을 구현하는 다른 MPEG-4 장치와의 연동을 유지하면서 필요한 표준의 하위 집합만 구현하는 코덱 빌더

- . MPEG-4 장치가 표준을 준수하는지 확인합니다\('적합성 테스트'\).

스트림은 "profile-level-id" 매개변수에 의해 지정된 MPEG-4 Profile@Level을 준수해야 합니다. 발신자와 수신자 간의 상호 운용성은 MIME 콘텐츠에 "profile-level-id" 매개변수를 지정하여 달성됩니다. 능력 교환/발표 절차에서 이 매개변수는 상호 동일한 값으로 설정될 수 있다.\(MUST\)

공개 사양: MPEG-4 스트림 사양은 ISO/IEC 14496-1, 14496-2 및 14496-3에 나와 있습니다. RTP 페이로드 형식은 RFC 3640에 설명되어 있습니다.

이 미디어 유형을 사용하는 애플리케이션: 멀티미디어 스트리밍 및 회의 도구.

```text
   Additional information: none

   Magic number(s): none
```

파일 확장자: 없음. 확장명이 .mp4인 파일 형식은 MPEG-4 콘텐츠에 대해 정의되었지만 유일한 목적이 RTP 전송인 이 MIME 유형과 직접적으로 연관되지는 않습니다.

```text
   Macintosh File Type Code(s): none
```

자세한 내용을 문의할 사람 및 이메일 주소: RFC 3640 작성자, IETF 오디오/비디오 전송 작업 그룹.

```text
   Intended usage: COMMON
```

작성자/변경 컨트롤러: RFC 3640, IETF 오디오/비디오 전송 작업 그룹의 작성자입니다.

---
### **4.2.  Registration of Mode Definitions with IANA**

이 사양은 다양한 모드에서 사용될 수 있습니다. 작동 모드는 섹션 4.1에 지정된 초기 값 세트와 함께 "mode" MIME 매개변수를 사용하여 신호됩니다. 섹션 3.3.7에 설명된 대로 언제든지 새 모드를 정의할 수 있습니다. 이름이 충돌하지 않도록 하려면 이러한 모드를 IANA에 등록해야 합니다.\(MUST\)

새로운 모드 등록에는 RFC, MPEG 표준 또는 기타 영구적이고 쉽게 사용할 수 있는 참조 형식의 사양이 수반되어야 합니다\(RFC 2434 \[6\]에 정의된 "사양 필수" 정책\).\(MUST\)

---
### **4.3.  Concatenation of Parameters**

여러 매개변수는 세미콜론으로 구분된 매개변수=값 쌍 목록 형식의 MIME 미디어 유형 문자열로 표현되어야 합니다\(매개변수 사용 예는 섹션 3.3.2\~3.3.6 참조\).\(SHOULD\)

---
### **4.4.  Usage of SDP**
---
#### **4.4.1.  The a=fmtp Keyword**

이 페이로드 형식과 관련된 위에 설명된 매개변수를 전송하는 일반적인 방법 중 하나는 SDP 메시지\[5\]를 통해, 예를 들어 RTSP DESCRIBE\[8\]에 대한 응답으로 클라이언트로 전송되거나 SAP\[11\]를 통해 전송되는 것으로 가정됩니다. 이 경우 RFC 2327 \[5\], 섹션 6에 설명된 대로 \(a=fmtp\) 키워드를 사용해야 하며 구문은 다음과 같습니다.\(MUST\)

```text
   a=fmtp:<format> <parameter name>=<value>[; <parameter name>=<value>]
```

---
## **5.  Security Considerations**

본 사양에 정의된 페이로드 형식을 사용하는 RTP 패킷은 RTP 사양 \[2\]에서 논의된 보안 고려 사항을 따릅니다. 이는 미디어 스트림의 기밀성이 암호화를 통해 달성됨을 의미합니다. 이 페이로드 형식에 사용되는 데이터 압축은 엔드투엔드\(end-to-end\)로 적용되므로 압축된 데이터에 대해 암호화가 수행되므로 두 작업 간에 충돌이 발생하지 않습니다. 이 페이로드 유형의 패킷 처리 복잡성\(즉, 미디어 데이터 처리 제외\)은 서비스 거부 위협을 유발할 만큼 수신자 측에서 심각한 비균일성을 나타내지 않습니다.

그러나 비호환 MPEG 스트림\(오디오, 비디오 및 시스템\)을 주입하여 수신기/디코더의 버퍼가 과부하되어 수신기의 기능이 손상되거나 심지어 충돌할 수도 있습니다. 이는 버퍼 모델이 정확하게 정의되는 MPEG와 같은 엔드투엔드 시스템의 경우 특히 그렇습니다.

MPEG-4 시스템은 OD 명령, BIFS 명령 등과 같이 터미널에서 실행되는 명령과 MPEG-J\(Java\(TM\) 바이트 코드\) 및 MPEG-4 스크립트와 같은 프로그래밍 콘텐츠를 포함한 스트림 유형을 지원합니다. MPEG와 호환되지 않는 방식으로 위의 중 하나 이상을 사용하여 수신기를 충돌시키거나 일시적으로 사용할 수 없게 만드는 것이 가능합니다. MPEG-4 콘텐츠를 전송하는 발신자는 IEC/ISO 14496\[1\]의 규정 준수 부분에 정의된 대로 해당 콘텐츠가 MPEG를 준수하는지 확인해야 합니다. MPEG-4 콘텐츠를 지원하는 수신기는 MPEG 호환 콘텐츠가 아닌 경우 수신기의 오작동을 방지해야 합니다.\(SHOULD\)

인증 메커니즘을 사용하면 발신자와 데이터를 검증하여 비호환 악성 MPEG-4 스트림으로 인한 보안 문제를 방지할 수 있습니다.

ISO/IEC 14496-1에서는 Java\(TM\) 클래스와 객체로 구성된 MPEG-J 액세스 단위를 전달하는 MPEG-4 시스템 스트림에 대한 보안 모델이 정의됩니다. MPEG-J는 일련의 Java API와 보안 실행 모델을 정의합니다. MPEG-J 콘텐츠는 정의된 보안 모델 내의 수신기에서 지원되는 Java 패키지 세트에서 이 API 세트 및 Java\(TM\) 메소드를 호출할 수 있습니다. 이 보안 모델에 따르면 다운로드한 바이트 코드는 라이브러리 로드, 기본 메서드 정의, 프로그램 시작, 파일 읽기 또는 쓰기, 시스템 속성 읽기가 금지됩니다. 수신기는 스트림의 버퍼 요구 사항이나 파라메트릭\(OD, BIFS 등\) 또는 프로그래밍 방식\(MPEG-J, MPEG-4 스크립트\) 명령을 검증하기 위해 지능형 필터를 구현할 수 있습니다. 그러나 이로 인해 복잡성이 크게 증가할 수 있습니다.

MPEG-4 스크립트\(ECMAScript의 하위 집합\)도 구현하는 RTP를 통한 MPEG-4 스트리밍 구현자는 이러한 스크립트의 작업이 해당 스크립트가 상주하는 단일 프리젠테이션의 도메인으로만 제한되도록 해야 합니다\(따라서 세션 간 통신을 허용하지 않음\). 로컬 리소스 및 저장소 등에 대한 액세스\) 네트워크에 위치한 정적 리소스\(예: 미디어\)를 프레젠테이션에 로드하는 것은 허용되어야 하지만, 스크립트에 의한 네트워크 액세스는 그러한\(미디어\) 다운로드로 제한되어야 합니다.\(MUST, MUST\)

---
## **6.  Acknowledgements**

이 문서는 여러 개정을 거쳐 RFC 3640으로 발전했습니다. ISMA 포럼, IETF AVT 실무 그룹 및 MPEG 내 4-on-IP 임시 그룹의 사람들의 기여에 감사드립니다. 저자들은 관련된 모든 사람들, 특히 Andrea Basso, Stephen Casner, M. Reha Civanlar, Carsten Herpel, John Lazaro, Zvi Lifshitz, Young-kwon Lim, Alex MacAulay, Bill May, Colin Perkins, Dorairaj V 및 Stephan Wenger에게 감사의 말씀을 전하고 싶습니다. 여러분의 소중한 의견과 지지를 부탁드립니다.

---
# **APPENDIX: Usage of this Payload Format**
---
# **Appendix A.  Interleave Analysis**
---
## **A.  Examples of Delay Analysis with Interleave**
---
### **A.1.  Introduction**

인터리빙 문제는 이 부록에서 논의됩니다. 디인터리빙 및 오류 은폐에 대한 몇 가지 일반적인 참고 사항이 제공되는 반면, 특히 디인터리브 버퍼의 크기와 시간에 따른 액세스 단위의 최대 변위를 결정하기 위해 여러 인터리빙 패턴이 검사됩니다. 이 예에서는 읽기 쉽도록 액세스 유닛 수를 기준으로 최대 변위를 인용합니다. 실제 스트림에서는 RTP 타임스탬프 클럭 단위로 신호가 전달됩니다.

---
### **A.2.  De-interleaving and Error Concealment**

AU 디코딩 및 오류 은폐 프로세스의 제어는 인터리빙과 거의 관련이 없기 때문에 이 부록에서는 디인터리빙 및 오류 은폐에 대한 세부 정보를 설명하지 않습니다. 디코딩할 다음 AU가 존재하고 디코딩된 AU에 사용할 수 있는 충분한 저장 공간이 있는 경우 즉시 디코딩합니다. 그렇지 않다면 기다리십시오. 디코딩 기한에 도달한 경우\(즉, AU가 제시될 때까지 완료되기 위해 디코딩을 시작해야 하는 시간\) 또는 디코더가 AU의 디코딩 시작 사이에 일정한 지연을 제공하는 일부 하드웨어인 경우 해당 AU를 제시한 다음 해당 마감 시간에 디코딩을 시작해야 합니다.

디코딩 기한에 도달했을 때 디코딩될 다음 AU가 존재하지 않으면 해당 AU는 손실되므로 수신기는 적절하다고 간주되는 모든 오류 은폐 조치를 취해야 합니다. 그 시점에서 플레이아웃 지연을 조정해야 할 수도 있습니다\(특히 최근에 다른 AU도 마감일을 놓친 경우\). 또는 일시적인 지연이었고 지연 시간을 유지하는 것이 중요하다면 수신기는 글리치를 최소화하고 다음 AU로 처리를 계속해야 합니다.

---
### **A.3.  Simple Group Interleave**
---
#### **A.3.1.  Introduction**

일반 인터리브의 예로는 패킷이 그룹으로 구성되는 경우가 있습니다. 인터리브의 '스트라이드'\(인터리빙된 AU 간의 거리\)가 N인 경우 패킷 0에는 AU\(0\), AU\(N\), AU\(2N\) 등이 포함될 수 있습니다. 패킷 1에는 AU\(1\), AU\(1+N\), AU\(1+2N\)이 포함될 수 있습니다.

에. 패킷에 M개의 액세스 단위가 있는 경우 그룹에는 M\*N개의 액세스 단위가 있습니다.

N=M=3의 예는 다음과 같습니다. 이는 섹션 2.5에 제공된 것과 동일한 예이며 액세스 단위당 고정된 시간 기간이 가정됩니다.

```text
   Packet   Time stamp   Carried AUs      AU-Index, AU-Index-delta
   P(0)     T[0]         0, 3, 6          0, 2, 2
   P(1)     T[1]         1, 4, 7          0, 2, 2
   P(2)     T[2]         2, 5, 8          0, 2, 2
   P(3)     T[9]         9,12,15          0, 2, 2
```

이 예에서 AU-Index는 첫 번째 AU-헤더에 존재하며 고정 기간 AU에 필요한 대로 값 0으로 코딩됩니다. 그룹 내 각 패킷의 첫 번째 AU 위치는 RTP 타임 스탬프로 정의되는 반면, AU-Index-delta 필드는 패킷의 첫 번째 AU를 기준으로 후속 AU의 위치를 ​​나타냅니다. 모든 AU-Index-delta 필드는 이 예에서 2와 동일한 N-1 값으로 코딩됩니다. 따라서 RTP 타임스탬프와 AU-Index-delta는 원래 주문을 재구성하는 데 사용됩니다. 섹션 3.2.3.2도 참조하세요.

---
#### **A.3.2.  Determining the De-interleave Buffer Size**

이 예와 같은 정규 패턴의 경우 섹션 3.2.3.3의 그림 6에서는 디인터리브 버퍼가 최대 4개의 AU를 저장한다는 것을 보여줍니다. 동시에 저장된 임의의 4개의 "초기" AU의 총 옥텟 수와 적어도 동일한 de-interleaveBufferSize 값이 신호될 수 있습니다.

---
#### **A.3.3.  Determining the Maximum Displacement**

이 예와 같은 규칙적인 패턴의 경우 섹션 3.3의 그림 7은 시간의 최대 변위가 5 AU 기간과 동일하다는 것을 보여줍니다. 따라서 신호를 보내야 하는 최소 maxDisplacement 값은 5AU 기간입니다. 각 AU의 크기가 동일한 경우 이 maxDisplacement 값은 하나의 AU로 디인터리브 버퍼 크기를 과대평가합니다. 그러나 가변 AU 크기의 경우 동시에 저장해야 하는 4개의 "초기" AU의 총 크기는 maxDisplacement에 최대 비트 전송률을 곱한 값을 초과할 수 있으며, 이 경우 deinterleaveBufferSize를 신호로 보내야 합니다.

---
### **A.4.  More Subtle Group Interleave**
---
#### **A.4.1.  Introduction**

그룹 인터리브를 사용하여 패킷을 형성하는 또 다른 예는 다음과 같습니다. 이 예에서, 두 개의 후속 RTP 패킷의 손실이 두 개의 후속 AU의 손실을 초래하지 않도록 패킷이 형성됩니다. 이 예에서 패킷 3과 패킷 4의 RTP 타임스탬프는 각각 패킷 1과 2의 RTP 타임스탬프보다 빠릅니다. 액세스 단위당 고정된 기간이 가정됩니다.

```text
   Packet   Time stamp   Carried AUs      AU-Index, AU-Index-delta
   0        T[0]         0,  5            0, 4
   1        T[2]         2,  7            0, 4
   2        T[4]         4,  9            0, 4
   3        T[1]         1,  6            0, 4
   4        T[3]         3,  8            0, 4
   5        T[10]       10, 15            0, 4
   and so on ..
```

이 예에서 AU-Index는 첫 번째 AU-헤더에 존재하며 고정된 기간을 가진 AU에 필요한 대로 값 0으로 코딩됩니다. 원래 순서를 재구성하기 위해 RTP 타임스탬프와 AU-Index-delta\(값 4로 코딩됨\)가 사용됩니다. 섹션 3.2.3.2도 참조하세요.

---
#### **A.4.2.  Determining the De-interleave Buffer Size**

도 8로부터, 최대 5개의 "초기" AU가 저장되어야 한다고 결정될 수 있다. AU의 크기가 일정한 경우 이 값은 AU 크기의 5배와 같습니다. 디인터리브 버퍼의 최소 크기는 동시에 저장될 "초기" AU의 최대 총 옥텟 수와 같습니다. 이는 신호를 받을 수 있는 de-interleaveBufferSize의 최소값을 제공합니다.

```text
                              +--+--+--+--+--+--+--+--+--+--+
   Interleaved AUs            | 0| 5| 2| 7| 4| 9| 1| 6| 3| 8|
                              +--+--+--+--+--+--+--+--+--+--+
                                -  -  5  -  5  -  2  7  4  9
                                            7     4  9  5
   "Early" AUs                                    5     6
                                                  7     7
                                                  9     9
```

그림 8: 인터리브된 AU당 디인터리브 버퍼의 "초기" AU 저장.

---
#### **A.4.3.  Determining the Maximum Displacement**

그림 9에서 시간에 따른 최대 변위는 8AU 기간과 동일하다는 것을 알 수 있습니다. 따라서 신호를 보낼 최소 maxDisplacement 값은 8AU 기간입니다.

```text
                                    +--+--+--+--+--+--+--+--+--+--+
   Interleaved AUs                  | 0| 5| 2| 7| 4| 9| 1| 6| 3| 8|
                                    +--+--+--+--+--+--+--+--+--+--+

   Earliest not yet present AU        -  1  1  1  1  1  -  3  -  -
```

그림 9: 인터리빙 패턴의 각 AU에 대해 아직 존재하지 않는 이전 AU 중 가장 빠른 것

각 AU의 크기가 동일한 경우 발견된 maxDisplacement 값은 3개의 AU로 디인터리브 버퍼 크기를 과대평가합니다. 그러나 가변 AU 크기의 경우 동시에 저장된 5개의 "초기" AU의 총 크기는 maxDisplacement에 최대 비트 전송률을 곱한 값을 초과할 수 있으며, 이 경우 de-interleaveBufferSize를 신호로 보내야 합니다.

---
### **A.5.  Continuous Interleave**
---
#### **A.5.1.  Introduction**

연속 인터리브에서는 체계가 '프라이밍'되면 패킷의 AU 수가 '스트라이드'\(그들 사이의 거리\)를 초과합니다. 이는 필요한 버퍼링을 단축하고 데이터 흐름을 원활하게 하며 동일한 인터리브에 대해 약간 더 큰 패킷을 제공하므로 오버헤드가 낮아집니다. 예를 들어, 여기에는 3 AU의 스트라이드에 걸친 연속 인터리브가 있지만 20 AU 실행에 대해 패킷당 4 AU가 있습니다. 이는 계획이 '시작'되는 방식과 종료되는 방식을 모두 보여줍니다. 다시 한 번 예시에서는 액세스 단위당 고정된 시간 기간을 가정합니다.

```text
   Packet   Time-stamp   Carried AUs         AU-Index, AU-Index-delta
   0        T[0]                      0      0
   1        T[1]                  1   4      0  2
   2        T[2]              2   5   8      0  2  2
   3        T[3]          3   6   9  12      0  2  2  2
   4        T[7]          7  10  13  16      0  2  2  2
   5        T[11]        11  14  17  20      0  2  2  2
   6        T[15]        15  18              0  2
   7        T[19]        19                  0
```

이 예에서 AU-Index는 첫 번째 AU-헤더에 존재하며 고정된 기간을 가진 AU에 필요한 대로 값 0으로 코딩됩니다. 원래 주문을 재구성하려면 RTP 타임스탬프와

AU-Index-delta\(값 2로 코딩됨\)가 사용됩니다. 3.2.3.2도 참조하세요. 이 예에는 RTP 타임스탬프가 오름차순으로 표시되어 있습니다.

---
#### **A.5.2.  Determining the De-interleave Buffer Size**

```text
   For this example the de-interleave buffer size can be derived from
   Figure 10.  The maximum number of "early" AUs is 3.  If the AUs are
   of constant size, then the de-interleave buffer size equals 3 times
   the AU size.  Compared to the example in A.2, for constant size AUs
   the de-interleave buffer size is reduced from 4 to 3 times the AU
   size, while maintaining the same 'stride'.
```

```text
                        +--+--+--+--+--+--+--+--+--+--+--+--+--+--+-
   Interleaved AUs      | 0| 1| 4| 2| 5| 8| 3| 6| 9|12| 7|10|13|16|
                        +--+--+--+--+--+--+--+--+--+--+--+--+--+--+-
                          -  -  -  4  -  -  4  8  -  -  8 12  -  -
                                            5           9
   "Early" AUs                              8          12
```

그림 10: 인터리브된 AU당 디인터리브 버퍼의 "초기" AU 저장.

---
#### **A.5.3.  Determining the Maximum Displacement**

이 예에서 최대 변위의 값은 5AU 주기입니다. 그림 11을 참조하십시오. A.2의 예와 비교할 때 최대 변위는 감소하지 않지만 실제로 필요한 디인터리브 버퍼링은 더 적습니다.

```text
                        +--+--+--+--+--+--+--+--+--+--+--+--+--+--+-
   Interleaved AUs      | 0| 1| 4| 2| 5| 8| 3| 6| 9|12| 7|10|13|16|
                        +--+--+--+--+--+--+--+--+--+--+--+--+--+--+-
   Earliest not yet
        present AU        -  -  2  -  3  3  -  -  7  7  -  - 11 11
```

그림 11: 인터리빙 패턴의 각 AU에 대해 아직 존재하지 않는 이전 AU 중 가장 빠른 것

---
# **References**
---
# **Normative References**

\[1\] ISO/IEC 국제 표준 14496\(MPEG-4\); "정보 기술 - 시청각 개체의 코딩", 2000년 1월

\[2\] Schulzrinne, H., Casner, S., Frederick, R. 및 V. Jacobson, "RTP: 실시간 애플리케이션을 위한 전송 프로토콜", RFC 3550, 2003년 7월.

\[3\] Freed, N., Klensin, J. 및 J. Postel, "다목적 인터넷 메일 확장\(MIME\) 4부: 등록 절차", BCP 13, RFC 2048, 1996년 11월.

\[4\] Bradner, S., "요구 사항 수준을 나타 내기 위해 RFC에 사용되는 핵심 단어", BCP 14, RFC 2119, 1997년 3월.

\[5\] Handley, M. 및 V. Jacobson, "SDP: 세션 설명

- 프로토콜", RFC 2327, 1998년 4월.

\[6\] Narten, T. 및 H. Alvestrand, "RFC에서 IANA 고려 사항 섹션 작성 지침", BCP 26, RFC 2434, 1998년 10월.

---
# **Informative References**

\[7\] Hoffman, D., Fernando, G., Goyal, V. 및 M. Civanlar, "MPEG1/MPEG2 비디오용 RTP 페이로드 형식", RFC 2250, 1998년 1월.

\[8\] Schulzrinne, H., Rao, A. 및 R. Lanphier, "실시간 세션 프로토콜\(RTSP\)", RFC 2326, 1998년 4월.

\[9\] Perkins, C. 및 O. Hodson, "스트리밍 미디어 복구 옵션", RFC 2354, 1998년 6월.

\[10\] Schulzrinne, H. 및 J. Rosenberg, "일반 정방향 오류 수정을 위한 RTP 페이로드 형식", RFC 2733, 1999년 12월.

\[11\] Handley, M., Perkins, C. 및 E. Whelan, "세션 발표 프로토콜", RFC 2974, 2000년 10월.

\[12\] Kikuchi, Y., Nomura, T., Fukunaga, S., Matsui, Y. 및 H. Kimata, "MPEG-4 오디오/비주얼 스트림용 RTP 페이로드 형식", RFC 3016, 2000년 11월.

---
# **Authors' Addresses**

```text
   Jan van der Meer
   Philips Electronics
   Prof Holstlaan 4
   Building WAH-1
   5600 JZ Eindhoven
   Netherlands

   EMail: jan.vandermeer@philips.com

   David Mackie
   Apple Computer, Inc.
   One Infinite Loop, MS:302-3KS
   Cupertino  CA 95014

   EMail: dmackie@apple.com

   Viswanathan Swaminathan
   Sun Microsystems Inc.
   2600 Casey Avenue
   Mountain View, CA 94043

   EMail: viswanathan.swaminathan@sun.com

   David Singer
   Apple Computer, Inc.
   One Infinite Loop, MS:302-3MT
   Cupertino  CA 95014

   EMail: singer@apple.com

   Philippe Gentric
   Philips Electronics
   51 rue Carnot
   92156 Suresnes
   France

   EMail: philippe.gentric@philips.com
```

---
# **Full Copyright Statement**

저작권\(C\)인터넷학회\(2003\). 판권 소유.

이 문서와 그 번역본은 복사되어 타인에게 제공될 수 있으며, 이에 대해 설명하거나 설명하거나 구현을 지원하는 파생물은 어떤 종류의 제한 없이 전체적으로 또는 부분적으로 준비, 복사, 출판 및 배포될 수 있습니다. , 단, 위의 저작권 표시와 이 단락은 그러한 모든 사본 및 파생물에 포함됩니다. 그러나 이 문서 자체는 인터넷 표준 개발 목적으로 필요한 경우를 제외하고는 저작권 표시를 제거하거나 Internet Society 또는 기타 인터넷 조직에 대한 참조를 제거하는 등 어떤 식으로든 수정할 수 없습니다. 인터넷 표준 프로세스를 따르거나 영어 이외의 언어로 번역하는 데 필요한 대로 따라야 합니다.

위에 부여된 제한된 권한은 영구적이며 Internet Society나 그 승계자 또는 양수인에 의해 취소되지 않습니다.

이 문서와 여기에 포함된 정보는 "있는 그대로" 제공되며 인터넷 사회 및 인터넷 공학 태스크포스는 여기에 포함된 정보의 사용이 상품성 또는 특정 목적에의 적합성에 대한 권리 또는 묵시적 보증을 침해하는 행위.

---
# **Acknowledgement**

RFC 편집기 기능에 대한 자금은 현재 Internet Society에서 제공하고 있습니다.