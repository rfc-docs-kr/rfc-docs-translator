

```text
Network Working Group                                        P. Ferguson
Request for Comments: 2827                           Cisco Systems, Inc.
Obsoletes: 2267                                                 D. Senie
BCP: 38                                           Amaranth Networks Inc.
Category: Best Current Practice                                 May 2000

                       Network Ingress Filtering:
            Defeating Denial of Service Attacks which employ
                       IP Source Address Spoofing
```

---
# **Status of this Memo**

이 문서는 인터넷 커뮤니티를 위한 인터넷 모범 사례를 명시하고 개선을 위한 토론과 제안을 요청합니다. 이 메모의 배포는 무제한입니다.

---
# **Copyright Notice**

저작권\(C\)인터넷학회\(2000\). 판권 소유.

---
# **Abstract**

최근 위조된 소스 주소를 사용하는 다양한 서비스 거부\(DoS\) 공격이 발생하면서 인터넷 서비스 제공업체와 인터넷 커뮤니티 전반에 골치 아픈 문제가 되고 있는 것으로 나타났습니다. 이 문서에서는 ISP\(인터넷 서비스 제공업체\) 집합 지점 '뒤'에서 전파되는 위조된 IP 주소를 사용하는 DoS 공격을 방지하기 위해 수신 트래픽 필터링을 사용하는 간단하고 효과적이며 간단한 방법에 대해 설명합니다.

---
# **Table of Contents**

```text
    1.  Introduction . . . . . . . . . . . . . . . . . . . . . . .  2
    2.  Background . . . . . . . . . . . . . . . . . . . . . . . .  3
    3.  Restricting forged traffic . . . . . . . . . . . . . . . .  5
    4.  Further capabilities for networking equipment. . . . . . .  6
    5.  Liabilities. . . . . . . . . . . . . . . . . . . . . . . .  6
    6.  Summary. . . . . . . . . . . . . . . . . . . . . . . . . .  7
    7.  Security Considerations. . . . . . . . . . . . . . . . . .  8
    8.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . .  8
    9.  References . . . . . . . . . . . . . . . . . . . . . . . .  8
   10.  Authors' Addresses . . . . . . . . . . . . . . . . . . . .  9
   11.  Full Copyright Statement . . . . . . . . . . . . . . . . . 10
```

---
## **1. Introduction**

인터넷의 다양한 대상을 겨냥한 서비스 거부 공격\[1\]이 다시 발생하면서 ISP\(인터넷 서비스 제공업체\)와 네트워크 보안 커뮤니티 내에서는 이러한 유형의 공격을 완화하기 위한 새롭고 혁신적인 방법을 찾아야 하는 새로운 과제가 생겼습니다. 이 목표를 달성하는 데에는 어려움이 많습니다. 이러한 공격의 효율성과 범위를 제한하기 위한 몇 가지 간단한 도구가 이미 존재하지만 널리 구현되지는 않았습니다.

이 공격 방법은 오랫동안 알려져 왔습니다. 그러나 이에 맞서 방어하는 것은 지속적인 관심사였습니다. Bill Cheswick은 \[2\]에서 공격을 받고 있는 시스템 관리자가 효과적으로 방어할 수 있는 방법이 없었기 때문에 마지막 순간에 자신의 책 "방화벽과 인터넷 보안" \[3\]에서 한 장을 빼냈다고 말했습니다. 체계. 그는 그 방법을 언급함으로써 그 사용을 장려하는 것에 대해 우려했습니다.

이 문서에서 논의된 필터링 방법은 유효한 접두사\(IP 주소\)에서 발생하는 플러딩 공격으로부터 보호하는 데 전혀 도움이 되지 않지만 원래 네트워크 내의 공격자가 일치하지 않는 위조된 소스 주소를 사용하여 이러한 성격의 공격을 시작하는 것을 금지합니다. 필터링 규칙을 수신합니다. 모든 인터넷 연결 제공업체는 공격자가 합법적으로 광고된 접두사 범위 내에 있지 않은 위조된 소스 주소를 사용하는 것을 방지하기 위해 이 문서에 설명된 필터링을 구현해야 합니다. 즉, ISP가 여러 다운스트림 네트워크에 대한 라우팅 알림을 집계하는 경우 이러한 집계된 알림 외부에서 발생했다고 주장하는 트래픽을 금지하기 위해 엄격한 트래픽 필터링을 사용해야 합니다.

이러한 유형의 필터링을 구현하면 공격자가 유효하고 합법적으로 접근할 수 있는 소스 주소를 사용해야 하기 때문에 발신자를 실제 소스로 쉽게 추적할 수 있다는 추가적인 이점이 있습니다.

---
## **2. Background**

TCP SYN 플러딩 문제의 단순화된 다이어그램은 다음과 같습니다.

```text
                                                    204.69.207.0/24
    host <----- router <--- Internet <----- router <-- attacker

             TCP/SYN
         <---------------------------------------------
               Source: 192.168.0.4/32
    SYN/ACK
    no route
             TCP/SYN
         <---------------------------------------------
               Source: 10.0.0.13/32
    SYN/ACK
    no route
             TCP/SYN
         <---------------------------------------------
               Source: 172.16.0.2/32
    SYN/ACK
    no route

    [etc.]

    Assume:
```

o "호스트"는 대상 컴퓨터입니다.

o 공격자는 "유효한" 접두사인 204.69.207.0/24 내에 상주합니다.

o 공격자는 무작위로 변경되는 소스 주소를 사용하여 공격을 시작합니다. 이 예에서 소스 주소는 일반적으로 글로벌 인터넷 라우팅 테이블에 존재하지 않으므로 연결할 수 없는 \[4\] 내에서 표시됩니다. 그러나 연결할 수 없는 접두사를 사용하여 이 공격 방법을 실행할 수 있습니다.

또한 언급할 가치가 있는 것은 소스 주소가 글로벌 라우팅 테이블에 나타나는 다른 합법적인 네트워크 내에서 시작된 것처럼 위조된 경우입니다. 예를 들어, 유효한 네트워크 주소를 사용하는 공격자는 실제로 공격을 시작하지 않았고 완전히 결백한 조직에서 공격이 발생한 것처럼 보이게 하여 큰 피해를 입힐 수 있습니다. 이러한 경우 공격을 받고 있는 시스템의 관리자는 명백한 공격 소스에서 들어오는 모든 트래픽을 필터링하려는 경향이 있을 수 있습니다. 이러한 필터를 추가하면 다음에 대한 서비스 거부가 발생합니다.

합법적이고 적대적이지 않은 최종 시스템. 이 경우 공격을 받고 있는 시스템의 관리자는 자신도 모르게 공격자의 공범자가 됩니다.

더 복잡한 문제는 TCP SYN 플러드 공격으로 인해 SYN-ACK 패킷이 공격에 관여하지 않지만 2차 피해자가 되는 하나 이상의 호스트로 전송된다는 것입니다. 이를 통해 공격자는 동시에 두 개 이상의 시스템을 남용할 수 있습니다.

UDP 및 ICMP 플러딩을 사용하여 유사한 공격이 시도되었습니다. 전자의 공격\(UDP 플러딩\)은 위조된 패킷을 이용해 유료 UDP 서비스를 다른 사이트의 에코 UDP 서비스에 연결하려고 시도합니다. 시스템 관리자는 관리 도메인 외부에서 시스템 진단 포트로 향하는 UDP 패킷이 시스템에 도달하도록 허용해서는 안 됩니다. 후자의 공격\(ICMP 플러딩\)은 IP 서브넷 브로드캐스트 복제 메커니즘의 교활한 기능을 사용합니다. 이 공격은 IP 브로드캐스트 주소\(예: 10.255.255.255로 향하는 주소\)를 레이어 2 브로드캐스트 프레임\(이더넷의 경우 FF:FF:FF:FF:FF: FF\). 이더넷 NIC 하드웨어\(특히 MAC 계층 하드웨어\)는 정상 작동 시 선택된 수의 주소만 수신합니다. 일반 작동 시 모든 장치가 공통적으로 공유하는 하나의 MAC 주소는 미디어 브로드캐스트 또는 FF:FF:FF:FF:FF:FF입니다. 이 경우 장치는 패킷을 가져와 처리를 위해 인터럽트를 보냅니다. 따라서 이러한 브로드캐스트 프레임의 홍수는 최종 시스템에서 사용 가능한 모든 리소스를 소모하게 됩니다\[9\]. 시스템 관리자는 경계 라우터가 기본적으로 라우터를 통해 전달되는 방향성 브로드캐스트 패킷을 허용하지 않도록 하는 것이 현명할 것입니다.

도달할 수 없는 소스 주소를 사용하여 TCP SYN 공격이 시작되면 대상 호스트는 응답을 기다리는 리소스를 예약하려고 시도합니다. 공격자는 새로운 패킷이 전송될 때마다 가짜 소스 주소를 반복적으로 변경하여 추가 호스트 리소스를 소모합니다.

또는 공격자가 다른 사람의 유효한 호스트 주소를 소스 주소로 사용하는 경우 공격을 받는 시스템은 연결 설정 시퀀스의 발신자라고 생각되는 대상에게 대량의 SYN/ACK 패킷을 보냅니다. 이러한 방식으로 공격자는 대상 시스템과 글로벌 라우팅 시스템에서 스푸핑된 주소를 실제로 사용하는 시스템이라는 두 시스템에 손상을 입힙니다.

두 가지 공격 방법의 결과는 성능이 극도로 저하되거나 더 심하면 시스템 충돌이 발생하는 것입니다.

이러한 위협에 대응하여 대부분의 운영 체제 공급업체는 대상 서버가 매우 높은 연결 시도율로 공격을 견딜 수 있도록 소프트웨어를 수정했습니다. 이는 문제 해결을 위해 환영받고 필요한 부분입니다. 수신 필터링을 광범위하게 구현하고 완전히 효과적이려면 시간이 걸리지만 운영 체제 확장은 신속하게 구현할 수 있습니다. 이 조합은 소스 주소 스푸핑에 대해 효과적인 것으로 입증되어야 합니다. 공급업체 및 플랫폼 소프트웨어 업그레이드 정보는 \[1\]을 참조하세요.

---
## **3. Restricting forged traffic**

이러한 유형의 공격으로 인해 발생하는 문제는 다양하며 호스트 소프트웨어 구현, 라우팅 방법론 및 TCP/IP 프로토콜 자체의 단점을 포함합니다. 그러나 다운스트림 네트워크에서 시작되는 전송 트래픽을 알려진 및 의도적으로 광고된 접두사로 제한함으로써 이 공격 시나리오에서 소스 주소 스푸핑 문제를 사실상 제거할 수 있습니다.

```text
                               11.0.0.0/8
                                   /
                               router 1
                                 /
                                /
                               /                       204.69.207.0/24
         ISP <----- ISP <---- ISP <--- ISP <-- router <-- attacker
          A          B         C        D         2
                    /
                   /
                  /
              router 3
                /
            12.0.0.0/8
```

위의 예에서 공격자는 ISP D가 인터넷 연결을 제공하는 204.69.207.0/24 내에 상주합니다. 공격자의 네트워크에 연결을 제공하는 "라우터 2"의 수신\(입력\) 링크에 대한 입력 트래픽 필터는 다음을 제한합니다. 204.69.207.0/24 접두사 내의 소스 주소에서 발생하는 트래픽만 허용하고 공격자가 이 접두사 범위 외부에 있는 "잘못된" 소스 주소를 사용하는 것을 금지합니다.

즉, 위의 "라우터 2"에 대한 수신 필터는 다음을 확인합니다.

```text
    IF    packet's source address from within 204.69.207.0/24
    THEN  forward as appropriate

    IF    packet's source address is anything else
    THEN  deny packet
```

네트워크 관리자는 삭제된 패킷에 대한 정보를 기록해야 합니다. 그러면 의심스러운 활동을 모니터링하기 위한 기반이 제공됩니다.

---
## **4. Further possible capabilities for networking equipment**

향후 플랫폼 구현을 위해서는 추가 기능을 고려해야 합니다. 다음은 주목할 가치가 있습니다.

- 원격 액세스 서버에 대한 자동 필터링 구현. 대부분의 경우 액세스 서버에 전화 접속하는 사용자는 단일 PC의 개별 사용자입니다. 해당 PC에서 발생하는 패킷의 유일한 유효한 소스 IP 주소는 ISP가 할당한 것입니다\(정적으로 또는 동적으로 할당됨\). 원격 액세스 서버는 수신 시 모든 패킷을 검사하여 사용자가 원래 패킷의 소스 주소를 스푸핑하지 않도록 할 수 있습니다. 분명히 고객이 원격 라우터를 통해 네트나 서브넷을 합법적으로 연결하는 경우에 대한 규정도 마련되어야 하지만 이는 확실히 선택적 매개변수로 구현될 수 있습니다. 우리는 일부 공급업체와 일부 ISP가 이미 이 기능을 구현하기 시작했다는 보고를 받았습니다.

우리는 \[8\]에서 제안한 대로 라우터가 발신자의 소스 IP 주소를 검증하도록 제안하는 것을 고려했지만 이 방법은 현재 실제 네트워크에서는 제대로 작동하지 않습니다. 제안된 방법은 소스 주소를 조회하여 해당 주소에 대한 반환 경로가 패킷이 도착한 것과 동일한 인터페이스에서 흘러나오는지 확인하는 것입니다. 인터넷의 비대칭 경로 수로 인해 이는 분명히 문제가 될 수 있습니다.

---
## **5. Liabilities**

이러한 성격의 필터링은 일부 유형의 "특별" 서비스를 중단시킬 가능성이 있습니다. 그러나 이러한 유형의 특수 서비스를 제공하는 ISP에게는 수신 트래픽 필터링의 영향을 받지 않도록 이러한 서비스를 구현하는 대체 방법을 고려하는 것이 가장 좋습니다.

\[6\]에 정의된 모바일 IP는 특히 수신 트래픽 필터링의 영향을 받습니다. 지정된 대로 모바일 노드로의 트래픽은 터널링되지만 모바일 노드의 트래픽은 터널링되지 않습니다. 이로 인해 스테이션이 연결된 네트워크와 일치하지 않는 소스 주소를 가진 모바일 노드의 패킷이 발생합니다. 수신 필터링 및 기타 문제를 수용하기 위해 모바일 IP 워킹 그룹은 \[7\]에 지정된 "역방향 터널"에 대한 방법론을 개발했습니다. 이는 모바일 노드에 의해 전송된 데이터가 인터넷으로 전송되기 전에 홈 에이전트로 터널링되는 방법을 제공합니다. 멀티캐스트 트래픽을 더 잘 처리하는 등 역방향 터널링 방식에는 추가적인 이점이 있습니다. 모바일 IP 시스템을 구현하는 사람들은 이 역방향 터널링 방법을 구현하는 것이 좋습니다.

앞서 언급했듯이 수신 트래픽 필터링은 소스 주소 스푸핑의 성공률을 대폭 감소시키지만 허용된 접두사 필터 범위 내에서 다른 호스트의 위조된 소스 주소를 사용하는 공격자를 배제하지는 않습니다. 그러나 이러한 성격의 공격이 실제로 발생하는 경우 네트워크 관리자는 해당 공격이 실제로 광고 중인 알려진 접두사 내에서 발생하고 있음을 확신할 수 있습니다. 이를 통해 범인 추적이 단순화되고, 최악의 경우 관리자는 문제가 해결될 때까지 다양한 소스 주소를 차단할 수 있습니다.

DHCP 또는 BOOTP를 사용하는 환경에서 수신 필터링을 사용하는 경우 네트워크 관리자는 소스 주소가 0.0.0.0이고 대상이 255.255.255.255인 패킷이 라우터의 릴레이 에이전트에 도달하도록 허용하는 것이 좋습니다. 적절한 경우. 그러나 지시된 방송 복제의 범위는 제어되어야 하며 임의로 전달되어서는 안 됩니다.

---
## **6. Summary**

인터넷에 연결된 네트워크 주변의 수신 트래픽 필터링은 소스 주소 스푸핑 서비스 거부 공격의 효율성을 감소시킵니다. 네트워크 서비스 제공업체와 관리자는 이미 주변 라우터에 이러한 유형의 필터링을 구현하기 시작했으며 모든 서비스 제공업체는 가능한 한 빨리 구현하는 것이 좋습니다. 이 공격 방법을 물리치기 위해 인터넷 커뮤니티 전체를 돕는 것 외에도 서비스 제공업체가 네트워크에 이미 고객 링크에 수신 필터링이 적용되어 있음을 명확하게 입증할 수 있는 경우 서비스 제공업체가 공격 소스를 찾는 데도 도움이 될 수 있습니다.

기업 네트워크 관리자는 기업 네트워크가 이러한 문제의 원인이 되지 않도록 필터링을 구현해야 합니다. 실제로 조직 내에서 필터링을 사용하면 사용자가 시스템을 잘못된 네트워크에 부적절하게 연결하여 문제를 일으키지 않도록 할 수 있습니다.

필터링은 실제로 불만을 품은 직원의 익명 공격을 차단할 수도 있습니다.

자신도 모르게 이러한 성격의 공격이 발생하지 않도록 하는 것은 모든 네트워크 관리자의 책임입니다.

---
## **7. Security Considerations**

이 문서의 주요 목적은 본질적으로 인터넷 커뮤니티 전체의 보안 관행과 인식을 높이는 것입니다. 더 많은 인터넷 공급자와 기업 네트워크 관리자가 수신 필터링을 구현함에 따라 공격자가 위조된 소스 주소를 공격 방법으로 사용할 기회는 크게 줄어들 것입니다. 소스가 "유효"할 가능성이 높을 때 공격 소스 추적이 단순화됩니다. 전체적으로 인터넷의 공격 횟수와 빈도를 줄임으로써 궁극적으로 발생하는 공격을 추적할 수 있는 리소스가 더 많아질 것입니다.

---
## **8. Acknowledgments**

NANOG\(North American Network Operators Group\)\[5\] 그룹은 전체적으로 이러한 문제를 공개적으로 논의하고 가능한 솔루션을 적극적으로 모색한 점에서 특별한 공로를 인정받을 만합니다. 또한 Justin Newton \[Priori Networks\] 및 Steve Bielagus \[IronBridge Networks\]에게도 감사드립니다. 그들의 의견과 기여에 대해.

---
## **9. References**

```text
   [1]  CERT Advisory CA-96.21; TCP SYN Flooding and IP Spoofing
        Attacks; September 24, 1996.

   [2]  B. Ziegler, "Hacker Tangles Panix Web Site", Wall Street
        Journal, 12 September 1996.

   [3]  "Firewalls and Internet Security: Repelling the Wily Hacker";
        William R. Cheswick and Steven M. Bellovin, Addison-Wesley
        Publishing Company, 1994; ISBN 0-201-63357-4.

   [4]  Rekhter, Y., Moskowitz, R., Karrenberg, D., de Groot, G., and E.
        Lear, "Address Allocation for Private Internets", RFC 1918,
        February 1996.

   [5]  The North American Network Operators Group;
        http://www.nanog.org.

   [6]  Perkins, C., "IP Mobility Support", RFC 2002, October 1996.

   [7]  Montenegro, G., "Reverse Tunneling for Mobile IP", RFC 2344, May
        1998.

   [8]  Baker, F., "Requirements for IP Version 4 Routers", RFC 1812,
        June 1995.

   [9]  Thanks to: Craig Huegen; See:
        http://www.quadrunner.com/~chuegen/smurf.txt.
```

---
## **10. Authors' Addresses**

```text
   Paul Ferguson
   Cisco Systems, Inc.
   13625 Dulles Technology Dr.
   Herndon, Virginia  20170 USA

   EMail: ferguson@cisco.com

   Daniel Senie
   Amaranth Networks Inc.
   324 Still River Road
   Bolton, MA 01740 USA

   EMail: dts@senie.com
```

---
## **11.  Full Copyright Statement**

저작권\(C\)인터넷학회\(2000\). 판권 소유.

본 문서와 그 번역본은 다른 사람에게 복사 및 제공될 수 있으며, 본 문서에 대해 논평하거나 설명하거나 구현을 지원하는 파생 저작물은 어떤 종류의 제한 없이 전체 또는 일부를 준비, 복사, 출판 및 배포할 수 있습니다. 단, 위의 저작권 표시와 이 단락은 모든 사본과 파생물에 포함되어 있어야 합니다. 그러나 이 문서 자체는 저작권 표시를 제거하거나 인터넷 협회 또는 기타 인터넷 조직에 대한 참조를 제거하는 등 어떠한 방식으로도 수정할 수 없습니다. 단, 인터넷 표준을 개발할 목적으로 필요한 경우는 제외됩니다. 이 경우 저작권에 대한 절차는 인터넷 표준 프로세스를 따라야 하거나 영어 이외의 언어로 번역하려면 필요한 대로 따라야 합니다.

위에 부여된 제한된 권한은 영구적이며 Internet Society 또는 그 승계자 또는 양수인에 의해 취소되지 않습니다.

이 문서와 여기에 포함된 정보는 "있는 그대로" 제공되며 인터넷 사회와 인터넷 엔지니어링 태스크 포스는 여기에 있는 정보의 사용으로 인해 발생하지 않는 모든 보증을 포함하되 이에 국한되지 않고 명시적이든 묵시적이든 모든 보증을 부인합니다. 특정 목적에 대한 상품성이나 적합성에 대한 권리나 묵시적인 보증을 침해하는 행위.

---
# **Acknowledgement**

RFC 편집 기능을 위한 자금은 현재 Internet Society에서 제공됩니다.