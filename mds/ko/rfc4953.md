

```text
Network Working Group                                          J.  Touch
Request for Comments: 4953                                       USC/ISI
Category: Informational                                        July 2007

                 Defending TCP Against Spoofing Attacks
```

---
# **Status of This Memo**

이 메모는 인터넷 커뮤니티에 대한 정보를 제공합니다. 어떤 종류의 인터넷 표준도 지정하지 않습니다. 이 메모의 배포는 무제한입니다.

---
# **Copyright Notice**

저작권\(C\) IETF 트러스트\(2007\).

---
# **Abstract**

핵심 인터넷 인프라에 대한 잠재적인 공격에 대한 최근 분석에 따르면 위조된 IP 소스 주소\(스푸핑\)와 함께 전송되는 RST\(가짜 재설정\)에 대한 TCP 연결의 취약성이 증가한 것으로 나타났습니다. TCP는 항상 RST 스푸핑 공격에 취약했는데, 이는 RST 시퀀스 번호가 현재 수신 창 내부에 있는지 확인하고 TCP 엔드포인트 및 포트 번호를 난독화함으로써 간접적으로 보호되었습니다. BGP와 같은 예측 가능한 포트 쌍을 통해 또는 웹 서버와 잘 알려진 대규모 캐시 사이의 잘 알려진 엔드포인트 쌍의 경우 연결의 경로 대역폭 지연 곱이 증가하여 수신 창 공간이 충분히 증가했습니다. 경로 제3자가 무차별 공격을 통해 실행 가능한 RST 시퀀스 번호를 생성할 수 있습니다. 공격에 대한 민감성은 대역폭의 제곱에 따라 증가하므로 최근 고속 네트워크에 심각한 취약성을 나타냅니다. 이 문서에서는 이 취약점을 다루고 전송 수준에서 제안된 솔루션과 고유한 문제는 물론 기존 네트워크 수준 솔루션과 배포 가능성에 대해 논의합니다. 이 문서는 스푸핑된 TCP 세그먼트로 인한 취약점에 중점을 두고 있으며 TCP 연결에 대한 관련 ICMP 스푸핑 공격에 대한 논의를 포함합니다.

---
# **Table of Contents**

```text
   1. Introduction ....................................................3
   2. Background ......................................................4
      2.1. Review of TCP Windows ......................................5
      2.2. Recent BGP Attacks Using TCP RSTs ..........................6
      2.3. TCP RST Vulnerability ......................................6
      2.4. What Changed - the Ever-Opening Advertised Receive Window ..7
   3. Proposed Solutions and Mitigations .............................10
      3.1. Transport Layer Solutions .................................10
           3.1.1. TCP MD5 Authentication .............................11
           3.1.2. TCP RST Window Attenuation .........................11
           3.1.3. TCP Timestamp Authentication .......................12
           3.1.4. Other TCP Cookies ..................................13
           3.1.5. Other TCP Considerations ...........................13
           3.1.6. Other Transport Protocol Solutions .................14
      3.2. Network Layer (IP) Solutions ..............................14
           3.2.1. Address Filtering ..................................15
           3.2.2. IPsec ..............................................16
   4. ICMP ...........................................................17
   5. Issues .........................................................18
      5.1. Transport Layer (e.g., TCP) ...............................18
      5.2. Network Layer (IP) ........................................19
      5.3. Application Layer .........................................21
      5.4. Link Layer ................................................21
      5.5. Issues Discussion .........................................21
   6. Security Considerations ........................................22
   7. Conclusions ....................................................23
   8. Acknowledgments ................................................23
   9. Informative References .........................................24
```

---
## **1.  Introduction**

최근 인터넷 인프라 분석을 통해 오프패스 공격자의 RST 스푸핑 기반 공격을 사용하는 코어 라우터 간의 BGP 연결에 대한 새로운 버전의 취약점이 입증되었습니다\[9\]\[10\]\[48\]. 공격 자체는 새로운 것이 아니며 거의 6년 전에 문서화되었습니다\[20\]. 일반적으로 TCP를 사용하는 이러한 연결은 위조된 소스 주소\(스푸핑\)가 있는 경로를 벗어난 타사 재설정\(RST\) 세그먼트에 취약하여 TCP 연결을 종료할 수 있습니다. BGP 라우터는 연결을 다시 시작하는 것부터 다른 라우터에 연결할 수 없다고 판단하여 BGP 경로를 플러시하는 것까지 공격의 영향을 증폭시킬 수 있는 다양한 방식으로 종료된 TCP 연결에 반응합니다\[37\]. 이러한 종류의 공격은 잘 알려진 엔드포인트 간의 장기간 연결을 포함하여 BGP 이외의 다른 프로토콜에 영향을 미칩니다. 인터넷 인프라에 미치는 영향은 상당할 수 있으며\(특히 BGP의 경우\) 즉각적인 주의가 필요합니다.

다른 많은 프로토콜과 마찬가지로 TCP는 이러한 경로를 벗어난 제3자 스푸핑 공격에 취약할 수 있습니다. 이러한 공격은 시스템 수준\(예: 루트\) 액세스와 같이 이전에 권한이 부여된 리소스에 대한 공개 액세스를 지원하는 상용 플랫폼의 증가에 의존합니다. 이러한 액세스가 제공되면 누구나 원하는 헤더가 포함된 패킷을 생성하는 것이 쉽습니다.

이는 이러한 스푸핑된 트래픽을 삭제하기에 충분한 주소 필터링이 부족함과 함께 경로를 벗어난 제3자 스푸핑 공격의 가능성을 높일 수 있습니다\[9\]\[10\]\[48\]. 제안된 솔루션에는 기존 인터넷 네트워크 및 전송 보안의 배포뿐만 아니라 생성된 공격에 대한 취약성을 줄이는 전송 프로토콜 수정도 포함됩니다\[13\]\[15\]\[20\]\[36\]\[46\].

스푸핑을 방지하는 한 가지 방법은 전송 수준이나 네트워크 수준에서 연결 세그먼트의 유효성을 검사하는 것입니다. MD5 확장이 포함된 TCP는 전송 수준에서 이 인증을 제공하고, IPsec은 네트워크 수준에서 인증을 제공합니다\[20\]\[24\]\[27\]. 두 경우 모두 배포 오버헤드가 엄청날 수 있습니다. 예를 들어 웹 서버와 같은 공용 서비스를 다수의 피어로 구성된 적절한 인증 기관으로 구성하는 것이 불가능할 수 있습니다\(인터넷 키 교환 프로토콜을 사용하는 IPsec의 경우\). IKE\)\) 또는 공유 비밀\(공유 비밀 모드의 IPsec 또는 TCP/MD5\). 많은 클라이언트를 외부 지원 없이 신속하게 구성해야 할 수 있기 때문입니다. 대규모 캐시 또는 더 많은 수의 피어가 있는 BGP에 연결되는 공용 웹 서버에 있는 서비스가 이 범주에 속할 수 있습니다.

이 문서의 나머지 부분에서는 최근 공격 시나리오를 자세히 설명하고 TCP/MD5 및 IPsec 기반의 기존 솔루션과 TCP의 RST 처리 \[36\] 수정, 수정을 포함하여 최근 제안된 솔루션을 포함한 다양한 솔루션을 설명하고 비교합니다. TCP의 타임스탬프 처리 \[34\], IPsec 및 TCP/MD5 키잉 수정 \[45\]. 스푸핑된 TCP 콘텐츠를 기반으로 하는 ICMP 패킷의 관련 스푸핑에 대해서도 논의하지만 이 문서에서는 TCP 세그먼트 스푸핑에 중점을 둡니다.

이러한 공격에 대한 설명은 새로운 것이 아닙니다. BGP에서 RST를 사용하는 공격은 1998년부터 알려져 왔으며 이것이 TCP/MD5 \[20\] 개발의 이유였습니다. 최근 공격 시나리오는 2003년 NANOG\(North American Network Operators' Group\) 회의에서 Convery에 의해 처음 문서화되었지만 해당 분석에서는 공격이 성공하려면 전체 시퀀스 공간\(2^32 패킷\)을 처리해야 한다고 가정했습니다.\[10\] . Watson의 보다 자세한 분석을 통해 현재 창의 어느 위치에서나 단일 패킷이 공격에 성공할 수 있다는 사실이 밝혀졌습니다\[48\]. 이 문서에서는 수신 창 크기의 선형 증가와 잠재적 공격 속도의 선형 증가 사이의 결합으로 인해 공격에 대한 민감도가 대역폭의 제곱에 정비례한다는 관찰을 추가하고 최신 제안의 다양성을 비교합니다. , 이러한 공격에 저항하기 위한 TCP 수정, IPsec 사용, TCP/MD5 사용 등이 포함됩니다.

---
## **2.  Background**

BGP에 대한 잠재적인 공격에 대한 최근 분석에서는 오프패스 제3자 스푸핑 공격에 대한 TCP의 취약성 문제가 다시 제기되었습니다\[9\]\[10\]\[48\]. 기존 연결에 영향을 주거나 서버에 부하를 주기 위해 RST, SYN, 심지어 ACK를 보내는 등 다양한 공격이 수년 동안 알려져 왔습니다. 이러한 공격은 종종 외부 지식\(예: 공격할 IP 주소, 대상 포트 번호, 때로는 ISN\(초기 시퀀스 번호\)을 나타냄\)과 최신 컴퓨터 및 네트워크 대역폭을 통해 지원되는 무차별 공격 기능\(예: 모든 항목을 검색하는 등\)을 결합합니다. 소스 포트 또는 전체 창 공간\). 전반적으로 이러한 공격은 네트워크\(예: IPsec\), 전송\(예: SYN 쿠키, TCP/MD5\) 또는 기타 계층에서 특정 형태의 인증을 사용하여 대응됩니다. TCP에는 현재 수신자 창에 대한 세그먼트 시퀀스 번호를 확인할 때 이러한 인증의 약한 형태가 이미 포함되어 있습니다. 특정 긴 연결에 대한 대역폭 지연 곱의 증가로 인해 이러한 유형의 약한 인증이 충분히 약화되어 이에 의존하는 것이 바람직하지 않게 되었습니다.

---
### **2.1.  Review of TCP Windows**

계속하기 전에 TCP 창 알고리즘의 용어와 구성 요소를 검토하는 것이 유용합니다. TCP 연결에는 세 가지 종류의 창이 있습니다\[1\]\[35\]:

- 송신 창\(SND.WND\): 최근 송신 창 크기입니다.

- 수신 창\(RCV.WND\): 최근에 알려진 수신 창 크기입니다.

- 혼잡 창\(CWND\): 왕복 시간에 비행 중일 수 있는 RCV.WND의 양을 제한하는 혼잡 피드백에 의해 결정되는 창입니다.

대부분의 최신 구현에서 TCP 연결의 경우 SND.WND 및 RCV.WND는 해당 송신 및 수신 소켓 버퍼의 크기이며 소켓 버퍼 크기 조정 명령을 사용하여 구성할 수 있습니다.

CWND는 왕복 시간 동안 전송 가능한 데이터의 양을 결정하고, SND.WND는 손실로 인한 재전송 가능성을 위해 발신자가 자신 측에 저장할 데이터의 양을 결정하며, RCV.WND는 수신자의 능력을 결정합니다. 손실을 수용하고 수신된 패킷을 다시 정렬합니다. CWND는 RCV.WND 이상으로 커지지 않습니다.

고대역폭 지연 제품 네트워크는 왕복 시간 동안 전송될 수 있는 만큼의 데이터를 수용할 수 있을 만큼 충분히 큰 CWND가 필요합니다. 그렇지 않으면 성능이 저하됩니다. 따라서 사용자와 다양한 자동 프로그램에서는 RCV.WND를 최소한 대역폭\*지연\(대역폭-지연 곱\) 크기 이상으로 늘리는 것이 좋습니다\[23\]\[38\].

그러나 네트워크의 대역폭-지연 곱이 증가함에 따라 광고된 수신 창의 증가로 인해 이 문서의 나머지 부분에서 볼 수 있듯이 스푸핑 공격에 대한 민감성이 높아질 수 있습니다. 그러나 이는 대역폭-지연 곱이 증가함에 따라 수신 창 크기\(예: 수신 소켓 버퍼 구성 증가를 통해\)가 증가한다고 가정합니다. 그렇지 않은 경우 연결 성능은 저하되지만 스푸핑 공격에 대한 취약성은 대역폭의 제곱이 아닌 선형적으로만 증가합니다\(공격자가 스푸핑된 패킷을 보낼 수 있는 속도\). 증가 여부는 수신 창 자체에 따라 달라지며 혼잡 상태나 전송된 데이터 양과 무관합니다.

---
### **2.2.  Recent BGP Attacks Using TCP RSTs**

BGP는 라우팅 가능성을 추론하기 위해 TCP 연결을 사용하기 때문에 스푸핑 공격에 대한 특별한 취약성을 나타냅니다. 따라서 BGP 피어와의 TCP 연결이 끊어지면 해당 피어에 대한 경로가 플러시될 수 있습니다\[37\].

6년 전까지만 해도 이러한 연결은 비교적 모호한 몇 가지 매개변수로 설명되었기 때문에 공격하기 어려운 것으로 간주되었습니다\[20\]. 대부분의 TCP 연결은 연결 끝점을 제외하고 여러 수준의 난독화로 보호됩니다.

- 두 엔드포인트 주소는 일반적으로 잘 알려져 있지 않습니다. 서버 주소가 광고되지만 클라이언트는 다소 익명입니다.

- 두 포트 번호 모두 일반적으로 잘 알려져 있지 않습니다. 서버는 일반적으로 광고되지만\(서비스를 나타냄\) 클라이언트는 일반적으로 경로를 벗어난 제3자가 충분히 예측할 수 없습니다.

- 유효한 일련 번호 공간이 잘 알려져 있지 않습니다.

- 연결은 상대적으로 수명이 짧고 유효한 시퀀스 공간 변경이므로 위의 정보를 추측하려는 시도\(예: 외부 지식 또는 무차별 대입\)는 유용하지 않을 것입니다.

BGP는 위 기준에 대한 예외를 나타냅니다\(유일한 경우는 아님\). 두 끝점 모두 잘 알려져 있거나 AS 경로의 일부 힌트를 사용하여 추측할 수 있습니다. 대상 포트는 일반적으로 BGP 서비스를 나타내도록 고정되어 있습니다. BGP 라우터에서 사용하는 소스 포트는 때때로 고정되어 방화벽 구성을 활성화하도록 광고됩니다. 수정하지 않더라도 유효한 소스 포트는 약 65,000개에 불과하므로 철저한 공격을 받을 수 있습니다. 연결은 오래 지속되며 앞서 언급했듯이 일부 BGP 구현에서는 연속적인 TCP 연결 실패를 라우팅 실패로 해석하여 해당 라우팅 정보를 삭제합니다. 또한 한때 일부 보호 기능을 제공한다고 생각되었던 유효한 시퀀스 번호 공간은 광고된 수신 창 크기가 증가함에 따라 크게 약화되었습니다.

---
### **2.3.  TCP RST Vulnerability**

TCP에는 타사 스푸핑 세그먼트에 대한 알려진 취약점이 있습니다. SYN 플러딩은 절반만 열린 연결에서 서버 리소스를 소비하여 새 연결을 여는 서버의 기능에 영향을 미칩니다\[4\]\[11\]. ACK 스푸핑으로 인해 연결이 너무 많은 데이터를 너무 빨리 전송하게 되어 네트워크 정체 및 세그먼트 손실이 발생하고 연결 속도가 느려져 크롤링 속도가 느려질 수 있습니다. BGP에 대한 가장 최근의 공격에서 RST로 인해 연결이 끊어졌습니다. 앞서 언급했듯이 일부 BGP는

구현에서는 TCP 연결 종료 또는 일련의 실패를 네트워크 실패로 해석합니다\[37\]. 이로 인해 라우터는 이미 교환된 BGP 라우팅 정보를 삭제하고 진행 중인 교환을 금지하여 공격의 영향을 증폭시킵니다. 결과는 인터넷 전체의 라우팅 경로에 영향을 미칠 수 있습니다.

TCP에 대한 RST의 위험한 영향은 연결의 합법적인 끝점에서 사용되는 경우에도 수년 동안 알려져 왔습니다. TCP RST는 수신자가 모든 연결 상태를 삭제하도록 합니다. 소스가 TIME\_WAIT 상태를 유지할 필요가 없기 때문에 이러한 RST는 주소/포트 쌍의 조기 재사용을 유발하여 잠재적으로 이전 연결의 세그먼트가 TIME\_WAIT 암살이라고 알려진 새 연결의 데이터를 오염시킬 수 있습니다\[8\]. 이 경우 합법적인 소스의 세그먼트 중복으로 인해 암살이 실수로 발생하며 TIME\_WAIT 동안 RST 처리를 차단하여 피할 수 있습니다. 그러나 암살은 서버에 있는 상태를 의도적으로 줄이는 데 유용할 수 있습니다. 이를 위해서는 이러한 위험을 피하기 위해 RST의 소스가 TIME\_WAIT 상태로 들어가고 RST가 TIME\_WAIT 상태에서 차단되지 않아야 합니다\[12\].

RFC 3360 \[14\]에 명시된 대로 소위 '미들박스'라고 불리는 방화벽과 로드 밸런서는 때때로 서버 성능을 최적화하기 위해 전송된 연결을 대신하여 RST를 내보냅니다. 이는 사실상 RST가 선의 또는 유익한 의도로 전송되는 경로 상의 RST 공격입니다. 해당 RFC에 설명된 대로 RST를 사용하면 수많은 위험이 있습니다.

---
### **2.4.  What Changed - the Ever-Opening Advertised Receive Window**

RST는 특히 완전히 검증되지 않은 경우 TCP에 위험을 나타냅니다. 다행히 앞서 언급한 것처럼 경로를 벗어난 제3자가 유효한 RST를 위조\(스푸핑\)하는 것을 어렵게 만드는 여러 가지 난독화 메커니즘이 있습니다. 우리는 이미 일부 프로토콜, 특히 BGP의 경우 엔드포인트 주소와 포트를 모두 쉽게 배울 수 있다는 것을 보여주었습니다. 최종 난독화는 세그먼트 시퀀스 번호입니다.

TCP 세그먼트에는 시퀀스 번호가 포함되어 있어 잘못된 수신자 처리와 중복 감지가 가능합니다. 시퀀스 번호 공간은 혼잡을 관리하는 데에도 사용되며 전송 또는 수신할 다음 바이트의 인덱스를 나타냅니다. RST의 경우 이는 적법한 RST가 송신기 창의 다음 시퀀스 번호를 사용하고 수신기는 수신 RST가 예상 수신 창에 시퀀스 번호를 가지고 있는지 확인하기 때문에 관련이 있습니다. 이러한 처리는 중복된 세그먼트를 제거하고\(RST의 경우 다소 논란의 여지가 있음\) 이전 연결의 일부였던 RST를 삭제하기 위한 것입니다.

TCP는 재정렬 및 ​​혼잡 제어\(32비트 공간 사용\)를 위한 기본 메커니즘과 이 창을 확장하는 보조 메커니즘의 두 가지 창 메커니즘을 사용합니다\[23\]\[35\]. 유효한 광고 수신 창은 이 공간의 약 절반, 즉 \~20억\(2 \* 10^9, 즉 2E9 또는 2U.S. 10억\)을 초과하지 않는 일부입니다. 일반적인 구성에서 대부분의 TCP 연결은 이 공간의 아주 작은 부분\(예: 10,000-60,000\(약 5-100개 세그먼트\)\)에 열려 있습니다. 이는 알려진 수신 창이 일반적으로 수신 소켓 버퍼 크기와 일치하기 때문입니다. 이 버퍼는 수동으로 또는 자동 외부 수단을 통해 연결 요구 사항에 맞게 조정하는 것이 좋습니다\[38\].

저손실 경로에서 광고된 수신 창은 버퍼링 지연\(1 패킷/홉으로 가정\)을 포함하여 경로 대역폭-지연 곱과 일치하도록 구성되어야 합니다\[38\]. 인터넷의 많은 경로는 1Mbps 미만의 종단 간 대역폭, 100ms 미만의 지연 시간, 15홉 미만의 홉을 가지므로 위와 같이 상당히 작은 광고 수신 창\(35,000바이트 미만\)이 발생합니다. 이러한 조건에서 초기 시퀀스 번호가 적절하게\(의사 무작위로\) 선택되었다고 가정하면 유효한 추측 시퀀스 번호는 광고된 수신 창 내에 포함될 확률이 57,000분의 1입니다. 다르게 말하면, 블라인드\(즉, 경로를 벗어난\) 공격자가 연결을 성공적으로 재설정하려면 한 번의 왕복 시간 내에 적절한 간격의 시퀀스 번호 추측과 함께 57,000개의 RST를 보내야 합니다. 1Mbps에서는 57,000\(40바이트\) RST를 전송하는 데 20초밖에 걸리지 않지만 이는 두 IP 주소와 두 포트가 모두 알려져 있다고 가정합니다. 소스 포트에 대한 지식이 없으면 오프패스 스푸퍼는 최소한 49152-65535의 전체 범위 또는 16,384개의 다른 포트를 시도해야 하므로 공격에 91시간 이상이 소요됩니다. 대부분의 TCP 연결은 상대적으로 수명이 짧기 때문에 추가 포트 무작위화가 권장될 수 있지만 소스 포트의 중간 정도의 변화도 이러한 환경에 충분합니다\[29\].

최근 10Gbps 이상의 높은 대역폭 경로를 사용하면 125MB를 초과하는 대역폭 지연 제품이 발생합니다. 이는 TCP의 전체 최대 광고 수신 창 크기\(즉, 수신 소켓 버퍼가 최대한 증가한다고 가정\)의 약 1/10입니다. 수신기가 충분한 버퍼링을 할당한다고 가정합니다\(섹션 2에서 설명한 대로\). 10배 느린 네트워크\(1Gbps\)에서도 활성 광고 수신 창은 전체 창 크기의 1/100을 차지합니다. 이러한 속도에서는 유효한 시퀀스 번호를 정확하게 추측하고 연결을 끊는 데 10\~100개의 패킷, 즉 32마이크로초 미만이 소요됩니다. 보다 일반적인 100ms 지연 시간을 가정할 때 다양한 회선 속도에 대해 다양한 양의 RST에 대한 해당 노출 표가 아래에 나와 있습니다\(BGP의 경우 100ms도 크지만\).

```text
          BW       BW*delay     RSTs needed     Time needed
      ------------------------------------------------------------
       10 Gbps   125       MB          35     1 us (microsecond)
        1 Gbps    12.5     MB         344   110 us
      100 Mbps     1.25    MB       3,436    10 ms (millisecond)
       10 Mbps     0.125   MB      34,360     1 second
        1 Mbps     0.0125  MB     343,598     2 minutes
      100 Kbps     0.00125 MB   3,435,974     3 hours

                Figure 1: Time needed to kill a connection
```

이 표는 취약점에 대한 대역폭의 영향이 제곱되었음을 보여줍니다. 대역폭이 증가할 때마다 필요한 시퀀스 번호 추측 수가 선형적으로 감소할 뿐만 아니라 일련의 추측을 전송하는 데 필요한 시간도 선형적으로 감소합니다. 특히, 라우터 간 링크 대역폭이 1Mbps에 가까워질수록 '철저한' 공격이 현실화됩니다. RST 시퀀스 번호가 전체 최대 수신 창\(2^32\)을 벗어나 알려진 수신 창 어딘가에 있는지 확인하는 것은 불충분한 난독화입니다.

이 표에서는 다음과 같은 여러 가지 가정을 하고 있습니다.

1. 전체 대역폭-지연 곱은 상대적으로 고정되어 있습니다.

1. 트래픽 손실은 미미합니다\(대부분의 연결 기간 동안 혼잡 기간에 영향을 미치기에는 불충분함\).

1. 광고된 수신 창은 전체 최대 수신 창 크기의 큰 부분입니다. 예를 들어 수신 소켓 버퍼가 큰 대역폭 지연 제품과 일치하도록 설정되어 있기 때문입니다.

1. 공격 대역폭은 종단 간 경로 대역폭과 유사합니다.

이러한 가정 중 마지막 두 가지 가정이 더 주목할 만합니다. 수신 소켓 버퍼 문제는 섹션 2에서 논의되었습니다. 그림 1은 광고된 대규모 수신 창을 기반으로 공격이 성공하기까지의 시간을 요약했지만 현재 많은 상업용 라우터는 대형 장치의 경우 128KB, 중간 규모의 경우 32KB, 그리고 작은 장치의 경우 32KB로 제한됩니다. 적당한 크기의 경우 4KB입니다. 그림 2는 100ms 지연 시간 동안 BGP 세션에 대한 공격을 수행하는 데 필요한 시간과 대역폭을 보여줍니다. 단거리 네트워크 대기 시간\(10ms\)의 경우에도 이러한 세션은 짧은 시간\(분에서 몇 시간\) 동안 여전히 공격을 받을 수 있습니다.

```text
                   Receive
          BW     Buffer Size  RSTs needed     Time needed
      ------------------------------------------------------------
       10 Mbps     0.128 MB        33,555     1 second
        3 Mbps     0.032 MB       134,218    40 seconds
      300 Kbps     0.004 MB     1,073,742     1 hour

      Figure 2: Time needed to kill a connection with limited buffers
```

공격 대역폭 문제는 다음과 같이 합리적이라고 간주됩니다.

1. RST는 데이터보다 전송하기가 훨씬 쉽습니다. 미리 계산할 수 있으며 데이터 패킷\(40바이트\)보다 작습니다.

1. 취약한 연결은 다소 덜 유비쿼터스적인 고대역폭 경로를 사용하지만 공격이 분산될 수 있으며 이 시점에서는 공격의 수신 링크만이 주요 제한 사항입니다.

1. 위 표의 목적에 따라 공격 시 수신은 근사치로 경로와 동일한 대역폭을 갖는다고 가정합니다.

이전 섹션에서는 RST 스푸핑 공격에 대한 TCP의 취약성으로 인해 BGP에 대한 최근 공격의 특성에 대해 논의했습니다. 이는 주로 단일 장기 연결에 사용되는 TCP 광고 수신 창 공간의 비율이 최근 증가했기 때문입니다.

---
## **3.  Proposed Solutions and Mitigations**

TCP는 현재 주소와 포트 쌍 번호를 사용하여 수신된 RST를 인증하고 시퀀스 번호가 유효한 수신자 창 내에 있는지 확인합니다. 이전 섹션에서는 수신 창 크기의 증가로 인해 TCP가 RST 스푸핑 공격에 어떻게 더 취약해졌는지를 보여주었습니다. 이 취약점에 대해 현재 제안된 솔루션이 많이 있으며, 모두 수신된 RST가 합법적이라는 증거를 제공하려고 시도합니다.

---
### **3.1.  Transport Layer Solutions**

전송 계층은 세그먼트가 연결 관리에 영향을 미치기 전에 세그먼트가 인증될 수 있는 마지막 위치를 나타냅니다. TCP에는 세그먼트 인증을 강화하여 오프패스 및 온패스 제3자 스푸핑 공격으로부터 보호하기 위한 다양한 현재 및 제안된 메커니즘이 있습니다. SCTP 및 DCCP와 같은 다른 전송 프로토콜에도 스푸핑 방지 메커니즘이 제한되어 있습니다.

---
#### **3.1.1.  TCP MD5 Authentication**

MD5 인증을 지원하는 TCP 확장은 BGP 연결을 인증하기 위해 특별히 1998년에 개발되었습니다\(모든 TCP 연결에 사용할 수 있음\)\[20\]. 확장은 미리 공유된 비밀 키를 사용하여 데이터, TCP 헤더 및 TCP 의사 헤더\(IP 헤더의 특정 필드\)를 포함한 전체 TCP 세그먼트를 인증합니다. RST를 포함한 모든 세그먼트는 서명이 일치하는 경우에만 허용되도록 보호됩니다. 이 옵션은 인터넷 라우터에 널리 배포되어 있지만 사전 공유 키가 필요하기 때문에 널리 사용하기에는 배포할 수 없는 것으로 간주됩니다\[3\]\[30\]. 또한 MD5 \[43\]\[44\]의 오버헤드로 인해 호스트나 라우터에 대해 계산 비용이 많이 드는 것으로 간주됩니다.

최근 충돌 기반 공격으로 인해 MD5 사용에 대한 우려도 있다\[22\]. SHA-1에도 비슷한 우려가 있으며, IETF는 현재 이러한 공격이 TCP/MD5 및 IPsec 제품군 모두에서 이러한 해시 사용에 대한 권장 사항에 어떤 영향을 미치는지 평가하고 있습니다. 이 논의의 목적을 위해 두 프로토콜 제품군에 사용되는 특정 알고리즘은 초점이 아니며 TCP/MD5가 보다 일반적인 TCP 보안 옵션으로 발전할 수 있도록 하는 작업이 진행 중입니다\[6\]\[47\].

---
#### **3.1.2.  TCP RST Window Attenuation**

최근 제안에서는 예상되는 다음 시퀀스 번호와 일치하도록 수신된 RST를 추가로 제한하기 위해 TCP를 확장합니다\[36\]. 이는 가짜 RST에 대한 TCP의 저항을 복원하여 RST의 수신 창을 단일 숫자로 효과적으로 제한합니다. 결과적으로 공격자는 시퀀스 번호를 무차별 추측하기 위해 2^32개의 다른 패킷을 보내야 합니다\(최악의 경우 평균은 그 절반이 됩니다\). 이로 인해 TCP의 공격 취약성은 수신 창\(RCV.WND\)의 크기와 무관하게 됩니다. 확장은 길이가 0인 ACK를 전송하여 번호가 잘못된 RST에 반응하도록 RST 수신기를 추가로 수정합니다. RST 소스가 합법적인 경우 ACK를 수신하면 폐쇄 소스는 아마도 ACK와 일치하는 시퀀스 번호가 있는 RST를 내보내 의도된 수신자를 올바르게 재설정할 것입니다. 이 수정은 TCP의 제어 처리를 변경하여 복잡성을 추가하고 잠재적으로 정확성에 영향을 미칩니다\(TCP 제어 처리와 완전히 직교하는 MD5 서명을 추가하는 것과는 대조적\). 예를 들어, RST가 TIME-WAIT\(앞서 언급한 대로\)를 플러시하기 때문에 동일한 끝점 쌍 사이에 서로 다른 연결의 RST 간에 문제가 발생할 수 있습니다. 또한 이 제안은 TCP를 수정하여 어떤 상황에서는 RST가 일반적으로 허용되는 관행을 위반하여 응답\(ACK\)을 유발하도록 합니다. 이는 온화한 권장 사항은 아니지만 생략할 수 있으므로 시간 제한이 충분할 수 있습니다. 이 제안의 장점은 점진적으로 배포할 수 있고 해당 엔드포인트에 이점이 있다는 것입니다.

배포되었습니다. 이 제안의 또 다른 장점은 여기에 설명된 창 감쇠가 수신 창의 크기와 관계없이 스푸핑된 RST 패킷에 대한 취약성을 만든다는 것입니다.

이 제안의 변형은 실행 가능한 RST의 창을 약화시키기 위해 다른 값을 사용합니다. RST는 다음 예상 시퀀스 번호가 아닌 초기 시퀀스 번호, 즉 연결 설정 시 협상된 값을 전달해야 합니다\[42\]\[49\]. 이 제안은 명시적으로 협상된 값을 사용한다는 이점이 있지만 수정되지 않은 끝점의 동작을 현재 유효한 RST로 변경하는 비용이 듭니다. 따라서 추가 메커니즘 없이는 점진적으로 배포하기가 더 어려울 것입니다.

이 제안의 또 다른 변형은 RST의 유효 범위를 줄이는 것, 즉 시퀀스 공간을 32비트에서 64비트로 늘리는 대신 TCP의 창 공간을 늘리는 것입니다. 이는 동일한 효과를 갖습니다. 전체 시퀀스 번호 공간에 대한 모든 세그먼트의 유효한 시퀀스 번호 비율이 크게 줄어듭니다. ISN\(초기 시퀀스 번호\)을 사용하여 약한 인증을 설정하는 현재 방식과 마찬가지로 더 큰 공간을 사용하려면 ISN에 대해 적절하게 임의의 값을 사용해야 합니다. 이러한 임의성은 사양과 구현 모두에서 TCP에 추가적인 복잡성을 추가하고 매우 약한 인증만을 제공합니다. 이러한 수정은 확실히 이전 버전과 호환되지 않으므로 배포하기가 어렵습니다.

TCP의 창 공간을 늘리는 반대 변형은 수신 창\(RCV.WND\)을 명시적으로 줄이는 것입니다. 이는 임의의 시퀀스 번호를 사용하여 스푸핑된 RST의 효율성을 더욱 감소시킵니다. 이 대안은 알려진 수신 창이 연결의 대역폭-지연 곱보다 작은 경우 연결 처리량을 줄일 수 있습니다.

---
#### **3.1.3.  TCP Timestamp Authentication**

TCP 세그먼트를 인증하는 또 다른 방법은 타임스탬프 옵션을 통해 값을 일종의 인증으로 사용하는 것입니다\[34\]. 이를 위해서는 수신자 TCP가 타임스탬프가 허용 창 외부에 있는 세그먼트를 폐기해야 하며, 이는 동일한 연결의 다른 패킷의 타임스탬프에서 파생됩니다. 이 기술은 기존 TCP 옵션을 사용하지만 수정된 TCP 제어 처리도 필요하며\(동일한 주의 사항\) 추가 수정 없이는 점진적으로 배포하기 어려울 수 있습니다. 또한 타임스탬프 값은 호스트의 실제 시간을 나타낸다고 가정하거나 관련 없는 양성 트래픽을 사용하여 호스트를 검색하여 예측 가능하게 파생될 수 있으므로 추측하기가 더 쉬울 수 있습니다.

---
#### **3.1.4.  Other TCP Cookies**

위의 모든 기술은 쿠키의 변형입니다. 그렇지 않으면 패킷의 유효성을 검사하는 데 값이 사용되는 의미 없는 데이터입니다. MD5 체크섬의 경우 쿠키는 공유 비밀을 기반으로 계산됩니다. 서명조차도 추측할 수 있으며 공격 가능성은 2^\(서명 길이\)에 1입니다. 주요 차이점은 MD5 서명이 패킷 데이터에 의존하고 따라서 반복되지 않기 때문에 경로상의 스누핑을 기반으로 예측할 수 없는 사실상 일회성 쿠키라는 것입니다. 창 감쇠 시퀀스 번호는 기존 연결의 현재 패킷 시퀀스 번호를 스누핑하여 추측할 수 있으며, 타임스탬프는 별도의 양성 연결을 사용하거나 대략 현지 시간과 상관 관계가 있다고 가정하여 훨씬 덜 직접적으로 추측할 수 있습니다. 이러한 쿠키 변형은 정신적으로 TCP SYN 쿠키와 유사하며, \(MD5를 제외하면 상당히 약한\) 인증 형식을 기반으로 경로를 벗어난 제3자 스푸핑 공격에 대한 취약점을 다시 패치합니다. 또 다른 형태의 쿠키는 소스 포트 자체로, 무작위로 지정될 수 있지만 16비트의 보호\(65,000개 조합\)만 제공하므로 철저한 공격을 받을 수 있습니다. 이는 대상 포트 무작위화와도 결합될 수 있지만 별도의 조정 메커니즘이 필요하므로\(양 당사자가 사용할 포트를 알 수 있도록\) 이는 공유 비밀을 교환하는 것과 동일하며 대규모 배포에는 실행 불가능합니다. 39\].

---
#### **3.1.5.  Other TCP Considerations**

위의 RST 스푸핑 가능성에 대한 분석에서는 광고된 수신 창이 종단간 경로의 대역폭-지연 곱이 제안하는 최대 범위까지 열려 있고 창이 전체 창의 상당한 부분까지 열려 있다고 가정합니다. 시퀀스 번호 공간. 앞서 언급했듯이 대부분의 일반적인 경우 연결이 너무 짧거나 대역폭이 너무 낮아서 큰 창이 유용하지 않습니다. TCP의 시퀀스 번호 공간을 확장하는 것은 새로운 대역폭을 통한 긴 연결의 경우에도 이러한 취약점을 추가로 방지할 수 있는 직접적인 방법입니다. 수동 조정 또는 알려진 수신 창의 자동 조정\(수신 버퍼 조정을 통해\)이 제공되지 않는 경우 이는 문제가 되지 않습니다\(연결 성능이 저하되더라도\)\[38\].

엔드포인트가 의도적으로 작게 남겨두어 광고된 수신 창을 제한하는 것만으로도 충분할 수 있습니다. 수신 소켓 버퍼가 제한되는 경우\(예: 유비쿼터스 기본값인 64KB\), 광고된 수신 창은 매우 높은 대역폭을 통한 매우 긴 연결의 경우에도 취약하지 않습니다. 취약점은 네트워크 속도가 증가함에 따라 선형적으로 증가하지만 정사각형으로 증가하지는 않습니다. 결과적으로 RTT\(왕복 시간\)당 하나의 창에 해당하는 데이터만 교환되는 지속 처리량이 낮아집니다.

이렇게 하면 연결이 더 오랫동안 열려 있게 됩니다. 지속적으로 소스 데이터를 사용하는 장기간 연결의 경우 대상이 드물고 느리게 움직이는 경우에도 계속 공격 기회가 될 수 있습니다. 인터넷 라우터 간에 BGP 데이터가 교환되는 가장 최근의 경우 데이터가 폭주하고 총 트래픽이 작을 수 있습니다\(즉, 수명이 길더라도 시퀀스 공간의 상당 부분을 차지할 가능성이 낮음\). 경우에 따라 수신 창\(작은 수신기 버퍼를 통해\)은 즉각적인 문제를 충분히 해결할 수 있습니다. 이는 더 작은 버퍼로 인해 감소된 대역폭으로 라우팅 테이블이 충분히 빠르게 교환될 수 있거나 아마도 광고된 수신 창이 대규모 버스트 교환 중에만 열린다고 가정합니다\(예: 두 라우터 간의 다른 신호 또는 시간을 통해\). 기반 신호\(둘 중 하나는 비표준임\).

---
#### **3.1.6.  Other Transport Protocol Solutions**

세그먼트 인증은 다른 프로토콜의 전송 계층에서 해결되었습니다. SCTP와 DCCP 모두 연결 설정을 위한 쿠키를 포함하고 있으며 이를 사용하여 다양한 기타 제어 메시지를 인증합니다\[28\]\[41\]. 전송 프로토콜에 이러한 메커니즘을 포함시키는 것은 비록 표준 관행으로 떠오르고 있지만 새로운 프로토콜의 설계와 구현을 복잡하게 만듭니다\[32\]. 새로운 공격\(SYN 플러드, RST 등\)이 발견되면 이를 보완하기 위해 각 프로토콜을 개별적으로 수정해야 합니다. 네트워크 솔루션이 더 적절하고 효율적일 수 있습니다.

무차별 공격에 의존하는 RST 공격은 침입 탐지 소프트웨어가 TCP 계층에서 탐지하기가 상대적으로 쉽다는 점에 유의해야 합니다. 다수의 유효하지 않은\(창 외부\) RST를 수신하는 모든 연결은 이러한 공격을 방지하기 위해 후속 RST를 차단할 수 있습니다. 이는 해당 연결에 대한 합법적인 RST를 차단하는 부작용을 가져오며, 이는 엔드포인트 피어 간의 전송 상태 정리를 방해할 수 있습니다. 증가된 모니터링 부하와 결합된 이러한 부작용으로 인해 이러한 솔루션은 일반적인 경우 바람직하지 않을 수 있지만 라우터용 BGP와 같은 특수한 경우에는 유용하게 적용될 수 있습니다.

---
### **3.2.  Network Layer (IP) Solutions**

스푸핑에 대한 네트워크 계층 솔루션에는 주소 필터링과 IPsec라는 두 가지 주요 변형이 있습니다. 주소 필터링은 공격의 업스트림으로 전송된 패킷을 필터링하기 위해 다른 당사자에 의존하는 간접 시스템이지만 패킷 소스의 참여가 반드시 필요한 것은 아닙니다. IPsec을 사용하려면 연결에 대한 공격을 피하려는 엔드포인트 간의 협력이 필요합니다. 여기에는 현재 공유 키 또는 공유 인증 기관에 대한 기존 공유 지식이 포함됩니다.

---
#### **3.2.1.  Address Filtering**

주소 필터링은 IP 소스 주소 스푸핑을 방지하기 위한 프로토콜 메커니즘의 대안으로 종종 제안됩니다\[2\]\[13\]. 주소 필터링은 IP 소스 주소를 기반으로 전송 네트워크 전체에서 다운스트림 소스의 트래픽을 제한합니다. 공격 메시지가 성공하려면 소켓 쌍과 일치해야 하기 때문에 일종의 필터링이 연결 끝점에서 이미 발생합니다. 다시 한번 말씀드리지만, 이러한 공격은 전체 소켓 쌍을 알아야 하며 특별한 경우를 제외하고는 거의 발생하지 않습니다. 이 섹션에서는 일반적으로 AS 경계에서 수행되는 주소만을 기반으로 한 필터링에 대해 설명합니다.

또한 에지 쪽으로 더 멀리 시작되어야 하는 트래픽을 거부하도록 코어-에지 경로를 제한할 수도 있습니다. 코어를 통한 필터링이 부족한 에지에서 특정 에지로의 트래픽을 제한할 수는 없습니다. 결과적으로 각 경계 라우터는 전체적인 보호를 위해 적절한 필터링을 수행해야 합니다. 국경 라우터가 필터링하지 못하면 국경 내부의 모든 참가자는 물론 외부 참가자도 보호할 수 없게 됩니다. 국경에서의 주소 필터링은 내부 주소만 국경 내부에서 시작되어야 하기 때문에 국경 내부의 사람들을 일종의 스푸핑, 즉 국경 내부 사람들 간의 연결로부터 보호할 수 있습니다. 그러나 트래픽이 들어오는 위치를 제한하는 것\(예: 한 AS에서는 예상하고 다른 AS에서는 예상하지 않는 경우\)을 제외하고는 경계 외부의 끝점\(예: AS 경계를 통과하는 끝점\)을 포함한 연결을 보호할 수 없습니다.

결과적으로 주소 필터링은 통신 쌍을 보호하기 위해 배포할 수 있는 로컬 솔루션이 아니라 네트워크에 진입하는 위조 트래픽을 필터링하는 신뢰할 수 있는 게이트웨이의 분산 인프라에 의존합니다. 로컬 증분 배포에는 적합하지 않지만 일부 시나리오에서는 보호된 경계 내부 연결에 적용될 수 있습니다. 필터링을 적용하면 스푸핑된 트래픽의 네트워크 부하를 줄이는 데에도 유용할 수 있습니다\[31\].

주소 필터링의 최신 변형은 연결의 다른 쪽 끝에서 설정된 TTL에 의존하여 IP TTL\(Time to Live\) 필드를 확인합니다\[15\]. 이 기술은 BGP에 대한 필터링을 제공하는 데 사용되었습니다. 연결 소스 TTL이 255로 설정되어 있다고 가정합니다. 수신기의 패킷은 TTL=255인지 확인하고 다른 패킷은 삭제됩니다. 이는 트래픽을 수신기의 한 홉 업스트림\(예: BGP 라우터\)으로 제한하지만 해당 홉에는 해당 노드의 다른 사용자 프로그램\(예: BGP 라우터의 피어\) 또는 해당 노드가 터널을 통해 허용하는 모든 트래픽이 포함될 수 있습니다. 특히 "Bump in the Wire"\(BITW\) 또는 BITW와 동등한 시나리오 \[33\]의 경우 TTL을 감소시키지 않습니다\(\[15\] 및 \[16\]의 섹션 5.1 참조\). TTL 필터링은 터널 반대쪽 끝의 모든 트래픽을 신뢰할 수 있는 경우에만 작동합니다.

즉, 스푸핑된 트래픽을 시작하거나 전송하지 않는 경우입니다. 링크 또는 네트워크 보안 대신 TTL을 사용하면 다른 트래픽이 링크로 스푸핑될 수 없는 변조되지 않은 지점 간 링크가 가정됩니다.

이 필터링 방법은 트래픽이 한 홉 떨어진 곳에서 시작되는 경우에 가장 잘 작동하므로 주소 필터링은 직접 연결된\(터널링 또는 기타\) 노드의 신뢰를 기반으로 합니다. 기존 주소 필터링과 마찬가지로 이는 일반적으로 스푸핑 트래픽을 줄이지만 분산 필터링\(예: 업스트림 노드가 터널을 임의로 종료하지 않는다는 사실\)에 의존하기 때문에 신뢰할 수 있는 보안 메커니즘으로 간주되지 않습니다.

---
#### **3.2.2.  IPsec**

TCP는 RST에 취약할 뿐만 아니라 SYN 공격을 포함한 기타 오프패스\(off-path\) 및 온패스\(on-path\) 스푸핑 공격에도 취약합니다. UDP 및 RTP와 같은 다른 전송 프로토콜도 마찬가지로 취약합니다. 새로운 전송 프로토콜은 전송 계층에서 이러한 공격을 방어하려고 시도하지만 이러한 공격은 네트워크 계층 ID 스푸핑을 활용합니다. 패킷은 업스트림이나 인터넷의 다른 위치에서 다른 끝점을 스푸핑하는 끝점에서 나옵니다. IPsec은 이 보안 취약점을 가장 직접적이고 명시적으로 해결하기 위해 패킷의 소스와 내용에 대한 인증을 설정하고 시행하도록 특별히 설계되었습니다.

IPsec의 더 큰 문제는 키 배포 및 사용 문제입니다. IPsec은 번거로운 경우가 많으며 최근에야 많은 최종 시스템 운영 체제에서 지원되었습니다. 더 중요한 것은 사전 공유 키, 서명된 X.509 인증서 또는 신뢰할 수 있는 제3자\(예: Kerberos\) 키 인프라를 사용하여 키 정보를 설정하고 교환합니다\(예: IKE를 통해\). 이러한 각 문제는 클라이언트가 IPsec을 지원하지 않거나 이전에 알려진 인증 기관\(CA\)에 등록되지 않았을 수 있는 잘 알려진 서버에 대한 트래픽을 보호하기 위해 IPsec을 사용할 때 문제를 제시합니다.

이러한 주요 과제는 사전 조정 없이 서버가 다른 당사자와의 연결을 안전하게 유지할 수 있는 방식으로 IETF에서 해결되고 있습니다\[45\]\[46\]. 이는 공개적으로 사용 가능한 서버에 특히 유용할 수 있으며, 어떤 이유로든 기존 IPsec 인증서\(예: 핵심 인터넷 BGP 라우터\)를 배포하지 않거나 배포하지 않을 서버에 대한 연결을 보호하는 데 유용할 수 있습니다.

---
## **4.  ICMP**

스푸핑된 TCP 패킷이 연결을 종료할 수 있는 것처럼 스푸핑된 ICMP 패킷도 연결을 종료할 수 있습니다. ICMP는 연결 재설정, 경로 MTU 공격 등 TCP에 대한 다양한 공격을 실행하는 데 사용될 수 있으며, 비 TCP '죽음의 핑' 및 '스머프 공격' 등으로 호스트를 공격하는 데에도 사용될 수 있습니다.\[40\] . 따라서 ICMP는 TCP에 대한 실질적인 위협을 나타내지만 이 문서의 초점은 아니지만 일부 보호는 TCP 스푸핑 방지 기술과 유사하기 때문에 아래에서 논의됩니다. 또한 TCP에 대한 ICMP 공격은 공격자가 소켓 쌍을 알고 있다고 가정하며 이는 널리 알려진 끝점 쌍 사이의 서비스 하위 집합을 제외하고는 거의 발생하지 않습니다.

TCP 헤더는 특정 ICMP 메시지 내에 포함될 수 있습니다\[7\]. ICMP 메시지 내에서 TCP 헤더가 발생할 때 TCP 헤더의 시퀀스 번호를 검증하라는 최근 제안이 있었습니다\[18\]. 이 시퀀스 검사는 TCP의 기존 데이터 패킷에 대해 발생하는 검사와 유사하지만 섹션 3.1.2에 설명된 RST 창 감쇠의 정신으로 제안되고 있습니다.

이러한 검사 중 일부는 특히 TCP 처리에 의해 이미 수행된 유효성 검사와 병행하는 경우, 특히 그러한 처리의 의미를 에뮬레이션하는 경우 합리적일 수 있습니다. 예를 들어, 손상된 패킷에 대한 반응을 방지하려면 TCP 헤더의 필드를 검사하기 전에 TCP 체크섬을 검증해야 합니다\(전체 TCP 세그먼트가 ICMP 메시지에 포함된 경우\). 마찬가지로 TCP MD5 옵션이 있는 경우 메시지 내용을 고려하기 전에 해당 서명의 유효성을 검사해야 합니다. 이러한 유효성 검사를 통해 ICMP 생성\(체크섬\) 이전에 패킷이 손상되지 않았는지, 해당 패킷이 원본\(IPsec 또는 TCP/MD5 인증\)에서 보낸 패킷인지 또는 패킷이 초과 기간 동안 네트워크에 없었는지 확인할 수 있습니다. 2\*MSL\(유효한 시퀀스 번호\).

ICMP는 일부 메시지가 일부 스푸핑된 TCP 세그먼트보다 더 적은 유효성 검사를 통해 더 쉽게 연결을 재설정할 수 있기 때문에 특별한 문제를 제시합니다. 제안된 또 다른 대안은 연결이 설정된 후 TCP의 반응을 ICMP로 변경하는 것입니다. 이는 연결 설정 중에 TCP를 취약하게 만들고 특정 유효한 네트워크 이벤트에 대한 TCP의 반응을 수정합니다\[19\]. 이는 일부 터널링 구성의 IPsec과 마찬가지로 ICMP 메시지의 상황별 민감도를 고려하지만 이러한 필터링과 관련된 권장 사항은 모호합니다\[27\].

궁극적으로 이 문서에서 스푸핑된 데이터에 대해 설명하는 것처럼 TCP ICMP 메시지가 '창 내'에 있도록 요구하는 것만으로는 보호가 충분하지 않을 수 있습니다. ICMP 패킷은 알려진 연결 끝점이나 라우터와 같이 알려지고 신뢰할 수 있는 끝점에서 시작될 때 인증될 수 있습니다.

기존 IPsec 연결이 있는 도메인. 불행하게도 이러한 정보는 네트워크의 다른 위치에서도 발생할 수 있습니다. 또한 일부 네트워크에서는 유효성 검사가 불가능할 수 있으므로 모든 ICMP 패킷을 필터링합니다. 특히 네트워크의 어느 곳에서나 삽입될 수 있어 쉽고 로컬 주소 필터링이 불가능하기 때문입니다\[27\]. 따라서 이 문서의 문제나 보안 고려 사항에서는 별도로 다루지 않습니다.

---
## **5.  Issues**

경로를 벗어난 제3자 스푸핑 공격에 대한 일반적인 전송 프로토콜\(특히 TCP\)의 취약성을 해결하는 기존 솔루션과 제안된 솔루션이 많이 있습니다. 표시된 것처럼 이는 전송 또는 네트워크 계층에서 작동합니다. 전송 솔루션을 사용하려면 각 전송 프로토콜을 별도로 수정해야 하며, 각 전송 연결의 맥락에서 네트워크 ID 스푸핑을 별도로 처리해야 합니다. 네트워크 솔루션에는 분산 조정\(필터링\)이 필요하거나 계산 집약적일 수 있으며 가능한 모든 엔드포인트에 대한 인증 기관의 광범위한 등록\(인증\)이 필요합니다. 이 섹션에서는 이러한 관찰 내용을 자세히 설명합니다.

---
### **5.1.  Transport Layer (e.g., TCP)**

전송 솔루션은 공유 쿠키를 사용하여 데이터, 전송 헤더 및 의사 헤더\(예: TCP의 외부 IP 헤더의 고정 부분\)를 포함한 세그먼트를 인증합니다. 인터넷은 상태 비저장 네트워크 프로토콜에 의존하기 때문에 연결뿐만 아니라 인증 상태에 대해서도 일부 전송 계층에서 사용할 수 있는 상태 설정 및 유지 관리에 의존하는 것이 합리적입니다. 3방향 핸드셰이크 및 하트비트를 사용하여 연결 상태와 함께 쉽게 저장할 수 있는 연결 매개변수와 함께 인증 상태를 협상할 수 있습니다.

앞서 언급한 것처럼 전송 계층 솔루션에는 인증을 포함하도록 모든 전송 프로토콜을 별도로 수정해야 합니다. 모든 전송 프로토콜이 협상된 엔드포인트 상태\(예: UDP\)를 지원하는 것은 아니며 레거시 프로토콜은 안전하게 확장하기가 매우 어렵습니다. 모든 인증 솔루션이 동일하게 생성되는 것은 아니며 다양한 전송 솔루션에 의존하면 최종 시스템이 잘못 지정되거나 구현된 솔루션의 가능성이 높아질 수 있습니다. 전송 인증은 SYN 쿠키 및 RST 창 감쇠\[4\]\[36\]와 같은 특정 공격에 대응하여 조각별로 개발되는 경우가 많습니다.

전송 계층 솔루션은 프로토콜별일 뿐만 아니라 연결별인 경우도 많습니다. 여기에는 장점과 단점이 모두 있습니다. 전송 계층 솔루션의 한 가지 장점은 하위 계층이 오류로 인해 실패할 때 전송 프로토콜을 보호할 수 있다는 것입니다.

구현. TCP에는 이러한 경우를 보호하기 위한 다양한 패킷 검증 메커니즘\(예: RST가 창 내에 있는지 확인\)이 이미 포함되어 있습니다. 더 엄격한 검사를 통해 제공되는 보호 기능을 강화할 수 있습니다\(예: 창 내에서 종료되는 잘못 주소가 지정된 RST로부터 보호\(TCP보안을 통해\) 또는 RST, SYN 또는 잘못 주소가 지정된 패킷\(TCP/MD5\)으로 인한 데이터 주입으로 인한 연결 중단으로부터 보호\). 36\].

또 다른 장점은 전송 계층 보호가 특정 연결로 보다 구체적으로 제한될 수 있다는 것입니다. 각 연결은 해당 상태를 개별적으로 협상하므로 해당 상태는 해당 연결과 더욱 구체적으로 연결될 수 있습니다. 이것은 장점이자 단점입니다. 실제로 공유 비밀이나 인증서는 일반적으로 여러 연결에서 공유되지만 보안을 개별 연결에 더 쉽게 연결할 수 있습니다.

단점은 각 전송 연결이 인증 상태를 개별적으로 협상하고 유지해야 한다는 것입니다. 일부 오버헤드\(예: 패킷 교환의 오버헤드\)는 다중 연결을 통해 상각되지 않는 반면, 다른 오버헤드\(예: 설계 및 구현 복잡성\)는 네트워크 계층 솔루션의 경우처럼 서로 다른 전송 프로토콜을 통해 상각되지 않습니다. 인증은 필요한 것보다 나중에 패킷 처리에서 발생하기 때문에 추가 엔드포인트 리소스가 불필요하게 소비될 수 있습니다\(예: 수신된 패킷 역다중화, 연결 식별자 인덱싱, 스푸핑된 패킷 버퍼링 계속 등\). 나중에 전송 계층에서 삭제될 수 있습니다. .

---
### **5.2.  Network Layer (IP)**

네트워크 계층 솔루션은 수신기 패킷 처리 초기에 단일 공유 엔드포인트 인증 메커니즘을 사용하여 네트워크 계층에서 인증되지 않은 패킷을 삭제함으로써 여러 전송 변형의 위험을 방지합니다. 스푸핑에는 다른 엔드포인트로 가장하는 작업이 포함되고, 네트워크 계층 보안은 엔드포인트가 방출하는 패킷의 소스로 엔드포인트를 검증하기 때문에 스푸핑을 완전히 무력화합니다. 이러한 네트워크 수준 솔루션은 결과적으로 레거시 프로토콜과 신흥 프로토콜을 모두 포함하여 모든 전송 프로토콜을 보호하고 이러한 프로토콜의 복잡성도 줄여줍니다. 또한 공유 솔루션은 프로토콜 오버헤드를 줄이고 인증 상태 관리\(및 새로 고침\)를 개별 전송 연결의 상태와 분리합니다. 마지막으로, 네트워크 계층 솔루션은 전송 계층뿐만 아니라 네트워크 계층도 IGMP 및 일부 ICMP\(섹션 4\) 스푸핑 공격으로부터 보호합니다.

네트워크 계층 인증을 위한 IETF 제안 표준 프로토콜은 IPsec\[27\]입니다. IPsec은 헤더 인증\(AH\)\[25\] 및 캡슐화\(ESP\) 모드\[26\]를 포함한 전체 아키텍처를 지정합니다.

AH는 IP 헤더와 IP 데이터를 모두 인증하는 반면 ESP는 IP 데이터\(예: 전송 헤더 및 페이로드\)만 인증합니다. ESP가 더 효율적이고 SPI\(보안 매개변수 색인\)에 IP 헤더를 확인하는 데 충분한 정보가 포함되어 있기 때문에 AH는 단계적으로 폐지되고 있습니다\[27\]. 이 두 가지 모드는 IPsec 시스템 내의 개별 패킷에 적용되는 보안을 설명합니다. 키 교환 및 관리는 대역 외\(사전 공유 키를 통해\) 또는 자동화된 키 교환 프로토콜\(예: IKE\[24\]\)을 통해 수행됩니다.

IPsec은 이미 온패스 및 오프패스 제3자 스푸핑 공격을 모두 방어하기에 충분한 IP 헤더 및 데이터 콘텐츠 인증을 제공합니다. IKE는 원하는 대로 엔드포인트별, 프로토콜별 또는 연결별로 두 엔드포인트 간의 인증을 구성할 수 있습니다. IKE는 또한 자동으로 주기적으로 키 재입력을 수행하여 스누핑\(비밀 데이터 수집\)을 기반으로 한 암호화 분석을 더욱 무력화할 수 있습니다. IPsec의 사용은 이미 보호된 인프라에 대해 일반적으로 강력히 권장됩니다.

기존 IPsec은 많은 배포에 적합하지 않습니다. 키 관리와 개별 패킷 인증 모두에서 계산 집약적입니다\[43\]. 이러한 계산 오버헤드는 엄청날 수 있으며, 특히 상업용 라우터에서는 추가 하드웨어가 필요한 경우가 많습니다. 중요한 점은 IKE가 익명이 아니라는 점입니다. 키는 서로의 X.509 인증서를 신뢰하거나, 키 생성\(예: Kerberos\)을 도와줄 다른 제3자를 신뢰하거나, 키를 사전 공유하는 경우에만 당사자 간에 교환할 수 있습니다. 이러한 인증서는 양 당사자가 이미 신뢰하는 인증 기관\(CA\)이 인증서 자체에 서명한 경우에만 식별 정보\(상대방이 귀하가 누구인지 알 수 있음\)를 제공합니다. 대체로 CA 자체는 IKE가 보안 연결 키를 설정하는 데 도움이 되는 사전 공유 키이며, 이 키는 인증 알고리즘에 사용됩니다.

이러한 제한을 해결하고, 공개적으로 액세스 가능한 서버가 미리 알려지지 않은 클라이언트에 대한 연결을 보호하도록 허용하거나, IPsec의 나머지 보호 기능을 사용할 수 있도록 ID 확인을 일방적으로 완화할 수 있는 대체 메커니즘이 개발 중입니다.\[45\]\[46 \]. 특히, 이러한 메커니즘은 공격자가 동일한 통신 경로에 있는 경우에도 클라이언트\(클라이언트가 누구인지 알지 못한 채\)가 다른 클라이언트의 스푸핑에 의해 영향을 받는 것을 방지할 수 있습니다.

IPsec은 상업용 라우터와 일반 최종 시스템 모두에서 널리 사용 가능하지만 이미 기존 관계가 있는 당사자\(직원/고용주, 두 ISP 간 등\)를 제외하고는 자주 사용되지 않습니다. 익명 클라이언트\(예: 고객/비즈니스\) 또는 더 개방적인 서비스\(예: 라우터에 많은 수의 피어가 있을 수 있는 BGP\)에 대한 서버는 폭과 흐름으로 인해 관리하기 어렵습니다.

CA의. 새 끝점은 서버에서 이미 신뢰하는 CA가 자체 인증서에 서명하지 않는 한 해당 서버와 IPsec 연결을 설정할 수 없습니다. 동일한 전체 시스템\(예: BGP\) 내에서도 서로 다른 서버는 일반적으로 CA의 겹치는 하위 집합을 신뢰하지 않거나 신뢰하지 않는 경우가 많습니다.

---
### **5.3.  Application Layer**

엔드투엔드 암호화 내에 암시적인 경우가 많은 애플리케이션 계층 인증 메커니즘이 많이 있습니다. 애플리케이션 계층 보안\(예: BGP 스트림 내의 TLS, SSH 또는 MD5 체크섬\)은 네트워크 라우터뿐만 아니라 최종 시스템의 다른 계층에서의 노출을 포함한 모든 중개자로부터 애플리케이션 데이터를 궁극적으로 보호합니다. 이것이 궁극적으로 애플리케이션 데이터를 보호할 수 있는 유일한 방법입니다.

그러나 애플리케이션 인증은 스푸핑 공격으로부터 네트워크나 전송 프로토콜을 보호할 수 없습니다. 스푸핑된 패킷은 애플리케이션이 데이터를 확인하기 전에 네트워크 처리를 방해하거나 전송 연결을 재설정합니다. 인증은 이러한 패킷을 선별하여 하위 계층에서 간섭하기 전에 삭제해야 합니다.

대체 애플리케이션 계층 솔루션에는 연결 재설정에 대한 복원력이 포함됩니다. 애플리케이션이 이러한 연결 중단으로부터 복구할 수 있다면 그러한 공격은 영향을 덜 받습니다. 불행하게도 공격자는 연결을 다시 시작하는 비용, 연결이 다시 시작될 때까지의 지연 또는 네트워크에서 연결 설정 메시지 증가 등의 이유로 여전히 애플리케이션에 영향을 미칩니다. 일부 애플리케이션\(특히 BGP\)은 TCP 연결 신뢰성을 경로 경로 안정성의 지표로 해석하기도 합니다. 이것이 바로 BGP에 대한 공격이 상당한 결과를 초래하는 이유입니다.

---
### **5.4.  Link Layer**

링크 계층 보안은 인터넷의 각 홉에서 별도로 작동합니다. 이러한 보안은 대역폭 및 링크 관리 프로토콜과 같은 링크 리소스를 보호하는 데 중요할 수 있습니다. 이 계층의 보호는 패킷의 엔드포인트 소스를 인증할 수 없기 때문에 네트워크 또는 전송 계층에 충분하지 않습니다. 링크 인증은 검사되는 현재 링크 홉의 소스만 보장합니다.

---
### **5.5.  Issues Discussion**

이 섹션에서 제기된 문제는 스푸핑 공격으로부터 보호를 전송하는 모든 솔루션에 문제가 있음을 시사합니다. 이로 인해 대체 보안 수준이 필요할 가능성이 높아집니다. 보안이 필요하다는 것은 이미 널리 인식되어 있지만

많은 프로토콜 계층에서 동시에 단일 계층에서 다양한 장점을 지원하는 데 유용할 수도 있습니다. 예를 들어 IPsec은 이미 다양한 알고리즘\(인증을 위한 MD5, SHA1 등\)을 지원하지만 항상 다음을 가정합니다.

1. 패킷의 본문 전체가 보호됩니다.

1. 보안 연결은 알려진 인증 기관이나 기타 사전 공유 키를 통해 ID가 인증되는 경우에만 설정됩니다.

1. 온패스\(on-path\) 및 오프패스\(off-path\) 제3자 스푸핑 공격을 모두 물리쳐야 합니다.

이러한 가정은 특히 스푸핑 공격의 많은 경우에 금지됩니다. 스푸핑의 경우 가장 중요한 문제는 패킷이 서버가 도달할 수 있는 동일한 당사자로부터 오는지 여부입니다. 근본적으로 IP 헤더만 문제가 되므로 전체 패킷\(1\)을 보호하는 것은 과도한 계산입니다. \(2\)에서와 같이 신뢰할 수 있는 ID\("Bill" 대 "Bob"\)를 설정하는 대신 "패킷을 교환한 당사자"로 상대방을 인증하는 것으로 충분합니다. 마지막으로, 많은 쿠키 시스템은 일반 텍스트\(암호화되지 않음\), 고정 쿠키 값을 사용하여 경로를 벗어난 제3자 스푸핑 공격에 대해 합리적인\(1/2^{cookie-size}\) 보호를 제공하지만 경로상의 공격은 전혀 처리하지 않습니다. . 이러한 잠재적인 솔루션은 BTNS\(Better Than Nothing Security\) 문서\[5\]\[45\]\[46\]에서 논의됩니다. 또한 IPsec의 NULL 암호화는 이 쿠키의 변형을 적용합니다. 여기서 SPI는 쿠키이며 추가 암호화는 적용되지 않습니다\[17\].

---
## **6.  Security Considerations**

이 전체 문서는 전송 프로토콜의 보안과 스푸핑 공격에 대한 저항력을 높이는 데 중점을 둡니다. 보안은 전체적으로 다뤄졌습니다.

이 문서에서는 스푸핑 공격을 방어하기 위한 다양한 기술을 설명합니다. 명시적이든 암시적이든 일반 텍스트 쿠키\(예: 창 시퀀스 감쇠\)에 의존하는 쿠키는 이전 트래픽에서 유효한 값을 학습할 수 있으므로 경로 위조 공격으로부터 보호되지 않습니다. 실제 인증 알고리즘에 의존하는 알고리즘은 단일 패킷의 인증 해시가 "일회성" 쿠키의 동작에 접근하기 때문에 더 강력하여 경로상의 공격으로부터도 보호합니다.

프로토콜 스택의 다양한 수준에 대한 보안이 다뤄집니다. 스푸핑 공격은 기본적으로 신원 위장이므로 엔드투엔드 신원이 있는 네트워크 계층에서 이러한 공격을 물리치는 가장 적절한 솔루션이 있다고 생각합니다. 일부 전송 프로토콜

네트워크 계층\(예: TCP 의사 헤더\)의 엔드포인트 ID 정보를 포함하는 반면, 다른 것들은 교환된 nonce\(예: SCTP\)를 기반으로 연결별 ID를 설정합니다. 권장되지는 않지만 프로토콜 스택의 모든 계층에서 보안을 해결하는 것이 합리적입니다.

NAT\(Network Address Translator\) 및 기타 미들박스는 스푸핑 공격을 방지하기 위한 기술의 설계 및 배포를 복잡하게 만듭니다. 전송 중인 IP 및/또는 TCP 헤더를 수정하는 이와 같은 장치는 스푸핑 공격과 동일한 트래픽을 생성하므로 스푸핑 방지 메커니즘으로 차단해야 합니다. 이러한 미들박스 관련 문제에 대한 자세한 내용은 이 문서의 범위를 벗어나지만 해당 문제는 RFC 및 해당 장치와 인터넷 아키텍처 간의 상호 작용을 논의하는 새로운 문서\(예: \[21\]\)에서 다루어집니다. 다행스럽게도 가장 중요한 TCP 기반 연결 중 다수, 특히 BGP와 같은 라우팅 프로토콜을 지원하는 연결은 이러한 미들박스를 통과하지 않으며 이러한 제한의 영향을 받지 않습니다.

---
## **7.  Conclusions**

이 문서에서는 TCP 연결을 종료하는 데 사용될 수 있는 가짜 RST와 관련된 최근 BGP 스푸핑 공격에 대해 자세히 설명합니다. 다양한 프로토콜 계층에서 다양한 현재 솔루션과 제안된 솔루션을 요약하고 논의합니다.

---
## **8.  Acknowledgments**

이 문서는 R. Stewart의 문서\(작성자 목록\)를 포함하여 BGP 라우터에 대한 최근 스푸핑된 RST 공격에 대한 TCPM WG <http://www.ietf.org/html.charters/tcpm-charter.html\>의 토론에서 영감을 받았습니다. 이후 진화했습니다\) \[36\]\[42\]. 공격 문제 분석, 대체 솔루션 및 익명의 보안 제안 솔루션은 USC/ISI의 T. Faber, A. Falk, G. Finn 및 Y. Wang과 함께 해당 목록에 대한 논의의 결과였습니다. R. Atkinson은 TCP/MD5의 UDP 변형을 제안했고, P. Goyette는 ISN을 사용하여 TCP/MD5를 시드할 것을 제안했으며, L. Wood는 ISN을 사용하여 RST를 검증할 것을 제안했습니다. 다른 개선 사항은 IETF TCPM WG의 다양한 구성원의 의견, 특히 F. Gont, P. Savola 및 A. Hoenes의 자세한 피드백 덕분입니다.

이 문서는 2-Word-v2.0.template.dot를 사용하여 작성되었습니다.

---
## **9.  Informative References**

```text
   [1]   Allman, M., Paxson, V., and W. Stevens, "TCP Congestion
         Control", RFC 2581, April 1999.

   [2]   Baker, F. and P. Savola, "Ingress Filtering for Multihomed
         Networks", BCP 84, RFC 3704, March 2004.

   [3]   Bellovin, S. and A. Zinin, "Standards Maturity Variance
         Regarding the TCP MD5 Signature Option (RFC 2385) and the BGP-4
         Specification", RFC 4278, January 2006.

   [4]   Bernstein, D., "SYN cookies", 1997,
         <http://cr.yp.to/syncookies.html>.

   [5]   Better Than Nothing Security [BTNS] WG web pages,
         <http://www.postel.org/anonsec>.

   [6]   Bonica, R., Weis, B., Viswanathan, S., Lange, A., and O.
         Wheeler, "Authentication for TCP-based Routing and Management
         Protocols", Work in Progress, February 2007.

   [7]   Braden, R., "Requirements for Internet Hosts - Communication
         Layers", STD 3, RFC 1122, October 1989.

   [8]   Braden, R., "TIME-WAIT Assassination Hazards in TCP", RFC 1337,
         May 1992.

   [9]   CERT alert: "Technical Cyber Security Alert TA04-111A:
         Vulnerabilities in TCP", April 20, 2004,
         <http://www.us-cert.gov/cas/techalerts/TA04-111A.html>.

   [10]  Convery, S., and M. Franz, "BGP Vulnerability Testing:
         Separating Fact from FUD", 2003,
         <http://www.nanog.org/mtg-0306/pdf/franz.pdf>.

   [11]  Eddy, W., "TCP SYN Flooding Attacks and Common Mitigations",
         Work in Progress, May 2007.

   [12]  Faber, T., J. Touch, and W. Yue, "The TIME-WAIT state in TCP
         and Its Effect on Busy Servers", Proc. Infocom 1999, pp. 1573-
         1583, Mar. 1999.

   [13]  Ferguson, P. and D. Senie, "Network Ingress Filtering:
         Defeating Denial of Service Attacks which employ IP Source
         Address Spoofing", BCP 38, RFC 2827, May 2000.

   [14]  Floyd, S., "Inappropriate TCP Resets Considered Harmful", BCP
         60, RFC 3360, August 2002.

   [15]   Gill, V., Heasley, J., and D. Meyer, "The Generalized TTL
         Security Mechanism (GTSM)", RFC 3682, February 2004.

   [16]  Gill, V., Heasley, J., Meyer, D., Savola, P., Ed., and C.
         Pignataro, "The Generalized TTL Security Mechanism (GTSM)",
         Work in Progress, June 2007.

   [17]  Glenn, R. and S. Kent, "The NULL Encryption Algorithm and Its
         Use With IPsec", RFC 2410, November 1998.

   [18]  Gont, F., "ICMP attacks against TCP", Work in Progress, May
         2007.

   [19]  Gont, F., "TCP's Reaction to Soft Errors", Work in Progress,
         June 2007.

   [20]  Heffernan, A., "Protection of BGP Sessions via the TCP MD5
         Signature Option", RFC 2385, August 1998.

   [21]  Holdrege, M. and P. Srisuresh, "Protocol Complications with the
         IP Network Address Translator", RFC 3027, January 2001.

   [22]  Housley, R., Post to IETF Discussion mailing list regarding his
         IETF 64 Security Area presentation,
         ID=7.0.0.10.2.20051124135914.00f50558@vigilsec.com, Nov. 24,
         2005, <http://www1.ietf.org/
         mail-archive/ietf/Current/maillist.html>.

   [23]  Jacobson, V., Braden, R., and D. Borman, "TCP Extensions for
         High Performance", RFC 1323, May 1992.

   [24]  Kaufman, C., Ed., "Internet Key Exchange (IKEv2) Protocol", RFC
         4306, December 2005.

   [25]  Kent, S., "IP Authentication Header", RFC 4302, December 2005.

   [26]  Kent, S., "IP Encapsulating Security Payload (ESP)", RFC 4303,
         December 2005.

   [27]  Kent, S. and K. Seo, "Security Architecture for the Internet
         Protocol", RFC 4301, December 2005.

   [28]  Kohler, E., Handley, M., and S. Floyd, "Datagram Congestion
         Control Protocol (DCCP)", RFC 4340, March 2006.

   [29]  Larsen, M., and F. Gont, "Port Randomization", Work in
         Progress, February 2007.

   [30]  Leech, M., "Key Management Considerations for the TCP MD5
         Signature Option", RFC 3562, July 2003.

   [31]  Moore, D., G. Voelker, and S. Savage, "Inferring Internet
         Denial-of-Service Activity", Proc. Usenix Security Symposium,
         Aug. 2001.

   [32]  O'Malley, S. and L. Peterson, "TCP Extensions Considered
         Harmful", RFC 1263, October 1991.

   [33]  Perkins, C., "IP Encapsulation within IP", RFC 2003, October
         1996.

   [34]  Poon, K., "Use of TCP timestamp option to defend against blind
         spoofing attack", Work in Progress, October 2004.

   [35]  Postel, J., "Transmission Control Protocol", STD 7, RFC 793,
         September 1981.

   [36]  Ramaiah, A., Stewart, R., and M. Dalal, "Improving TCP's
         Robustness to Blind In-Window Attacks", Work in Progress, July
         2007.

   [37]  Rekhter, Y., Ed., Li, T., Ed., and S. Hares, Ed., "A Border
         Gateway Protocol 4 (BGP-4)", RFC 4271, January 2006.

   [38]  Semke, J., J. Mahdavi, and M. Mathis, "Automatic TCP Buffer
         Tuning", ACM SIGCOMM '98/ Computer Communication Review, volume
         28, number 4, Oct. 1998.

   [39]  Shepard, T., "Reassign Port Number option for TCP", Work in
         Progress, July 2004.

   [40]  Shirey, R., "Internet Security Glossary, Version 2", Work in
         Progress, November 2006.

   [41]  Stewart, R., Xie, Q., Morneault, K., Sharp, C., Schwarzbauer,
         H., Taylor, T., Rytina, I., Kalla, M., Zhang, L., and V.
         Paxson, "Stream Control Transmission Protocol", RFC 2960,
         October 2000.

   [42]  TCPM: IETF TCPM Working Group and mailing list,
         <http://www.ietf.org/html.charters/tcpm-charter.html>.

   [43]  Touch, J., "Report on MD5 Performance", RFC 1810, June 1995.

   [44]  Touch, J., "Performance Analysis of MD5", Proc. Sigcomm 1995,
         pp. 77-86, Mar. 1999.

   [45]  Touch, J., "ANONsec: Anonymous Security to Defend Against
         Spoofing Attacks", Work in Progress, May 2004.

   [46]  Touch, J., Black, D., and Y. Wang, "Problem and Applicability
         Statement for Better Than Nothing Security (BTNS)", Work in
         Progress, February 2007.

   [47]  Touch, J. and A. Mankin, "The TCP Simple Authentication
         Option", Work in Progress, July 2007.

   [48]  Watson, P., "Slipping in the Window: TCP Reset attacks",
         Presentation at 2004 CanSecWest,
         <http://cansecwest.com/csw04archive.html>.

   [49]  Wood, L., Post to TCPM mailing list regarding use of ISN in
         RSTs, ID=Pine.GSO.4.50.0404232249570.5889-
         100000@argos.ee.surrey.ac.uk, Apr. 23, 2004,
         <http://www1.ietf.org/mail-archive/web/tcpm/current/
         msg00213.html>.
```

---
# **Author's Addresses**

```text
   Joe Touch
   USC/ISI
   4676 Admiralty Way
   Marina del Rey, CA 90292-6695
   U.S.A.

   Phone: +1 (310) 448-9151
   Fax:   +1 (310) 448-9300
   EMail: touch@isi.edu
   URI:   http://www.isi.edu/touch
```

---
# **Full Copyright Statement**

저작권\(C\) IETF 트러스트\(2007\).

이 문서에는 BCP 78에 포함된 권리, 라이선스 및 제한 사항이 적용되며, 여기에 명시된 경우를 제외하고 작성자는 모든 권리를 보유합니다.

이 문서와 여기에 포함된 정보는 "있는 그대로" 제공되며 기여자, 그가 대표하거나 후원하는 조직\(있는 경우\), 인터넷 사회, IETF 트러스트 및 인터넷 엔지니어링 태스크 포스는 모든 것을 부인합니다. 여기에 있는 정보의 사용이 상품성이나 특정 목적에의 적합성에 대한 묵시적인 보증이나 권리를 침해하지 않는다는 보증을 포함하되 이에 국한되지 않는 명시적 또는 묵시적 보증.

---
# **Intellectual Property**

IETF는 이 문서에 설명된 기술의 구현이나 사용과 관련이 있다고 주장될 수 있는 지적 재산권 또는 기타 권리의 유효성이나 범위, 그러한 권리에 따른 라이선스가 적용되거나 적용되지 않을 수 있는 범위에 대해 어떠한 입장도 취하지 않습니다. 는 가능하다; 또한 그러한 권리를 확인하기 위해 독립적인 노력을 했다는 것을 나타내지도 않습니다. RFC 문서의 권리와 관련된 절차에 대한 정보는 BCP 78 및 BCP 79에서 확인할 수 있습니다.

IETF 사무국에 제출된 IPR 공개 사본 및 사용 가능한 라이센스에 대한 보증, 또는 이 사양의 구현자 또는 사용자가 해당 독점적 권리 사용에 대한 일반 라이센스 또는 허가를 얻으려는 시도의 결과를 얻을 수 있습니다. IETF 온라인 IPR 저장소\(http://www.ietf.org/ipr\)에서.

IETF는 이 표준을 구현하는 데 필요할 수 있는 기술에 적용될 수 있는 모든 저작권, 특허, 특허 출원 또는 기타 독점권에 관심을 갖도록 관심 있는 당사자를 초대합니다. IETF\(ietf-ipr@ietf.org\)에 해당 정보를 보내주십시오.

---
# **Acknowledgement**

RFC 편집 기능을 위한 자금은 현재 Internet Society에서 제공됩니다.