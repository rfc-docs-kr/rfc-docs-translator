

```text
﻿

Internet Engineering Task Force (IETF)                        Y. Sheffer
Request for Comments: 9325                                        Intuit
BCP: 195                                                  P. Saint-Andre
Obsoletes: 7525                                              Independent
Updates: 5288, 6066                                           T. Fossati
Category: Best Current Practice                              ARM Limited
ISSN: 2070-1721                                            November 2022

  Recommendations for Secure Use of Transport Layer Security (TLS) and
                Datagram Transport Layer Security (DTLS)
```

---
# **Abstract**

TLS\(전송 계층 보안\) 및 DTLS\(데이터그램 전송 계층 보안\)는 광범위한 애플리케이션 프로토콜을 통해 교환되는 데이터를 보호하는 데 사용되며 보안 전송 프로토콜의 기초를 형성할 수도 있습니다. 수년에 걸쳐 업계에서는 가장 일반적으로 사용되는 암호화 제품군 및 해당 작동 모드에 대한 공격을 포함하여 TLS 및 DTLS에 대한 여러 가지 심각한 공격을 목격했습니다. 이 문서에서는 TLS 및 DTLS를 사용하여 배포된 서비스의 보안을 보장하기 위한 최신 권장 사항을 제공합니다. 이러한 권장 사항은 대부분의 사용 사례에 적용됩니다.

TLS 권장 사항의 이전 버전인 RFC 7525는 업계가 TLS 1.2로 전환할 때 게시되었습니다. 몇 년 후 이러한 전환은 거의 완료되었으며 TLS 1.3이 널리 사용 가능해졌습니다. 이 문서는 새로운 환경에 따른 지침을 업데이트하고 RFC 7525를 더 이상 사용하지 않습니다. 또한 이 문서는 최근 공격을 고려하여 RFC 5288 및 6066을 업데이트합니다.

---
# **Status of This Memo**

이 메모에는 인터넷 모범 사례가 기록되어 있습니다.

이 문서는 IETF\(Internet Engineering Task Force\)의 산물입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 게시 승인을 받았습니다. BCP에 대한 자세한 내용은 RFC 7841의 섹션 2에서 확인할 수 있습니다.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 https://www.rfc-editor.org/info/rfc9325에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2022 IETF Trust 및 문서 작성자로 식별된 사람. 판권 소유.

이 문서에는 이 문서 발행일에 유효한 BCP 78 및 IETF 문서와 관련된 IETF Trust의 법적 조항\(https://trustee.ietf.org/license-info\)이 적용됩니다. 이 문서에 관한 귀하의 권리와 제한 사항이 설명되어 있으므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출된 코드 구성 요소는 신뢰 법률 조항의 섹션 4.e에 설명된 대로 개정된 BSD 라이센스 텍스트를 포함해야 하며 개정된 BSD 라이센스에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1.  Introduction
   2.  Terminology
   3.  General Recommendations
     3.1.  Protocol Versions
       3.1.1.  SSL/TLS Protocol Versions
       3.1.2.  DTLS Protocol Versions
       3.1.3.  Fallback to Lower Versions
     3.2.  Strict TLS
     3.3.  Compression
       3.3.1.  Certificate Compression
     3.4.  TLS Session Resumption
     3.5.  Renegotiation in TLS 1.2
     3.6.  Post-Handshake Authentication
     3.7.  Server Name Indication (SNI)
     3.8.  Application-Layer Protocol Negotiation (ALPN)
     3.9.  Multi-Server Deployment
     3.10. Zero Round-Trip Time (0-RTT) Data in TLS 1.3
   4.  Recommendations: Cipher Suites
     4.1.  General Guidelines
     4.2.  Cipher Suites for TLS 1.2
       4.2.1.  Implementation Details
     4.3.  Cipher Suites for TLS 1.3
     4.4.  Limits on Key Usage
     4.5.  Public Key Length
     4.6.  Truncated HMAC
   5.  Applicability Statement
     5.1.  Security Services
     5.2.  Opportunistic Security
   6.  IANA Considerations
   7.  Security Considerations
     7.1.  Host Name Validation
     7.2.  AES-GCM
       7.2.1.   Nonce Reuse in TLS 1.2
     7.3.  Forward Secrecy
     7.4.  Diffie-Hellman Exponent Reuse
     7.5.  Certificate Revocation
   8.  References
     8.1.  Normative References
     8.2.  Informative References
   Appendix A.  Differences from RFC 7525
   Acknowledgments
   Authors' Addresses
```

---
## **1.  Introduction**

TLS\(전송 계층 보안\) 및 DTLS\(데이터그램 전송 계층 보안\)는 HTTP \[RFC9112\] \[RFC9113\], IMAP \[RFC9051\], 우체국 프로토콜\(POP\) \[STD53\]을 비롯한 다양한 애플리케이션 프로토콜을 통해 교환되는 데이터를 보호하는 데 사용됩니다. \], SIP \[RFC3261\], SMTP \[RFC5321\] 및 XMPP\(Extensible Messaging and Presence Protocol\) \[RFC6120\]. 이러한 프로토콜은 TLS 또는 DTLS 핸드셰이크 프로토콜과 TLS 또는 DTLS 레코드 계층을 모두 사용합니다. TLS 핸드셰이크 프로토콜은 보안 전송 프로토콜을 정의하기 위해 다양한 레코드 계층과 함께 사용될 수도 있지만\(가장 눈에 띄는 예는 QUIC \[RFC9000\]입니다\) 이러한 전송 프로토콜은 이 문서의 범위에 직접 포함되지 않습니다. 그럼에도 불구하고 여기에 나온 권장 사항 중 상당수는 해당 프로토콜이 TLS 핸드셰이크 프로토콜을 사용하는 한 적용될 수 있습니다.

2015년까지 수년 동안 업계에서는 가장 일반적으로 사용되는 암호화 제품군 및 해당 작동 모드에 대한 공격을 포함하여 TLS 및 DTLS에 대한 심각한 공격을 목격했습니다. 예를 들어, 한때 가장 널리 배포된 암호였던 AES-CBC \[RFC3602\] 및 RC4 \[RFC7465\] 암호화 알고리즘은 모두 TLS와 관련하여 공격을 받았습니다. 2015년 이전에 알려진 공격에 대한 자세한 정보는 이전 버전의 TLS 권장 사항 \[RFC7525\]에 대한 동반 문서 \[RFC7457\]에 제공되어 독자가 여기에 제공된 권장 사항의 근거를 이해하는 데 도움이 됩니다. 해당 문서는 이 문서와 함께 업데이트되지 않았습니다. 대신 이 문서에서는 이러한 공격에 대한 완화 방법과 마찬가지로 최신 공격에 대해 설명합니다.

TLS 커뮤니티는 \[RFC7457\]에 설명된 공격에 여러 가지 방법으로 대응했습니다.

\* 이전 프로토콜 버전과 함께 TLS 1.2 \[RFC5246\] 및 DTLS 1.2 \[RFC6347\] 사용에 대한 자세한 지침이 게시되었습니다. 이 지침은 원본 \[RFC7525\]에 포함되어 있으며 개정된 버전에서도 대부분 유지됩니다. 이 지침은 2015년 RFC 7525가 발표된 이후 업계에서 대부분 채택되었습니다.

\* 1.2 이전 버전의 TLS는 더 이상 사용되지 않습니다\[RFC8996\].

\* TLS \[RFC8446\] 버전 1.3이 출시되었고, 이어서 DTLS \[RFC9147\] 버전 1.3이 출시되었습니다. 이러한 버전은 설명된 공격을 크게 완화하거나 해결합니다.

TLS 및 TLS 기반 프로토콜을 구현하고 배포하는 사람들은 이를 안전하게 사용할 수 있는 방법에 대한 지침이 필요합니다. 이 문서는 구현자가 자신의 코드가 섹션 5에 정의된 환경에 배포될 것으로 예상한다는 가정하에 배포된 서비스와 소프트웨어 구현에 대한 지침을 제공합니다. 배포와 관련하여 이 문서는 광범위한 청중, 즉 인증을 추가하려는 모든 배포자를 대상으로 합니다\( 단방향이든 상호이든\), 기밀성 및 통신에 대한 데이터 무결성 보호를 제공합니다.

여기의 권장 사항은 다양한 메커니즘의 보안, 기술적 성숙도 및 상호 운용성, 작성 당시 구현의 보급률을 고려합니다. 권장 사항이 TLS에만 적용되거나 DTLS에만 적용된다는 점을 명시적으로 언급하지 않는 한 각 권장 사항은 TLS와 DTLS 모두에 적용됩니다.

이 문서는 TLS 1.2 구현에 대한 새로운 지침을 최소화하려고 시도하며 전반적인 접근 방식은 시스템이 TLS 1.3으로 이동하도록 권장하는 것입니다. 그러나 이것이 항상 실용적인 것은 아닙니다. 새로 발견된 공격과 생태계 변화로 인해 TLS 1.2 환경에 적용되는 몇 가지 새로운 요구 사항이 필요했습니다. 이는 부록 A에 요약되어 있습니다.

당연히 향후 공격이 발생할 가능성이 높으며 이 문서에서는 해당 공격을 해결할 수 없습니다. TLS/DTLS와 TLS/DTLS 기반 프로토콜을 구현하고 배포하는 사람들은 향후 개발에 주의를 기울일 것을 강력히 권고합니다. 특히, 양자 컴퓨터의 생성이 암호화 기본 요소의 보안과 이를 사용하는 기술에 상당한 영향을 미칠 것으로 알려져 있음에도 불구하고, 현재 포스트 양자 암호화는 진행 중인 작업이며 권장 사항을 제시하기에는 너무 이르습니다. 관련 사양이 IETF 또는 다른 곳에서 표준화되면 이 문서는 당시의 모범 사례를 반영하도록 업데이트되어야 합니다.

언급한 대로 TLS 1.3 사양은 이 문서에 나열된 많은 취약점을 해결합니다. TLS 1.3을 배포하는 시스템은 TLS 1.2 이하보다 취약성이 적어야 합니다. 따라서 이 문서는 대부분의 TLS 1.2 사용을 TLS 1.3으로 마이그레이션하도록 장려하는 명시적인 목표로 \[RFC7525\]를 대체합니다.

이는 인증되지 않은 TLS를 제외하고 대부분의 구현 및 배포 시나리오에서 TLS 사용에 대한 최소 권장 사항입니다\(섹션 5 참조\). 이 문서를 참조하는 다른 사양은 특정 상황\(예: 특정 응용 프로그램 프로토콜과 함께 사용\)에 따라 프로토콜의 하나 이상의 측면과 관련된 더 엄격한 요구 사항을 가질 수 있습니다. 이 경우 구현자는 더 엄격한 요구 사항을 준수하는 것이 좋습니다. 또한 이 문서는 상한선이 아닌 하한선을 제공합니다. 가능한 경우 서비스 관리자는 구현에 사용 가능한 최소 지원을 넘어 가능한 가장 강력한 보안을 제공하도록 권장됩니다. 예를 들어, 기존 애플리케이션 프로토콜의 배포 기반에 대한 지식과 보안 강도 및 상호 운용성에 관한 비용 편익 분석을 기반으로 특정 서비스 제공업체는 TLS 1.2를 완전히 비활성화하고 TLS 1.3만 제공하기로 결정할 수 있습니다.

다양한 알고리즘과 실행 가능한 공격의 강도에 대한 커뮤니티 지식은 빠르게 변할 수 있으며, 경험에 따르면 보안에 관한 BCP\(Best Current Practice\) 문서는 특정 시점에 대한 설명입니다. 독자들은 이 문서에 적용되는 정오표나 업데이트를 찾아보는 것이 좋습니다.

이 문서는 \[Boeck2016\] 공격을 고려하여 \[RFC5288\]을 업데이트합니다. 자세한 내용은 섹션 7.2.1을 참조하세요.

이 문서는 \[ALPACA\] 공격을 고려하여 \[RFC6066\]을 업데이트합니다. 자세한 내용은 섹션 3.7을 참조하세요.

---
## **2.  Terminology**

이 문서의 여러 보안 관련 용어는 "공격", "인증", "인증서", "암호화", "타협", "기밀성", "자격 증명"을 포함하여 \[RFC4949\]에 정의된 의미로 사용됩니다. "데이터 무결성", "암호화", "순방향 비밀성", "키", "키 길이", "자체 서명 인증서", "강도" 및 "강함".

핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY" 및 "OPTIONAL 이 문서의 "는 여기에 표시된 대로 모두 대문자로 표시되는 경우에만 BCP 14 \[RFC2119\] \[RFC8174\]에 설명된 대로 해석됩니다.

---
## **3.  General Recommendations**

이 섹션에서는 TLS의 안전한 사용에 대한 일반적인 권장 사항을 제공합니다. 암호화 제품군과 관련된 권장 사항은 다음 섹션에서 설명됩니다.

---
### **3.1.  Protocol Versions**
---
#### **3.1.1.  SSL/TLS Protocol Versions**

SSL/TLS의 보안 수준이 낮은 오래된 버전의 사용을 중단하고 보다 안전한 최신 버전을 사용하는 것이 모두 중요합니다. 따라서 TLS/SSL 프로토콜 버전에 관한 권장 사항은 다음과 같습니다.

```text
   *  Implementations MUST NOT negotiate SSL version 2.
```

- 근거: 현재 SSLv2는 안전하지 않은 것으로 간주됩니다\[RFC6176\].

```text
   *  Implementations MUST NOT negotiate SSL version 3.
```

- 근거: SSLv3 \[RFC6101\]은 SSLv2보다 개선되었으며 몇 가지 중요한 보안 허점을 해결했지만 강력한 암호화 제품군을 지원하지 않았습니다. SSLv3은 TLS 확장을 지원하지 않으며 그 중 일부\(예: renegotiation\_info \[RFC5746\]\)는 보안에 중요합니다. 또한, Padding Oracle On Downgraded Legacy Encryption\(POODLE\) 공격\[POODLE\]이 등장하면서 SSLv3은 이제 근본적으로 안전하지 않은 것으로 널리 인식되었습니다. 자세한 내용은 \[RFC7568\]을 참조하세요.

```text
   *  Implementations MUST NOT negotiate TLS version 1.0 [RFC2246].
```

- 근거: TLS 1.0\(1999년에 게시됨\)은 현대적이고 강력한 암호화 제품군을 많이 지원하지 않습니다. 또한 TLS 1.0에는 CBC\(암호 블록 체인\) 기반 암호화 제품군에 대한 레코드별 초기화 벡터\(IV\)가 없으며 일반적인 패딩 오류에 대해 경고하지 않습니다. 이 섹션의 권장 사항과 기타 권장 사항은 \[RFC8996\]과 일치합니다.

```text
   *  Implementations MUST NOT negotiate TLS version 1.1 [RFC4346].
```

- 근거: TLS 1.1\(2006년 게시\)은 TLS 1.0에 대한 보안 개선 사항이지만 이 문서에서 TLS 1.2에 권장되는 암호화 제품군을 포함하여 2008년 TLS 1.2 표준화와 함께 도입된 특정 강력한 암호화 제품군을 여전히 지원하지 않습니다\( 아래 섹션 4.2를 참조하세요\).

```text
   *  Implementations MUST support TLS 1.2 [RFC5246].
```

- 근거: TLS 1.2는 현재 TLS 1.3보다 더 광범위하게 구현 및 배포되며, 알려진 공격을 완화하기 위해 이 문서의 권장 사항을 따르면 TLS 1.2의 사용은 TLS 1.3의 사용만큼 안전합니다. TLS 및 DTLS를 재사용하는 대부분의 애플리케이션 프로토콜에서는 TLS 1.3으로만 즉시 마이그레이션할 필요가 없습니다. 실제로 많은 애플리케이션 클라이언트가 아직 TLS 1.3을 지원하지 않는 TLS 라이브러리나 운영 체제에 의존하기 때문에 TLS 1.2를 적극적으로 지원하지 않으면 상당한 상호 운용성 문제가 발생하여 보안에 도움이 되기보다 해를 끼치게 됩니다. 그럼에도 불구하고 이 BCP의 향후 버전에서는 적절한 경우 TLS 1.2의 사용을 더 이상 사용하지 않을 것으로 예상됩니다.

\* 구현은 TLS 1.3 \[RFC8446\]을 지원해야 하며, 구현된 경우 이전 버전의 TLS보다 TLS 1.3 협상을 선호해야 합니다\(MUST\).

- 근거: TLS 1.3은 프로토콜에 대한 대대적인 점검이며 TLS 1.2의 많은 보안 문제를 해결합니다. 구현이 TLS 1.2를 지원하는 범위 내에서\(기본값이 TLS 1.3인 경우에도\) 이 문서에 지정된 TLS 1.2에 관한 권장 사항을 따라야 합니다.

\* TLS/DTLS 핸드셰이크 프로토콜 및/또는 레코드 계층을 통합하는 새로운 전송 프로토콜은 TLS/DTLS 1.3만 사용해야 합니다\(예: QUIC \[RFC9001\]가 이 접근 방식을 사용함\). 채널 또는 세션 암호화를 위해 TLS/DTLS를 사용하는 새로운 애플리케이션 프로토콜은 TLS/DTLS 버전 1.2 및 1.3과 모두 통합되어야 합니다. 그럼에도 불구하고 광범위한 상호 운용성이 문제가 되지 않는 드문 경우에는 애플리케이션 프로토콜 설계자가 TLS 1.2를 포기할 수도 있습니다.

- 근거: TLS 1.3의 보안 배포는 TLS 1.2의 보안 배포보다 훨씬 쉽고 오류 발생 가능성이 낮습니다. QUIC와 같은 새로운 보안 전송 프로토콜을 설계할 때 TLS 1.2를 지원할 이유가 없습니다. 이와 대조적으로 TLS를 재사용하는 새로운 애플리케이션 프로토콜은 두 버전에 대한 기본 라이브러리 또는 운영 체제 지원을 활용하려면 TLS 1.3과 TLS 1.2를 모두 지원해야 합니다.

이 BCP는 TLS 1.3, TLS 1.2 및 이전 버전에 적용됩니다. 독자가 이 BCP의 권장 사항이 TLS의 향후 버전에 적용된다고 가정하는 것은 안전하지 않습니다.

---
#### **3.1.2.  DTLS Protocol Versions**

UDP 데이터그램에 TLS를 적용한 DTLS는 TLS 1.1이 출시되었을 때 도입되었습니다. DTLS와 관련된 권장 사항은 다음과 같습니다.

```text
   *  Implementations MUST NOT negotiate DTLS version 1.0 [RFC4347].
```

- DTLS 버전 1.0은 TLS 버전 1.1과 관련이 있습니다\(위 참조\).

```text
   *  Implementations MUST support DTLS 1.2 [RFC6347].
```

- DTLS 버전 1.2는 TLS 버전 1.2와 관련이 있습니다\(위 참조\). \(DTLS 버전 1.1은 없습니다.\)

\* 구현은 DTLS 1.3 \[RFC9147\]을 지원해야 하며, 구현된 경우 이전 버전의 DTLS보다 DTLS 버전 1.3 협상을 선호해야 합니다\(MUST\).

- DTLS 버전 1.3은 TLS 버전 1.3과 관련이 있습니다\(위 참조\).

---
#### **3.1.3.  Fallback to Lower Versions**

TLS/DTLS 1.2 클라이언트는 이전 TLS 버전이 더 이상 사용되지 않으므로 \[RFC8996\] 이전 TLS 버전으로 대체하면 안 됩니다. 결과적으로 다운그레이드 보호 SCSV\(Signaling Cipher Suite Value\) 메커니즘\[RFC7507\]은 더 이상 클라이언트에 필요하지 않습니다. 또한 TLS 1.3은 새로운 버전 협상 메커니즘을 구현합니다.

---
### **3.2.  Strict TLS**

"SSL Stripping" 및 STARTTLS 명령 주입\(\[RFC7457\]에 요약된 공격\)을 방지하는 데 도움이 되는 다음 권장 사항이 제공됩니다.

\* 기존의 많은 애플리케이션 프로토콜은 TLS 사용이 일반화되기 전에 설계되었습니다. 이러한 프로토콜은 일반적으로 TLS 전용 통신을 위한 별도의 포트\(예: HTTPS의 경우 포트 443\)를 통해 또는 암호화되지 않은 채널에서 TLS 보호 채널로 동적으로 업그레이드하는 방법\(예: STARTTLS, 즉 STARTTLS\) 중 하나로 TLS를 지원합니다. IMAP 및 XMPP와 같은 프로토콜에 사용됩니다. 통신 채널을 보호하기 위한 메커니즘\(TLS 전용 포트 또는 동적 업그레이드\)에 관계없이 중요한 것은 채널의 최종 상태입니다. 프로토콜이 동적 업그레이드 방법과 별도의 TLS 전용 방법을 모두 정의하는 경우 구현에서는 별도의 TLS 전용 방법을 지원해야 하며 동적 업그레이드 방법보다 우선적으로 사용되도록 관리자가 구성해야 합니다. 프로토콜이 동적 업그레이드 방법만 지원하는 경우 구현에서는 관리자가 협상된 TLS 채널이 없을 때 일반 텍스트 사용을 금지하는 엄격한 로컬 정책을 설정할 수 있는 방법을 제공해야 하며 관리자는 이 정책을 사용해야 합니다.

\* World Wide Web\(섹션 5 참조\)에서 사용하기 위한 HTTP 클라이언트 및 서버 구현은 웹 서버가 TLS 전용 클라이언트를 허용할 의사가 있음을 광고할 수 있도록 HSTS\(HTTP Strict Transport Security\) 헤더 필드\[RFC6797\]를 지원해야 합니다. . 웹 서버는 HSTS를 사용하여 실제로 전체 보안을 약화시키는 방식으로 배포되지 않는 한 TLS 전용 클라이언트를 허용할 의사가 있음을 나타내기 위해 HSTS를 사용해야 합니다\(예: 자체 서명된 인증서와 함께 HSTS를 사용하는 것이 문제가 될 수 있음\). , \[RFC6797\]의 섹션 11.3에 설명된 대로\). 메일 전송 에이전트를 위한 MTA-STS\(Mail Transfer Agent Strict Transport Security\) \[RFC8461\] 및 SMTP를 위한 DANE\(DNS-Based Authentication of Named Entities\) \[RFC6698\] 기반 방법과 같은 비HTTP 애플리케이션 프로토콜에도 유사한 기술이 존재합니다. RFC7672\] 및 XMPP \[RFC7712\].

근거: 보호되지 않은 통신과 TLS로 보호되는 통신을 결합하면 SSL 스트리핑 및 유사한 공격이 발생할 수 있습니다. 통신의 초기 부분은 무결성이 보호되지 않아 통신을 명확하게 유지하려는 목표를 가진 공격자가 조작할 수 있기 때문입니다.

---
### **3.3.  Compression**

TLS 1.2를 사용할 때 압축 관련 공격\(\[RFC7457\]의 섹션 2.6에 요약됨\)을 방지하기 위해 구현 및 배포는 TLS 수준 압축\(\[RFC5246\]의 섹션 6.2.2\)을 지원해서는 안 됩니다. 유일한 예외는 문제의 애플리케이션 프로토콜이 그러한 공격에 노출되지 않는 것으로 입증된 경우입니다. 그러나 이 경우에도 TLS 압축과 관련된 향후 공격 가능성이 있으므로 극도의 주의가 필요합니다. 보다 구체적으로, HTTP 프로토콜은 압축 관련 공격에 취약한 것으로 알려져 있습니다. \(압축이 TLS 1.3에서 제거되었기 때문에 이 권장 사항은 TLS 1.2에만 적용됩니다.\)

근거: TLS 압축은 CRIME\(Compression Ratio Info-leak Made Easy\) 공격과 같은 보안 공격의 대상이 되었습니다.

구현자는 더 높은 프로토콜 수준의 압축으로 인해 적극적인 공격자가 연결에서 일반 텍스트 정보를 추출할 수 있다는 점에 유의해야 합니다. BREACH\(Adaptive Compression of Hypertext\) 공격을 통한 브라우저 정찰 및 유출이 그러한 사례 중 하나입니다. 이러한 문제는 TLS 외부에서만 완화될 수 있으므로 이 문서의 범위를 벗어납니다. 자세한 내용은 \[RFC7457\]의 섹션 2.6을 참조하세요.

---
#### **3.3.1.  Certificate Compression**

인증서 체인은 핸드셰이크 중에 전송된 대부분의 바이트를 차지하는 경우가 많습니다. 크기를 관리하기 위해 다음 방법 중 일부 또는 전부를 사용할 수 있습니다\(추가 제안은 \[RFC9191\]의 섹션 4 참조\).

\* 이름이나 확장자의 수를 제한하십시오.

\* ECDSA\(타원 곡선 디지털 서명 알고리즘\)와 같은 작은 공개 키 표현이 포함된 키를 사용하세요.

```text
   *  Use certificate compression.
```

후자를 달성하기 위해 TLS 1.3은 \[RFC8879\]에서 압축\_인증서 확장을 정의합니다. 사용과 관련된 보안 및 개인 정보 보호 고려 사항은 \[RFC8879\]의 섹션 5를 참조하세요. 의심의 여지를 없애기 위해 TLS 압축에 대한 CRIME 스타일 공격은 인증서 압축에 적용되지 않습니다.

미들박스 간섭 가능성이 높기 때문에 TLS 1.2에서는 \[RFC8879\] 스타일의 압축이 제공되지 않습니다. 이론적으로는 \[RFC7924\]에 정의된 캐시된 정보 확장을 사용할 수 있지만 실용적인 대안으로 간주될 만큼 널리 지원되지는 않습니다.

---
### **3.4.  TLS Session Resumption**

세션 재개는 전체 TLS 핸드셰이크 수를 크게 줄여주므로 대부분의 배포에서 필수적인 성능 기능입니다.

세션 티켓을 사용한 상태 비저장 세션 재개는 널리 사용되는 전략입니다. TLS 1.2의 경우 \[RFC5077\]에 지정되어 있습니다. TLS 1.3의 경우 사전 공유 키\(PSK\) 사용을 기반으로 하는 보다 안전한 메커니즘이 \[RFC8446\]의 섹션 4.6.1에 설명되어 있습니다. 세션 재개를 포함하여 TLS 암호화 "바로가기"로 인한 위험에 대한 정량적 연구는 \[Springall16\]을 참조하세요.

사용 시 공격자에 의한 수정이나 도청을 방지하기 위해 재개 정보를 인증하고 암호화해야 합니다. 세션 티켓에 추가 권장 사항이 적용됩니다.

\* 티켓을 암호화할 때는 강력한 암호화를 사용해야 합니다\(적어도 기본 TLS 암호화 제품군만큼 강력함\).

\* 티켓 암호화 키는 순방향 비밀성의 이점을 무효화하지 않도록 정기적으로\(예: 매주 한 번\) 변경해야 합니다\(순방향 비밀성에 대한 자세한 내용은 섹션 7.3 참조\). 이전 티켓 암호화 키는 유효 기간이 끝나면 반드시 파기되어야 합니다.

\* 비슷한 이유로 세션 티켓 유효성은 합리적인 기간\(예: 티켓 암호화 키 유효성의 절반\)으로 제한되어야 합니다.

\* TLS 1.2는 단일 세션 내에서 세션 키를 롤포워드하지 않습니다. 따라서 서버의 티켓 암호화 키를 훔쳐 세션의 전체 콘텐츠를 해독하는 데 사용되는 공격을 방지하기 위해\(순방향 비밀성 개념 부정\) TLS 1.2 서버는 너무 오래된 세션\(예: 세션\)을 재개해서는 안 됩니다. 두 번의 티켓 암호화 키 순환 기간보다 오랫동안 열려 있었던 티켓입니다.

이유: 세션 재개는 또 다른 종류의 TLS 핸드셰이크이므로 초기 핸드셰이크만큼 안전해야 합니다. 이 문서\(섹션 4\)에서는 순방향 비밀성을 제공하는 암호화 제품군의 사용을 권장합니다. 즉, TLS 엔드포인트\(클라이언트 또는 서버\)에 일시적으로 액세스하는 공격자가 과거 또는 미래의 통신을 읽지 못하도록 방지하는 암호화 제품군을 사용할 것을 권장합니다. 이 보안 속성이 무효화되지 않도록 티켓을 관리해야 합니다.

TLS 1.3은 주기적으로 재개되는 장기 연결 내에서도 강력한 전달 보안 옵션을 제공합니다. \[RFC8446\]의 섹션 2.2에서는 클라이언트가 세션 재개를 시작할 때 "key\_share"를 보내야 한다고 권장합니다. 순방향 비밀성을 확보하기 위해 이 문서에서는 서버 구현이 "psk\_dhe\_ke" PSK 키 교환 모드를 선택하고 "key\_share"로 응답하여 각 세션 재개 시 ECDHE\(Ephemeral Elliptic Curve Diffie-Hellman\) 교환을 완료해야 한다고 권장합니다. 보다 성능이 뛰어난 대안으로, 서버 구현은 마지막 ECDHE 교환 이후 특정 시간\(예: 시간 단위로 측정\)이 지날 때까지 "key\_share"로 응답하는 것을 삼가할 수 있습니다. 이는 예상되는 대부분의 세션 재개 요청\(몇 시간 내에 발생\)에 대해 "key\_share" 작업이 발생하지 않는 동시에 더 오래 지속되는 세션에 대해 순방향 보안을 보장한다는 것을 의미합니다.

TLS 세션 재개는 경우에 따라 서버가 클라이언트를 무기한 추적할 수 있는 잠재적인 개인 정보 보호 문제를 야기합니다. 자세한 내용은 \[Sy2018\]을 참조하세요.

---
### **3.5.  Renegotiation in TLS 1.2**

재협상이 TLS 1.3에서 제거되었으므로 이 섹션의 권장 사항은 TLS 1.2에만 적용됩니다.

TLS 1.2의 재협상은 기존 세션에 대한 새로운 암호화 매개변수를 설정하는 핸드셰이크입니다. 이 메커니즘은 TLS 1.2 및 이전 프로토콜 버전에 존재했으며 일반 텍스트 삽입 공격인 CVE-2009-3555\[CVE\]를 포함한 여러 주요 공격 이후 개선되었습니다.

TLS 1.2 클라이언트와 서버는 \[RFC5746\]에 정의된 대로 renegotiation\_info 확장을 구현해야 합니다.

TLS 1.2 클라이언트는 클라이언트 Hello에서 renegotiation\_info를 보내야 합니다. 서버가 확장을 승인하지 않으면 클라이언트는 연결을 종료하기 전에 치명적인 handshake\_failure 경고를 생성해야 합니다.

근거: 두 끝점이 실제로 재협상을 구현하는지 여부에 관계없이 클라이언트가 renegotiation\_info를 지원하지 않는 TLS 1.2 서버에 연결하는 것은 안전하지 않습니다. \[RFC5746\]의 섹션 4.1도 참조하세요.

TLS 세션 매개변수가 제대로 인증되지 않아 발생하는 관련 공격은 Triple Handshake\[Triple-Handshake\]입니다. 이 공격을 해결하려면 TLS 1.2 구현은 \[RFC7627\]에 정의된 Extended\_master\_secret 확장을 지원해야 합니다.

---
### **3.6.  Post-Handshake Authentication**

TLS 1.2의 재협상은 TLS 1.3에서 별도의 사후 핸드셰이크 인증 및 키 업데이트 메커니즘으로 \(부분적으로\) 대체되었습니다. 단일 연결을 통해 요청을 다중화하는 프로토콜\(예: HTTP/2 \[RFC9113\]\)의 컨텍스트에서 핸드셰이크 후 인증에는 TLS 1.2 재협상과 동일한 문제가 있습니다. 다중화 프로토콜은 \[RFC9113\]의 섹션 9.2.3에서 HTTP/2에 대해 제공된 조언을 따라야 합니다.

---
### **3.7.  Server Name Indication (SNI)**

TLS 구현은 HTTPS를 포함하여 이를 통해 이점을 얻을 수 있는 상위 수준 프로토콜에 대해 \[RFC6066\]의 섹션 3에 정의된 SNI\(서버 이름 표시\) 확장을 지원해야 합니다. 그러나 특정 상황에서 SNI의 실제 사용은 지역 정책의 문제입니다. 이 글을 쓰는 시점에서 SNI를 암호화하는 기술\(암호화된 클라이언트 Hello라고 함\)은 TLS 워킹 그룹\[TLS-ECH\]에서 작업 중입니다. 해당 방법이 표준화되고 널리 구현되면 이 BCP의 향후 버전에서 해당 방법을 사용하도록 권장하는 것이 적절할 것입니다.

근거: SNI는 단일 주소에 여러 개의 TLS로 보호되는 가상 서버 배포를 지원하므로 각 가상 서버가 자체 인증서를 갖도록 허용함으로써 이러한 가상 서버에 대한 세분화된 보안을 활성화합니다. 그러나 SNI는 특정 연결에 대한 대상 도메인도 유출합니다. 이 정보 유출은 TLS 암호화 클라이언트 Hello 방법이 표준화되면 이를 통해 종료됩니다.

\[ALPACA\]에 설명된 공격을 방지하기 위해 제시된 서버 이름을 인식하지 못하는 서버는 핸드셰이크를 계속해서는 안 되며 대신 치명적인 수준의 unrecognized\_name\(112\) 경고로 실패해야 합니다. 이 권장 사항은 다음과 같이 명시된 \[RFC6066\]의 섹션 3을 업데이트합니다.

| 서버가 ClientHello 확장을 이해했지만 이해하지 못한 경우 | 서버 이름을 인식하려면 서버는 둘 중 하나를 선택해야 합니다 | 작업: 치명적인 수준의 | 메시지를 전송하여 핸드셰이크를 중단하거나 | unrecognized\_name\(112\) 경고를 보내거나 핸드셰이크를 계속하십시오.

서버가 SNI 확장을 승인하지만 클라이언트가 보낸 것과 다른 호스트 이름을 가진 인증서를 제시하는 경우 클라이언트는 핸드셰이크를 중단해야 합니다\(SHOULD\).

---
### **3.8.  Application-Layer Protocol Negotiation (ALPN)**

TLS 구현\(클라이언트 측 및 서버 측 모두\)은 ALPN\(Application-Layer Protocol Negotiation\) 확장 \[RFC7301\]을 지원해야 합니다.

한 프로토콜에서 사용하기 위한 메시지가 다른 프로토콜에서 사용하기 위한 메시지로 오인되지 않도록 보장하지 못하여 발생하는 "프로토콜 간" 공격을 방지하기 위해 서버는 \[의 섹션 3.2에 설명된 동작을 엄격하게 시행하는 것이 좋습니다. RFC7301\]:

| 서버가 클라이언트가 지원하는 프로토콜을 지원하지 않는 경우 | 광고하면 서버는 치명적인 | 'no\_application\_protocol' 경고.

서버가 ALPN 확장을 승인했지만 클라이언트 목록에서 프로토콜을 선택하지 않은 경우 클라이언트는 핸드셰이크를 중단해야 합니다. 그렇게 하지 않으면 \[ALPACA\]에 설명된 것과 같은 공격이 발생할 수 있습니다.

프로토콜 개발자는 해당 프로토콜에 대한 ALPN 식별자를 등록하는 것이 좋습니다. 이는 새로운 프로토콜과 잘 확립된 프로토콜 모두에 적용됩니다. 그러나 후자는 대규모 배포 기반을 가질 수 있으므로 잘 확립된 프로토콜에 대해 ALPN 식별자가 등록된 경우 ALPN 사용을 엄격하게 적용하는 것이 불가능할 수 있습니다.

---
### **3.9.  Multi-Server Deployment**

여러 서버 또는 서비스가 포함된 배포는 TLS에 대한 공격 표면의 크기를 증가시킬 수 있습니다. 두 가지 시나리오가 중요합니다.

1. 여러 서비스가 서로 다른 프로토콜\(예: HTTP 및 IMAP\)을 통해 동일한 도메인 이름을 처리하는 배포입니다. 이 경우 공격자는 연결 엔드포인트를 다른 프로토콜을 제공하는 서비스로 연결하고 프로토콜 간 공격을 수행할 수 있습니다. 크로스 프로토콜 공격에서 클라이언트와 서버는 서로 다른 프로토콜을 사용하고 있다고 생각하며, 한 프로토콜에서 보낸 메시지가 다른 프로토콜의 메시지로 해석되어 바람직하지 않은 영향을 미치는 경우 공격자가 이를 악용할 수 있습니다\(자세한 내용은 \[ALPACA\] 참조\). 이 클래스의 공격\). 이 위협을 완화하려면 서비스 제공업체는 ALPN을 배포해야 합니다\(섹션 3.8 참조\). 또한 가능한 한 동일한 도메인 이름을 처리하는 여러 서비스가 이 문서의 권장 사항과 일치하는 동등한 수준의 보안을 제공하도록 해야 합니다. 이러한 조치에는 여러 TLS 서버에 걸친 구성 처리와 해당 서버가 보유한 자격 증명의 손상으로부터 보호하는 것이 포함되어야 합니다.

1. 동일한 서비스를 제공하는 여러 서버가 서로 다른 TLS 구성을 갖는 배포. 이 경우 공격자는 보다 쉽게 ​​악용할 수 있는 TLS 구성을 사용하여 연결 엔드포인트를 서버에 연결할 수 있습니다\(이 공격 클래스에 대한 자세한 내용은 \[DROWN\] 참조\). 이러한 위협을 완화하기 위해 서비스 제공업체는 동일한 서비스를 제공하는 모든 서버가 이 문서의 권장 사항과 일치하는 동등한 수준의 보안을 제공하는지 확인해야 합니다.

---
### **3.10.  Zero Round-Trip Time (0-RTT) Data in TLS 1.3**

0-RTT 초기 데이터 기능은 TLS 1.3의 새로운 기능입니다. 특정 보안 속성의 잠재적인 비용으로 TLS 연결이 재개될 때 대기 시간이 줄어듭니다. 결과적으로 서버측과 클라이언트측 구현자의 특별한 주의가 필요합니다. 일반적으로 이는 TLS 라이브러리와 그 위의 프로토콜 계층으로 확장됩니다.

TLS를 통한 HTTP의 경우 지침은 \[RFC8470\]을 참조하세요.

TLS의 QUIC에 대해서는 \[RFC9001\]의 섹션 9.2를 참조하세요.

다른 프로토콜의 경우 \[RFC8446\]의 섹션 8 및 부록 E.5에 일반 지침이 제공됩니다. 부록 E.5를 바꿔 말하면, 0-RTT가 적절하고 안전한 시기를 명확히 하기 위해 문제의 애플리케이션 프로토콜에 대한 명시적 사양이 존재하지 않는 한 애플리케이션은 이 기능을 피해야 합니다. 이는 IETF RFC, 비IETF 표준 또는 비표준 프로토콜과 관련된 문서의 형태를 취할 수 있습니다.

---
## **4.  Recommendations: Cipher Suites**

TLS 1.2는 암호화 제품군 선택에 있어 상당한 유연성을 제공했습니다. 불행하게도 이러한 암호 제품군 중 일부의 보안은 시간이 지남에 따라 일부가 안전하지 않은 것으로 알려진 지점까지 저하되었습니다\(이것이 TLS 1.3이 이러한 유연성을 제한한 이유 중 하나입니다\). 서버를 잘못 구성하면 보안이 저하되거나 저하됩니다. 이 섹션에는 암호 제품군 선택 및 협상에 대한 권장 사항이 포함되어 있습니다.

---
### **4.1.  General Guidelines**

암호 분석이 향상됨에 따라 암호화 알고리즘은 시간이 지남에 따라 약화됩니다. 한때 강력하다고 간주되었던 알고리즘은 약해집니다. 결과적으로 약한 알고리즘을 사용하는 암호화 제품군은 단계적으로 폐지되고 보다 안전한 암호화 제품군으로 대체되어야 합니다. 이는 원하는 보안 속성이 계속 유지되도록 하는 데 도움이 됩니다. SSL/TLS는 20년 넘게 존재해 왔으며 SSL/TLS의 다양한 버전에서 권장되는 많은 암호화 제품군은 이제 약한 것으로 간주되거나 적어도 원하는만큼 강력하지 않은 것으로 간주됩니다. 따라서 이 섹션에서는 암호 제품군 선택에 관한 권장 사항을 현대화합니다.

\* 구현 시 NULL 암호화를 사용하여 암호 제품군을 협상하면 안 됩니다.

- 근거: NULL 암호화 제품군은 트래픽을 암호화하지 않으므로 기밀 서비스를 제공하지 않습니다. 연결에 액세스할 수 있는 네트워크의 모든 엔터티는 클라이언트와 서버가 교환하는 콘텐츠의 일반 텍스트를 볼 수 있습니다. 그럼에도 불구하고 이 문서에서는 소프트웨어가 테스트 및 디버깅에 유용할 수 있는 NULL 암호화 제품군을 구현하는 것을 권장하지 않습니다.

```text
   *  Implementations MUST NOT negotiate RC4 cipher suites.
```

- 근거: RC4 스트림 암호에는 \[RFC7465\]에 문서화된 대로 다양한 암호화 약점이 있습니다. DTLS는 이미 RC4 사용을 금지하고 있습니다.

\* 구현에서는 소위 "내보내기 수준" 암호화\(40비트 또는 56비트 보안 제공\)를 포함하여 112비트 미만의 보안을 제공하는 암호 제품군을 협상해서는 안 됩니다.

- 근거: \[RFC3766\]에 따르면 최소 112비트의 보안이 필요합니다. 40비트 및 56비트 보안\(소위 "수출 암호"에 있음\)은 오늘날 안전하지 않은 것으로 간주됩니다.

\* 구현 시 128비트 미만의 보안을 제공하는 알고리즘을 사용하는 암호 제품군을 협상해서는 안 됩니다.

- 근거: 112비트 이상, 128비트 미만의 보안을 제공하는 암호화 제품군은 현재 약한 것으로 간주되지 않습니다. 그러나 현재로서는 더 강력한 암호 제품군을 지원하는 것을 정당화할 만큼 유효 수명이 짧을 것으로 예상됩니다. 128비트 암호는 최소한 몇 년 동안 보안이 유지될 것으로 예상되며, 256비트 암호는 다음 근본적인 기술 혁신이 이루어질 때까지 보안이 유지될 것으로 예상됩니다. 소위 "중간 만남" 공격\[다중 암호화\]으로 인해 일부 레거시 암호 제품군\(예: 168비트 Triple DES\(3DES\)\)은 실제 키 길이보다 짧은 유효 키 길이를 갖습니다. 공칭 키 길이\(3DES의 경우 112비트\) 이러한 암호 제품군은 유효 키 길이에 따라 평가되어야 합니다.

\* 구현은 RSA 키 전송\(즉, "정적 RSA"\)을 기반으로 암호화 제품군을 협상해서는 안 됩니다.

- 이유: 문자열 "TLS\_RSA\_WITH\_\*"로 시작하는 값이 할당된 이러한 암호 제품군에는 특히 순방향 보안을 지원하지 않는다는 점과 같은 몇 가지 단점이 있습니다.

\* 구현은 임시가 아닌\(정적\) 유한 필드 DH\(Diffie-Hellman\) 키 계약을 기반으로 암호 제품군을 협상해서는 안 됩니다. 마찬가지로, 구현은 일시적이지 않은 타원 곡선 DH 키 합의를 협상해서는 안 됩니다.

- 이유: "TLS\_DH\_\*"라는 접두사가 붙은 값을 할당한 이전 암호 제품군에는 특히 순방향 보안을 지원하지 않는다는 점과 같은 몇 가지 단점이 있습니다. 후자\("TLS\_ECDH\_\*"\)도 순방향 비밀성이 부족하고 잘못된 곡선 공격을 받기 쉽습니다\[Jager2015\].

\* 구현에서는 순방향 비밀성을 제공하는 암호화 제품군을 지원하고 협상하는 것을 선호해야 합니다. 그러나 TLS 1.2 구현은 임시 유한 필드 Diffie-Hellman 키 계약\(예: "TLS\_DHE\_\*" 모음\)을 기반으로 암호 모음을 협상해서는 안 됩니다. 이는 구축의 알려진 취약성\(\[RACCOON\] 참조\)과 활용이 매우 제한된 \[RFC7919\] 사용을 포함하여 협상에 대한 제한으로 인해 정당화됩니다.

- 근거: 순방향 비밀성\(때때로 "완전한 순방향 비밀성"이라고도 함\)은 이전 세션 키로 암호화된 정보의 복구를 방지하여 공격이 성공할 때 과거 데이터를 해독할 수 있는 기간을 제한합니다. 자세한 내용은 섹션 7.3 및 7.4를 참조하십시오.

---
### **4.2.  Cipher Suites for TLS 1.2**

앞서 말한 고려 사항을 고려하여 다음 암호 제품군을 구현하고 배포하는 것이 권장됩니다.

```text
   *  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256

   *  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384

   *  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256

   *  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384
```

이는 AEAD\(Authenticated Encryption with Associated Data\) 알고리즘 \[RFC5116\]이므로 이러한 암호화 제품군은 TLS 1.2에서만 지원되고 이전 프로토콜 버전에서는 지원되지 않습니다.

일반적으로 이러한 제품군을 선호하려면 서버 소프트웨어에서 제품군의 순서를 명시적으로 구성해야 합니다. 서버 소프트웨어 구현이 기본적으로 이러한 제품군을 선호한다면 이상적일 것입니다.

일부 장치에는 CBC-MAC\(AES-CCM\)이 포함된 AES 카운터 모드가 지원되지만 AES-GCM\(AES Galois/Counter Mode\)은 지원되지 않으므로 암호화 제품군과 관련하여 앞서 언급한 권장 사항을 따를 수 없습니다. 공개 키 암호화를 전혀 지원하지 않는 장치도 있지만 이는 완전히 범위를 벗어납니다.

CBC\(암호 블록 체인\) 모드\(예: TLS\_ECDHE\_RSA\_WITH\_AES\_128\_CBC\_SHA256\)에서 작동하는 암호 제품군은 encrypt\_then\_mac 확장 \[RFC7366\]도 성공적으로 협상되지 않는 한 사용해서는 안 됩니다. 이 요구 사항은 클라이언트 및 서버 구현 모두에 적용됩니다.

TLS 피어 인증을 위해 ECDSA 서명을 사용할 때 구현 시 NIST 곡선 P-256을 사용하는 것이 좋습니다. 또한 예측 가능하거나 반복되는 nonce\(장기 서명 키를 노출할 수 있음\)를 방지하려면 \[RFC6979\]에 지정되고 \[RFC8446\]의 권장 사항에 따라 구현 시 "결정론적 ECDSA"를 구현하는 것이 좋습니다.

"결정론적 ECDSA" 구현은 결정론으로 인해 특정 부채널 및 결함 주입 공격에 취약할 수 있습니다. 문헌에 설명된 대부분의 결함 주입 공격은 장치에 대한 물리적 액세스를 가정하지만\(따라서 물리적 보안이 열악하거나 존재하지 않는 사물 인터넷\(IoT\) 배포와 더 관련이 있음\) 일부 공격은 원격으로 수행될 수 있습니다\[Poddebniak2017\]. , Rowhammer \[Kim2014\] 변형. 부채널 공격 및 오류 주입 공격이 문제가 되는 배포에서는 임의성과 결정성을 모두 결합한 구현 전략\(예: \[CFRG-DET-SIGS\]에 설명된 대로\)을 사용하여 서명을 성공적으로 추출하는 위험을 피할 수 있습니다. 열쇠.

---
#### **4.2.1.  Implementation Details**

클라이언트는 모든 서버에 대한 첫 번째 제안으로 TLS\_ECDHE\_RSA\_WITH\_AES\_128\_GCM\_SHA256을 포함해야 합니다. 서버는 첫 번째 제안이 아니더라도 제안될 때마다 약한 암호 모음보다 이 암호 모음을 선호해야 합니다\(MUST\). 물론 클라이언트는 AES-256을 사용하는 등 더 강력한 암호화 제품군을 자유롭게 제공할 수 있습니다. 그렇게 하는 경우 서버는 달리 선택할 설득력 있는 이유\(예: 심각하게 저하된 성능\)가 없는 한 더 강력한 암호 제품군을 선호해야 합니다.

TLS 권장 사항 \[RFC7525\]의 이전 버전에서는 이전 RFC 5246 구현 필수 암호 제품군인 TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA를 암시적으로 허용했습니다. 이 글을 쓰는 시점에서 이 암호 제품군은 아주 오래된 클라이언트를 제외하고는 추가적인 상호 운용성을 제공하지 않습니다. 순방향 비밀성을 제공하지 않는 다른 암호 제품군과 마찬가지로 구현은 이 암호 제품군을 지원해서는 안 됩니다. 다른 애플리케이션 프로토콜은 다른 암호화 제품군을 MTI\(필수 구현\)로 지정합니다.

\[RFC8422\]를 사용하면 클라이언트와 서버가 ECDH 매개변수\(곡선\)를 협상할 수 있습니다. 클라이언트와 서버 모두 "지원되는 타원 곡선 확장"\[RFC8422\]을 포함해야 합니다. 클라이언트와 서버는 NIST P-256\(secp256r1\) \[RFC8422\] 및 X25519\(x25519\) \[RFC7748\] 곡선을 지원해야 합니다. \[RFC8422\]는 압축되지 않은 포인트 형식을 제외한 모든 형식을 더 이상 사용하지 않습니다. 따라서 클라이언트가 ec\_point\_formats 확장을 보내는 경우 ECPointFormatList에는 "압축되지 않은" 단일 요소가 포함되어야 합니다.

---
### **4.3.  Cipher Suites for TLS 1.3**

이 문서에서는 TLS 1.3에 대한 암호화 제품군을 지정하지 않습니다. 암호 제품군 권장 사항은 \[RFC8446\]의 섹션 9.1을 참조하세요.

---
### **4.4.  Limits on Key Usage**

모든 암호에는 특정 키로 안전하게 보호할 수 있는 트래픽 양에 대한 상한이 있습니다. AEAD 암호화 제품군의 경우 각 키에 대해 두 가지 별도의 제한이 유지됩니다.

1. 기밀성 한계\(CL\), 즉 암호화할 수 있는 기록의 수.

1. 무결성 한계\(IL\), 즉 인증 실패가 허용되는 레코드 수.

후자는 DTLS\(및 QUIC\)에 적용되지만 TLS 자체에는 적용되지 않습니다. 왜냐하면 TLS 연결은 첫 번째 암호 해독 실패 시 끊어지기 때문입니다.

발신자가 CL에 접근할 때 구현은 세션 키를 회전하기 위해 새로운 핸드셰이크를 시작해야 합니다\(TLS 1.3에서는 설정된 세션에서 KeyUpdate 메시지를 전송하여 이를 달성할 수 있음\). 수신기가 IL에 도달하면 구현은 연결을 닫아야 합니다. 이러한 권장 사항은 모범 사례이지만 구현자는 계층 경계를 넘어 조정을 도입하지 않고 TLS/DTLS 위에 구축된 프로토콜에서 권장 사항을 달성하는 것이 항상 쉬운 것은 아니라는 점을 인식해야 합니다. 키 업데이트를 지원하기 위해 암호화 계층과 전송 계층 간의 QUIC에서 필요한 협력의 예는 \[RFC9001\]의 섹션 6을 참조하세요. 일반적으로 애플리케이션 프로토콜은 TLS/DTLS와의 상호 작용이 더 제한되어 있기 때문에 해당 메서드를 에뮬레이트하지 못할 수도 있습니다. 이러한 복잡성으로 인해 이러한 권장 사항은 필수가 아닙니다.

모든 TLS 1.3 암호 그룹의 경우 독자는 CL 및 IL 값에 대해 \[RFC8446\]의 섹션 5.5를 참조합니다. 모든 DTLS 1.3 암호 제품군의 경우 독자는 \[RFC9147\]의 섹션 4.5.3을 참조하세요.

이 문서에서 TLS 1.2 및 DTLS 1.2에 권장되는 모든 AES-GCM 암호화 제품군의 경우 CL은 해당 매개변수를 무작위, 부분적으로 암시적인 nonce에 적용되는 \[AEAD-LIMITS\] 섹션 6.1의 부등식에 연결하여 파생될 수 있습니다. 즉, TLS 1.2에서 사용되는 nonce 구성. 얻은 수치는 TLS 1.3의 수치보다 약간 높지만 두 버전 모두에 동일한 2^24.5 레코드 제한을 사용하는 것이 좋습니다.

DTLS 1.2에 권장되는 모든 AES-GCM 암호화 제품군의 경우 IL\(위에서 참조한 동일한 부등식에서 얻음\)은 2^28입니다.

---
### **4.5.  Public Key Length**

이 문서에서 권장하는 암호화 제품군을 사용할 때 TLS 핸드셰이크에는 일반적으로 두 개의 공개 키가 사용됩니다. 하나는 Diffie-Hellman 키 계약용이고 다른 하나는 서버 인증용입니다. 클라이언트 인증서가 사용되는 경우 세 번째 공개 키가 추가됩니다.

MODP\(모듈식 지수\) Diffie-Hellman 그룹\("DHE" 암호 그룹\)을 기반으로 하는 키 교환을 사용하려면 최소 2048비트의 DH 키 길이가 필요합니다.

근거: 다양한 이유로 인해 실제로 DH 키는 일반적으로 2의 거듭제곱인 길이로 생성됩니다\(예: 2^10 = 1024비트, 2^11 = 2048비트, 2^12 = 4096비트\). 1228비트의 DH 키는 대략 80비트 대칭 키\[RFC3766\]와 동일하므로 "DHE" 암호 제품군의 키보다 긴 키를 사용하는 것이 좋습니다. 1926비트의 DH 키는 대략 100비트 대칭 키\[RFC3766\]와 동일합니다. 2048비트의 DH 키\(112비트 대칭 키와 동일\)는 이 글을 쓰는 시점에서 \[NIST.SP.800-56A\]의 최신 개정판에서 허용하는 최소값입니다\(특히 해당 문서의 부록 D 참조\).

\[RFC3766\]에 언급된 대로 Weizmann Institute Relation Locator\(TWIRL\) 기계 \[TWIRL\]의 출현을 수정하면 1024비트 DH 키가 약 61비트의 등가 강도를 생성하고 2048비트 DH 키가 약 61비트를 생성한다는 것을 의미합니다. 92비트의 동등한 강도. Logjam 공격 \[Logjam\]은 1024비트 Diffie-Hellman 매개변수를 피해야 함을 추가로 보여줍니다.

ECDH 키와 관련하여 구현자는 "TLS\(전송 계층 보안\) 매개변수" 레지스트리\[IANA\_TLS\] 내의 IANA "TLS 지원 그룹" 레지스트리\(이전의 "EC 명명 곡선 레지스트리"\)를 참조하며 특히 "권장" 그룹. 224비트 미만의 곡선은 사용하면 안 됩니다. 이 권장 사항은 \[NIST.SP.800-56A\]의 최신 개정판과 일치합니다.

RSA를 사용할 때 서버는 공개 키에 대해 최소 2048비트 모듈러스를 갖춘 인증서를 사용하여 인증해야 합니다. 또한 SHA-256 해시 알고리즘의 사용을 권장하며 SHA-1 또는 MD5는 사용하면 안 됩니다. \[RFC9155\] \(자세한 내용은 이 글을 쓰는 당시의 현재 버전인 \[CAB-Baseline\]도 참조하세요.\) 1.8.4\)입니다. 클라이언트는 TLS 1.2에 정의된 "서명 알고리즘" 확장을 사용하여 SHA-256을 요청한다는 것을 서버에 표시해야 합니다. TLS 1.3의 경우 \[RFC8446\]에 동일한 요구 사항이 이미 지정되어 있습니다.

---
### **4.6.  Truncated HMAC**

구현은 \[RFC6066\]의 섹션 7에 정의된 Truncated HMAC 확장을 사용해서는 안 됩니다.

근거: 위에서 권장하는 AEAD 암호화 제품군에는 확장이 적용되지 않습니다. 그러나 대부분의 다른 TLS 암호화 제품군에는 적용됩니다. \[PatersonRS11\]에서는 그 사용이 안전하지 않은 것으로 나타났습니다.

---
## **5.  Applicability Statement**

이 문서의 권장 사항은 주로 오늘날 인터넷에서 TLS 및 DTLS와 함께 가장 일반적으로 사용되는 애플리케이션 프로토콜의 구현 및 배포에 적용됩니다. 예는 다음을 포함하지만 이에 국한되지는 않습니다.

\* TLS로 HTTP 트래픽을 보호하려는 웹 소프트웨어 및 서비스.

\* TLS를 사용하여 IMAP, POP3\(Post Office Protocol 버전 ​​3\) 또는 SMTP 트래픽을 보호하려는 이메일 소프트웨어 및 서비스.

\* TLS를 사용하여 XMPP\(Extensible Messaging and Presence Protocol\) 또는 IRC\(Internet Relay Chat\) 트래픽을 보호하려는 인스턴트 메시징 소프트웨어 및 서비스.

\* DTLS를 사용하여 SRTP\(Secure Realtime Transport Protocol\) 트래픽을 보호하려는 실시간 미디어 소프트웨어 및 서비스.

이 문서는 TLS 또는 DTLS를 사용하는 기존 애플리케이션 프로토콜에서 규정한 구현 및 배포 권장 사항\(예: 구현 필수 암호 제품군\)을 수정하지 않습니다. 이러한 애플리케이션 프로토콜을 사용하는 커뮤니티가 여기에서 권장하는 모범 사례와 일치하도록 TLS 또는 DTLS 사용을 현대화하려는 경우 기존 애플리케이션 프로토콜 정의를 명시적으로 업데이트해야 합니다\(예: \[RFC6120을 업데이트하는 \[RFC7590\]\) \]\).

인터넷 표준 프로세스 \[RFC2026\]를 통해 개발된 새로운 애플리케이션 프로토콜의 설계자는 그러한 적합성을 방해하는 설득력 있는 이유에 대한 문서를 제공하지 않는 한\(예: 지원이 부족한 제한된 장치에 대한 광범위한 배포\) 최소한 여기에서 권장되는 모범 사례를 준수해야 합니다. 필요한 알고리즘을 위해\).

여기에 제공된 많은 권장 사항은 TLS 1.3 핸드셰이크 프로토콜을 사용하는 한 QUIC에도 적용될 수 있지만 QUIC 및 기타 보안 전송 프로토콜은 이 문서의 범위를 벗어납니다. 특히 QUIC의 경우 독자는 \[RFC9001\]의 섹션 9.2를 참조하세요.

이 문서는 제한된 노드 네트워크\[RFC7228\]에서의 TLS 사용을 다루지 않습니다. 전력, 메모리, 처리 리소스에 심각한 제약이 있는 소형 장치에 대한 TLS 및 DTLS 프로파일링에 관한 권장 사항은 \[RFC7925\] 및 \[IOT-PROFILE\]을 참조하세요.

---
### **5.1.  Security Services**

이 문서는 다음을 달성하기 위해 TLS와의 통신을 보호하려는 청중을 위한 권장 사항을 제공합니다.

기밀성: 모든 애플리케이션 계층 통신은 의도된 수신자 외에는 누구도 해독할 수 없도록 암호화됩니다.

데이터 무결성: 전송 중인 통신에 대한 모든 변경 사항을 수신자가 감지할 수 있습니다.

인증: TLS 통신의 끝점은 통신하려는 엔터티로 인증됩니다.

인증과 관련하여 TLS는 통신에서 하나 또는 두 끝점 모두에 대한 인증을 가능하게 합니다. 기회주의적 보안 \[RFC7435\]의 맥락에서 TLS는 때때로 인증 없이 사용됩니다. 섹션 5.2에서 설명한 대로 기회주의적 보안에 대한 고려 사항은 이 문서의 범위에 포함되지 않습니다.

배포자가 이 문서에 제공된 권장 사항을 벗어나는 경우 앞서 언급한 보안 서비스 중 하나에 대한 액세스 권한을 상실할 수 있다는 점을 인식해야 합니다.

이 문서는 기밀 유지가 필요한 환경에만 적용됩니다. 전송 중인 데이터의 보안을 강화하는 알고리즘과 구성 옵션이 필요합니다.

또한 이 문서에서는 데이터 무결성 보호가 항상 배포 목표 중 하나라고 가정합니다. 무결성이 필요하지 않은 경우 애초에 TLS를 사용하는 것은 의미가 없습니다. 무결성 부족을 활용하여 기밀성을 깨뜨리는 기밀성 전용 보호에 대한 공격이 있습니다\(예를 들어 IPsec의 맥락에서 \[DegabrieleP07\] 참조\).

이 문서에서는 TLS 및 DTLS와 함께 인터넷에서 가장 일반적으로 사용되는 애플리케이션 프로토콜에 대해 설명합니다. 일반적으로 TLS 클라이언트와 TLS 서버 간의 모든 통신에는 위의 세 가지 보안 서비스가 모두 필요합니다. 이는 TLS 클라이언트가 웹 브라우저나 이메일 클라이언트와 같은 사용자 에이전트인 경우 특히 그렇습니다.

이 문서에서는 섹션 5.2에 설명된 사용 사례와 같이 위의 세 가지 속성 중 하나가 바람직하지 않은 드문 배포 시나리오를 다루지 않습니다. 기밀성이 필요하지 않은 또 다른 시나리오로, 각 트래픽 도메인을 담당하는 기관이 암호화되지 않은\(일반 텍스트\) 트래픽에 대한 전체 액세스를 요구하고 사용자가 협력하여 트래픽을 암호화되지 않은 상태로 전송하는 모니터링되는 네트워크를 고려하십시오.

---
### **5.2.  Opportunistic Security**

TLS 사용이 선택 사항인 몇 가지 중요한 시나리오가 있습니다. 즉, 클라이언트는 특정 서버에서 TLS를 사용할지 또는 일반 연결을 사용할지 여부를 동적으로\("기회주의적으로"\) 결정합니다. 종종 "기회주의적 보안"이라고 불리는 이 방식은 \[RFC7435\]에 자세히 설명되어 있으며 레거시 배포와의 하위 호환성을 원하는 경우가 많습니다.

이러한 시나리오에서 이 문서의 권장 사항 중 일부는 너무 엄격할 수 있습니다. 이를 준수하면 일반 텍스트로 대체될 수 있으며, 이는 오래된 프로토콜 버전이나 암호 제품군과 함께 TLS를 사용하는 것보다 더 나쁜 결과를 초래할 수 있기 때문입니다.

---
## **6.  IANA Considerations**

이 문서에는 IANA 작업이 없습니다.

---
## **7.  Security Considerations**

이 전체 문서에서는 TLS 프로토콜을 사용하는 애플리케이션에 직접 영향을 미치는 보안 관행에 대해 설명합니다. 이 섹션에는 TLS와 함께 사용되거나 TLS에 의해 사용되는 기술과 관련된 보다 광범위한 보안 고려 사항이 포함되어 있습니다. 자세한 내용은 TLS 1.3 \[RFC8446\], DTLS 1.3 \[RFC9147\], TLS 1.2 \[RFC5246\] 및 DTLS 1.2 \[RFC6347\]의 보안 고려 사항 섹션을 참조하세요.

---
### **7.1.  Host Name Validation**

애플리케이션 작성자는 일부 TLS 구현이 호스트 이름의 유효성을 검사하지 않는다는 점에 유의해야 합니다. 사용 중인 TLS 구현이 호스트 이름의 유효성을 검사하지 않는 경우 작성자는 자체 유효성 검사 코드를 작성하거나 다른 TLS 구현 사용을 고려해야 할 수도 있습니다.

호스트 이름 유효성 검사\(및 일반적으로 TLS 계층과 그 위에서 실행되는 프로토콜 간의 바인딩\)와 관련된 요구 사항은 프로토콜마다 다릅니다. HTTPS의 경우 이러한 요구 사항은 \[RFC9110\]의 섹션 4.3.3, 4.3.4 및 4.3.5에 정의되어 있습니다.

호스트 이름 검증은 모든 일반적인 TLS 사용 사례에서 보안에 중요합니다. 이것이 없으면 TLS는 인증서가 유효한지 확인하고 개인 키의 소유를 보장하지만 원하는 끝점에서 연결이 종료되는지는 보장하지 않습니다. TLS 컨텍스트의 일반 호스트 이름 유효성 검사에 관한 자세한 내용은 \[RFC6125\]를 참조하세요. 또한 해당 RFC에는 애플리케이션 프로토콜의 긴 목록이 포함되어 있으며 그 중 일부는 HTTPS와 매우 다른 정책을 구현합니다.

호스트 이름이 간접적이고 안전하지 않게 발견된 경우\(예: SRV 또는 메일 교환\(MX\) 레코드에 대한 일반 텍스트 DNS 쿼리를 통해\) 제시된 인증서와 일치하더라도 참조 식별자\[RFC6125\]로 사용하면 안 됩니다. 호스트 이름이 안전하게 발견된 경우 이 단서는 적용되지 않습니다\(자세한 논의는 \[RFC7673\] 및 \[RFC7672\] 참조\).

호스트 이름 검증은 일반적으로 리프 "최종 엔터티" 인증서에만 적용됩니다. 당연히 PKI의 맥락에서 적절한 인증을 보장하기 위해 애플리케이션 클라이언트는 \[RFC5280\]에 따라 전체 인증 경로를 확인해야 합니다.

---
### **7.2.  AES-GCM**

섹션 4.2에서는 AES-GCM 인증 암호화 알고리즘을 사용할 것을 권장합니다. TLS와 함께 사용할 때 AES-GCM에 특별히 적용되는 보안 고려 사항은 \[RFC5288\]의 섹션 6을 참조하세요.

---
#### **7.2.1.   Nonce Reuse in TLS 1.2**

AES-GCM nonce를 실수로 재사용하는 배포된 TLS 스택의 존재는 \[Boeck2016\]에 문서화되어 있으며 AES-GCM이 안전하지 않게 구현되어 AES-GCM 암호화 제품군을 사용하는 TLS 세션을 공격에 취약하게 만드는 실제 위험이 있음을 보여줍니다. \[Joux2006\]과 같은. \(\[CVE\] 레코드: CVE-2016-0270, CVE-2016-10213, CVE-2016-10212 및 CVE-2017-5933을 참조하세요.\)

이 문제는 모든 AEAD 암호화 제품군\(AES-GCM 포함\)에 대해 레코드 시퀀스 번호 및 공유 비밀에서 nonce를 생성하는 결정론적 방법을 적용하는 TLS 1.3에서 해결되었지만 TLS 1.2 구현은 여전히 ​​자체적으로 선택할 수 있습니다\(잠재적으로 안전하지 않음\). nonce 생성 방법.

따라서 \[RFC8446\] 섹션 5.3의 처음 두 단락에 설명된 대로 TLS 1.2 구현에서는 64비트 시퀀스 번호를 사용하여 GCM nonce의 nonce\_explicit 부분을 채우는 것이 좋습니다\(RECOMMENDED\). 이 강력한 권장 사항은 nonce\_explicit 필드를 채우기 위해 64비트 시퀀스 번호를 사용하는 것이 선택 사항임을 지정하는 \[RFC5288\]의 섹션 3을 업데이트합니다.

이 글을 쓰는 시점에는 AES-GCM-SIV \[RFC8452\]와 같은 임시 재사용 방지 알고리즘에 대해 정의된 암호화 제품군이 없다는 점에 유의하세요.

---
### **7.3.  Forward Secrecy**

순방향 비밀성\("완전 순방향 비밀성" 또는 "PFS"라고도 하며 \[RFC4949\]에 정의됨\)은 세션 키가 통신 당사자의 장기 키로만 암호화되는 암호화된 대화를 기록하는 공격자에 대한 방어입니다.

공격자가 나중에 특정 시점에 이러한 장기 키를 얻을 수 있다면 세션 키와 전체 대화가 해독될 수 있습니다.

TLS 및 DTLS의 맥락에서 이러한 장기 키 손상이 완전히 불가능한 것은 아닙니다. 예를 들어 다음과 같은 이유로 발생할 수 있습니다.

\* 클라이언트나 서버가 다른 공격 벡터의 공격을 받고 개인 키가 검색되었습니다.

\* 사전 삭제 없이 판매되었거나 폐기된 장치에서 검색된 장기 키입니다.

\* 장치에서 기본 키로 사용되는 장기 키 \[Heninger2012\].

\* CA와 같은 신뢰할 수 있는 제3자에 의해 생성된 후 나중에 강탈이나 손상을 통해 검색된 키입니다\[Soghoian2011\].

\* 암호화의 획기적인 발전 또는 길이가 부족한 비대칭 키 사용 \[Kleinjung2010\].

\* 시스템 관리자를 대상으로 한 사회공학 공격.

\* 부적절하게 보호된 백업에서 개인 키를 수집합니다.

순방향 비밀성은 공격자가 대화 후 일정 시간 동안 장기 키를 획득했더라도 공격자가 세션 키를 확인하는 것이 불가능하다는 것을 보장합니다. 또한 장기 키를 보유하고 있지만 대화 중에 수동적으로 남아 있는 공격자로부터 보호합니다.

순방향 비밀성은 일반적으로 Diffie-Hellman 체계를 사용하여 세션 키를 파생함으로써 달성됩니다. Diffie-Hellman 방식은 양 당사자가 개인 비밀을 유지하고 특정 순환 그룹에 대한 모듈식 전력으로 네트워크를 통해 매개변수를 전송하도록 합니다. 소위 이산 로그 문제\(DLP\)의 속성을 통해 당사자는 도청자 없이 세션 키를 파생할 수 있습니다. 충분히 큰 매개변수를 선택한 경우 현재 DLP에 대한 알려진 공격은 없습니다. Diffie-Hellman 방식의 변형은 원래 제안된 모듈러 연산 대신 타원 곡선을 사용합니다. 현재의 기술 상태를 고려할 때 타원 곡선 Diffie-Hellman은 유한 필드 Diffie-Hellman보다 더 효율적이고 더 짧은 키 길이를 허용하며 구현 오류에 대한 자유도가 더 낮은 것으로 보입니다.

불행하게도 TLS\_RSA\_WITH\_AES\_256\_CBC\_SHA256과 같이 순방향 비밀성을 제공하지 않는 많은 TLS/DTLS 암호 그룹이 정의되었습니다. 따라서 이 문서에서는 순방향 비밀성 전용 암호의 엄격한 사용을 옹호합니다.

---
### **7.4.  Diffie-Hellman Exponent Reuse**

성능상의 이유로 TLS 구현이 여러 연결에서 Diffie-Hellman 및 Elliptic Curve Diffie-Hellman 지수를 재사용하는 것은 드문 일이 아닙니다. 이러한 재사용은 심각한 보안 문제를 초래할 수 있습니다.

\* 지수가 너무 오랫동안\(경우에 따라 몇 시간 정도\) 재사용되는 경우 호스트에 대한 액세스 권한을 얻은 공격자가 이전 연결을 해독할 수 있습니다. 즉, 지수 재사용은 순방향 비밀성의 효과를 무효화합니다.

\* 지수를 재사용하는 TLS 구현은 알려진 공격을 피하기 위해 그룹 멤버십에 대해 수신한 DH 공개 키를 테스트해야 합니다. 이 영역에 대한 일반적인 지침은 \[NIST.SP.800-56A\]에서 제공되고 많은 프로토콜 구현에서 사용할 수 있지만 이러한 테스트는 작성 당시 TLS에서 표준화되지 않았습니다.

\* 특정 조건에서 정적 유한 필드 DH 키 또는 여러 연결에서 재사용되는 임시 유한 필드 DH 키를 사용하면 사용된 공유 비밀에 대한 타이밍 공격\(예: \[RACCOON\]에 설명된 공격\)이 발생할 수 있습니다. Diffie-Hellman 키 교환에서.

\* 피해자가 수신된 지점이 올바른 곡선에 있는지 확인하지 않으면 타원 곡선 DH에 대해 "잘못된 곡선" 공격이 실행될 수 있습니다. 피해자가 DH 비밀을 재사용하는 경우 공격자는 전체 비밀을 복구하기 위해 지점을 변경하는 조사를 반복할 수 있습니다\(\[Antipa2003\] 및 \[Jager2015\] 참조\).

이러한 문제를 해결하려면 다음을 수행하십시오.

\* TLS 구현은 정적 유한 필드 DH 키를 사용해서는 안 되며, 여러 연결에서 임시 유한 필드 DH 키를 재사용해서는 안 됩니다.

\* 타원 곡선 DH 키를 재사용하려는 서버 구현은 "안전 곡선" \[SAFECURVES\]\(예: X25519\)을 사용하거나 수신된 포인트에 대해 \[NIST.SP.800-56A\]에 설명된 검사를 수행해야 합니다.

---
### **7.5.  Certificate Revocation**

공통 공개 키 인증서 \[RFC5280\]의 해지 상태를 확인하는 문제에 대한 완전하고 효율적인 솔루션은 존재하지 않지만 다음 고려 사항 및 권장 사항은 인증서 해지와 관련된 현재 기술 상태를 나타냅니다.

\* 인증서 취소는 TLS 구현에 대한 공격 및 인증서가 잘못 발급된 경우를 복구할 때 중요한 도구입니다. TLS 구현은 해지된 인증서를 불신하는 전략을 구현해야 합니다.

\* CRL\(인증서 해지 목록\)은 해지 정보 배포를 위해 가장 널리 지원되는 메커니즘이지만 분할된 CRL 및 델타 CRL과 같은 해결 방법에도 불구하고 유용성을 제한하는 확장 문제가 있는 것으로 알려져 있습니다. 보다 현대적인 \[CRLite\] 및 후속 Let's Revoke \[LetsRevoke\]는 인증서 투명성 \[RFC9162\] 로그의 가용성과 공격적인 압축을 기반으로 구축되어 CRL 인프라의 실제 사용을 허용하지만 작성 당시에는 두 솔루션 모두 배포되지 않았습니다. 대규모 클라이언트 측 해지 처리를 위한 것입니다.

\* 웹 브라우저의 구성 데이터베이스에 폐기 목록을 포함하는 독점 메커니즘은 가장 많이 사용되는 소수의 웹 서버 이상으로 확장할 수 없습니다.

\* 기본 형태의 OCSP\(온라인 인증 상태 프로토콜\) \[RFC6960\]는 확장성과 개인 정보 보호 문제를 모두 나타냅니다. 또한 클라이언트는 일반적으로 "소프트 실패"합니다. 즉, OCSP 서버가 응답하지 않아도 TLS 연결을 중단하지 않습니다. \(단, 이는 OCSP 응답자가 오프라인 상태인 경우 서비스 거부 공격을 피하기 위한 해결 방법일 수 있습니다.\) 웹 PKI의 OCSP 배포 상태에 대한 최근 조사는 \[Chung18\]을 참조하세요.

\* 일반적으로 "OCSP 스테이플링"이라고 불리는 TLS 인증서 상태 요청 확장\(\[RFC6066\]의 섹션 8\)은 OCSP의 운영 문제를 해결합니다. 그러나 공격자가 기본 OCSP 응답에 대한 클라이언트의 요청을 간단히 무시할 수 있기 때문에 활성 경로 공격자가 있는 경우에는 여전히 효과적이지 않습니다.

\* \[RFC7633\]은 클라이언트가 인증서에 대해 고정된 OCSP 응답을 기대해야 하며 그러한 응답을 사용할 수 없는 경우 핸드셰이크\("하드 실패"\)를 중단해야 함을 나타내는 인증서 확장을 정의합니다.

\* TLS 1.2에서 사용되는 OCSP 스테이플링은 인증서 체인 내의 중간 인증서로 확장되지 않습니다. 다중 인증서 상태 확장 \[RFC6961\]은 이 단점을 해결하지만 거의 배포되지 않았으며 \[RFC8446\]에 의해 더 이상 사용되지 않습니다. 결과적으로 이 확장은 \[RFC7525\]에서 TLS 1.2에 권장되었지만 이 문서에서는 더 이상 권장되지 않습니다.

\* TLS 1.3\(\[RFC8446\]의 섹션 4.4.2.1\)은 CertificateEntry 구조에 대한 확장을 사용하여 OCSP 정보와 중간 인증서의 연결을 허용합니다. 그러나 많은 인증 기관\(CA\)이 CA 인증서에 대한 OCSP를 게시하지 않거나 수명이 너무 길어 유용하지 않은 OCSP 보고서를 게시하지 않기 때문에 이 기능을 사용하는 것은 여전히 ​​비실용적입니다.

\* CRL과 OCSP는 모두 상대적으로 안정적인 인터넷 연결에 의존하며 특정 종류의 노드에서는 사용하지 못할 수도 있습니다. 일반적인 예는 처음으로 부팅하기 위해 보안 연결을 설정해야 하는 새로 프로비저닝된 장치입니다.

TLS의 공개 키 인증서의 일반적인 사용 사례의 경우 서버는 현재의 기술 상태를 고려한 모범 사례이자 가능한 미래 솔루션의 기반으로 다음을 지원해야 합니다. OCSP \[RFC6960\] 및 정의된 status\_request 확장을 사용하는 OCSP 스테이플링 \[RFC6066\]에서. status\_request 확장을 포함하는 정확한 메커니즘은 TLS 1.2와 1.3에서 다릅니다. 로컬 정책에 따라 서버 운영자는 CA가 서버 및/또는 클라이언트 인증을 위해 필수 \[RFC7633\] 인증서를 발급하도록 요청할 수 있지만 이 접근 방식을 결정하기 전에 운영 조건을 검토하는 것이 좋습니다.

이 섹션의 고려 사항은 DANE\(DNS 기반 인증 of Named Entities\) TLSA 리소스 레코드\[RFC6698\]를 사용하여 서버가 TLS 연결에 사용하기에 적합하고 유효하다고 간주하는 인증서를 클라이언트에 알리는 시나리오에는 적용되지 않습니다.

---
## **8.  References**
---
### **8.1.  Normative References**

```text
   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC3766]  Orman, H. and P. Hoffman, "Determining Strengths For
              Public Keys Used For Exchanging Symmetric Keys", BCP 86,
              RFC 3766, DOI 10.17487/RFC3766, April 2004,
              <https://www.rfc-editor.org/info/rfc3766>.

   [RFC5246]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.2", RFC 5246,
              DOI 10.17487/RFC5246, August 2008,
              <https://www.rfc-editor.org/info/rfc5246>.

   [RFC5288]  Salowey, J., Choudhury, A., and D. McGrew, "AES Galois
              Counter Mode (GCM) Cipher Suites for TLS", RFC 5288,
              DOI 10.17487/RFC5288, August 2008,
              <https://www.rfc-editor.org/info/rfc5288>.

   [RFC5746]  Rescorla, E., Ray, M., Dispensa, S., and N. Oskov,
              "Transport Layer Security (TLS) Renegotiation Indication
              Extension", RFC 5746, DOI 10.17487/RFC5746, February 2010,
              <https://www.rfc-editor.org/info/rfc5746>.

   [RFC6066]  Eastlake 3rd, D., "Transport Layer Security (TLS)
              Extensions: Extension Definitions", RFC 6066,
              DOI 10.17487/RFC6066, January 2011,
              <https://www.rfc-editor.org/info/rfc6066>.

   [RFC6125]  Saint-Andre, P. and J. Hodges, "Representation and
              Verification of Domain-Based Application Service Identity
              within Internet Public Key Infrastructure Using X.509
              (PKIX) Certificates in the Context of Transport Layer
              Security (TLS)", RFC 6125, DOI 10.17487/RFC6125, March
              2011, <https://www.rfc-editor.org/info/rfc6125>.

   [RFC6176]  Turner, S. and T. Polk, "Prohibiting Secure Sockets Layer
              (SSL) Version 2.0", RFC 6176, DOI 10.17487/RFC6176, March
              2011, <https://www.rfc-editor.org/info/rfc6176>.

   [RFC6347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security Version 1.2", RFC 6347, DOI 10.17487/RFC6347,
              January 2012, <https://www.rfc-editor.org/info/rfc6347>.

   [RFC6979]  Pornin, T., "Deterministic Usage of the Digital Signature
              Algorithm (DSA) and Elliptic Curve Digital Signature
              Algorithm (ECDSA)", RFC 6979, DOI 10.17487/RFC6979, August
              2013, <https://www.rfc-editor.org/info/rfc6979>.

   [RFC7301]  Friedl, S., Popov, A., Langley, A., and E. Stephan,
              "Transport Layer Security (TLS) Application-Layer Protocol
              Negotiation Extension", RFC 7301, DOI 10.17487/RFC7301,
              July 2014, <https://www.rfc-editor.org/info/rfc7301>.

   [RFC7366]  Gutmann, P., "Encrypt-then-MAC for Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", RFC 7366, DOI 10.17487/RFC7366, September 2014,
              <https://www.rfc-editor.org/info/rfc7366>.

   [RFC7465]  Popov, A., "Prohibiting RC4 Cipher Suites", RFC 7465,
              DOI 10.17487/RFC7465, February 2015,
              <https://www.rfc-editor.org/info/rfc7465>.

   [RFC7627]  Bhargavan, K., Ed., Delignat-Lavaud, A., Pironti, A.,
              Langley, A., and M. Ray, "Transport Layer Security (TLS)
              Session Hash and Extended Master Secret Extension",
              RFC 7627, DOI 10.17487/RFC7627, September 2015,
              <https://www.rfc-editor.org/info/rfc7627>.

   [RFC7748]  Langley, A., Hamburg, M., and S. Turner, "Elliptic Curves
              for Security", RFC 7748, DOI 10.17487/RFC7748, January
              2016, <https://www.rfc-editor.org/info/rfc7748>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8422]  Nir, Y., Josefsson, S., and M. Pegourie-Gonnard, "Elliptic
              Curve Cryptography (ECC) Cipher Suites for Transport Layer
              Security (TLS) Versions 1.2 and Earlier", RFC 8422,
              DOI 10.17487/RFC8422, August 2018,
              <https://www.rfc-editor.org/info/rfc8422>.

   [RFC8446]  Rescorla, E., "The Transport Layer Security (TLS) Protocol
              Version 1.3", RFC 8446, DOI 10.17487/RFC8446, August 2018,
              <https://www.rfc-editor.org/info/rfc8446>.

   [RFC8996]  Moriarty, K. and S. Farrell, "Deprecating TLS 1.0 and TLS
              1.1", BCP 195, RFC 8996, DOI 10.17487/RFC8996, March 2021,
              <https://www.rfc-editor.org/info/rfc8996>.

   [RFC9147]  Rescorla, E., Tschofenig, H., and N. Modadugu, "The
              Datagram Transport Layer Security (DTLS) Protocol Version
              1.3", RFC 9147, DOI 10.17487/RFC9147, April 2022,
              <https://www.rfc-editor.org/info/rfc9147>.

   [RFC9155]  Velvindron, L., Moriarty, K., and A. Ghedini, "Deprecating
              MD5 and SHA-1 Signature Hashes in TLS 1.2 and DTLS 1.2",
              RFC 9155, DOI 10.17487/RFC9155, December 2021,
              <https://www.rfc-editor.org/info/rfc9155>.
```

---
### **8.2.  Informative References**

```text
   [AEAD-LIMITS]
              Günther, F., Thomson, M., and C. A. Wood, "Usage Limits on
              AEAD Algorithms", Work in Progress, Internet-Draft, draft-
              irtf-cfrg-aead-limits-05, 11 July 2022,
              <https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-
              aead-limits-05>.

   [ALPACA]   Brinkmann, M., Dresen, C., Merget, R., Poddebniak, D.,
              Müller, J., Somorovsky, J., Schwenk, J., and S. Schinzel,
              "ALPACA: Application Layer Protocol Confusion - Analyzing
              and Mitigating Cracks in TLS Authentication", 30th USENIX
              Security Symposium (USENIX Security 21), August 2021,
              <https://www.usenix.org/conference/usenixsecurity21/
              presentation/brinkmann>.

   [Antipa2003]
              Antipa, A., Brown, D. R. L., Menezes, A., Struik, R., and
              S. Vanstone, "Validation of Elliptic Curve Public Keys",
              Public Key Cryptography - PKC 2003, December 2003,
              <https://doi.org/10.1007/3-540-36288-6_16>.

   [Boeck2016]
              Böck, H., Zauner, A., Devlin, S., Somorovsky, J., and P.
              Jovanovic, "Nonce-Disrespecting Adversaries: Practical
              Forgery Attacks on GCM in TLS", May 2016,
              <https://eprint.iacr.org/2016/475.pdf>.

   [CAB-Baseline]
              CA/Browser Forum, "Baseline Requirements for the Issuance
              and Management of Publicly-Trusted Certificates",
              Version 1.8.4, April 2022,
              <https://cabforum.org/documents/>.

   [CFRG-DET-SIGS]
              Preuß Mattsson, J., Thormarker, E., and S. Ruohomaa,
              "Deterministic ECDSA and EdDSA Signatures with Additional
              Randomness", Work in Progress, Internet-Draft, draft-irtf-
              cfrg-det-sigs-with-noise-00, 8 August 2022,
              <https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-
              det-sigs-with-noise-00>.

   [Chung18]  Chung, T., Lok, J., Chandrasekaran, B., Choffnes, D.,
              Levin, D., Maggs, B., Mislove, A., Rula, J., Sullivan, N.,
              and C. Wilson, "Is the Web Ready for OCSP Must-Staple?",
              Proceedings of the Internet Measurement Conference 2018,
              DOI 10.1145/3278532.3278543, October 2018,
              <https://doi.org/10.1145/3278532.3278543>.

   [CRLite]   Larisch, J., Choffnes, D., Levin, D., Maggs, B., Mislove,
              A., and C. Wilson, "CRLite: A Scalable System for Pushing
              All TLS Revocations to All Browsers", 2017 IEEE Symposium
              on Security and Privacy (SP), DOI 10.1109/sp.2017.17, May
              2017, <https://doi.org/10.1109/sp.2017.17>.

   [CVE]      MITRE, "Common Vulnerabilities and Exposures",
              <https://cve.mitre.org>.

   [DegabrieleP07]
              Degabriele, J. and K. Paterson, "Attacking the IPsec
              Standards in Encryption-only Configurations", 2007 IEEE
              Symposium on Security and Privacy (SP '07),
              DOI 10.1109/sp.2007.8, May 2007,
              <https://doi.org/10.1109/sp.2007.8>.

   [DROWN]    Aviram, N., Schinzel, S., Somorovsky, J., Heninger, N.,
              Dankel, M., Steube, J., Valenta, L., Adrian, D.,
              Halderman, J., Dukhovni, V., Käsper, E., Cohney, S.,
              Engels, S., Paar, C., and Y. Shavitt, "DROWN: Breaking TLS
              using SSLv2", 25th USENIX Security Symposium (USENIX
              Security 16), August 2016,
              <https://www.usenix.org/conference/usenixsecurity16/
              technical-sessions/presentation/aviram>.

   [Heninger2012]
              Heninger, N., Durumeric, Z., Wustrow, E., and J. A.
              Halderman, "Mining Your Ps and Qs: Detection of Widespread
              Weak Keys in Network Devices", 21st Usenix Security
              Symposium, August 2012.

   [IANA_TLS] IANA, "Transport Layer Security (TLS) Parameters",
              <https://www.iana.org/assignments/tls-parameters>.

   [IOT-PROFILE]
              Tschofenig, H. and T. Fossati, "TLS/DTLS 1.3 Profiles for
              the Internet of Things", Work in Progress, Internet-Draft,
              draft-ietf-uta-tls13-iot-profile-05, 6 July 2022,
              <https://datatracker.ietf.org/doc/html/draft-ietf-uta-
              tls13-iot-profile-05>.

   [Jager2015]
              Jager, T., Schwenk, J., and J. Somorovsky, "Practical
              Invalid Curve Attacks on TLS-ECDH", Computer Security --
              ESORICS 2015, pp. 407-425,
              DOI 10.1007/978-3-319-24174-6_21, 2015,
              <https://doi.org/10.1007/978-3-319-24174-6_21>.

   [Joux2006] Joux, A., "Authentication Failures in NIST version of
              GCM", 2006, <https://csrc.nist.gov/csrc/media/projects/
              block-cipher-techniques/documents/bcm/comments/800-38-
              series-drafts/gcm/joux_comments.pdf>.

   [Kim2014]  Kim, Y., Daly, R., Kim, J., Fallin, C., Lee, J. H., Lee,
              D., Wilkerson, C., Lai, K., and O. Mutlu, "Flipping Bits
              in Memory Without Accessing Them: An Experimental Study of
              DRAM Disturbance Errors", DOI 10.1109/ISCA.2014.6853210,
              July 2014, <https://users.ece.cmu.edu/~yoonguk/papers/kim-
              isca14.pdf>.

   [Kleinjung2010]
              Kleinjung, T., Aoki, K., Franke, J., Lenstra, A., Thomé,
              E., Bos, J., Gaudry, P., Kruppa, A., Montgomery, P.,
              Osvik, D., te Riele, H., Timofeev, A., and P. Zimmermann,
              "Factorization of a 768-Bit RSA Modulus", Advances in
              Cryptology - CRYPTO 2010, pp. 333-350,
              DOI 10.1007/978-3-642-14623-7_18, 2010,
              <https://doi.org/10.1007/978-3-642-14623-7_18>.

   [LetsRevoke]
              Smith, T., Dickinson, L., and K. Seamons, "Let's Revoke:
              Scalable Global Certificate Revocation", Proceedings 2020
              Network and Distributed System Security Symposium,
              DOI 10.14722/ndss.2020.24084, February 2020,
              <https://doi.org/10.14722/ndss.2020.24084>.

   [Logjam]   Adrian, D., Bhargavan, K., Durumeric, Z., Gaudry, P.,
              Green, M., Halderman, J., Heninger, N., Springall, D.,
              Thomé, E., Valenta, L., VanderSloot, B., Wustrow, E.,
              Zanella-Béguelin, S., and P. Zimmermann, "Imperfect
              Forward Secrecy: How Diffie-Hellman Fails in Practice",
              Proceedings of the 22nd ACM SIGSAC Conference on Computer
              and Communications Security, pp. 5-17,
              DOI 10.1145/2810103.2813707, October 2015,
              <https://doi.org/10.1145/2810103.2813707>.

   [Multiple-Encryption]
              Merkle, R. and M. Hellman, "On the security of multiple
              encryption", Communications of the ACM, Vol. 24, Issue 7,
              pp. 465-467, DOI 10.1145/358699.358718, July 1981,
              <https://doi.org/10.1145/358699.358718>.

   [NIST.SP.800-56A]
              National Institute of Standards and Technology,
              "Recommendation for Pair-Wise Key-Establishment Schemes
              Using Discrete Logarithm Cryptography", Revision 3, NIST
              Special Publication 800-56A,
              DOI 10.6028/NIST.SP.800-56Ar3, April 2018,
              <https://doi.org/10.6028/NIST.SP.800-56Ar3>.

   [PatersonRS11]
              Paterson, K., Ristenpart, T., and T. Shrimpton, "Tag Size
              Does Matter: Attacks and Proofs for the TLS Record
              Protocol", Proceedings of the 17th International
              conference on The Theory and Application of Cryptology and
              Information Security, pp. 372-389,
              DOI 10.1007/978-3-642-25385-0_20, December 2011,
              <https://doi.org/10.1007/978-3-642-25385-0_20>.

   [Poddebniak2017]
              Poddebniak, D., Somorovsky, J., Schinzel, S., Lochter, M.,
              and P. Rösler, "Attacking Deterministic Signature Schemes
              using Fault Attacks", Conference: 2018 IEEE European
              Symposium on Security and Privacy,
              DOI 10.1109/EuroSP.2018.00031, April 2018,
              <https://eprint.iacr.org/2017/1014.pdf>.

   [POODLE]   US-CERT, "SSL 3.0 Protocol Vulnerability and POODLE
              Attack", October 2014,
              <https://www.us-cert.gov/ncas/alerts/TA14-290A>.

   [RACCOON]  Merget, R., Brinkmann, M., Aviram, N., Somorovsky, J.,
              Mittmann, J., and J. Schwenk, "Raccoon Attack: Finding and
              Exploiting Most-Significant-Bit-Oracles in TLS-DH(E)",
              30th USENIX Security Symposium (USENIX Security 21), 2021,
              <https://www.usenix.org/conference/usenixsecurity21/
              presentation/merget>.

   [RFC2026]  Bradner, S., "The Internet Standards Process -- Revision
              3", BCP 9, RFC 2026, DOI 10.17487/RFC2026, October 1996,
              <https://www.rfc-editor.org/info/rfc2026>.

   [RFC2246]  Dierks, T. and C. Allen, "The TLS Protocol Version 1.0",
              RFC 2246, DOI 10.17487/RFC2246, January 1999,
              <https://www.rfc-editor.org/info/rfc2246>.

   [RFC3261]  Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston,
              A., Peterson, J., Sparks, R., Handley, M., and E.
              Schooler, "SIP: Session Initiation Protocol", RFC 3261,
              DOI 10.17487/RFC3261, June 2002,
              <https://www.rfc-editor.org/info/rfc3261>.

   [RFC3602]  Frankel, S., Glenn, R., and S. Kelly, "The AES-CBC Cipher
              Algorithm and Its Use with IPsec", RFC 3602,
              DOI 10.17487/RFC3602, September 2003,
              <https://www.rfc-editor.org/info/rfc3602>.

   [RFC4346]  Dierks, T. and E. Rescorla, "The Transport Layer Security
              (TLS) Protocol Version 1.1", RFC 4346,
              DOI 10.17487/RFC4346, April 2006,
              <https://www.rfc-editor.org/info/rfc4346>.

   [RFC4347]  Rescorla, E. and N. Modadugu, "Datagram Transport Layer
              Security", RFC 4347, DOI 10.17487/RFC4347, April 2006,
              <https://www.rfc-editor.org/info/rfc4347>.

   [RFC4949]  Shirey, R., "Internet Security Glossary, Version 2",
              FYI 36, RFC 4949, DOI 10.17487/RFC4949, August 2007,
              <https://www.rfc-editor.org/info/rfc4949>.

   [RFC5077]  Salowey, J., Zhou, H., Eronen, P., and H. Tschofenig,
              "Transport Layer Security (TLS) Session Resumption without
              Server-Side State", RFC 5077, DOI 10.17487/RFC5077,
              January 2008, <https://www.rfc-editor.org/info/rfc5077>.

   [RFC5116]  McGrew, D., "An Interface and Algorithms for Authenticated
              Encryption", RFC 5116, DOI 10.17487/RFC5116, January 2008,
              <https://www.rfc-editor.org/info/rfc5116>.

   [RFC5280]  Cooper, D., Santesson, S., Farrell, S., Boeyen, S.,
              Housley, R., and W. Polk, "Internet X.509 Public Key
              Infrastructure Certificate and Certificate Revocation List
              (CRL) Profile", RFC 5280, DOI 10.17487/RFC5280, May 2008,
              <https://www.rfc-editor.org/info/rfc5280>.

   [RFC5321]  Klensin, J., "Simple Mail Transfer Protocol", RFC 5321,
              DOI 10.17487/RFC5321, October 2008,
              <https://www.rfc-editor.org/info/rfc5321>.

   [RFC6101]  Freier, A., Karlton, P., and P. Kocher, "The Secure
              Sockets Layer (SSL) Protocol Version 3.0", RFC 6101,
              DOI 10.17487/RFC6101, August 2011,
              <https://www.rfc-editor.org/info/rfc6101>.

   [RFC6120]  Saint-Andre, P., "Extensible Messaging and Presence
              Protocol (XMPP): Core", RFC 6120, DOI 10.17487/RFC6120,
              March 2011, <https://www.rfc-editor.org/info/rfc6120>.

   [RFC6698]  Hoffman, P. and J. Schlyter, "The DNS-Based Authentication
              of Named Entities (DANE) Transport Layer Security (TLS)
              Protocol: TLSA", RFC 6698, DOI 10.17487/RFC6698, August
              2012, <https://www.rfc-editor.org/info/rfc6698>.

   [RFC6797]  Hodges, J., Jackson, C., and A. Barth, "HTTP Strict
              Transport Security (HSTS)", RFC 6797,
              DOI 10.17487/RFC6797, November 2012,
              <https://www.rfc-editor.org/info/rfc6797>.

   [RFC6960]  Santesson, S., Myers, M., Ankney, R., Malpani, A.,
              Galperin, S., and C. Adams, "X.509 Internet Public Key
              Infrastructure Online Certificate Status Protocol - OCSP",
              RFC 6960, DOI 10.17487/RFC6960, June 2013,
              <https://www.rfc-editor.org/info/rfc6960>.

   [RFC6961]  Pettersen, Y., "The Transport Layer Security (TLS)
              Multiple Certificate Status Request Extension", RFC 6961,
              DOI 10.17487/RFC6961, June 2013,
              <https://www.rfc-editor.org/info/rfc6961>.

   [RFC7228]  Bormann, C., Ersue, M., and A. Keranen, "Terminology for
              Constrained-Node Networks", RFC 7228,
              DOI 10.17487/RFC7228, May 2014,
              <https://www.rfc-editor.org/info/rfc7228>.

   [RFC7435]  Dukhovni, V., "Opportunistic Security: Some Protection
              Most of the Time", RFC 7435, DOI 10.17487/RFC7435,
              December 2014, <https://www.rfc-editor.org/info/rfc7435>.

   [RFC7457]  Sheffer, Y., Holz, R., and P. Saint-Andre, "Summarizing
              Known Attacks on Transport Layer Security (TLS) and
              Datagram TLS (DTLS)", RFC 7457, DOI 10.17487/RFC7457,
              February 2015, <https://www.rfc-editor.org/info/rfc7457>.

   [RFC7507]  Moeller, B. and A. Langley, "TLS Fallback Signaling Cipher
              Suite Value (SCSV) for Preventing Protocol Downgrade
              Attacks", RFC 7507, DOI 10.17487/RFC7507, April 2015,
              <https://www.rfc-editor.org/info/rfc7507>.

   [RFC7525]  Sheffer, Y., Holz, R., and P. Saint-Andre,
              "Recommendations for Secure Use of Transport Layer
              Security (TLS) and Datagram Transport Layer Security
              (DTLS)", BCP 195, RFC 7525, DOI 10.17487/RFC7525, May
              2015, <https://www.rfc-editor.org/info/rfc7525>.

   [RFC7568]  Barnes, R., Thomson, M., Pironti, A., and A. Langley,
              "Deprecating Secure Sockets Layer Version 3.0", RFC 7568,
              DOI 10.17487/RFC7568, June 2015,
              <https://www.rfc-editor.org/info/rfc7568>.

   [RFC7590]  Saint-Andre, P. and T. Alkemade, "Use of Transport Layer
              Security (TLS) in the Extensible Messaging and Presence
              Protocol (XMPP)", RFC 7590, DOI 10.17487/RFC7590, June
              2015, <https://www.rfc-editor.org/info/rfc7590>.

   [RFC7633]  Hallam-Baker, P., "X.509v3 Transport Layer Security (TLS)
              Feature Extension", RFC 7633, DOI 10.17487/RFC7633,
              October 2015, <https://www.rfc-editor.org/info/rfc7633>.

   [RFC7672]  Dukhovni, V. and W. Hardaker, "SMTP Security via
              Opportunistic DNS-Based Authentication of Named Entities
              (DANE) Transport Layer Security (TLS)", RFC 7672,
              DOI 10.17487/RFC7672, October 2015,
              <https://www.rfc-editor.org/info/rfc7672>.

   [RFC7673]  Finch, T., Miller, M., and P. Saint-Andre, "Using DNS-
              Based Authentication of Named Entities (DANE) TLSA Records
              with SRV Records", RFC 7673, DOI 10.17487/RFC7673, October
              2015, <https://www.rfc-editor.org/info/rfc7673>.

   [RFC7712]  Saint-Andre, P., Miller, M., and P. Hancke, "Domain Name
              Associations (DNA) in the Extensible Messaging and
              Presence Protocol (XMPP)", RFC 7712, DOI 10.17487/RFC7712,
              November 2015, <https://www.rfc-editor.org/info/rfc7712>.

   [RFC7919]  Gillmor, D., "Negotiated Finite Field Diffie-Hellman
              Ephemeral Parameters for Transport Layer Security (TLS)",
              RFC 7919, DOI 10.17487/RFC7919, August 2016,
              <https://www.rfc-editor.org/info/rfc7919>.

   [RFC7924]  Santesson, S. and H. Tschofenig, "Transport Layer Security
              (TLS) Cached Information Extension", RFC 7924,
              DOI 10.17487/RFC7924, July 2016,
              <https://www.rfc-editor.org/info/rfc7924>.

   [RFC7925]  Tschofenig, H., Ed. and T. Fossati, "Transport Layer
              Security (TLS) / Datagram Transport Layer Security (DTLS)
              Profiles for the Internet of Things", RFC 7925,
              DOI 10.17487/RFC7925, July 2016,
              <https://www.rfc-editor.org/info/rfc7925>.

   [RFC8452]  Gueron, S., Langley, A., and Y. Lindell, "AES-GCM-SIV:
              Nonce Misuse-Resistant Authenticated Encryption",
              RFC 8452, DOI 10.17487/RFC8452, April 2019,
              <https://www.rfc-editor.org/info/rfc8452>.

   [RFC8461]  Margolis, D., Risher, M., Ramakrishnan, B., Brotman, A.,
              and J. Jones, "SMTP MTA Strict Transport Security (MTA-
              STS)", RFC 8461, DOI 10.17487/RFC8461, September 2018,
              <https://www.rfc-editor.org/info/rfc8461>.

   [RFC8470]  Thomson, M., Nottingham, M., and W. Tarreau, "Using Early
              Data in HTTP", RFC 8470, DOI 10.17487/RFC8470, September
              2018, <https://www.rfc-editor.org/info/rfc8470>.

   [RFC8879]  Ghedini, A. and V. Vasiliev, "TLS Certificate
              Compression", RFC 8879, DOI 10.17487/RFC8879, December
              2020, <https://www.rfc-editor.org/info/rfc8879>.

   [RFC9000]  Iyengar, J., Ed. and M. Thomson, Ed., "QUIC: A UDP-Based
              Multiplexed and Secure Transport", RFC 9000,
              DOI 10.17487/RFC9000, May 2021,
              <https://www.rfc-editor.org/info/rfc9000>.

   [RFC9001]  Thomson, M., Ed. and S. Turner, Ed., "Using TLS to Secure
              QUIC", RFC 9001, DOI 10.17487/RFC9001, May 2021,
              <https://www.rfc-editor.org/info/rfc9001>.

   [RFC9051]  Melnikov, A., Ed. and B. Leiba, Ed., "Internet Message
              Access Protocol (IMAP) - Version 4rev2", RFC 9051,
              DOI 10.17487/RFC9051, August 2021,
              <https://www.rfc-editor.org/info/rfc9051>.

   [RFC9110]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
              Ed., "HTTP Semantics", STD 97, RFC 9110,
              DOI 10.17487/RFC9110, June 2022,
              <https://www.rfc-editor.org/info/rfc9110>.

   [RFC9112]  Fielding, R., Ed., Nottingham, M., Ed., and J. Reschke,
              Ed., "HTTP/1.1", STD 99, RFC 9112, DOI 10.17487/RFC9112,
              June 2022, <https://www.rfc-editor.org/info/rfc9112>.

   [RFC9113]  Thomson, M., Ed. and C. Benfield, Ed., "HTTP/2", RFC 9113,
              DOI 10.17487/RFC9113, June 2022,
              <https://www.rfc-editor.org/info/rfc9113>.

   [RFC9162]  Laurie, B., Messeri, E., and R. Stradling, "Certificate
              Transparency Version 2.0", RFC 9162, DOI 10.17487/RFC9162,
              December 2021, <https://www.rfc-editor.org/info/rfc9162>.

   [RFC9191]  Sethi, M., Preuß Mattsson, J., and S. Turner, "Handling
              Large Certificates and Long Certificate Chains in TLS-
              Based EAP Methods", RFC 9191, DOI 10.17487/RFC9191,
              February 2022, <https://www.rfc-editor.org/info/rfc9191>.

   [SAFECURVES]
              Bernstein, D. J. and T. Lange, "SafeCurves: choosing safe
              curves for elliptic-curve cryptography", December 2014,
              <https://safecurves.cr.yp.to>.

   [Soghoian2011]
              Soghoian, C. and S. Stamm, "Certified Lies: Detecting and
              Defeating Government Interception Attacks Against SSL",
              SSRN Electronic Journal, DOI 10.2139/ssrn.1591033, April
              2010, <https://doi.org/10.2139/ssrn.1591033>.

   [Springall16]
              Springall, D., Durumeric, Z., and J. Halderman, "Measuring
              the Security Harm of TLS Crypto Shortcuts", Proceedings of
              the 2016 Internet Measurement Conference, pp. 33-47,
              DOI 10.1145/2987443.2987480, November 2016,
              <https://doi.org/10.1145/2987443.2987480>.

   [STD53]    Myers, J. and M. Rose, "Post Office Protocol - Version 3",
              STD 53, RFC 1939, May 1996.

              <https://www.rfc-editor.org/info/std53>

   [Sy2018]   Sy, E., Burkert, C., Federrath, H., and M. Fischer,
              "Tracking Users across the Web via TLS Session
              Resumption", Proceedings of the 34th Annual Computer
              Security Applications Conference, pp. 289-299,
              DOI 10.1145/3274694.3274708, December 2018,
              <https://doi.org/10.1145/3274694.3274708>.

   [TLS-ECH]  Rescorla, E., Oku, K., Sullivan, N., and C. A. Wood, "TLS
              Encrypted Client Hello", Work in Progress, Internet-Draft,
              draft-ietf-tls-esni-15, 3 October 2022,
              <https://datatracker.ietf.org/doc/html/draft-ietf-tls-
              esni-15>.

   [Triple-Handshake]
              Bhargavan, K., Lavaud, A., Fournet, C., Pironti, A., and
              P. Strub, "Triple Handshakes and Cookie Cutters: Breaking
              and Fixing Authentication over TLS", 2014 IEEE Symposium
              on Security and Privacy, DOI 10.1109/sp.2014.14, May 2014,
              <https://doi.org/10.1109/sp.2014.14>.

   [TWIRL]    Shamir, A. and E. Tromer, "Factoring Large Numbers with
              the TWIRL Device", 2014 IEEE Symposium on Security and
              Privacy, DOI 10.1007/978-3-540-45146-4_1, 2004,
              <https://cs.tau.ac.il/~tromer/papers/twirl.pdf>.
```

---
# **Appendix A.  Differences from RFC 7525**

이번 모범 사례 개정판에는 수많은 변경 사항이 포함되어 있으며, 이 섹션에서는 규범적 변경 사항에 중점을 둡니다.

```text
   *  High-level differences:
```

- 새로운 TLS 통합 전송 프로토콜과 TLS에 계층화된 새로운 애플리케이션 프로토콜에 대한 기대를 설명했습니다.

- TLS 1.2에만 적용되는 항목\(예: 재협상\)을 명확히 했습니다.

- TLS 1.0 및 1.1의 상태를 "SHOULD NOT"에서 "MUST NOT"으로 변경했습니다.

- "SHOULD" 수준에 TLS 1.3을 추가했습니다.

- DTLS에도 유사한 변경이 이루어졌습니다.

- 다중화 프로토콜에 대한 특정 지침이 포함되었습니다.

- ALPN에 대한 MUST 수준 구현 요구 사항과 ALPN 및 SNI에 대한 보다 구체적인 SHOULD 수준 지침입니다.

- MUST 수준 권장 사항을 포함하여 엄격한 TLS 정책에 대한 논의를 명확히 했습니다.

- 키 사용이 제한됩니다.

- \[RFC7457\] 이후 새로운 공격: ALPACA, Raccoon, Logjam 및 "Nonce-Distrusting Adversaries".

- RFC 6961\(OCSP status\_request\_v2\)은 더 이상 사용되지 않습니다.

- 서버 측 RSA 인증서에 대한 MUST 수준 요구 사항은 최소 2048비트 모듈러스를 가져야 하며 "SHOULD"를 대체합니다.

\* TLS 1.2의 차이점:

- AES-GCM nonce 생성에 대한 수준의 지침을 제공해야 합니다.

- \(정적 또는 임시\) 유한 필드 DH 키 계약을 사용하면 안 됩니다.

- 여러 연결에서 임시 유한 필드 DH 키를 재사용해서는 안 됩니다.

```text
      -  SHOULD NOT use static Elliptic Curve DH key exchange.
```

- 2048비트 DH는 이제 "필수"이며 ECDH 최소 곡선 크기는 224입니다\(이전 192 대비\).

- Extended\_master\_secret에 대한 지원은 이제 "필수"입니다\(이전에는 RFC가 당시 게시되지 않았기 때문에 이는 소프트 권장 사항이었습니다\). 또한 더 복잡하고 관련된 다른 완화 조치도 제거되었습니다.

- 세션 티켓 유효성에 대한 MUST 수준 제한으로 "SHOULD"를 대체합니다.

- \[RFC5077\] 티켓 키의 순환 기간에 따라 TLS 세션 기간을 수준 제한해야 합니다.

- 권장 암호에서 TLS\_DHE\_RSA\_WITH\_AES를 삭제했습니다.

- 권장 암호에 TLS\_ECDHE\_ECDSA\_WITH\_AES를 추가했습니다.

- 이전 MTI 암호화 제품군인 TLS\_RSA\_WITH\_AES\_128\_CBC\_SHA를 사용하면 안 됩니다.

```text
      -  Recommended curve X25519 alongside NIST P-256.
```

\* TLS 1.3의 차이점:

```text
      -  New TLS 1.3 capabilities: 0-RTT.
```

- 제거된 기능: 재협상 및 압축.

- TLS 암호화 클라이언트 Hello에 대한 언급이 추가되었지만 완료될 때까지 사용이 권장되지 않습니다.

- TLS 1.3 세션 재개 시 순방향 보안에 대한 SHOULD 수준 요구 사항입니다.

- 특정 프로토콜에 대해 문서화되지 않은 경우 0-RTT를 방지하기 위한 일반적인 MUST 수준 지침입니다.

---
# **Acknowledgments**

Alexey Melnikov, Alvaro Retana, Andrei Popov, Ben Kaduk, Christian Huitema, Corey Bonnell, Cullen Jennings, Daniel Kahn Gillmor, David Benjamin, Eric Rescorla, Éric Vyncke, Francesca Palombini, Hannes Tschofenig, Hubert Kario, Ilari Liusvaara, John Preuß에게 감사드립니다. Mattsson, John R. Levine, Julien Élie, Lars Eggert, Leif Johansson, Magnus Westerlund, Martin Duke, Martin Thomson, Mohit Sahni, Nick Sullivan, Nimrod Aviram, Paul Wouters, Peter Gutmann, Rich Salz, Robert Sayre, Robert Wilton, Roman Danyliw, Ryan Sleevi, Sean Turner, Stephen Farrell, Tim Evans, Valery Smyslov, Viktor Dukhovni 및 Warren Kumari는 이 문서를 형성하는 데 도움이 되는 의견과 토론을 펼쳤습니다.

저자들은 TLS 권장 사항의 이전 버전인 RFC 7525의 공동 저자인 Ralph Holz의 기여에 감사를 표합니다.

TLS 권장 사항의 이전 버전과 관련된 추가 승인은 RFC 7525를 참조하세요.

---
# **Authors' Addresses**

```text
   Yaron Sheffer
   Intuit
   Email: yaronf.ietf@gmail.com

   Peter Saint-Andre
   Independent
   Email: stpeter@stpeter.im

   Thomas Fossati
   ARM Limited
   Email: thomas.fossati@arm.com
```