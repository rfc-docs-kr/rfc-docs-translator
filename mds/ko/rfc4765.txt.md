

```text
Network Working Group                                           H. Debar
Request for Comments: 4765                                France Telecom
Category: Experimental                                          D. Curry
                                                                Guardian
                                                            B. Feinstein
                                                       SecureWorks, Inc.
                                                              March 2007

        The Intrusion Detection Message Exchange Format (IDMEF)
```

---
# **Status of This Memo**

이 메모는 인터넷 커뮤니티를 위한 실험 프로토콜을 정의합니다. 어떤 종류의 인터넷 표준도 지정하지 않습니다. 개선을 위한 논의와 제안을 요청합니다. 이 메모의 배포는 무제한입니다.

---
# **Copyright Notice**

저작권\(C\) IETF 트러스트\(2007\).

---
# **IESG Note**

이 RFC의 내용은 한때 IETF에서 고려되었지만 작업 그룹은 이 작업이 표준 추적 프로토콜로 승인되기 전에 결론을 내렸습니다. 이 RFC는 어떤 수준의 인터넷 표준에도 적합하지 않습니다. IETF는 이 RFC가 어떤 목적으로든 적합하다는 사실을 전혀 알지 못하며, 특히 게시 결정은 보안, 혼잡 제어 또는 배포된 프로토콜과의 부적절한 상호 작용과 같은 사항에 대한 완전한 IETF 검토를 기반으로 하지 않는다는 점을 명시합니다. IESG는 작업 그룹이 결론을 내렸을 때의 작업을 문서화하고 기술의 실험과 개발을 장려하기 위해 이 문서를 출판하기로 결정했습니다. 이 RFC의 독자는 구현 및 배포에 대한 가치를 평가할 때 주의를 기울여야 합니다.

---
# **Abstract**

IDMEF\(침입 감지 메시지 교환 형식\)의 목적은 침입 감지 및 대응 시스템과 상호 작용해야 하는 관리 시스템에 관심 있는 정보를 공유하기 위한 데이터 형식과 교환 절차를 정의하는 것입니다.

이 문서에서는 침입 탐지 시스템에서 내보낸 정보를 나타내는 데이터 모델을 설명하고 이 모델을 사용하는 이유를 설명합니다. XML\(Extensible Markup Language\)의 데이터 모델 구현이 제시되고 XML 문서 유형 정의가 개발되며 예제가 제공됩니다.

---
# **Table of Contents**

```text
   1. Introduction ....................................................4
      1.1. About the IDMEF Data Model .................................4
           1.1.1. Problems Addressed by the Data Model ................5
           1.1.2. Data Model Design Goals .............................6
      1.2. About the IDMEF XML Implementation .........................7
           1.2.1. The Extensible Markup Language ......................7
           1.2.2. Rationale for Implementing IDMEF in XML .............8
   2. Notices and Conventions Used in This Document ..................10
   3. Notational Conventions and Formatting Issues ...................10
      3.1. IDMEF XML Documents .......................................10
           3.1.1. The Document Prolog ................................10
           3.1.2. Character Data Processing in IDMEF .................11
           3.1.3. Languages in IDMEF .................................12
      3.2. IDMEF Data Types ..........................................12
           3.2.1. Integers ...........................................12
           3.2.2. Real Numbers .......................................12
           3.2.3. Characters and Strings .............................13
           3.2.4. Bytes ..............................................14
           3.2.5. Enumerated Types ...................................14
           3.2.6. Date-Time Strings ..................................14
           3.2.7. NTP Timestamps .....................................16
           3.2.8. Port Lists .........................................16
           3.2.9. Unique Identifiers .................................17
   4. The IDMEF Data Model and DTD ...................................18
      4.1. Data Model Overview .......................................18
      4.2. The Message Classes .......................................20
           4.2.1. The IDMEF-Message Class ............................20
           4.2.2. The Alert Class ....................................20
           4.2.3. The Heartbeat Class ................................27
           4.2.4. The Core Classes ...................................29
           4.2.5. The Time Classes ...................................41
           4.2.6. The Assessment Classes .............................42
           4.2.7. The Support Classes ................................47
   5. Extending the IDMEF ............................................79
      5.1. Extending the Data Model ..................................79
      5.2. Extending the IDMEF DTD ...................................80
   6. Special Considerations .........................................81
      6.1. XML Validity and Well-Formedness ..........................81
      6.2. Unrecognized XML Tags .....................................82
      6.3. Analyzer-Manager Time Synchronization .....................82
      6.4. NTP Timestamp Wrap-Around .................................84
      6.5. Digital Signatures ........................................85
   7. Examples .......................................................85
      7.1. Denial-of-Service Attacks .................................86
           7.1.1. The "teardrop" Attack ..............................86
           7.1.2. The "ping of death" Attack .........................87
      7.2. Port Scanning Attacks .....................................88
           7.2.1. Connection to a Disallowed Service .................88
           7.2.2. Simple Port Scanning ...............................89
      7.3. Local Attacks .............................................90
           7.3.1. The "loadmodule" Attack ............................90
           7.3.2. The "phf" Attack ...................................93
           7.3.3. File Modification ..................................94
      7.4. System Policy Violation ...................................96
      7.5. Correlated Alerts .........................................98
      7.6. Analyzer Assessments ......................................99
      7.7. Heartbeat ................................................100
      7.8. XML Extension ............................................101
   8. The IDMEF Document Type Definition (Normative) ................104
   9. Security Considerations .......................................117
   10. IANA Considerations ..........................................118
      10.1. Adding Values to Existing Attributes ....................118
           10.1.1. Attribute Registrations ..........................119
           10.1.2. Registration Template ............................130
      10.2. Adding New Attributes and Classes .......................131
   11. References ...................................................131
      11.1. Normative References ....................................131
      11.2. Informative References ..................................132
   Appendix A.  Acknowledgements ....................................134
   Appendix B.  The IDMEF Schema Definition (Non-normative) .........135
```

---
## **1.  Introduction**

IDMEF\(침입 감지 메시지 교환 형식\)\[2\]는 자동화된 침입 감지 시스템이 의심스러운 이벤트에 대한 경고를 보고하는 데 사용할 수 있는 표준 데이터 형식으로 만들어졌습니다. 이 표준 형식의 개발을 통해 상업용, 오픈 소스 및 연구 시스템 간의 상호 운용성이 가능해지며 사용자는 이러한 시스템의 장점과 단점에 따라 배포를 혼합하여 최적의 구현을 얻을 수 있습니다.

IDMEF를 구현하는 가장 확실한 위치는 침입 탐지 분석기\(또는 "센서"\)와 경보를 보내는 관리자\(또는 "콘솔"\) 사이의 데이터 채널입니다. 그러나 IDMEF가 유용할 수 있는 다른 곳도 있습니다.

```text
   o  a single database system that could store the results from a
      variety of intrusion detection products would make it possible for
      data analysis and reporting activities to be performed on "the
      whole picture" instead of just a part of it;

   o  an event correlation system that could accept alerts from a
      variety of intrusion detection products would be capable of
      performing more sophisticated cross-correlation and cross-
      confirmation calculations than one that is limited to a single
      product;
```

o 다양한 침입 탐지 제품의 경고를 표시할 수 있는 그래픽 사용자 인터페이스를 통해 사용자는 단일 화면에서 모든 제품을 모니터링할 수 있으며 여러 인터페이스 대신 하나의 인터페이스만 배우면 됩니다. 그리고

o 공통 데이터 교환 형식을 사용하면 다양한 조직\(사용자, 공급업체, 대응 팀, 법 집행 기관\)이 데이터를 교환할 뿐만 아니라 이에 대해 통신하는 것도 더 쉬워집니다.

구현 방법을 선택할 때 IDMEF의 용도 다양성을 고려해야 합니다.

---
### **1.1.  About the IDMEF Data Model**

IDMEF 데이터 모델은 침입 탐지 분석기가 침입 탐지 관리자에게 보낸 경고 데이터를 객체 지향적으로 표현한 것입니다.

---
#### **1.1.1.  Problems Addressed by the Data Model**

데이터 모델은 침입 탐지 경고 데이터 표시와 관련된 몇 가지 문제를 해결합니다.

o 경고 정보는 본질적으로 이질적입니다. 일부 경고는 이벤트의 출발지, 목적지, 이름 및 시간과 같은 정보가 거의 없이 정의됩니다. 다른 경고는 포트나 서비스, 프로세스, 사용자 정보 등과 같은 훨씬 더 많은 정보를 제공합니다. 이 정보를 나타내는 데이터 모델은 다양한 요구 사항을 수용할 수 있도록 유연해야 합니다.

- 객체지향 모델은 집합\(aggregation\)과 서브클래싱\(subclassing\)을 통해 자연스럽게 확장 가능합니다. 데이터 모델의 구현이 집계 또는 하위 클래스화를 통해 새 클래스로 확장하는 경우 이러한 확장을 이해하지 못하는 구현은 여전히 ​​데이터 모델에 의해 정의된 정보의 하위 집합을 이해할 수 있습니다. 하위 클래스화 및 집계는 모델의 일관성을 유지하면서 확장성을 제공합니다.

o 침입 탐지 환경이 다릅니다. 일부 분석기는 네트워크 트래픽을 분석하여 공격을 탐지합니다. 다른 사람들은 운영 체제 로그나 애플리케이션 감사 추적 정보를 사용합니다. 서로 다른 정보 소스를 사용하는 분석기가 보낸 동일한 공격에 대한 경고에는 동일한 정보가 포함되지 않습니다.

- 데이터 모델은 분석기 간의 데이터 소스 차이를 수용하는 지원 클래스를 정의합니다. 특히 경고의 소스 및 대상 개념은 노드, 프로세스, 서비스 및 사용자 클래스의 조합으로 표현됩니다.

o 분석기 기능이 다릅니다. 에 따라

- 환경에서는 경고에 거의 정보를 제공하지 않는 경량 분석기를 설치하거나, ​​실행 중인 시스템에 더 큰 영향을 주지만 더 자세한 경고 정보를 제공하는 더 복잡한 분석기를 설치할 수 있습니다. 데이터 모델은 경보 정보를 추가로 처리할 목적으로 침입 탐지 분석기 이외의 도구에서 사용되는 형식으로의 변환을 허용해야 합니다.

- 데이터 모델은 단순하고 복잡한 경고를 모두 전달할 수 있는 기본 DTD\(문서 유형 정의\)에 대한 확장을 정의합니다. 확장은 새 클래스의 하위 클래스화 또는 연결을 통해 수행됩니다.

o 운영 환경이 다릅니다. 사용되는 네트워크 또는 운영 체제의 종류에 따라 공격은 서로 다른 특성으로 관찰되고 보고됩니다. 데이터 모델은 이러한 차이점을 수용해야 합니다.

- 노드 및 서비스 지원 클래스를 통해 보고에 있어 상당한 유연성이 제공됩니다. 추가 정보를 보고해야 하는 경우 추가 속성을 사용하여 데이터 모델을 확장하는 하위 클래스를 정의할 수 있습니다.

o 상업적 공급업체의 목표는 다릅니다. 여러 가지 이유로 공급업체는 특정 유형의 공격에 대해 더 많거나 적은 정보를 제공하기를 원할 수 있습니다.

- 객체 지향 접근 방식은 하위 클래스 규칙이 모델의 무결성을 유지하면서 이러한 유연성을 허용합니다.

---
#### **1.1.2.  Data Model Design Goals**

데이터 모델은 명확한 방식으로 경고의 표준 표현을 제공하고 단순 경고와 복잡한 경고 간의 관계를 설명할 수 있도록 설계되었습니다.

---
##### **1.1.2.1.  Representing Events**

데이터 모델의 목표는 침입 탐지 분석기가 비정상적인 이벤트 발생을 탐지할 때 보고하는 정보의 표준 표현을 제공하는 것입니다. 이러한 경고는 이를 생성하는 분석기의 기능에 따라 단순할 수도 있고 복잡할 수도 있습니다.

---
##### **1.1.2.2.  Content-Driven**

데이터 모델의 디자인은 콘텐츠 중심입니다. 이는 경고 간의 의미적 차이가 아니라 추가 콘텐츠를 수용하기 위해 새 개체가 도입되었음을 의미합니다. 컴퓨터 취약점을 분류하고 이름을 지정하는 작업은 매우 어렵고 주관적이므로 이는 중요한 목표입니다.

데이터 모델은 명확해야 합니다. 이는 분석기가 서로보다 다소 정확할 수 있도록 허용하지만\(예: 한 분석기가 다른 분석기보다 이벤트에 대해 더 많은 정보를 보고할 수 있음\) 동일한 이벤트를 설명하는 두 개의 경고에서 모순되는 정보를 생성하는 것을 허용하지 않습니다\(예: , 두 분석기에서 보고된 정보의 공통 하위 집합은 동일해야 하며 경고 데이터 구조 내의 동일한 자리 표시자에 삽입되어야 합니다. 물론, 특정 항목에 대한 모든 "흥미로운" 정보를 삽입하는 것은 항상 가능합니다.

이벤트가 속한 필드 대신 경고의 확장 필드에 이벤트가 발생합니다. 그러나 이러한 관행은 상호 운용성을 감소시키므로 가능하면 피해야 합니다.

---
##### **1.1.2.3.  Relationship between Alerts**

침입 탐지 경고는 여러 수준에서 전송될 수 있습니다. 이 문서는 매우 단순한 경고\(예: 실패한 로그인 보고서와 같은 시스템의 단일 작업 또는 작업의 결과인 경고\)부터 매우 복잡한 경고\(예: 여러 이벤트의 집계\)까지 전체 범위에 적용됩니다. 경고가 생성됩니다\).

따라서 데이터 모델은 여러 단순 경고를 집계하여 복잡한 경고 콘텐츠에서 이러한 단순 경고를 식별하는 복잡한 경고에 대한 방법을 제공해야 합니다.

---
### **1.2.  About the IDMEF XML Implementation**

IDMEF의 두 가지 구현은 원래 IDWG\(침입 감지 작업 그룹\)에 제안되었습니다. 하나는 SMI\(Structure of Management Information\)를 사용하여 SNMP\(Simple Network Management Protocol\) MIB를 설명하고 다른 하나는 DTD를 사용하여 XML 문서를 설명합니다. .

이러한 제안된 구현은 1999년 9월과 2000년 2월 회의에서 IDWG에 의해 검토되었습니다. 2월 회의에서는 XML 솔루션이 IDWG 요구 사항을 충족하는 데 가장 적합하다고 결정되었습니다.

---
#### **1.2.1.  The Extensible Markup Language**

XML\(Extensible Markup Language\) \[3\]은 ISO 8879 표준에 의해 정의된 텍스트 마크업을 지정하기 위한 구문인 SGML\(Standard Generalized Markup Language\)의 단순화된 버전입니다. XML은 인터넷에서 문서와 데이터를 표현하고 교환하기 위한 언어이자 HTML\(HyperText Markup Language\)에 내재된 대부분의 문제에 대한 솔루션으로 널리 주목을 받고 있습니다. XML은 1998년 2월 10일 W3C\(World Wide Web Consortium\)의 권장 사항으로 게시되었습니다.

XML은 응용 프로그램이 자체 마크업을 정의할 수 있도록 하는 메타언어\(다른 언어를 설명하는 언어\)입니다. XML을 사용하면 다양한 유형의 문서와 다양한 애플리케이션에 맞게 사용자 정의된 마크업 언어를 정의할 수 있습니다. 이는 특수한 용도에 맞게 "적응"되어야 하는 미리 설정된 의미를 가진 고정된 식별자 세트가 있다는 점에서 HTML과 다릅니다. XML과 HTML 모두 요소\(태그\)\('<' 및 '\>'로 구분된 식별자\)와 속성을 사용합니다.

\("이름='값'" 형식\). 그러나 "<p\>"가 HTML에서 항상 "단락"을 의미하는 경우 XML에서는 "단락", "사람", "가격" 또는 "오리너구리"를 의미할 수도 있고 특정 항목에 따라 전혀 의미가 없을 수도 있습니다. 애플리케이션.

참고: XML은 문서 마크업 및 구조를 선언하기 위한 구문\(예: 요소 및 속성 정의, 표시 순서 지정 등\)과 문서에서 해당 마크업을 사용하기 위한 구문을 모두 제공합니다. 마크업 선언은 마크업과 근본적으로 다르기 때문에 많은 사람들이 어떤 구문을 XML이라고 하는지 혼동합니다. 대답은 둘 다 사실이라는 것입니다. 둘 다 실제로 동일한 언어의 일부이기 때문입니다.

- 이 문서의 명확성을 위해 일반적인 경우에는 "XML" 및 "XML 문서"라는 용어를 사용하고, IDMEF 메시지를 설명하는 요소\(태그\) 및 속성을 구체적으로 말할 때는 "IDMEF 마크업"이라는 용어를 사용합니다.

XML이 출판된 후 World Wide Web Consortium은 XML 문서에서 네임스페이스 사용을 정의하는 두 번째 권장 사항\[4\]을 발표했습니다. XML 네임스페이스는 URI\(Uniform Resource Identifier\) ​​\[5\]로 식별되는 이름 모음입니다. 네임스페이스를 사용할 때 각 태그는 해당 태그가 나온 네임스페이스로 식별되므로 동일한 이름을 가진 다른 네임스페이스의 태그가 동일한 문서에 나타날 수 있습니다. 예를 들어 단일 문서에는 각각 서로 다른 의미를 갖는 "usa:football" 및 "europe:football" 태그가 모두 포함될 수 있습니다.

XML 네임스페이스의 광범위한 사용을 예상하여 이 메모에는 IDMEF 네임스페이스를 식별하는 데 사용되는 URI의 정의가 포함되어 있습니다.

---
#### **1.2.2.  Rationale for Implementing IDMEF in XML**

XML 기반 응용 프로그램은 다양한 분야의 전자 데이터 교환, 금융 데이터 교환, 전자 명함, 달력 및 일정 관리, 기업 소프트웨어 배포, 웹 "푸시" 기술, 마크업 등 다양한 목적으로 사용되거나 개발되고 있습니다. 화학, 수학, 음악, 분자 역학, 천문학, 도서 및 정기 간행물 출판, 웹 출판, 날씨 관측, 부동산 거래 등을 위한 언어입니다.

XML은 유연성이 뛰어나 이러한 응용 프로그램에 적합한 선택입니다. 동일한 유연성으로 인해 IDMEF를 구현하는 데에도 좋은 선택이 됩니다. IDMEF를 구현하기 위해 XML을 선택하는 기타 보다 구체적인 이유는 다음과 같습니다.

o XML을 사용하면 침입 탐지 경고를 설명하기 위한 목적으로 특별히 사용자 정의 언어를 개발할 수 있습니다. 또한 이 문서의 이후 개정판\("표준" 확장\) 또는 공급업체별 사용\("비표준" 확장\)을 위해 이 언어를 확장하는 표준 방법을 정의합니다.

o XML 문서 처리를 위한 소프트웨어 도구는 상용 및 오픈 소스 형식으로 널리 사용 가능합니다. XML 구문 분석 및/또는 유효성 검사를 위한 다양한 도구와 API가 Java, C, C++, Tcl, Perl, Python 및 GNU Emacs Lisp를 비롯한 다양한 언어로 제공됩니다. 도구에 대한 광범위한 액세스로 인해 제품 개발자는 IDMEF를 더 쉽고 빠르게 채택할 수 있을 것입니다.

o XML은 메시지 형식이 완전한 국제화 및 지역화를 지원하는 IDMEF 요구 사항 5.1 \[2\]을 충족합니다. XML 표준은 ISO/IEC 10646\(Universal Multiple-Octet Coded Character Set, "UCS"\) 및 유니코드의 UTF-8 및 UTF-16 인코딩에 대한 지원을 요구하므로 모든 XML 응용 프로그램\(따라서 모든 IDMEF 호환 응용 프로그램\)이 만들어집니다. 이러한 일반적인 문자 인코딩과 호환됩니다.

- 또한 XML은 요소별로 요소의 내용이 작성되는 언어를 지정하는 지원을 제공하므로 IDMEF를 제품의 "자연어 지원" 버전에 쉽게 적용할 수 있습니다.

o XML은 메시지 형식이 필터링 및 집계를 지원해야 하는 IDMEF 요구 사항 5.2 \[2\]를 충족합니다. 스타일 언어인 XSL과 XML의 통합을 통해 메시지를 결합하고, 삭제하고, 재배열할 수 있습니다.

o W3C 및 다른 곳에서 진행 중인 XML 개발 프로젝트는 객체 지향 확장, 데이터베이스 지원 및 기타 유용한 기능을 제공할 것입니다. XML로 구현된 경우 IDMEF는 이러한 기능도 즉시 얻습니다.

o XML은 무료이며 라이선스, 라이선스 비용, 로열티가 없습니다.

---
## **2.  Notices and Conventions Used in This Document**

이 문서의 키워드 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119 \[1\]에 설명된 대로 해석됩니다.\(MUST NOT\)

"IDMEF 호환 응용 프로그램"은 이 메모에서 지정한 형식으로 메시지를 읽거나 쓰는 분석기 또는 관리자와 같은 프로그램 또는 프로그램 구성 요소입니다.

"IDMEF 문서"는 이 메모에 지정된 요구 사항을 준수하고 둘 이상의 IDMEF 응용 프로그램에서 교환되는 메시지입니다. "IDMEF 메시지"는 "IDMEF 문서"의 또 다른 용어입니다.

---
## **3.  Notational Conventions and Formatting Issues**

이 문서에서는 데이터 모델을 설명하는 통합 모델링 언어\[14\], IDMEF 문서에 사용되는 마크업을 설명하는 XML, 문서 자체를 나타내는 IDMEF 마크업이라는 세 가지 표기법을 사용합니다.

---
### **3.1.  IDMEF XML Documents**

이 섹션에서는 IDMEF XML 문서 형식 지정 규칙을 설명합니다. 이러한 규칙의 대부분은 XML 문서 형식 지정 규칙에서 "상속"됩니다.

---
#### **3.1.1.  The Document Prolog**

IDMEF XML 문서 프롤로그의 형식은 다음 섹션에 설명되어 있습니다.

---
##### **3.1.1.1.  XML Declaration**

IDMEF 호환 응용 프로그램 간에 교환되는 IDMEF 문서는 반드시 XML 선언으로 시작해야 하며 사용 중인 XML 버전을 지정해야 합니다. 사용 중인 인코딩 지정을 권장합니다.\(MUST, SHOULD\)

따라서 IDMEF 메시지는 다음으로 시작해야 합니다.\(SHOULD\)

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef"/>
```

IDMEF 호환 응용 프로그램은 공간을 절약하기 위해 내부적으로 XML 선언을 생략하고 메시지가 다른 대상\(예: 웹 브라우저\)으로 전송될 때만 추가하도록 선택할 수 있습니다. 각 메시지의 버전 및 인코딩 정보가 손실되지 않고 수행될 수 없다면 이 방법은 권장되지 않습니다.\(MAY, SHOULD NOT\)

XML 문서가 유효하려면\(섹션 6.1 참조\) XML 문서에 문서 유형 정의가 포함되어야 합니다. 그러나 이는 소비하는 대역폭과 XML 프로세서에 대한 요구 사항\(선언 자체를 구문 분석할 뿐만 아니라 참조하는 DTD를 구문 분석하기 위해\) 모두에서 IDMEF 호환 응용 프로그램에 대한 상당한 오버헤드를 나타냅니다.

그러므로 구현자는 분석자와 관리자가 메시지 교환에 사용할 특정 문서 유형 정의\(여기에 정의된 표준 또는 확장이 포함된 정의\)에 대해 대역 외 합의를 하고 문서 유형을 생략하도록 결정할 수 있습니다. IDMEF 메시지의 정의. 본 계약의 협상 방법은 본 문서의 범위를 벗어납니다. 관리자는 각기 다른 확장 세트가 있는 DTD를 사용하는 여러 분석기로부터 메시지를 받아야 할 수 있으므로 이러한 계약을 협상할 때는 세심한 주의를 기울여야 합니다.\(MAY\)

---
#### **3.1.2.  Character Data Processing in IDMEF**

이식성 이유로 IDMEF 호환 응용 프로그램은 UTF-8 및 UTF-16 이외의 문자 인코딩을 사용해서는 안 되며 IDMEF 메시지는 인코딩되어서는 안 됩니다. XML 표준에 따라 IDMEF 메시지에 인코딩이 지정되지 않은 경우 UTF-8이 가정됩니다.\(SHOULD NOT\)

참고: ASCII 문자 집합은 UTF-8 인코딩의 하위 집합이므로 IDMEF 메시지를 인코딩하는 데 사용될 수 있습니다.

XML 표준에 따라 UTF-16으로 인코딩된 IDMEF 문서는 ISO/IEC 10646 Annex E 및 유니코드 부록 B에 설명된 바이트 순서 표시\("ZERO WIDTH NO-break SPACE" 문자, #xFEFF\)로 시작해야 합니다.\(MUST\)

---
##### **3.1.2.1.  Character Entity References**

IDMEF 호환 응용 프로그램은 항상 '&', ,'<', '\>', '"' 및 '''\(작은따옴표\) 문자의 엔터티 참조 형식\(섹션 3.2.3.1 참조\)을 사용하는 것이 좋습니다. 오해의 가능성을 피하기 위해 이러한 문자를 데이터에 기록합니다.\(SHOULD\)

---
##### **3.1.2.2.  White Space Processing**

모든 IDMEF 요소는 "xml:space" 속성을 지원해야 합니다.\(MUST\)

---
#### **3.1.3.  Languages in IDMEF**

IDMEF 호환 애플리케이션은 콘텐츠가 인코딩되는 언어를 지정해야 합니다. 일반적으로 이는 최상위 요소에 "xml:lang" 속성을 지정하고 다른 모든 요소가 해당 정의를 "상속"하도록 하여 수행할 수 있습니다\[10\].\(MUST\)

---
### **3.2.  IDMEF Data Types**

XML IDMEF 메시지 내에서 모든 데이터는 "바이너리"가 아닌 "텍스트"로 표현됩니다. XML은 텍스트 형식 언어이기 때문입니다. 그러나 데이터 모델의 클래스 속성에 대한 입력 정보를 제공하여 모델이 각 속성에 대해 기대하는 데이터 유형을 독자에게 전달합니다.

모델의 각 데이터 유형에는 XML IDMEF 메시지의 특정 형식 요구 사항이 있습니다. 이러한 요구 사항은 이 섹션에 명시되어 있습니다.

---
#### **3.2.1.  Integers**

정수 속성은 INTEGER 데이터 유형으로 표시됩니다. 정수 데이터는 Base 10 또는 Base 16으로 인코딩되어야 합니다.\(MUST\)

기본 10 정수 인코딩은 '0'부터 '9'까지의 숫자와 선택적 기호\('+' 또는 '-'\)를 사용합니다. 예를 들어 "123", "-456"입니다.

기본 16 정수 인코딩은 숫자 '0'\~'9' 및 'a'\~'f'\(또는 이에 상응하는 대문자\)를 사용하며 앞에 문자 "0x"가 옵니다. 예를 들어 "0x1a2b"입니다.

---
#### **3.2.2.  Real Numbers**

실수\(부동 소수점\) 속성은 REAL 데이터 유형으로 표시됩니다. 실제 데이터는 Base 10으로 인코딩되어야 합니다.\(MUST\)

실제 인코딩은 POSIX 1003.1 "strtod" 라이브러리 함수의 인코딩입니다. 선택적 기호\('+' 또는 '-'\) 뒤에 비어 있지 않은 십진수 문자열이 오고 선택적으로 기수 문자가 포함된 다음 선택적 지수 부분이 나옵니다. 지수 부분은 'e' 또는 'E', 선택적 기호, 하나 이상의 십진수로 구성됩니다. 예를 들어 "123.45e02", "-567,89e-03"입니다.

IDMEF 호환 애플리케이션은 '.' 및 ',' 기수 문자.\(MUST\)

---
#### **3.2.3.  Characters and Strings**

단일 문자 속성은 CHARACTER 데이터 유형으로 표시됩니다. 알려진 길이의 다중 문자 속성은 STRING 데이터 유형으로 표시됩니다.

문자 및 문자열 데이터에는 특수 문자를 나타내기 위해 때때로 문자 참조\(섹션 3.2.3.1 및 섹션 3.2.3.2 참조\)를 사용해야 하는 것 외에는 특별한 형식 지정 요구 사항이 없습니다.

---
##### **3.2.3.1.  Character Entity References**

XML 문서 내에서 특정 문자는 일부 상황에서 특별한 의미를 갖습니다. 이러한 컨텍스트 중 하나에 실제 문자 자체를 포함하려면 엔터티 참조라고 하는 특수 이스케이프 시퀀스를 사용해야 합니다.

때때로 이스케이프해야 하는 문자와 해당 엔터티 참조는 다음과 같습니다.

```text
                     +-----------+------------------+
                     | Character | Entity Reference |
                     +-----------+------------------+
                     |         & | &amp;            |
                     |           |                  |
                     |         < | &lt;             |
                     |           |                  |
                     |         > | &gt;             |
                     |           |                  |
                     |         " | &quot;           |
                     |           |                  |
                     |         ' | &apos;           |
                     +-----------+------------------+
```

---
##### **3.2.3.2.  Character Code References**

ISO/IEC 10646 및 유니코드 표준에 의해 정의된 모든 문자는 문자 참조를 사용하여 XML 문서에 포함될 수 있습니다. 문자 참조는 '&' 및 '#' 문자로 시작하고 ';' 문자로 끝납니다. 이 문자 사이에는 해당 문자의 문자 코드가 삽입됩니다.

```text
   If the character code is preceded by an 'x' it is interpreted in
   hexadecimal (base 16); otherwise, it is interpreted in decimal (base
   10).  For instance, the ampersand (&) is encoded as &#38; or &#x0026;
   and the less-than sign (<) is encoded as &#60; or &#x003C;.
```

ISO/IEC 10646 및 유니코드 표준에 지정된 1바이트, 2바이트 또는 4바이트 문자는 이 기술을 사용하여 문서에 포함될 수 있습니다.

---
#### **3.2.4.  Bytes**

이진 데이터는 BYTE\(및 BYTE\[\]\) 데이터 유형으로 표시됩니다.

바이너리 데이터는 반드시 base64를 사용하여 전체적으로 인코딩되어야 합니다.\(MUST\)

---
#### **3.2.5.  Enumerated Types**

열거 유형은 ENUM 데이터 유형으로 표시되며 허용되는 값의 순서가 지정된 목록으로 구성됩니다.

---
#### **3.2.6.  Date-Time Strings**

날짜-시간 문자열은 DATETIME 데이터 유형으로 표시됩니다. 각 날짜-시간 문자열은 특정 순간을 식별합니다. 범위는 지원되지 않습니다.

날짜-시간 문자열은 아래와 같이 ISO 8601: 2000 \[6\]의 하위 집합에 따라 형식이 지정됩니다. 괄호 안의 섹션 참조는 ISO 8601:2000 표준 \[6\]의 섹션을 나타냅니다.

1. 날짜는 다음과 같은 형식이어야 합니다.\(MUST\)

```text
          YYYY-MM-DD
```

- 여기서 YYYY는 4자리 연도, MM은 2자리 월\(01-12\), DD는 2자리 일\(01-31\)입니다. \(섹션 5.2.1.1, "완전한 표현 - 확장 형식".\)

2. 시간은 다음과 같은 형식이어야 합니다.\(MUST\)

```text
          hh:mm:ss
```

- 여기서 hh는 두 자리 시간\(00-24\), mm은 두 자리 분\(00-59\), ss는 두 자리 초\(00-60\)입니다. \(섹션 5.3.1.1, "완전한 표현 - 확장 형식".\)

자정에는 00:00:00과 2개의 표현이 있습니다.

- 24:00:00. 두 표현 모두 IDMEF 호환 애플리케이션에서 지원되어야 합니다. 그러나 가능할 때마다 00:00:00 표현을 사용해야 합니다.\(MUST\)

- 이 형식은 윤초를 설명합니다. 양의 윤초는 23:59:59Z와 24:00:00Z 사이에 삽입되며 23:59:60Z로 표시됩니다. 음의 윤초는 23:59:59Z를 생략하여 달성됩니다. IDMEF 호환 애플리케이션은 윤초를 지원해야 합니다.\(MUST\)

3. 시간은 다음과 같이 초의 소수 부분을 포함하도록 형식화될 수 있습니다.\(MAY\)

```text
          hh:mm:ss.ss or
          hh:mm:ss,ss
```

- 소수점 뒤에는 필요한 만큼의 숫자가 올 수 있습니다\(소수점 뒤에는 최소한 한 자리 이상 있어야 합니다\). 시간과 분의 소수 부분은 지원되지 않습니다. \(섹션 5.3.1.3, "소수 분수 표현".\)

- IDMEF 호환 애플리케이션은 소수점 기호\('.' 및 ','\)의 사용을 모두 지원해야 합니다.\(MUST\)

- 분수 부분의 자릿수는 정확성을 의미하지 않습니다. 즉, "00.100000", "00,1000" 및 "00.1"은 모두 동일합니다.

4. 시간은 \(a\) 시간이 UTC\(협정 세계시\)에 있다는 표시 또는 \(b\) 지정된 시간과 협정 세계시 간의 차이 표시를 포함하도록 형식화되어야 합니다.\(MUST\)

- \* UTC 시간은 다음과 같이 시간 문자열에 문자 'Z'를 추가하여 형식을 지정해야 합니다.\(MUST\)

```text
             hh:mm:ssZ
             hh:mm:ss.ssZ
             hh:mm:ss,ssZ

          (Section 5.3.3, "Coordinated Universal Time (UTC) -- Extended
          format".)
```

- \* 시간이 UTC보다 빠르거나 같은 경우 '+' 기호가 시간 문자열에 추가됩니다. 시간이 UTC보다 늦으면 '-' 기호가 추가됩니다. 기호 뒤에는 UTC와의 차이를 나타내는 시간과 분이 다음과 같이 추가됩니다.

```text
             hh:mm:ss+hh:mm
             hh:mm:ss-hh:mm
             hh:mm:ss.ss+hh:mm

             hh:mm:ss.ss-hh:mm
             hh:mm:ss,ss+hh:mm
             hh:mm:ss,ss-hh:mm
```

- 분 구성 요소가 0인 경우에도 UTC와의 차이는 시간과 분 모두로 지정되어야 합니다. "+00:00"의 "차이"는 UTC와 동일합니다. \(5.3.4.2절, "현지 시간 및 협정 세계시\(UTC\)와의 차이 - 확장 형식".\)\(MUST\)

5. 날짜-시간 문자열은 아래와 같이 날짜 및 시간 문자열을 문자 'T'와 결합하여 생성됩니다.

```text
          YYYY-MM-DDThh:mm:ssZ
          YYYY-MM-DDThh:mm:ss.ssZ
          YYYY-MM-DDThh:mm:ss,ssZ
          YYYY-MM-DDThh:mm:ss+hh:mm
          YYYY-MM-DDThh:mm:ss-hh:mm
          YYYY-MM-DDThh:mm:ss.ss+hh:mm
          YYYY-MM-DDThh:mm:ss.ss-hh:mm
          YYYY-MM-DDThh:mm:ss,ss+hh:mm
          YYYY-MM-DDThh:mm:ss,ss-hh:mm

       (Section 5.4.1, "Complete representation -- Extended format".)
```

요약하자면, IDMEF 날짜-시간 문자열은 위의 5항에서 식별된 9가지 템플릿 중 하나를 준수해야 합니다.\(MUST\)

---
#### **3.2.7.  NTP Timestamps**

NTP 타임스탬프는 NTPSTAMP 데이터 유형으로 표현되며 \[7\]과 \[8\]에 자세히 설명되어 있습니다. NTP 타임스탬프는 64비트 부호 없는 고정 소수점 숫자입니다. 정수 부분은 처음 32비트에 있고 분수 부분은 마지막 32비트에 있습니다.

IDMEF 메시지 내에서 NTP 타임스탬프는 마침표\('.'\)로 구분된 두 개의 32비트 16진수 값으로 인코딩되어야 합니다. 예를 들어 "0x12345678.0x87654321"입니다.\(MUST\)

NTP 타임스탬프에 대한 자세한 내용은 섹션 6.4를 참조하세요.

---
#### **3.2.8.  Port Lists**

포트 목록은 PORTLIST 데이터 유형으로 표시되며 쉼표로 구분된 숫자\(개별 정수\) 및 범위 목록으로 구성됩니다\(N-M은 포트 N에서 M까지를 의미함\). 숫자와 범위의 모든 조합을 단일 목록에 사용할 수 있습니다. 예: "5-25,37,42,43,53,69-119,123-514".

---
#### **3.2.9.  Unique Identifiers**

본 사양에는 두 가지 유형의 고유 식별자가 사용됩니다. 두 유형 모두 STRING 데이터 유형으로 표시됩니다.

이러한 식별자는 관련 XML 요소의 속성으로 구현되며 다음과 같이 고유한 값을 가져야 합니다.

1. 분석기 클래스\(섹션 4.2.4.1\) "analyzerid" 속성이 지정된 경우 침입 탐지 환경의 모든 분석기에서 고유한 값을 가져야 합니다.\(MUST\)

- "analyzerid" 속성은 전역적으로 고유할 필요는 없으며 분석기가 구성원으로 속해 있는 침입 탐지 환경 내에서만 고유해야 합니다. 서로 다른 침입 탐지 환경에 있는 두 개의 분석기가 "analyzerid"에 대해 동일한 값을 갖는 것이 허용됩니다.

- 기본값은 "0"이며, 이는 분석기가 고유 식별자를 생성할 수 없음을 나타냅니다.

2. 분석기가 메시지 식별자 생성을 지원하는 경우 경고 및 하트비트 메시지\(섹션 4.2.2, 4.2.3\)는 쌍\(analyzerid,messageid\)으로 고유하게 식별되어야 합니다.

3. 분류, 소스, 대상, 노드, 사용자, 프로세스, 서비스, 파일, 주소 및 UserId 클래스'\(섹션 4.2.4.2, 4.2.4.3, 4.2.4.4, 4.2.7.2, 4.2.7.3, 4.2.7.4 , 4.2.7.5, 4.2.7.6, 4.2.7.2.1 및 4.2.7.3.1\) "ident" 속성이 지정된 경우 개별 분석기가 보낸 모든 메시지에서 고유한 값을 가져야 합니다.\(MUST\)

- "ident" 속성 값은 각 개체가 아니라 개체를 식별하는 각 특정 데이터 조합에 대해 고유해야 합니다. 개체에는 둘 이상의 "ident" 값이 연결되어 있을 수 있습니다. 예를 들어, 이름으로 호스트를 식별하는 것은 하나의 값을 갖고, 주소로 호스트를 식별하는 것은 또 다른 값을 가지며, 이름과 주소로 호스트를 식별하는 것은 또 다른 값을 갖습니다. 또한, 서로 다른 분석기는 동일한 정보에 대해 서로 다른 값을 생성할 수 있습니다.\(MUST\)

- "ident" 속성은 그 자체로 특정 분석기가 전송한 모든 "ident" 값 중에서 고유한 식별자를 제공합니다. 그러나 분석기의 "analyzerid" 값과 결합하면 침입 탐지 환경 전체에서 고유한 값이 생성됩니다. 다시 말하지만 전역 고유성에 대한 요구 사항은 없습니다.

- 기본값은 "0"이며, 이는 분석기가 고유 식별자를 생성할 수 없음을 나타냅니다.

이러한 속성에 포함된 고유 값을 생성하는 방법의 사양은 이 문서의 범위를 벗어납니다.

---
## **4.  The IDMEF Data Model and DTD**

이 섹션에서는 IDMEF 데이터 모델의 개별 구성 요소에 대해 자세히 설명합니다. 모델의 UML\(Unified Modeling Language\) 다이어그램이 제공되어 구성 요소가 서로 어떻게 연관되어 있는지 보여주고, IDMEF DTD의 관련 섹션이 제공되어 모델이 XML로 변환되는 방식을 보여 줍니다.

---
### **4.1.  Data Model Overview**

데이터 모델의 주요 구성 요소 간의 관계는 그림 1에 나와 있습니다\(발생 표시기와 속성은 생략됨\).

모든 IDMEF 메시지의 최상위 클래스는 IDMEF-Message입니다. 각 메시지 유형은 이 최상위 클래스의 하위 클래스입니다. 현재 정의된 메시지에는 경고와 하트비트라는 두 가지 유형이 있습니다. 각 메시지 내에서 메시지 클래스의 하위 클래스는 메시지에 포함된 세부 정보를 제공하는 데 사용됩니다.

데이터 모델은 경고를 분류하거나 식별하는 방법을 지정하지 않는다는 점에 유의하는 것이 중요합니다. 예를 들어, 한 분석기는 포트 스캔을 여러 대상에 대한 단일 공격으로 식별하고, 다른 분석기는 이를 단일 소스의 여러 공격으로 식별할 수 있습니다. 그러나 분석기가 보내려는 경고 유형을 결정하면 데이터 모델은 해당 경고의 형식을 지정합니다.

```text
                         IDMEF-Message
                              /_\
                               |
          +--------------------+-------------+
          |                                  |
      +-------+   +--------------+    +-----------+   +----------------+
      | Alert |<>-|   Analyzer   |    | Heartbeat |<>-|    Analyzer    |
      +-------+   +--------------+    +-----------+   +----------------+
      |       |   +--------------+    |           |   +----------------+
      |       |<>-|  CreateTime  |    |           |<>-|   CreateTime   |
      |       |   +--------------+    |           |   +----------------+
      |       |   +--------------+    |           |   +----------------+
      |       |<>-|  DetectTime  |    |           |<>-| AdditionalData |
      |       |   +--------------+    +-----------+   +----------------+
      |       |   +--------------+
      |       |<>-| AnalyzerTime |
      |       |   +--------------+
      |       |   +--------+   +----------+
      |       |<>-| Source |<>-|   Node   |
      |       |   +--------+   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-|   User   |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-| Process  |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-| Service  |
      |       |   +--------+   +----------+
      |       |   +--------+   +----------+
      |       |<>-| Target |<>-|   Node   |
      |       |   +--------+   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-|   User   |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-| Process  |
      |       |   |        |   +----------+
      |       |   |        |   +----------+
      |       |   |        |<>-| Service  |       +----------------+
      |       |   |        |   +----------+  +----| Classification |
      |       |   |        |   +----------+  |    +----------------+
      |       |   |        |<>-|   File   |  |    +----------------+
      |       |   +--------+   +----------+  | +--|   Assessment   |
      |       |<>----------------------------+ |  +----------------+
      |       |<>------------------------------+  +----------------+
      |       |<>---------------------------------| AdditionalData |
      +-------+                                   +----------------+

                       Figure 1: Data Model Overview
```

---
### **4.2.  The Message Classes**

개별 클래스는 다음 섹션에 설명되어 있습니다.

---
#### **4.2.1.  The IDMEF-Message Class**

모든 IDMEF 메시지는 IDMEF-Message 클래스의 인스턴스입니다. 이는 IDMEF 데이터 모델과 IDMEF DTD의 최상위 클래스입니다. 현재 IDMEF 메시지에는 경고와 하트비트라는 두 가지 유형\(하위 클래스\)이 있습니다.

IDMEF-Message 클래스에는 다음과 같은 단일 속성이 있습니다.

```text
   version
```

- 이 메시지가 준수하는 IDMEF-Message 사양\(본 문서\)의 버전입니다. 이 속성의 값을 지정하는 애플리케이션은 "1.0" 값을 지정해야 합니다.\(MUST\)

---
#### **4.2.2.  The Alert Class**

일반적으로 분석기는 검색하도록 구성된 이벤트를 감지할 때마다 해당 관리자에게 경고 메시지를 보냅니다. 분석기에 따라 경고 메시지는 감지된 단일 이벤트 또는 감지된 여러 이벤트에 해당할 수 있습니다. 경고는 외부 이벤트에 대한 응답으로 비동기적으로 발생합니다.

그림 2에 표시된 것처럼 경고 메시지는 여러 집계 클래스로 구성됩니다. 집계 클래스 자체는 섹션 4.2.4, 섹션 4.2.5 및 섹션 4.2.6에 설명되어 있습니다.

```text
              +-------------------+
              |    Alert          |
              +-------------------+            +------------------+
              | STRING messageid  |<>----------|     Analyzer     |
              |                   |            +------------------+
              |                   |            +------------------+
              |                   |<>----------|    CreateTime    |
              |                   |            +------------------+
              |                   |            +------------------+
              |                   |<>----------|  Classification  |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |<>----------|    DetectTime    |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |<>----------|   AnalyzerTime   |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |<>----------|      Source      |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |<>----------|      Target      |
              |                   |            +------------------+
              |                   |       0..1 +------------------+
              |                   |<>----------|    Assessment    |
              |                   |            +------------------+
              |                   |       0..* +------------------+
              |                   |<>----------|  AdditionalData  |
              |                   |            +------------------+
              +-------------------+
                     /_\
                      |
                      +----+------------+-------------+
                           |            |             |
                +-------------------+   |   +-------------------+
                |     ToolAlert     |   |   |  CorrelationAlert |
                +-------------------+   |   +-------------------+
                                        |
                              +-------------------+
                              |   OverflowAlert   |
                              +-------------------+

                         Figure 2: The Alert Class
```

Alert를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Analyzer
```

- 딱 하나요. 경고를 발생시킨 분석기에 대한 식별 정보입니다.

```text
   CreateTime
```

- 딱 하나요. 경고가 생성된 시간입니다. 경고와 함께 제공될 수 있는 세 번 중에서 이것이 유일하게 필요한 것입니다.

```text
   Classification
```

- 딱 하나요. 경고의 "이름" 또는 관리자가 경고의 내용을 확인할 수 있는 기타 정보입니다.

```text
   DetectTime
```

- 0 아니면 1. 경고가 발생한 이벤트가 감지된 시간입니다. 이벤트가 2개 이상인 경우 첫 번째 이벤트가 감지된 시간입니다. 경우에 따라 이 값은 CreateTime과 동일하지 않을 수 있습니다.

```text
   AnalyzerTime
```

- 0 아니면 1. 분석기의 현재 시간\(섹션 6.3 참조\).

```text
   Source
```

- 0개 이상. 경고로 이어지는 이벤트의 소스입니다.

```text
   Target
```

- 0개 이상. 경고로 이어지는 이벤트의 대상입니다.

```text
   Assessment
```

- 0 아니면 1. 이벤트의 영향, 이에 대응하여 분석가가 취한 조치, 평가에 대한 분석가의 신뢰도에 대한 정보입니다.

```text
   AdditionalData
```

- 0개 이상. 데이터 모델에 맞지 않는 분석기에 포함된 정보입니다. 이는 원자 단위의 데이터일 수도 있고 IDMEF 확장을 통해 제공되는 대량의 데이터일 수도 있습니다\(섹션 5 참조\).

경고는 IDMEF DTD에 다음과 같이 표시됩니다.

```text
   <!ELEMENT Alert                         (
       Analyzer, CreateTime, DetectTime?, AnalyzerTime?,
       Source*, Target*, Classification, Assessment?, (ToolAlert |
       OverflowAlert | CorrelationAlert)?, AdditionalData*
     )>
   <!ATTLIST Alert
       messageid           CDATA                   '0'
       %attlist.global;
     >
```

Alert 클래스에는 다음과 같은 속성이 하나 있습니다.

```text
   messageid
```

- 선택사항입니다. 경고의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

---
##### **4.2.2.1.  The ToolAlert Class**

ToolAlert 클래스는 공격 도구 또는 트로이 목마와 같은 악의적인 프로그램의 사용과 관련된 추가 정보를 전달하며 분석기가 이러한 도구를 식별할 수 있을 때 사용할 수 있습니다. 이는 이전에 전송된 하나 이상의 경고를 함께 그룹화하여 "이러한 경고는 모두 누군가가 이 도구를 사용한 결과였습니다"라고 말하려는 의도입니다.

ToolAlert 클래스는 그림 3에 표시된 것처럼 세 가지 집계 클래스로 구성됩니다.

```text
             +------------------+
             |      Alert       |
             +------------------+
                     /_\
                      |
             +------------------+
             |    ToolAlert     |
             +------------------+            +-------------------+
             |                  |<>----------|        name       |
             |                  |            +-------------------+
             |                  |       0..1 +-------------------+
             |                  |<>----------|      command      |
             |                  |            +-------------------+
             |                  |       1..* +-------------------+
             |                  |<>----------|    alertident     |
             |                  |            +-------------------+
             |                  |            | STRING analyzerid |
             |                  |            +-------------------+
             +------------------+

                       Figure 3: The ToolAlert Class
```

ToolAlert를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

정확히 하나입니다. 끈. 경고를 그룹화하는 이유

- 예를 들어 특정 도구의 이름을 함께 사용합니다.

```text
   command
```

- 0 아니면 1. 끈. 도구가 수행하도록 요청받은 명령 또는 작업\(예: BackOrifice ping\)입니다.

```text
   alertident
```

-  하나 이상. 끈. 이 경고와 관련된 경고 식별자 목록입니다. 경고 식별자는 단일 분석기에서 보낸 경고 전체에서만 고유하므로 "alertident"의 선택적 "analyzerid" 특성을 사용하여 특정 경고가 발생한 분석기를 식별해야 합니다. "analyzerid"가 제공되지 않으면 경고는 ToolAlert를 보내는 동일한 분석기에서 발생한 것으로 가정됩니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT ToolAlert                     (
       name, command?, alertident+
     )>
   <!ATTLIST ToolAlert
       %attlist.global;
     >
```

---
##### **4.2.2.2.  The CorrelationAlert Class**

CorrelationAlert 클래스는 경고 정보의 상관 관계와 관련된 추가 정보를 전달합니다. 이는 이전에 전송된 하나 이상의 경고를 함께 그룹화하여 "이러한 경고는 모두 관련되어 있습니다"라고 표현하기 위한 것입니다.

CorrelationAlert 클래스는 그림 4에 표시된 것처럼 두 개의 집계 클래스로 구성됩니다.

```text
             +------------------+
             |      Alert       |
             +------------------+
                     /_\
                      |
             +------------------+
             | CorrelationAlert |
             +------------------+            +-------------------+
             |                  |<>----------|        name       |
             |                  |            +-------------------+
             |                  |       1..* +-------------------+
             |                  |<>----------|    alertident     |
             |                  |            +-------------------+
             |                  |            | STRING analyzerid |
             |                  |            +-------------------+
             +------------------+

                   Figure 4: The CorrelationAlert Class
```

CorrelationAlert를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

정확히 하나입니다. 끈. 경고를 그룹화하는 이유

- 예를 들어 특정 상관 방법을 함께 사용합니다.

```text
   alertident
```

-  하나 이상. 끈. 이 경고와 관련된 경고 식별자 목록입니다. 경고 식별자는 단일 분석기에서 보낸 경고 전체에서만 고유하므로 "alertident"의 선택적 "analyzerid" 특성을 사용하여 특정 경고가 발생한 분석기를 식별해야 합니다. "analyzerid"가 제공되지 않으면 CorrelationAlert를 보내는 동일한 분석기에서 경고가 발생한 것으로 가정됩니다.

이는 IDMEF DTD에 다음과 같이 표현됩니다.

```text
   <!ELEMENT CorrelationAlert              (
       name, alertident+
     )>
   <!ATTLIST CorrelationAlert
       %attlist.global;
     >
```

---
##### **4.2.2.3.  The OverflowAlert Class**

OverflowAlert는 버퍼 오버플로 공격과 관련된 추가 정보를 전달합니다. 이는 분석기가 오버플로 공격 자체에 대한 세부 정보를 제공할 수 있도록 하기 위한 것입니다.

OverflowAlert 클래스는 그림 5에 표시된 것처럼 세 가지 집계 클래스로 구성됩니다.

```text
                  +------------------+
                  |      Alert       |
                  +------------------+
                          /_\
                           |
                  +------------------+
                  |  OverflowAlert   |
                  +------------------+            +---------+
                  |                  |<>----------| program |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |<>----------| size    |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |<>----------| buffer  |
                  |                  |            +---------+
                  +------------------+
```

- 그림 5: OverflowAlert 클래스

OverflowAlert를 구성하는 집계 클래스는 다음과 같습니다.

```text
   program
```

- 딱 하나요. 끈. 오버플로 공격이 실행을 시도한 프로그램\(참고: 공격을 받은 프로그램이 아닙니다\).

```text
   size
```

- 0 아니면 1. 정수. 오버플로의 크기\(바이트\)\(즉, 공격자가 보낸 바이트 수\).

```text
   buffer
```

- 0 아니면 1. 바이트\[\]. 오버플로 데이터 자체의 일부 또는 전부\(분석기가 캡처할 수 있는 양에 따라 다름\)

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT OverflowAlert                 (
       program, size?, buffer?
     )>
   <!ATTLIST OverflowAlert
       %attlist.global;
     >
```

---
#### **4.2.3.  The Heartbeat Class**

분석기는 하트비트 메시지를 사용하여 현재 상태를 관리자에게 나타냅니다. 하트비트는 10분마다 또는 1시간마다와 같이 정기적으로 전송되도록 되어 있습니다. 분석기로부터 하트비트 메시지를 받으면 분석기가 작동 중임을 관리자에게 알립니다. 하트비트 메시지가 없다는 것은\(혹은 일정 개수의 연속 하트비트 메시지가 없다는 뜻일 가능성이 높음\) 분석기나 해당 네트워크 연결이 실패했음을 의미합니다.

모든 관리자는 하트비트 메시지 수신을 지원해야 합니다. 그러나 분석기에서 이러한 메시지를 사용하는 것은 선택 사항입니다. 관리자 소프트웨어 개발자는 하트비트 메시지를 사용하거나 사용하지 않도록 분석기별로 소프트웨어를 구성하도록 허용해야 합니다.\(MUST, SHOULD\)

하트비트 메시지는 그림 6에 표시된 것처럼 여러 집계 클래스로 구성됩니다. 집계 클래스 자체는 섹션 4.2.4 및 4.2.5에 설명되어 있습니다.

```text
               +------------------+
               |    Heartbeat     |
               +------------------+            +------------------+
               | STRING messageid |<>----------|     Analyzer     |
               |                  |            +------------------+
               |                  |            +------------------+
               |                  |<>----------|    CreateTime    |
               |                  |            +------------------+
               |                  |       0..1 +------------------+
               |                  |<>----------| HeartbeatInterval|
               |                  |            +------------------+
               |                  |       0..1 +------------------+
               |                  |<>----------|   AnalyzerTime   |
               |                  |            +------------------+
               |                  |       0..* +------------------+
               |                  |<>----------|  AdditionalData  |
               |                  |            +------------------+
               +------------------+

                       Figure 6: The Heartbeat Class
```

Heartbeat를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Analyzer
```

- 딱 하나요. 하트비트를 발생시킨 분석기에 대한 식별 정보입니다.

```text
   CreateTime
```

- 딱 하나요. 하트비트가 생성된 시간입니다.

```text
   HeartbeatInterval
```

- 0 아니면 1. 하트비트가 생성되는 간격\(초\)입니다.

```text
   AnalyzerTime
```

- 0 아니면 1. 분석기의 현재 시간\(섹션 6.3 참조\).

```text
   AdditionalData
```

- 0개 이상. 데이터 모델에 맞지 않는 분석기에 포함된 정보입니다. 이는 원자 단위의 데이터일 수도 있고 IDMEF 확장을 통해 제공되는 대량의 데이터일 수도 있습니다\(섹션 5 참조\).

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Heartbeat                     (
       Analyzer, CreateTime, HeartbeatInterval?, AnalyzerTime?,
       AdditionalData*
     )>
   <!ATTLIST Heartbeat
       messageid           CDATA                   '0'
       %attlist.global;
     >
```

Heartbeat 클래스에는 다음과 같은 속성이 하나 있습니다.

```text
   messageid
```

선택 과목. 하트비트의 고유 식별자입니다. 보다

- 섹션 3.2.9.

---
#### **4.2.4.  The Core Classes**

핵심 클래스인 분석기, 소스, 대상, 분류 및 추가 데이터는 그림 7에 표시된 것처럼 경고 및 하트비트의 주요 부분입니다.

```text
                +-----------+                +----------------+
                | Heartbeat |        +-------|    Analyzer    |
                +-----------+        |       +----------------+
                |           |<>---+--+
                +-----------+     |  |  0..* +----------------+
                                  |  +-------| AdditionalData |
                                  |          +----------------+
                +-----------+     |
                |   Alert   |     |     0..* +----------------+
                +-----------+     |  +-------|     Source     |
                |           |<>---+  |       +----------------+
                |           |        |  0..* +----------------+
                |           |        +-------|     Target     |
                |           |        |       +----------------+
                |           |<>------+
                +-----------+        |       +----------------+
                                     +-------| Classification |
                                             +----------------+
```

- 그림 7: 핵심 클래스

---
##### **4.2.4.1.  The Analyzer Class**

분석기 클래스는 경고 또는 하트비트 메시지가 발생하는 분석기를 식별합니다. 각 경고 또는 하트비트에 대해 하나의 분석기만 인코딩할 수 있으며 해당 분석기는 경고 또는 하트비트가 시작된 분석기여야 합니다. IDMEF 데이터 모델은 계층적 침입 탐지 시스템\(경고가 트리 위로 전달되는 경우\)의 사용을 막지는 않지만 원래 분석기에서 다음 분석기까지의 경로를 따라 "릴레이" 분석기의 ID를 기록하는 방법을 제공하지 않습니다. 최종적으로 경고를 받은 관리자입니다.\(MUST\)

분석기 클래스는 그림 8에 표시된 것처럼 세 가지 집계 클래스로 구성됩니다.

```text
                +---------------------+
                |      Analyzer       |
                +---------------------+       0..1 +----------+
                | STRING analyzerid   |<>----------|  Node    |
                | STRING name         |            +----------+
                | STRING manufacturer |
                | STRING model        |       0..1 +----------+
                | STRING version      |<>----------| Process  |
                | STRING class        |            +----------+
                | STRING ostype       |       0..1 +----------+
                | STRING osversion    |<>----------| Analyzer |
                +---------------------+            +----------+

                       Figure 8: The Analyzer Class
```

분석기를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Node
```

- 0 아니면 1. 분석기가 상주하는 호스트 또는 장치에 대한 정보\(네트워크 주소, 네트워크 이름 등\)

```text
   Process
```

- 0 아니면 1. 분석기가 실행 중인 프로세스에 대한 정보입니다.

```text
   Analyzer
```

- 0 아니면 1. 메시지가 전달되었을 수 있는 분석기에 대한 정보입니다. 이 메커니즘의 기본 개념은 관리자가 경고를 받고 이를 다른 분석기로 전달하려고 할 때 원래 분석기를 대체해야 한다는 것입니다.

- 자체 정보. 원래 분석기 정보를 보존하기 위해 새 분석기 정의에 포함될 수 있습니다. 이렇게 하면 분석기 경로 추적이 가능해집니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Analyzer                      (
       Node?, Process?, Analyzer?
     )>
   <!ATTLIST Analyzer
       analyzerid          CDATA                   '0'
       name                CDATA                   #IMPLIED
       manufacturer        CDATA                   #IMPLIED
       model               CDATA                   #IMPLIED
       version             CDATA                   #IMPLIED
       class               CDATA                   #IMPLIED
       ostype              CDATA                   #IMPLIED
       osversion           CDATA                   #IMPLIED
       %attlist.global;
     >
```

분석기 클래스에는 8가지 속성이 있습니다.

```text
   analyzerid
```

- 선택 사항\(단, 아래 참조\). 분석기의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

- 이 속성은 "부분적으로" 선택사항입니다. 분석기가 다른 클래스의 "ident" 특성을 사용하여 해당 개체에 대한 고유 식별자를 제공하는 경우 유효한 "analyzerid" 특성도 제공해야 합니다. 이 요구 사항은 "ident" 특성의 고유성 요구 사항에 따라 결정됩니다\(특정 "analyzerid"의 컨텍스트 내에서만 고유함\). 그러나 분석기가 "ident" 특성을 사용하지 않는 경우 "analyzerid" 특성을 생략할 수도 있습니다.\(MUST\)

```text
   name
```

- 선택사항입니다. analyzerid보다 이해하기 쉬울 수 있는 분석기의 명시적인 이름입니다.

```text
   manufacturer
```

- 선택사항입니다. 분석기 소프트웨어 및/또는 하드웨어 제조업체입니다.

```text
   model
```

- 선택사항입니다. 분석기 소프트웨어 및/또는 하드웨어의 모델 이름/번호.

```text
   version
```

- 선택사항입니다. 분석기 소프트웨어 및/또는 하드웨어의 버전 번호입니다.

```text
   class
```

- 선택사항입니다. 분석기 소프트웨어 및/또는 하드웨어의 클래스입니다.

```text
   ostype
```

- 선택사항입니다. 운영 체제 이름. POSIX 1003.1 호환 시스템에서 이는 uname\(\) 시스템 호출 또는 "uname -s" 명령의 출력에 의해 utsname.sysname에 반환된 값입니다.

```text
   osversion
```

- 선택사항입니다. 운영 체제 버전. POSIX 1003.1 호환 시스템에서 이는 uname\(\) 시스템 호출 또는 "uname -r" 명령의 출력에 의해 utsname.release에 반환된 값입니다.

"제조업체", ​​"모델", "버전" 및 "클래스" 속성의 내용은 공급업체별로 다르지만 다양한 유형의 분석기를 식별하기 위해 함께 사용될 수 있습니다\(그리고 아마도 다른 공급업체에서 기대할 수 있는 내용에 대한 결정을 내릴 수도 있습니다\). IDMEF 메시지의 특정 필드\).

---
##### **4.2.4.2.  The Classification Class**

분류 클래스는 경고의 "이름" 또는 관리자가 그것이 무엇인지 결정할 수 있도록 하는 기타 정보를 제공합니다. 이 이름은 경고 제공자가 선택합니다.

분류 클래스는 그림 9에 표시된 것처럼 하나의 집계 클래스로 구성됩니다.

```text
                    +----------------+
                    | Classification |
                    +----------------+       0..* +-----------+
                    | STRING ident   |<>----------| Reference |
                    | STRING text    |            +-----------+
                    +----------------+

                    Figure 9: The Classification Class
```

분류를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Reference
```

- 0개 이상. 경고에 대한 배경 정보를 제공하는 외부 설명서 사이트를 가리키는 메시지에 대한 정보입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Classification                (
       Reference*
     )>
   <!ATTLIST Classification
       ident               CDATA                   '0'
       text                CDATA                   #REQUIRED
     >
```

분류 클래스에는 두 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 이 분류에 대한 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   text
```

-  필수의. 경고 메시지를 식별하는 공급업체 제공 문자열입니다.

---
##### **4.2.4.3.  The Source Class**

Source 클래스에는 경고를 생성한 이벤트의 가능한 소스에 대한 정보가 포함되어 있습니다. 이벤트에는 둘 이상의 소스가 있을 수 있습니다\(예: 분산 서비스 거부 공격\).

Source 클래스는 그림 10에 표시된 것처럼 4개의 집계 클래스로 구성됩니다.

```text
                  +------------------+
                  |      Source      |
                  +------------------+       0..1 +---------+
                  | STRING ident     |<>----------|  Node   |
                  | ENUM spoofed     |            +---------+
                  | STRING interface |       0..1 +---------+
                  |                  |<>----------|  User   |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |<>----------| Process |
                  |                  |            +---------+
                  |                  |       0..1 +---------+
                  |                  |<>----------| Service |
                  |                  |            +---------+
                  +------------------+
```

- 그림 10: 소스 클래스

소스를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Node
```

- 0 아니면 1. 이벤트를 발생시키는 것으로 보이는 호스트 또는 장치에 대한 정보\(네트워크 주소, 네트워크 이름 등\)

```text
   User
```

- 0 아니면 1. 이벤트를 유발한 것으로 보이는 사용자에 대한 정보입니다.

```text
   Process
```

- 0 아니면 1. 이벤트를 발생시키는 것으로 보이는 프로세스에 대한 정보입니다.

```text
   Service
```

- 0 아니면 1. 이벤트와 관련된 네트워크 서비스에 대한 정보입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Source                        (
       Node?, User?, Process?, Service?
     )>
   <!ATTLIST Source
       ident               CDATA                   '0'
       spoofed             %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     >
```

Source 클래스에는 세 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 이 소스의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   spoofed
```

- 선택사항입니다. 분석기가 판단할 수 있는 한 소스가 공격의 실제 출처를 숨기는 데 사용되는 스푸핑된 주소인지 여부를 나타냅니다. 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "알 수 없음"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of source information unknown |
        |      |         |                                        |
        |    1 | yes     | Source is believed to be a decoy       |
        |      |         |                                        |
        |    2 | no      | Source is believed to be "real"        |
        +------+---------+----------------------------------------+

   interface
```

- 선택사항입니다. 이 소스가 표시된 인터페이스를 나타내기 위해 여러 인터페이스가 있는 네트워크 기반 분석기에 의해 사용될 수 있습니다.

---
##### **4.2.4.4.  The Target Class**

Target 클래스에는 경고를 생성한 이벤트의 가능한 대상에 대한 정보가 포함되어 있습니다. 이벤트에는 둘 이상의 대상이 있을 수 있습니다\(예: 포트 스윕의 경우\).

Target 클래스는 그림 11에 표시된 것처럼 4개의 집계 클래스로 구성됩니다.

```text
                  +------------------+
                  |      Target      |
                  +------------------+       0..1 +----------+
                  | STRING ident     |<>----------|   Node   |
                  | ENUM decoy       |            +----------+
                  | STRING interface |       0..1 +----------+
                  |                  |<>----------|   User   |
                  |                  |            +----------+
                  |                  |       0..1 +----------+
                  |                  |<>----------| Process  |
                  |                  |            +----------+
                  |                  |       0..1 +----------+
                  |                  |<>----------| Service  |
                  |                  |            +----------+
                  |                  |       0..n +----------+
                  |                  |<>----------|   File   |
                  |                  |            +----------+
                  +------------------+
```

- 그림 11: 대상 클래스

Target을 구성하는 집계 클래스는 다음과 같습니다.

```text
   Node
```

- 0 아니면 1. 이벤트\(네트워크 주소, 네트워크 이름 등\)가 전달되는 호스트 또는 장치에 대한 정보입니다.

```text
   User
```

- 0 아니면 1. 이벤트가 전달되는 사용자에 대한 정보입니다.

```text
   Process
```

- 0 아니면 1. 이벤트가 진행되는 프로세스에 대한 정보입니다.

```text
   Service
```

- 0 아니면 1. 이벤트와 관련된 네트워크 서비스에 대한 정보입니다.

```text
   File
```

- 선택사항입니다. 이벤트와 관련된 파일에 대한 정보입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Target                        (
       Node?, User?, Process?, Service?, File*
     )>
   <!ATTLIST Target
       ident               CDATA                   '0'
       decoy               %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     >
```

Target 클래스에는 세 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 이 대상의 고유 식별자는 섹션 3.2.9를 참조하세요.

```text
   decoy
```

- 선택사항입니다. 분석기가 판단할 수 있는 대상이 미끼인지 여부를 나타냅니다. 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "알 수 없음"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of target information unknown |
        |      |         |                                        |
        |    1 | yes     | Target is believed to be a decoy       |
        |      |         |                                        |
        |    2 | no      | Target is believed to be "real"        |
        +------+---------+----------------------------------------+

   interface
```

- 선택사항입니다. 이 대상이 표시된 인터페이스를 나타내기 위해 여러 인터페이스가 있는 네트워크 기반 분석기에 의해 사용될 수 있습니다.

---
##### **4.2.4.5.  The Assessment Class**

평가 클래스는 이벤트에 대한 분석가의 평가\(이벤트의 영향, 대응 조치 및 신뢰도\)를 제공하는 데 사용됩니다.

평가 클래스는 그림 12에 표시된 것처럼 세 가지 집계 클래스로 구성됩니다.

```text
                  +------------------+
                  |   Assessment     |
                  +------------------+       0..1 +------------+
                  |                  |<>----------|   Impact   |
                  |                  |            +------------+
                  |                  |       0..* +------------+
                  |                  |<>----------|   Action   |
                  |                  |            +------------+
                  |                  |       0..1 +------------+
                  |                  |<>----------| Confidence |
                  |                  |            +------------+
                  +------------------+

                      Figure 12: The Assessment Class
```

평가를 구성하는 집계 클래스는 다음과 같습니다.

```text
   Impact
```

- 0 아니면 1. 이벤트가 대상에 미치는 영향에 대한 분석기의 평가입니다.

```text
   Action
```

- 0개 이상. 이벤트에 대한 응답으로 분석기가 취하는 조치입니다.

```text
   Confidence
```

- 0 아니면 1. 분석기가 이벤트 평가에 대해 갖고 있는 신뢰도를 측정합니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Assessment                    (
       Impact?, Action*, Confidence?
     )>
   <!ATTLIST Assessment
       %attlist.global;
     >
```

---
##### **4.2.4.6.  The AdditionalData Class**

AnotherData 클래스는 데이터 모델로 표현할 수 없는 정보를 제공하는 데 사용됩니다. 추가 데이터는 소량의 추가 정보만 전송해야 하는 경우 원자 데이터\(정수, 문자열 등\)를 제공하는 데 사용할 수 있습니다. 또한 데이터 모델과 DTD를 확장하여 복잡한 데이터\(예: 패킷 헤더\)의 전송을 지원하는 데 사용할 수도 있습니다. 데이터 모델 및 DTD 확장에 대한 자세한 지침은 섹션 5에 제공됩니다.

```text
   +------+-------------+----------------------------------------------+
   | Rank | Keyword     | Description                                  |
   +------+-------------+----------------------------------------------+
   |    0 | boolean     | The element contains a boolean value, i.e.,  |
   |      |             | the strings "true" or "false"                |
   |      |             |                                              |
   |    1 | byte        | The element content is a single 8-bit byte   |
   |      |             | (see Section 3.2.4)                          |
   |      |             |                                              |
   |    2 | character   | The element content is a single character    |
   |      |             | (see Section 3.2.3)                          |
   |      |             |                                              |
   |    3 | date-time   | The element content is a date-time string    |
   |      |             | (see Section 3.2.6)                          |
   |      |             |                                              |
   |    4 | integer     | The element content is an integer (see       |
   |      |             | Section 3.2.1)                               |
   |      |             |                                              |
   |    5 | ntpstamp    | The element content is an NTP timestamp (see |
   |      |             | Section 3.2.7)                               |
   |      |             |                                              |
   |    6 | portlist    | The element content is a list of ports (see  |
   |      |             | Section 3.2.8)                               |
   |      |             |                                              |
   |    7 | real        | The element content is a real number (see    |
   |      |             | Section 3.2.2)                               |
   |      |             |                                              |
   |    8 | string      | The element content is a string (see         |
   |      |             | Section 3.2.3)                               |
   |      |             |                                              |
   |    9 | byte-string | The element is a byte[] (see Section 3.2.4)  |
   |      |             |                                              |
   |   10 | xmltext     | The element content is XML-tagged data (see  |
   |      |             | Section 5.2)                                 |
   +------+-------------+----------------------------------------------+
```

추가 데이터 요소는 IDMEF DTD에서 다음과 같이 선언됩니다.

```text
   <!ENTITY % attvals.adtype               "
       ( boolean | byte | character | date-time | integer | ntpstamp |
         portlist | real | string | byte-string | xmltext )
     ">

   <!ELEMENT AdditionalData           (
     (boolean | byte        | character | date-time |
      integer | ntpstamp    | portlist  | real      |
      string  | byte-string | xmltext  )
    )>

   <!ATTLIST AdditionalData
       type                %attvals.adtype;        'string'
       meaning             CDATA                   #IMPLIED
       %attlist.global;
     >
```

추가 데이터 클래스에는 다음과 같은 속성이 하나 있습니다.

```text
   meaning
```

- 선택사항입니다. 요소 콘텐츠의 의미를 설명하는 문자열입니다. 이러한 값은 공급업체/구현에 따라 다릅니다. 분석기가 보낸 문자열을 관리자가 이해하도록 하는 방법은 이 사양의 범위를 벗어납니다. 허용되는 의미 키워드 목록은 문서의 범위에 포함되지 않지만 이후 버전에서는 그러한 목록을 만들 수도 있습니다.

---
#### **4.2.5.  The Time Classes**

데이터 모델은 시간을 나타내는 세 가지 클래스를 제공합니다. 이러한 클래스는 Alert 및 Heartbeat 클래스의 요소입니다.

시간 클래스는 IDMEF DTD에 다음과 같이 표시됩니다.

```text
   <!ELEMENT ntpstamp          (#PCDATA)         >
   <!ATTLIST ntpstamp          %attlist.global;  >

   <!ELEMENT CreateTime          (#PCDATA) >
   <!ATTLIST CreateTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     >

   <!ELEMENT DetectTime          (#PCDATA) >
   <!ATTLIST DetectTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     >

   <!ELEMENT AnalyzerTime        (#PCDATA) >
   <!ATTLIST AnalyzerTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     >
```

<CreateTime\> 요소 콘텐츠의 DATETIME 형식은 섹션 3.2.6에 설명되어 있습니다.

요소 콘텐츠와 NTP 타임스탬프가 나타내는 날짜 및 시간이 다른 경우\("절대" 발생하지 않아야 함\) NTP 타임스탬프의 값을 사용해야 합니다.\(MUST\)

---
##### **4.2.5.1.  The CreateTime Class**

CreateTime 클래스는 분석기에서 경고 또는 하트비트가 생성된 날짜와 시간을 나타내는 데 사용됩니다.

---
##### **4.2.5.2.  The DetectTime Class**

DetectTime 클래스는 경고를 생성하는 이벤트가 분석기에 의해 감지된 날짜와 시간을 나타내는 데 사용됩니다. 이벤트가 2개 이상인 경우 첫 번째 이벤트가 감지된 시간입니다. \(CreateTime과 같은 시간일 수도 있고 아닐 수도 있습니다. 분석기는 탐지 즉시 경고를 보낼 필요가 없습니다.\)

---
##### **4.2.5.3.  The AnalyzerTime Class**

analyzerTime 클래스는 분석기의 현재 날짜와 시간을 나타내는 데 사용됩니다. 해당 값은 메시지 전송 프로세스에서 가능한 한 늦게, 이상적으로는 메시지를 "전송"하기 직전에 채워야 합니다.

분석기와 관리자 간의 기본적인 시간 동기화를 수행하기 위해 <AnalyzerTime\>을 사용하는 방법은 섹션 6.3에서 논의됩니다.

---
#### **4.2.6.  The Assessment Classes**

데이터 모델은 분석기가 이벤트에 대해 수행할 수 있는 세 가지 유형의 "평가"를 제공합니다. 이러한 클래스는 평가 클래스의 집합체입니다.

---
##### **4.2.6.1.  The Impact Class**

Impact 클래스는 이벤트가 대상에 미치는 영향에 대한 분석기의 평가를 제공하는 데 사용됩니다. IDMEF DTD에서는 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.severity             "
       ( info | low | medium | high )
     ">
   <!ENTITY % attvals.completion           "
       ( failed | succeeded )
     ">
   <!ENTITY % attvals.impacttype           "
       ( admin | dos | file | recon | user | other )
     ">

   <!ELEMENT Impact              (#PCDATA) >
   <!ATTLIST Impact
       severity            %attvals.severity;      #IMPLIED
       completion          %attvals.completion;    #IMPLIED
       type                %attvals.impacttype;    'other'
       %attlist.global;
     >
```

Impact 클래스에는 세 가지 속성이 있습니다.

```text
   severity
```

- 사건의 상대적 심각도에 대한 추정치입니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
       +------+---------+-----------------------------------------+
       | Rank | Keyword | Description                             |
       +------+---------+-----------------------------------------+
       |    0 | info    | Alert represents informational activity |
       |      |         |                                         |
       |    1 | low     | Low severity                            |
       |      |         |                                         |
       |    2 | medium  | Medium severity                         |
       |      |         |                                         |
       |    3 | high    | High severity                           |
       +------+---------+-----------------------------------------+

   completion
```

- 분석가가 이벤트가 설명하는 시도가 성공했다고 믿는지 여부를 나타냅니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
           +------+-----------+--------------------------------+
           | Rank | Keyword   | Description                    |
           +------+-----------+--------------------------------+
           |    0 | failed    | The attempt was not successful |
           |      |           |                                |
           |    1 | succeeded | The attempt succeeded          |
           +------+-----------+--------------------------------+

   type
```

- 상대적으로 광범위한 범주에서 이 이벤트가 나타내는 시도 유형입니다. 허용되는 값은 아래와 같습니다. 기본값은 "기타"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | admin   | Administrative privileges were attempted or      |
   |      |         | obtained                                         |
   |      |         |                                                  |
   |    1 | dos     | A denial of service was attempted or completed   |
   |      |         |                                                  |
   |    2 | file    | An action on a file was attempted or completed   |
   |      |         |                                                  |
   |    3 | recon   | A reconnaissance probe was attempted or          |
   |      |         | completed                                        |
   |      |         |                                                  |
   |    4 | user    | User privileges were attempted or obtained       |
   |      |         |                                                  |
   |    5 | other   | Anything not in one of the above categories      |
   +------+---------+--------------------------------------------------+
```

세 가지 속성은 모두 선택 사항입니다. 요소 자체는 비어 있을 수도 있고, 분석기가 추가 세부 정보를 제공할 수 있는 경우 영향에 대한 텍스트 설명을 포함할 수도 있습니다.

---
##### **4.2.6.2.  The Action Class**

Action 클래스는 이벤트에 대한 응답으로 분석기가 수행하는 모든 작업을 설명하는 데 사용됩니다. IDMEF DTD에서는 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.actioncat            "
       ( block-installed | notification-sent | taken-offline | other )
     ">

   <!ELEMENT Action              (#PCDATA) >
   <!ATTLIST Action
       category            %attvals.actioncat;     'other'
       %attlist.global;
     >
```

작업에는 하나의 속성이 있습니다.

```text
   category
```

- 취한 조치의 유형. 허용되는 값은 아래와 같습니다. 기본값은 "기타"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | block-installed   | A block of some sort was installed to  |
   |      |                   | prevent an attack from reaching its    |
   |      |                   | destination.  The block could be a     |
   |      |                   | port block, address block, etc., or    |
   |      |                   | disabling a user account.              |
   |      |                   |                                        |
   |    1 | notification-sent | A notification message of some sort    |
   |      |                   | was sent out-of-band (via pager,       |
   |      |                   | e-mail, etc.).  Does not include the   |
   |      |                   | transmission of this alert.            |
   |      |                   |                                        |
   |    2 | taken-offline     | A system, computer, or user was taken  |
   |      |                   | offline, as when the computer is shut  |
   |      |                   | down or a user is logged off.          |
   |      |                   |                                        |
   |    3 | other             | Anything not in one of the above       |
   |      |                   | categories.                            |
   +------+-------------------+----------------------------------------+
```

요소 자체는 비어 있거나 텍스트를 포함할 수 있습니다.

- 분석기가 추가 세부 정보를 제공할 수 있는 경우 작업에 대한 설명입니다.

---
##### **4.2.6.3.  The Confidence Class**

Confidence 클래스는 분석기의 분석 유효성에 대한 최선의 추정치를 나타내는 데 사용됩니다. IDMEF DTD에서는 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.rating               "
       ( low | medium | high | numeric )
     ">

   <!ELEMENT Confidence          (#PCDATA) >
   <!ATTLIST Confidence
       rating              %attvals.rating;        'numeric'
       %attlist.global;
     >
```

Confidence 클래스에는 다음과 같은 속성이 하나 있습니다.

```text
   rating
```

- 분석자의 분석 타당성에 대한 평가입니다. 허용되는 값은 아래와 같습니다. 기본값은 "숫자"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | low     | The analyzer has little confidence in its        |
   |      |         | validity                                         |
   |      |         |                                                  |
   |    1 | medium  | The analyzer has average confidence in its       |
   |      |         | validity                                         |
   |      |         |                                                  |
   |    2 | high    | The analyzer has high confidence in its validity |
   |      |         |                                                  |
   |    3 | numeric | The analyzer has provided a posterior            |
   |      |         | probability value indicating its confidence in   |
   |      |         | its validity                                     |
   +------+---------+--------------------------------------------------+
```

이 요소는 분석기가 의미 있는 정보를 생성할 수 있는 경우에만 사용해야 합니다. 대략적인 경험적 방법만 출력할 수 있는 시스템은 등급 값으로 "낮음", "보통" 또는 "높음"을 사용해야 합니다. 이 경우 요소 내용은 생략되어야 합니다.

합리적인 확률 추정치를 생성할 수 있는 시스템은 등급 값으로 "숫자"를 사용해야 하며 요소 콘텐츠에 숫자 신뢰도 값을 포함해야 합니다. 이 숫자 값은 사후 확률\(탐지 시스템에서 확인한 데이터와 시스템에서 사용하는 모델을 바탕으로 공격이 발생한 확률\)을 반영해야 합니다. 0.0에서 1.0 사이의 부동 소수점 숫자입니다. 자릿수는 단정밀도 부동 소수점 값으로 표현 가능한 자릿수로 제한되어야 하며, 3.2.2절에 설명된 대로 표현될 수 있습니다.

참고: 다양한 유형의 분석기가 서로 다른 방식으로 신뢰도 값을 계산할 수 있으며 많은 경우 서로 다른 분석기의 신뢰도 값을 비교해서는 안 된다는 점에 유의해야 합니다\(예를 들어, 분석기가 서로 다른 계산 방법을 사용하거나 신뢰도를 나타내는 경우\). 유형이나 구성이 다릅니다\). 신뢰도 값\(예: 이벤트 상관자\)을 처리하는 시스템을 구현할 때 작업 환경에 대한 시스템 지식으로 뒷받침할 수 없는 비교나 가정을 하지 않도록 주의해야 합니다.

---
#### **4.2.7.  The Support Classes**

지원 클래스는 핵심 클래스의 주요 부분을 구성하며 서로 공유됩니다.

---
##### **4.2.7.1.  The Reference Class**

Reference 클래스는 경고의 "이름" 또는 관리자가 그것이 무엇인지 결정할 수 있도록 하는 기타 정보를 제공합니다.

Reference 클래스는 그림 13에 표시된 것처럼 두 개의 집계 클래스로 구성됩니다.

```text
                    +----------------+
                    | Reference      |
                    +----------------+            +------+
                    | STRING origin  |<>----------| name |
                    | STRING meaning |            +------+
                    |                |            +------+
                    |                |<>----------| url  |
                    |                |            +------+
                    +----------------+

                      Figure 13: The Reference Class
```

Reference를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

- 딱 하나요. 끈. 아래 나열된 원본 중 하나의 경고 이름입니다.

```text
   url
```

- 딱 하나요. 끈. 관리자\(또는 관리자의 운영자\)가 경고에 대한 추가 정보를 찾을 수 있는 URL입니다. URL이 가리키는 문서에는 공격에 대한 심층적인 설명, 적절한 대응책 또는 공급업체가 관련 있다고 간주하는 기타 정보가 포함될 수 있습니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.origin               "
       ( unknown | vendor-specific | user-specific | bugtraqid | cve |
         osvdb )
     ">

   <!ELEMENT Reference                (
       name, url
     )>
   <!ATTLIST Reference
       origin              %attvals.origin;        'unknown'
       meaning             CDATA                   #IMPLIED
     >
```

Reference 클래스에는 두 가지 속성이 있습니다.

```text
   origin
```

-  필수의. 경고 이름의 출처입니다. 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "알 수 없음"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+-----------------+------------------------------------------+
   | Rank | Keyword         | Description                              |
   +------+-----------------+------------------------------------------+
   |    0 | unknown         | Origin of the name is not known          |
   |      |                 |                                          |
   |    1 | vendor-specific | A vendor-specific name (and hence, URL); |
   |      |                 | this can be used to provide              |
   |      |                 | product-specific information             |
   |      |                 |                                          |
   |    2 | user-specific   | A user-specific name (and hence, URL);   |
   |      |                 | this can be used to provide              |
   |      |                 | installation-specific information        |
   |      |                 |                                          |
   |    3 | bugtraqid       | The SecurityFocus ("Bugtraq")            |
   |      |                 | vulnerability database identifier        |
   |      |                 | (http://www.securityfocus.com/bid)       |
   |      |                 |                                          |
   |    4 | cve             | The Common Vulnerabilities and Exposures |
   |      |                 | (CVE) name (http://www.cve.mitre.org/)   |
   |      |                 |                                          |
   |    5 | osvdb           | The Open Source Vulnerability Database   |
   |      |                 | (http://www.osvdb.org)                   |
   +------+-----------------+------------------------------------------+

   meaning
```

- 선택사항입니다. 경고 제공자가 이해하는 참조의 의미입니다. 이 필드는 <origin\> 속성 값이 "공급업체별" 또는 "사용자별"로 설정된 경우에만 유효합니다.

---
##### **4.2.7.2.  The Node Class**

Node 클래스는 호스트 및 기타 네트워크 장치\(라우터, 스위치 등\)를 식별하는 데 사용됩니다.

Node 클래스는 그림 14에 표시된 것처럼 세 개의 집계 클래스로 구성됩니다.

```text
                   +---------------+
                   |     Node      |
                   +---------------+       0..1 +----------+
                   | STRING ident  |<>----------| location |
                   | ENUM category |            +----------+
                   |               |       0..1 +----------+
                   |               |<>----------|   name   |
                   |               |            +----------+
                   |               |       0..* +----------+
                   |               |<>----------|  Address |
                   |               |            +----------+
                   +---------------+

                         Figure 14: The Node Class
```

Node를 구성하는 집합 클래스는 다음과 같습니다.

```text
   location
```

- 0 아니면 1. 끈. 장비의 위치.

```text
   name
```

0 또는 1. 끈. 장비의 이름입니다. 이것

- 주소 정보가 제공되지 않은 경우 정보를 제공해야 합니다.\(MUST\)

```text
   Address
```

- 0개 이상. 장비의 네트워크 또는 하드웨어 주소입니다. 이름\(위\)을 제공하지 않는 한 하나 이상의 주소를 지정해야 합니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.nodecat              "
       ( unknown | ads | afs | coda | dfs | dns | hosts | kerberos |
         nds | nis | nisplus | nt | wfw )
     ">

   <!ELEMENT Node                          (
       location?, (name | Address), Address*
     )>
   <!ATTLIST Node
       ident               CDATA                   '0'
       category            %attvals.nodecat;       'unknown'
       %attlist.global;
     >
```

Node 클래스에는 두 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 노드의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   category
```

- 선택사항입니다. 해당되는 경우 이름 정보를 얻은 "도메인"입니다. 이 속성에 허용되는 값은 아래 표에 나와 있습니다. 기본값은 "알 수 없음"입니다. \(표 확장에 대해서는 섹션 10을 참조하십시오.\)

```text
      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | unknown  | Domain unknown or not relevant           |
      |      |          |                                          |
      |    1 | ads      | Windows 2000 Advanced Directory Services |
      |      |          |                                          |
      |    2 | afs      | Andrew File System (Transarc)            |
      |      |          |                                          |
      |    3 | coda     | Coda Distributed File System             |
      |      |          |                                          |
      |    4 | dfs      | Distributed File System (IBM)            |
      |      |          |                                          |
      |    5 | dns      | Domain Name System                       |
      |      |          |                                          |
      |    6 | hosts    | Local hosts file                         |
      |      |          |                                          |
      |    7 | kerberos | Kerberos realm                           |
      |      |          |                                          |
      |    8 | nds      | Novell Directory Services                |
      |      |          |                                          |
      |    9 | nis      | Network Information Services (Sun)       |
      |      |          |                                          |
      |   10 | nisplus  | Network Information Services Plus (Sun)  |
      |      |          |                                          |
      |   11 | nt       | Windows NT domain                        |
      |      |          |                                          |
      |   12 | wfw      | Windows for Workgroups                   |
      +------+----------+------------------------------------------+
```

---
###### **4.2.7.2.1.  The Address Class**

Address 클래스는 네트워크, 하드웨어 및 애플리케이션 주소를 나타내는 데 사용됩니다.

그림 15에 표시된 것처럼 Address 클래스는 두 개의 집계 클래스로 구성됩니다.

```text
                  +------------------+
                  |     Address      |
                  +------------------+            +---------+
                  | STRING ident     |<>----------| address |
                  | ENUM category    |            +---------+
                  | STRING vlan-name |       0..1 +---------+
                  | INTEGER vlan-num |<>----------| netmask |
                  |                  |            +---------+
                  +------------------+

                       Figure 15: The Address Class
```

주소를 구성하는 집계 클래스는 다음과 같습니다.

```text
   address
```

- 딱 하나요. 끈. 주소정보입니다. 이 데이터의 형식은 카테고리 속성에 따라 결정됩니다.

```text
   netmask
```

- 0 아니면 1. 끈. 해당하는 경우 주소의 네트워크 마스크입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.addrcat              "
       ( unknown | atm | e-mail | lotus-notes | mac | sna | vm |
         ipv4-addr | ipv4-addr-hex | ipv4-net | ipv4-net-mask |
         ipv6-addr | ipv6-addr-hex | ipv6-net | ipv6-net-mask )
     ">

   <!ELEMENT Address                       (
       address, netmask?
     )>
   <!ATTLIST Address
       ident               CDATA                   '0'
       category            %attvals.addrcat;       'unknown'
       vlan-name           CDATA                   #IMPLIED
       vlan-num            CDATA                   #IMPLIED
       %attlist.global;
     >
```

Address 클래스에는 네 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 주소의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   category
```

- 선택사항입니다. 표시되는 주소 유형입니다. 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "알 수 없음"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | unknown       | Address type unknown                       |
   |      |               |                                            |
   |    1 | atm           | Asynchronous Transfer Mode network address |
   |      |               |                                            |
   |    2 | e-mail        | Electronic mail address (RFC 2822 [12])    |
   |      |               |                                            |
   |    3 | lotus-notes   | Lotus Notes e-mail address                 |
   |      |               |                                            |
   |    4 | mac           | Media Access Control (MAC) address         |
   |      |               |                                            |
   |    5 | sna           | IBM Shared Network Architecture (SNA)      |
   |      |               | address                                    |
   |      |               |                                            |
   |    6 | vm            | IBM VM ("PROFS") e-mail address            |
   |      |               |                                            |
   |    7 | ipv4-addr     | IPv4 host address in dotted-decimal        |
   |      |               | notation (a.b.c.d)                         |
   |      |               |                                            |
   |    8 | ipv4-addr-hex | IPv4 host address in hexadecimal notation  |
   |      |               |                                            |
   |    9 | ipv4-net      | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, significant bits          |
   |      |               | (a.b.c.d/nn)                               |
   |      |               |                                            |
   |   10 | ipv4-net-mask | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, network mask in           |
   |      |               | dotted-decimal notation (a.b.c.d/w.x.y.z)  |
   |      |               |                                            |
   |   11 | ipv6-addr     | IPv6 host address                          |
   |      |               |                                            |
   |   12 | ipv6-addr-hex | IPv6 host address in hexadecimal notation  |
   |      |               |                                            |
   |   13 | ipv6-net      | IPv6 network address, slash, significant   |
   |      |               | bits                                       |
   |      |               |                                            |
   |   14 | ipv6-net-mask | IPv6 network address, slash, network mask  |
   +------+---------------+--------------------------------------------+

   vlan-name
```

- 선택사항입니다. 주소가 속한 가상 LAN의 이름입니다.

```text
   vlan-num
```

- 선택사항입니다. 주소가 속한 가상 LAN의 번호입니다.

---
##### **4.2.7.3.  The User Class**

User 클래스는 사용자를 설명하는 데 사용됩니다. 그림 16에 표시된 것처럼 주로 UserId 집계 클래스에 대한 "컨테이너" 클래스로 사용됩니다.

```text
               +---------------+
               |     User      |
               +---------------+       1..* +--------+
               | STRING ident  |<>----------| UserId |
               | ENUM category |            +--------+
               +---------------+

                         Figure 16: The User Class
```

User에 포함된 집계 클래스는 다음과 같습니다.

```text
   UserId
```

-  하나 이상. 유형 속성으로 표시되는 사용자 식별\(섹션 4.2.7.3.1 참조\)

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.usercat              "
       ( unknown | application | os-device )
     ">

   <!ELEMENT User                          (
       UserId+
     )>
   <!ATTLIST User
       ident               CDATA                   '0'
       category            %attvals.usercat;       'unknown'
       %attlist.global;
     >
```

User 클래스에는 두 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 사용자의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   category
```

- 선택사항입니다. 표시되는 사용자 유형입니다. 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "알 수 없음"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
        +------+-------------+------------------------------------+
        | Rank | Keyword     | Description                        |
        +------+-------------+------------------------------------+
        |    0 | unknown     | User type unknown                  |
        |      |             |                                    |
        |    1 | application | An application user                |
        |      |             |                                    |
        |    2 | os-device   | An operating system or device user |
        +------+-------------+------------------------------------+
```

---
###### **4.2.7.3.1.  The UserId Class**

UserId 클래스는 사용자에 대한 특정 정보를 제공합니다. User 클래스 내에서 둘 이상의 UserId를 사용하여 한 사용자에서 다른 사용자로 전환하려는 시도를 나타내거나 사용자\(또는 프로세스\) 권한에 대한 전체 정보를 제공할 수 있습니다.

UserId 클래스는 그림 17에 표시된 것처럼 두 개의 집계 클래스로 구성됩니다.

```text
                      +--------------+
                      |    UserId    |
                      +--------------+       0..1 +--------+
                      | STRING ident |<>----------|  name  |
                      | ENUM type    |            +--------+
                      | STRING tty   |       0..1 +--------+
                      |              |<>----------| number |
                      |              |            +--------+
                      +--------------+
```

- 그림 17: UserId 클래스

UserId를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

- 0 아니면 1. 끈. 사용자 또는 그룹 이름입니다.

```text
   number
```

- 0 아니면 1. 정수. 사용자 또는 그룹 번호.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.idtype               "
       ( current-user | original-user | target-user | user-privs |
         current-group | group-privs | other-privs )
     ">

   <!ELEMENT UserId                        (
       (name, number?) | (number, name?)
     )>
   <!ATTLIST UserId
       ident               CDATA                   '0'
       type                %attvals.idtype;        'original-user'
       tty                 CDATA                   #IMPLIED
       %attlist.global;
     >
```

UserId 클래스에는 세 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 사용자 ID의 고유 식별자는 섹션 3.2.9를 참조하세요.

```text
   type
```

선택 과목. 표시되는 사용자 정보의 유형입니다. 그만큼

- 이 속성에 허용되는 값은 아래와 같습니다. 기본값은 "원래 사용자"입니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | current-user  | The current user id being used by the user |
   |      |               | or process.  On Unix systems, this would   |
   |      |               | be the "real" user id, in general.         |
   |      |               |                                            |
   |    1 | original-user | The actual identity of the user or process |
   |      |               | being reported on.  On those systems that  |
   |      |               | (a) do some type of auditing and (b)       |
   |      |               | support extracting a user id from the      |
   |      |               | "audit id" token, that value should be     |
   |      |               | used.  On those systems that do not        |
   |      |               | support this, and where the user has       |
   |      |               | logged into the system, the "login id"     |
   |      |               | should be used.                            |
   |      |               |                                            |
   |    2 | target-user   | The user id the user or process is         |
   |      |               | attempting to become.  This would apply,   |
   |      |               | on Unix systems for example, when the user |
   |      |               | attempts to use "su", "rlogin", "telnet",  |
   |      |               | etc.                                       |
   |      |               |                                            |
   |    3 | user-privs    | Another user id the user or process has    |
   |      |               | the ability to use, or a user id           |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" user id in a user or process   |
   |      |               | context, and the owner permissions in a    |
   |      |               | file context.  Multiple UserId elements of |
   |      |               | this type may be used to specify a list of |
   |      |               | privileges.                                |
   |      |               |                                            |
   |    4 | current-group | The current group id (if applicable) being |
   |      |               | used by the user or process.  On Unix      |
   |      |               | systems, this would be the "real" group    |
   |      |               | id, in general.                            |
   |      |               |                                            |
   |    5 | group-privs   | Another group id the group or process has  |
   |      |               | the ability to use, or a group id          |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" group id in a group or process |
   |      |               | context, and the group permissions in a    |
   |      |               | file context.  On BSD-derived Unix         |
   |      |               | systems, multiple UserId elements of this  |
   |      |               | type would be used to include all the      |
   |      |               | group ids on the "group list".             |

   |    6 | other-privs   | Not used in a user, group, or process      |
   |      |               | context, only used in the file context.    |
   |      |               | The file permissions assigned to users who |
   |      |               | do not match either the user or group      |
   |      |               | permissions on the file.  On Unix systems, |
   |      |               | this would be the "world" permissions.     |
   +------+---------------+--------------------------------------------+

   tty
```

- 선택사항입니다. 끈. 사용자가 사용 중인 tty입니다.

---
##### **4.2.7.4.  The Process Class**

Process 클래스는 소스, 대상 및 분석기에서 실행되는 프로세스를 설명하는 데 사용됩니다.

Process 클래스는 그림 18에 표시된 것처럼 5개의 집계 클래스로 구성됩니다.

```text
                     +--------------+
                     |    Process   |
                     +--------------+            +------+
                     | STRING ident |<>----------| name |
                     |              |            +------+
                     |              |       0..1 +------+
                     |              |<>----------| pid  |
                     |              |            +------+
                     |              |       0..1 +------+
                     |              |<>----------| path |
                     |              |            +------+
                     |              |       0..* +------+
                     |              |<>----------| arg  |
                     |              |            +------+
                     |              |       0..* +------+
                     |              |<>----------| env  |
                     |              |            +------+
                     +--------------+

                       Figure 18: The Process Class
```

Process를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

- 딱 하나요. 끈. 실행 중인 프로그램의 이름입니다. 이것은 짧은 이름입니다. 경로 및 인수 정보는 다른 곳에서 제공됩니다.

```text
   pid
```

- 0 아니면 1. 정수. 프로세스의 프로세스 식별자입니다.

```text
   path
```

0 또는 1. 끈. 프로그램의 전체 경로는 다음과 같습니다.

- 처형.

```text
   arg
```

- 0개 이상. 끈. 프로그램에 대한 명령줄 인수입니다. arg를 여러 번 사용하면 여러 인수를 지정할 수 있습니다\(제공된 순서와 동일한 순서로 발생한 것으로 가정\).

```text
   env
```

- 0개 이상. 끈. 프로세스와 관련된 환경 문자열입니다. 일반적으로 "VARIABLE=value" 형식입니다. env를 여러 번 사용하면 여러 환경 문자열을 지정할 수 있습니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
    <!ELEMENT Process                       (
       name, pid?, path?, arg*, env*
     )>
   <!ATTLIST Process
       ident               CDATA                   '0'
       %attlist.global;
     >
```

Process 클래스에는 하나의 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 프로세스의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

---
##### **4.2.7.5.  The Service Class**

서비스 클래스는 소스와 대상의 네트워크 서비스를 설명합니다. 이름, 포트 및 프로토콜로 서비스를 식별할 수 있습니다. 서비스가 소스의 집합 클래스로 발생하는 경우 해당 서비스는 관심 활동이 시작되는 서비스인 것으로 이해됩니다. 서비스는 소스에도 포함된 노드, 프로세스 및 사용자 정보에 "연결"됩니다. 마찬가지로 서비스가 Target의 집계 클래스로 발생하는 경우 해당 서비스는 관심 있는 활동이 전달되는 서비스인 것으로 이해됩니다. 서비스는 Target에도 포함된 노드, 프로세스 및 사용자 정보에 "연결"됩니다. 서비스가 소스와 대상 모두에서 발생하는 경우 두 위치의 정보는 동일해야 합니다. 정보가 두 위치 모두에서 동일하고 구현자가 이를 한 위치에서만 전달하려는 경우 해당 정보를 Target 클래스의 집계로 지정해야 합니다.

서비스 클래스는 그림 19에 표시된 것처럼 4개의 집계 클래스로 구성됩니다.

```text
            +-----------------------------+
            |   Service                   |
            +-----------------------------+       0..1 +----------+
            | STRING  ident               |<>----------|   name   |
            | INTEGER ip_version          |            +----------+
            | INTEGER iana_protocol_number|       0..1 +----------+
            | STRING  iana_protocol_name  |<>----------|   port   |
            |                             |            +----------+
            |                             |       0..1 +----------+
            |                             |<>----------| portlist |
            |                             |            +----------+
            |                             |       0..1 +----------+
            |                             |<>----------| protocol |
            |                             |            +----------+
            +-----------------------------+
                            /_\
                             |
                   +---------+--------+
                   |                  |
            +-------------+     +-------------+
            | SNMPService |     | WebService  |
            +-------------+     +-------------+

                       Figure 19: The Service Class
```

서비스를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

0 또는 1. 끈. 서비스의 이름입니다. 언제든지

- 가능하다면 잘 알려진 포트의 IANA 목록에 있는 이름을 사용해야 합니다.\(SHOULD\)

```text
   port
```

- 0 아니면 1. 정수. 사용 중인 포트 번호입니다.

```text
   portlist
```

- 0 아니면 1. 포리스트. 사용 중인 포트 번호 목록. 형식 지정 규칙은 섹션 3.2.8을 참조하세요. 포트 목록이 제공되면 iana\_protocol\_number 및 iana\_protocol\_name이 목록의 모든 요소에 적용되어야 합니다.\(MUST\)

```text
   protocol
```

- 0 아니면 1. 끈. 사용 중인 프로토콜에 대한 추가 정보입니다. 프로토콜 필드의 목적은 <Service\> 속성 iana\_protocol\_number 또는/및 iana\_protocol\_name이 제출될 때 사용되는 프로토콜과 관련된 추가 정보를 전달하는 것입니다.

서비스는 \(a\) 이름이나 포트 또는 \(b\) 포트 목록으로 지정되어야 합니다. 프로토콜은 모든 경우에 선택 사항이지만 다른 조합은 허용되지 않습니다.\(MUST\)

서비스는 IDMEF DTD에 다음과 같이 표시됩니다.

```text
   <!ELEMENT Service                       (
       (((name, port?) | (port, name?)) | portlist), protocol?,
       SNMPService?, WebService?
     )>
   <!ATTLIST Service
       ident                CDATA                   '0'
   ip_version           CDATA                   #IMPLIED
   iana_protocol_number CDATA                  #IMPLIED
   iana_protocol_name   CDATA                  #IMPLIED
       %attlist.global;
     >
```

서비스 클래스에는 네 가지 속성이 있습니다.

```text
   ident
```

- 선택사항입니다. 서비스의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   ip_version
```

- 선택사항입니다. 정수. IP 버전 번호.

```text
   iana_protocol_number
```

- 선택사항입니다. 정수. IANA 프로토콜 번호입니다.

```text
   iana_protocol_name
```

- 선택사항입니다. 끈. IANA 프로토콜 이름입니다.

---
###### **4.2.7.5.1.  The WebService Class**

WebService 클래스는 웹 트래픽과 관련된 추가 정보를 전달합니다.

WebService 클래스는 그림 20에 표시된 것처럼 4개의 집계 클래스로 구성됩니다.

```text
                   +-------------+
                   |   Service   |
                   +-------------+
                         /_\
                          |
                   +-------------+
                   | WebService  |
                   +-------------+            +-------------+
                   |             |<>----------|     url     |
                   |             |            +-------------+
                   |             |       0..1 +-------------+
                   |             |<>----------|     cgi     |
                   |             |            +-------------+
                   |             |       0..1 +-------------+
                   |             |<>----------| http-method |
                   |             |            +-------------+
                   |             |       0..* +-------------+
                   |             |<>----------|     arg     |
                   |             |            +-------------+
                   +-------------+

                      Figure 20: The WebService Class
```

WebService를 구성하는 집계 클래스는 다음과 같습니다.

```text
   url
```

- 딱 하나요. 끈. 요청의 URL입니다.

```text
   cgi
```

- 0 아니면 1. 끈. 인수가 없는 요청의 CGI 스크립트입니다.

```text
   http-method
```

- 0 아니면 1. 끈. 요청에 사용된 HTTP 메서드\(PUT, GET\)입니다.

```text
   arg
```

- 0개 이상. 끈. CGI 스크립트에 대한 인수입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT WebService                    (
       url, cgi?, http-method?, arg*
     )>
   <!ATTLIST WebService
       %attlist.global;
     >
```

---
###### **4.2.7.5.2.  The SNMPService Class**

SNMPService 클래스는 SNMP 트래픽과 관련된 추가 정보를 전달합니다. SNMPService를 구성하는 집합 클래스는 RFC 3411 \[15\] 및 RFC 3584 \[16\]에 설명된 대로 해석되어야 합니다.

SNMPService 클래스는 그림 21에 표시된 대로 8개의 집계 클래스로 구성됩니다.

```text
                +-------------+
                |   Service   |
                +-------------+
                      /_\
                       |
                +-------------+
                | SNMPService |
                +-------------+       0..1 +----------------------+
                |             |<>----------|       oid            |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|messageProcessingModel|
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|    securityModel     |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|    securityName      |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|   securityLevel      |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|    contextName       |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|   contextEngineID    |
                |             |            +----------------------+
                |             |       0..1 +----------------------+
                |             |<>----------|     command          |
                |             |            +----------------------+
                +-------------+
```

- 그림 21: SNMPService 클래스

SNMPService를 구성하는 집계 클래스는 다음과 같습니다.

```text
   oid
```

- 0 아니면 1. 끈. 요청의 객체 식별자입니다.

```text
   messageProcessingModel
```

- 0 아니면 1. 정수. SNMP 버전은 일반적으로 SNMPv1의 경우 0, SNMPv2c의 경우 1, SNMPv2u 및 SNMPv2\*의 경우 2, SNMPv3의 경우 3입니다. 적절한 값은 RFC 3411 \[15\] 섹션 5를 참조하세요.

```text
   securityModel
```

- 0 아니면 1. 정수. 사용 중인 보안 모델의 식별입니다. 일반적으로 임의의 경우 0, SNMPv1의 경우 1, SNMPv2c의 경우 2, USM의 경우 3입니다. 적절한 값은 RFC 3411 \[15\] 섹션 5를 참조하세요.

```text
   securityName
```

- 0 아니면 1. 끈. 개체의 보안 이름입니다. RFC 3411 \[15\] 섹션 3.2.2를 참조하세요.

```text
   securityLevel
```

- 0 아니면 1. 정수. SNMP 요청의 보안 수준. RFC 3411 \[15\] 섹션 3.4.3을 참조하세요.

```text
   contextName
```

- 0 아니면 1. 끈. 객체의 컨텍스트 이름입니다. RFC 3411 \[15\] 섹션 3.3.3을 참조하세요.

```text
   contextEngineID
```

- 0 아니면 1. 끈. 객체의 컨텍스트 엔진 식별자입니다. RFC 3411 \[15\] 섹션 3.3.2를 참조하세요.

```text
   command
```

- 0 아니면 1. 끈. SNMP 서버\(GET, SET 등\)로 전송되는 명령입니다.

SNMP 메시지의 다른 필드를 사용할 수 있고 IDMEF 경고에 통합해야 하는 경우 해당 필드는 RFC 3411 \[15\] 섹션 5에 정의된 개체 정의 및 추가 데이터 페이로드 내에 있는 값을 의미하는 추가 데이터 구조에 있어야 합니다. .

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT SNMPService                   (
       oid?, messageProcessingModel?, securityModel?, securityName?,
       securityLevel?, contextName?, contextEngineID?, command?
     )>
   <!ATTLIST SNMPService
       %attlist.global;
     >
```

---
##### **4.2.7.6.  The File Class**

File 클래스는 대상에서 생성, 삭제 또는 수정된 파일 또는 기타 파일과 유사한 객체에 대한 특정 정보를 제공합니다. 설명은 "category" 속성을 사용하여 지정된 대로 이벤트 이전의 파일 설정이나 이벤트 당시의 파일 설정을 제공할 수 있습니다.

```text
   The File class is composed of eleven aggregate classes, as shown in
   Figure 22.
                  +--------------+
                  |     File     |
                  +--------------+            +-------------+
                  |              |<>----------|    name     |
                  |              |            +-------------+
                  |              |            +-------------+
                  |              |<>----------|    path     |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------| create-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------| modify-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------| access-time |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------|  data-size  |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------|  disk-size  |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |<>----------| FileAccess  |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |<>----------|   Linkage   |
                  |              |            +-------------+
                  |              |       0..1 +-------------+
                  |              |<>----------|    Inode    |
                  |              |            +-------------+
                  |              |       0..* +-------------+
                  |              |<>----------|  Checksum   |
                  |              |            +-------------+
                  +--------------+

                         Figure 22: The File Class
```

File을 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

- 딱 하나요. 끈. 파일 경로를 제외한 경고가 적용되는 파일의 이름입니다.

```text
   path
```

- 딱 하나요. 끈. 이름을 포함한 파일의 전체 경로입니다. 경로 이름은 경고 처리를 용이하게 하기 위해 가능한 "범용" 방식으로 표시되어야 합니다.

- Windows 시스템의 경우 원격 파일의 경우 UNC\(범용 명명 규칙\)를 사용하고 로컬 파일의 경우 드라이브 문자\(예: "C:\boot.ini"\)를 사용하여 경로를 지정해야 합니다. Unix 시스템의 경우 네트워크 파일 시스템의 경로는 로컬 마운트 지점 대신 마운트된 리소스의 이름을 사용해야 합니다\(예: "fileserver:/usr/local/bin/foo"\). 마운트 지점은 <Linkage\> 요소를 사용하여 제공될 수 있습니다.

```text
   create-time
```

- 0 아니면 1. 날짜 시간. 파일이 생성된 시간입니다. 이는 Unix "st\_ctime" 파일 속성\(파일 생성 시간이 아님\)이 \*아닙니다\*. Unix "st\_ctime" 속성은 "Inode" 클래스에 포함되어 있습니다.

```text
   modify-time
```

- 0 아니면 1. 날짜 시간. 파일이 마지막으로 수정된 시간입니다.

```text
   access-time
```

- 0 아니면 1. 날짜 시간. 파일이 마지막으로 액세스된 시간입니다.

```text
   data-size
```

- 0 아니면 1. 정수. 데이터의 크기\(바이트\)입니다. 일반적으로 파일 크기를 언급할 때의 의미입니다. Unix UFS 파일 시스템에서 이 값은 stat.st\_size에 해당합니다. Windows NTFS에서 이 값은 VDL\(유효 데이터 길이\)에 해당합니다.

```text
   disk-size
```

- 0 아니면 1. 정수. 파일이 사용하는 디스크의 물리적 공간\(바이트\)입니다. Unix UFS 파일 시스템에서 이 값은 512 \* stat.st\_blocks에 해당합니다. Windows NTFS에서 이 값은 EOF\(파일 끝\)에 해당합니다.

```text
   FileAccess
```

- 0개 이상. 파일에 대한 액세스 권한입니다.

```text
   Linkage
```

- 0개 이상. 이 파일이 링크된 파일 시스템 개체\(파일에 대한 다른 참조\)

```text
   Inode
```

- 0 아니면 1. 이 파일에 대한 Inode 정보\(Unix 관련\)

```text
   Checksum
```

- 0개 이상. 이 파일에 대한 체크섬 정보입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.filecat              "
       ( current | original )
     ">

   <!ELEMENT File                          (
       name, path, create-time?, modify-time?, access-time?,
       data-size?, disk-size?, FileAccess*, Linkage*, Inode?,
       Checksum*
     )>
   <!ATTLIST File
       ident               CDATA                   '0'
       category            %attvals.filecat;       #REQUIRED
       fstype              CDATA                   #IMPLIED
       file-type           CDATA                   #IMPLIED
       %attlist.global;
     >
```

File 클래스에는 4개의 속성\(1개는 필수, 3개는 선택\)이 있습니다.

```text
   ident
```

- 선택사항입니다. 이 파일의 고유 식별자입니다. 섹션 3.2.9를 참조하세요.

```text
   category
```

-  필수의. 제공되는 정보의 컨텍스트입니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+----------+-------------------------------------------------+
   | Rank | Keyword  | Description                                     |
   +------+----------+-------------------------------------------------+
   |    0 | current  | The file information is from after the reported |
   |      |          | change                                          |
   |      |          |                                                 |
   |    1 | original | The file information is from before the         |
   |      |          | reported change                                 |
   +------+----------+-------------------------------------------------+

   fstype
```

- 선택사항입니다. 파일이 있는 파일 시스템의 유형입니다. 이 속성은 경로 이름 및 기타 속성이 해석되는 방식을 제어합니다.

```text
                +------+---------+-------------------------------------+
                | Rank | Keyword | Description                         |
                +------+---------+-------------------------------------+
                |    0 | ufs     | Berkeley Unix Fast File System      |
                |    1 | efs     | Linux "efs" file system             |
                |    2 | nfs     | Network File System                 |
                |    3 | afs     | Andrew File System                  |
                |    4 | ntfs    | Windows NT File System              |
                |    5 | fat16   | 16-bit Windows FAT File System      |
                |    6 | fat32   | 32-bit Windows FAT File System      |
                |    7 | pcfs    | "PC" (MS-DOS) file system on CD-ROM |
                |    8 | joliet  | Joliet CD-ROM file system           |
                |    9 | iso9660 | ISO 9660 CD-ROM file system         |
                +------+---------+-------------------------------------+

   file-type
```

- 선택사항입니다. MIME 유형과 같은 파일 유형입니다.

---
###### **4.2.7.6.1.  The FileAccess Class**

FileAccess 클래스는 파일에 대한 액세스 권한을 나타냅니다. 이 표현은 운영 체제 전반에 걸쳐 유용하게 사용됩니다.

FileAccess 클래스는 그림 23에 표시된 것처럼 두 개의 집계 클래스로 구성됩니다.

```text
                  +--------------+
                  |  FileAccess  |
                  +--------------+            +------------+
                  |              |<>----------|   UserId   |
                  |              |            +------------+
                  |              |       1..* +------------+
                  |              |<>----------| Permission |
                  |              |            +------------+
                  +--------------+

                      Figure 23: The FileAccess Class
```

FileAccess를 구성하는 집계 클래스는 다음과 같습니다.

```text
   UserId
```

- 딱 하나요. 이러한 권한이 적용되는 사용자\(또는 그룹\)입니다. "type" 속성의 값은 적절하게 "user-privs", "group-privs" 또는 "other-privs"여야 합니다. 이 컨텍스트에서는 "type"에 대한 다른 값을 사용하면 안 됩니다.\(MUST NOT\)

```text
   Permission
```

-  하나 이상. ENUM. 허용되는 액세스 수준입니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | noAccess          | No access at all is allowed for this   |
   |      |                   | user                                   |
   |      |                   |                                        |
   |    1 | read              | This user has read access to the file  |
   |      |                   |                                        |
   |    2 | write             | This user has write access to the file |
   |      |                   |                                        |
   |    3 | execute           | This user has the ability to execute   |
   |      |                   | the file                               |
   |      |                   |                                        |
   |    4 | search            | This user has the ability to search    |
   |      |                   | this file (applies to "execute"        |
   |      |                   | permission on directories in Unix)     |
   |      |                   |                                        |
   |    5 | delete            | This user has the ability to delete    |
   |      |                   | this file                              |
   |      |                   |                                        |
   |    6 | executeAs         | This user has the ability to execute   |
   |      |                   | this file as another user              |
   |      |                   |                                        |
   |    7 | changePermissions | This user has the ability to change    |
   |      |                   | the access permissions on this file    |
   |      |                   |                                        |
   |    8 | takeOwnership     | This user has the ability to take      |
   |      |                   | ownership of this file                 |
   +------+-------------------+----------------------------------------+
```

"changePermissions" 및 "takeOwnership" 문자열은 Windows의 이러한 개념을 나타냅니다. Unix에서는 해당 사용자에게 다른 액세스가 허용되지 않더라도 파일 소유자는 항상 "changePermissions" 액세스 권한을 갖습니다. Windows의 "모든 권한"은 포함된 권한을 열거하여 표시됩니다. "executeAs" 문자열은 Unix의 set-user-id 및 set-group-id 기능을 나타냅니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Permission EMPTY >
   <!ATTLIST Permission
       perms               %attvals.fileperm;      #REQUIRED
       %attlist.global;
   >

   <!ENTITY % attvals.fileperm "( noAccess | read | write | execute |
     search | delete | executeAs | changePermissions |
     takeOwnership)" >
```

---
###### **4.2.7.6.2.  The Linkage Class**

Linkage 클래스는 <File\> 요소에 설명된 파일과 파일 시스템의 다른 개체 간의 파일 시스템 연결을 나타냅니다. 예를 들어 <File\> 요소가 심볼릭 링크나 바로가기인 경우 <Linkage\> 요소에는 링크가 가리키는 개체의 이름이 포함되어야 합니다. 해당하는 경우 다른 <File\> 요소를 사용하여 <Linkage\> 요소의 개체에 대한 추가 정보를 제공할 수 있습니다.

Linkage 클래스는 그림 24에 표시된 것처럼 세 개의 집계 클래스로 구성됩니다.

```text
                  +--------------+
                  |   Linkage    |
                  +--------------+            +------+
                  |              |<>----------| name |
                  |              |            +------+
                  |              |            +------+
                  |              |<>----------| path |
                  |              |            +------+
                  |              |            +------+
                  |              |<>----------| File |
                  |              |            +------+
                  +--------------+

                       Figure 24: The Linkage Class
```

Linkage를 구성하는 집계 클래스는 다음과 같습니다.

```text
   name
```

- 딱 하나요. 끈. 경로를 제외한 파일 시스템 개체의 이름입니다.

```text
   path
```

- 딱 하나요. 끈. 이름을 포함한 파일 시스템 개체의 전체 경로입니다. 경로 이름은 경고 처리를 용이하게 하기 위해 가능한 "범용" 방식으로 표시되어야 합니다.

```text
   File
```

- 딱 하나요. 파일에 대한 추가 정보를 포함하려는 경우 <name\> 및 <path\> 요소 대신 <File\> 요소를 사용할 수 있습니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.linkcat              "
       ( hard-link | mount-point | reparse-point | shortcut | stream |
         symbolic-link )
     ">

   <!ELEMENT Linkage                       (
       (name, path) | File
     )>
   <!ATTLIST Linkage
       category            %attvals.linkcat;       #REQUIRED
       %attlist.global;
     >
```

Linkage 클래스에는 하나의 속성이 있습니다.

```text
   category
```

- 링크가 설명하는 개체 유형입니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | hard-link     | The <name> element represents another name |
   |      |               | for this file.  This information may be    |
   |      |               | more easily obtainable on NTFS file        |
   |      |               | systems than others.                       |
   |      |               |                                            |
   |    1 | mount-point   | An alias for the directory specified by    |
   |      |               | the parent's <name> and <path> elements.   |
   |      |               |                                            |
   |    2 | reparse-point | Applies only to Windows; excludes symbolic |
   |      |               | links and mount points, which are specific |
   |      |               | types of reparse points.                   |
   |      |               |                                            |
   |    3 | shortcut      | The file represented by a Windows          |
   |      |               | "shortcut".  A shortcut is distinguished   |
   |      |               | from a symbolic link because of the        |
   |      |               | difference in their contents, which may be |
   |      |               | of importance to the manager.              |
   |      |               |                                            |
   |    4 | stream        | An Alternate Data Stream (ADS) in Windows; |
   |      |               | a fork on MacOS.  Separate file system     |
   |      |               | entity that is considered an extension of  |
   |      |               | the main <File>.                           |
   |    5 | symbolic-link | The <name> element represents the file to  |
   |      |               | which the link points.                     |
   +------+---------------+--------------------------------------------+
```

---
###### **4.2.7.6.3.  The Inode Class**

Inode 클래스는 Unix 파일 시스템 i-node에 포함된 추가 정보를 나타내는 데 사용됩니다.

Inode 클래스는 그림 25에 표시된 대로 6개의 집계 클래스로 구성됩니다.

```text
                  +--------------+
                  |    Inode     |
                  +--------------+            +----------------+
                  |              |<>----------|   change-time  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |<>----------|     number     |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |<>----------|  major-device  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |<>----------|  minor-device  |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |<>----------| c-major-device |
                  |              |            +----------------+
                  |              |            +----------------+
                  |              |<>----------| c-minor-device |
                  |              |            +----------------+
                  +--------------+
```

- 그림 25: Inode 클래스

Inode를 구성하는 집계 클래스는 다음과 같습니다.

```text
   change-time
```

- 0 아니면 1. 날짜 시간. "struct stat"의 st\_ctime 요소에 의해 제공되는 마지막 inode 변경 시간입니다.

```text
   number
```

- 0 아니면 1. 정수. 아이노드 번호.

```text
   major-device
```

- 0 아니면 1. 정수. 파일이 있는 장치의 주요 장치 번호입니다.

```text
   minor-device
```

- 0 아니면 1. 정수. 파일이 있는 장치의 보조 장치 번호입니다.

```text
   c-major-device
```

- 0 아니면 1. 정수. 문자 특수 장치인 경우 파일 자체의 주요 장치입니다.

```text
   c-minor-device
```

- 0 아니면 1. 정수. 문자 특수 장치인 경우 파일 자체의 보조 장치입니다.

주의할 점은 <number\>, <major-device\>, <minor-device\>는 함께 주어져야 하고, <c-major-device\>와 <c-minor-device\>는 함께 주어져야 한다는 점입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ELEMENT Inode                         (
       change-time?, (number, major-device, minor-device)?,
       (c-major-device, c-minor-device)?
     )>
   <!ATTLIST Inode
       %attlist.global;
     >
```

---
###### **4.2.7.6.4.  The Checksum Class**

Checksum 클래스는 파일과 관련된 체크섬 정보를 나타냅니다. 이 체크섬 정보는 파일 무결성 검사기 등을 통해 제공될 수 있습니다.

체크섬 클래스는 그림 26에 표시된 것처럼 두 개의 집계 클래스로 구성됩니다.

```text
                  +--------------+
                  |   Checksum   |
                  +--------------+            +-------+
                  | algorithm    |<>----------| value |
                  |              |            +-------+
                  |              |        0..1+-------+
                  |              |<>----------|  key  |
                  |              |            +-------+
                  +--------------+

                       Figure 26: The Checksum Class
```

체크섬을 구성하는 집계 클래스는 다음과 같습니다.

```text
   value
```

- 딱 하나요. 끈. 체크섬의 값입니다.

```text
   key
```

- 0 아니면 1. 끈. 해당하는 경우 체크섬의 키입니다.

이는 IDMEF DTD에서 다음과 같이 표현됩니다.

```text
   <!ENTITY % attvals.checksumalgos        "
         ( MD4 | MD5 | SHA1 | SHA2-256 | SHA2-384 | SHA2-512 | CRC-32 |
           Haval | Tiger | Gost )
     ">

   <!ELEMENT Checksum                      (
       value, key?
     )>
   <!ATTLIST Checksum
       algorithm           %attvals.checksumalgos; #REQUIRED
       %attlist.global;
     >
```

Checksum 클래스에는 다음과 같은 속성이 하나 있습니다.

```text
   algorithm
```

- 체크섬 계산에 사용되는 암호화 알고리즘입니다. 허용되는 값은 아래와 같습니다. 기본값은 없습니다. \(또한 섹션 10을 참조하십시오.\)

```text
      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | MD4      | The MD4 algorithm.                       |
      |      |          |                                          |
      |    1 | MD5      | The MD5 algorithm.                       |
      |      |          |                                          |
      |    2 | SHA1     | The SHA1 algorithm.                      |
      |      |          |                                          |
      |    3 | SHA2-256 | The SHA2 algorithm with 256 bits length. |
      |      |          |                                          |
      |    4 | SHA2-384 | The SHA2 algorithm with 384 bits length. |
      |      |          |                                          |
      |    5 | SHA2-512 | The SHA2 algorithm with 512 bits length. |
      |      |          |                                          |
      |    6 | CRC-32   | The CRC algorithm with 32 bits length.   |
      |      |          |                                          |
      |    7 | Haval    | The Haval algorithm.                     |
      |      |          |                                          |
      |    8 | Tiger    | The Tiger algorithm.                     |
      |      |          |                                          |
      |    9 | Gost     | The Gost algorithm.                      |
      +------+----------+------------------------------------------+
```

---
## **5.  Extending the IDMEF**

침입 탐지 시스템이 발전함에 따라 IDMEF 데이터 모델과 DTD도 함께 발전해야 합니다. 개발 시 새로운 기능을 추가할 수 있도록 이 섹션에 설명된 대로 데이터 모델과 DTD를 모두 확장할 수 있습니다. 이러한 확장 기능이 완성되면 사양의 향후 버전에 통합될 수 있습니다.

---
### **5.1.  Extending the Data Model**

IDMEF 데이터 모델을 확장하는 메커니즘에는 상속과 집계라는 두 가지 메커니즘이 있습니다.

o 상속은 하위 클래스가 모든 속성, 작업 및 속성을 상속하는 관계의 상위 클래스/하위 클래스 유형을 나타냅니다.

- 슈퍼클래스의 관계. 이러한 유형의 관계를 "is-a" 또는 "kind-of" 관계라고도 합니다. 하위 클래스에는 하위 클래스에만 적용되고 상위 클래스에는 적용되지 않는 추가 속성이나 작업이 있을 수 있습니다.

o 집합은 전체가 부분과 관련되어 있는 연합의 한 형태입니다. 이러한 유형의 관계를 "부분" 관계라고도 합니다. 이 경우 집합 클래스에는 자체 속성이 모두 포함되며 발생 표시기에 의해 필요하고 지정된 해당 부분과 연관된 속성도 모두 포함됩니다.

두 메커니즘 중에서 상속이 선호되는 이유는 기존 데이터 모델 구조를 보존하고 구조의 클래스에서 실행되는 작업\(메서드\)도 보존하기 때문입니다.

IDMEF DTD 확장 규칙\(아래 참조\)은 데이터 모델 확장이 이루어질 수 있는 위치에 대한 제한을 설정합니다.

---
### **5.2.  Extending the IDMEF DTD**

IDMEF DTD를 확장하는 방법에는 두 가지가 있습니다.

1. 추가 데이터 클래스\(섹션 4.2.4.6 참조\)는 다음을 허용합니다.

- 구현자는 경고 또는 하트비트 메시지에 임의의 "원자" 데이터 항목\(정수, 문자열 등\)을 포함합니다. 이 접근 방식은 가능할 때마다 사용해야 합니다. 섹션 7.4 및 섹션 7.5를 참조하십시오.\(SHOULD\)

2. 추가 데이터 클래스를 사용하면 구현자가 임의로 복잡한 데이터 유형 및 관계를 설명하는 추가 DTD "모듈"을 사용하여 IDMEF DTD를 확장할 수 있습니다. 이 섹션의 나머지 부분에서는 이 확장 방법을 설명합니다.

새로운 DTD "모듈"로 IDMEF DTD를 확장하려면 다음 단계를 따라야 합니다.\(MUST\)

1. 문서 선언은 네임스페이스를 정의하고 확장 DTD의 위치를 ​​포함하는 DTD 위치를 정의한 다음 해당 네임스페이스를 참조해야 합니다.\(MUST\)

2. 여러 확장을 정의하여 여러 확장을 포함할 수 있습니다.

- 네임스페이스와 DTD 위치 및 이를 참조합니다.

3. 확장 DTD는 별도의 XML 네임스페이스에서 모든 요소와 속성을 선언해야 합니다. 확장 DTD는 "idmef" 또는 기본 네임스페이스의 요소나 속성을 선언해서는 안 됩니다.\(MUST, MUST NOT\)

4. 확장은 "type" 속성에 "xml" 값이 포함된 <AdditionalData\> 요소 아래의 IDMEF 경고 및 하트비트 메시지에만 포함되어야 합니다. 예를 들어:\(MUST\)

이 예에서는 "vendorco" 네임스페이스가 정의된 다음 참조되어 XML 파서가 확장에 대한 DTD를 읽게 됩니다.

```text
   <idmef:IDMEF-Message version="1.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xmlns:idmef="http://iana.org/idmef"
     xmlns:vendorco="http://vendor.com/idmef"
   xsi:schemaLocation="http://vendor.com/idmef http://v.com/vidmef.xsd">
```

<idmef:경고 메시지id="..."\>

- ... <idmef:AdditionalData type="xml"meaning="VendorExtension"\> <idmef:xml\> <vendorco:TestVendor a="예제의 속성" xmlns:vendorco="http://vendor.com/idmef" xsi:schemaLocation="http://vendor.com/idmef http://v.com/vidmef.xsd"\> <vendorco:content\>예제의 콘텐츠 요소</vendorco:content\> </vendorco:TestVendor\> </ idmef:xml\> </idmef:AdditionalData\> </idmef:Alert\> </idmef:IDMEF-메시지\>

IDMEF DTD 확장의 또 다른 예는 섹션 7.8을 참조하십시오.

---
## **6.  Special Considerations**

이 섹션에서는 IDMEF 구현자가 고려해야 할 몇 가지 특별한 고려 사항에 대해 설명합니다.

---
### **6.1.  XML Validity and Well-Formedness**

IDMEF 호환 응용 프로그램은 일반적으로 통신에 IDMEF DTD 자체를 포함하지 않을 것으로 예상됩니다. 대신 DTD는 IDMEF 메시지의 문서 유형 정의에서 참조됩니다. 이러한 IDMEF 문서는 \[3\]에 정의된 대로 잘 구성되고 유효합니다.

문서 프롤로그를 포함하지 않는 다른 IDMEF 문서가 지정됩니다\(예: IDMEF 형식 데이터베이스의 항목\). 이러한 IDMEF 문서는 형식은 잘 되어 있지만 유효하지 않습니다.

일반적으로 올바른 형식이란 문서에 다른 모든 요소를 ​​포함하는 단일 요소\(예: "<Book\>"\)가 있고 다른 모든 요소가 겹치지 않고 서로 잘 중첩되어 있음\(예: "장"이 시작되지 않음\)을 의미합니다. 다른 "장" 중간에\).

유효성은 문서가 잘 구성되어 있을 뿐만 아니라 문서에서 어떤 요소가 "합법적"인지, 해당 요소가 다른 요소 내에 어떻게 중첩되는지 등에 대한 특정 규칙\(문서 유형 정의에 포함됨\)을 따른다는 것을 의미합니다. 예를 들어, "챕터"는 "제목" 중간에 시작되지 않습니다. DTD를 참조하지 않으면 문서는 유효할 수 없습니다.

유효한지 여부에 관계없이 잘 구성된 문서를 구문 분석할 수 있으려면 XML 프로세서가 필요합니다. 유효성 검사의 목적은 해당 문서의 처리\(파싱된 후 데이터로 수행되는 작업\)를 더 쉽게 만드는 것입니다. 유효성 검사가 없으면 문서에는 의미 없는 순서의 요소, 처리 응용 프로그램이 이해하지 못하는 작성자가 "발명한" 요소 등이 포함될 수 있습니다.

IDMEF 문서는 올바른 형식으로 작성되어야 합니다. IDMEF 문서는 가능하고 실용적일 때마다 유효해야 합니다.\(MUST, SHOULD\)

---
### **6.2.  Unrecognized XML Tags**

경우에 따라 IDMEF 호환 응용 프로그램이 이해하지 못하는 태그가 포함된 올바른 형식의 또는 올바른 형식의 유효한 IDMEF 메시지를 받을 수도 있습니다. 태그는 다음 중 하나일 수 있습니다.

o "적법한"\(유효한 문서\)로 인식되지만 애플리케이션이 요소 콘텐츠의 의미론적 의미를 알지 못합니다. 또는

o 전혀 인식되지 않습니다.

IDMEF 호환 응용 프로그램은 알 수 없는 태그가 포함된 IDMEF 메시지를 계속해서 처리해야 합니다. 단, 이러한 메시지는 섹션 6.1의 올바른 형식 요구 사항을 충족해야 합니다. 알 수 없는 요소의 콘텐츠를 처리\(또는 무시\)하는 방법을 결정하는 것은 개별 애플리케이션에 달려 있습니다.\(MUST\)

---
### **6.3.  Analyzer-Manager Time Synchronization**

분석기와 관리자 간의 시간 시계 동기화는 이 문서의 범위를 벗어납니다. 그러나 다음과 같은 의견과 제안이 제공됩니다.

1. 가능할 때마다 모든 분석기와 관리자는 NTP\[7\] 또는 SNTP\[8\] GPS\(Global Positioning System\), GOES\(Geosynchronous Operational Environmental Satellite\), NIST와 같은 외부 소스와 시간 시계를 동기화해야 합니다. 라디오 방송국 WWV 시계 또는 기타 신뢰할 수 있는 시간 표준.

2. 외부 시간 동기화가 불가능한 경우 IDMEF는 기본적인 시간 동기화를 수행하는 데 사용할 수 있는 <AnalyzerTime\> 요소를 제공합니다\(아래 참조\).

3. IDMEF 호환 애플리케이션은 사용자가 구성 옵션으로 시간 동기화의 <AnalyzerTime\> 방법을 활성화/비활성화할 수 있도록 허용해야 합니다.\(SHOULD\)

시간 동기화를 위해 <AnalyzerTime\>을 사용할 때는 여러 가지 주의 사항이 적용됩니다.

1. <AnalyzerTime\>은 분석기가 최대 단일 수준의 관리자에게 보고하는 "평평한" 환경에서 가장 잘 작동합니다. 상위 관리자, 중간 릴레이, 분석기의 트리 토폴로지를 사용하면 문제가 더욱 복잡해집니다.

2. 중간 메시지 릴레이\(관리자 또는 기타\)가 관련된 경우 두 가지 시나리오가 가능합니다.

- \* 중개자는 전체 IDMEF 메시지를 전달할 수 있거나 집계 또는 상관 관계를 수행할 수 있지만 지연을 주입해서는 안 됩니다. 이 경우 분석기와 최상위 관리자 간에 시간 동기화가 엔드 투 엔드로 이루어집니다.\(MUST NOT\)

- \* 중개자에 의한 보관이나 추가 처리로 인해 지연이 발생할 수 있습니다. 이 경우 각 홉마다 시간 동기화를 수행해야 합니다. 이는 각 중개자가 IDMEF 메시지를 분해하고 모든 시간 값을 조정한 다음 메시지를 보내기 전에 메시지를 재구성해야 함을 의미합니다.\(MUST\)

3. 외부 시간 동기화를 사용하는 분석기와 관리자가 있고 그렇지 않은 분석기와 관리자가 혼합된 환경에서는 모든 관리자와 중개자가 <AnalyzerTime\> 동기화를 수행해야 합니다. 이는 두 당사자 간에 실제로 보상이 필요한지 여부를 결정하는 것이 매우 복잡해지고 토폴로지의 다른 부분에 대한 지식이 필요하기 때문입니다.

4. 경고가 대체 경로를 사용하거나 여러 위치에 저장될 수 있는 경우 기록된 시간은 선택한 경로에 따라 다를 수 있습니다.

위에서 언급했듯이 <AnalyzerTime\> 동기화는 아마도 많은 환경에서 아무것도 하지 않는 것보다 낫습니다. 이러한 유형의 동기화를 구현하려면 다음 절차를 제안합니다.

1. 분석기 또는 관리자가 IDMEF 메시지를 보낼 때 현재 시간 시계 값을 <AnalyzerTime\> 요소에 배치해야 합니다. 이는 메시지 전송 프로세스에서 가능한 한 늦게 발생해야 하며 이상적으로는 메시지가 "전송"되기 직전에 발생해야 합니다.

2. 관리자가 IDMEF 메시지를 받으면 자체 시간 시계와 메시지의 <AnalyzerTime\> 요소에 있는 시간 간의 차이를 계산해야 합니다. 그런 다음 이 차이를 사용하여 <CreateTime\> 및 <DetectTime\> 요소의 시간을 조정해야 합니다\(NTP 타임스탬프도 조정해야 함\).

3. 관리자가 중개자이고 상위 관리자에게 IDMEF 메시지를 보내고 홉별 동기화가 적용되는 경우 관리자는 자신의 시간 값을 포함하도록 <AnalyzerTime\> 값을 재생성해야 합니다. -요일 시계.

---
### **6.4.  NTP Timestamp Wrap-Around**

\[8\]에서:

- 1968년\(초 2,147,483,648\) 이후 최상위 비트\(정수 부분의 비트 0\)가 설정되었으며 2036년\(초 4,294,967,296\)에 64비트 필드가 오버플로될 것이라는 점에 유의하세요. 2036년에 NTP 또는 SNTP를 사용하는 경우 1900년을 기준으로 한 시간과 2036년을 기준으로 한 시간\(및 기타 136년 배수\)을 한정하기 위해 일부 외부 수단이 필요합니다. 64비트 필드가 0이 되는 경우 136년마다 200피코초 간격이 존재하며 이후에는 무시됩니다. 이는 관례적으로 유효하지 않거나 사용할 수 없는 타임스탬프로 해석됩니다.

IDMEF 호환 애플리케이션은 유효하지 않거나 사용할 수 없음을 나타내려는 의미가 아닌 이상 값이 0인 NTP 타임스탬프를 보내서는 안 됩니다. IDMEF 호환 응용 프로그램이 롤오버 시 IDMEF 메시지를 보내야 하는 경우 응용 프로그램은 타임스탬프가 0이 아닌 값을 가질 때까지 200피코초 동안 기다려야 합니다.\(MUST NOT\)

또한 \[8\]에서:

- NTP 타임스탬프 형식은 지난 17년 동안 사용되어 왔기 때문에 초 필드가 오버플로되면 지금부터 40년 동안 사용될 가능성이 남아 있습니다. 1968년에 비트 0이 설정되기 전에 NTP 타임스탬프를 보관하는 것은 아마도 부적절할 것입니다.

- NTP 타임스탬프의 유효 수명을 연장하는 편리한 방법은 다음과 같습니다.

- 비트 0이 설정된 경우 UTC 시간은 1968-2036 범위에 있고 UTC 시간은 1900년 1월 1일 0시 0분 0초 UTC부터 계산됩니다.

- 비트 0이 설정되지 않은 경우 시간은 2036-2104 범위에 있고 UTC 시간은 2036년 2월 7일 6시 28분 16초 UTC부터 계산됩니다.

- 대응관계를 계산할 때 2000년은 윤년이 아닙니다. 또한 윤초는 계산에 포함되지 않습니다.

2036-02-07T06:28:16Z 이후에 사용되는 IDMEF 호환 애플리케이션은 위의 규칙을 준수해야 합니다.\(MUST\)

---
### **6.5.  Digital Signatures**

표준 XML 디지털 서명 처리 규칙 및 구문은 \[13\]에 지정되어 있습니다. XML 서명은 서명이 포함된 XML 내부 또는 다른 위치에 있는 모든 유형의 데이터에 대해 무결성, 메시지 인증 및/또는 서명자 인증 서비스를 제공합니다.

IDMEF 요구 사항 문서\[2\]는 메시지 형식이 아닌 통신 프로토콜에 메시지 무결성 및 인증에 대한 책임을 할당합니다. 그러나 IDMEF 메시지가 덜 안전한 다른 프로토콜을 통해 교환되는 상황이나 나중에 사용하기 위해 디지털 서명을 보관해야 하는 경우에는 IDMEF 메시지 자체에 디지털 서명을 포함하는 것이 바람직할 수 있습니다.

IDMEF 메시지 내의 디지털 서명 사용에 대한 사양은 이 문서의 범위를 벗어납니다. 그러나 그러한 기능이 필요한 경우 XML 서명 표준을 사용하는 것이 좋습니다.\(SHOULD\)

---
## **7.  Examples**

이 섹션에 표시된 예는 IDMEF가 경고 데이터를 인코딩하는 데 사용되는 방법을 보여줍니다. 이러한 예는 설명 목적으로만 제공되며 이러한 특정 경고를 인코딩하는 유일한\(또는 "최적"\) 방법을 반드시 나타내는 것은 아닙니다. 이러한 예를 경고 분류 방법에 대한 지침으로 간주해서는 안 됩니다.

---
### **7.1.  Denial-of-Service Attacks**

다음 예에서는 몇 가지 일반적인 서비스 거부 공격이 IDMEF에 어떻게 표시되는지 보여줍니다.

---
#### **7.1.1.  The "teardrop" Attack**

"티어드롭\(teardrop\)" 공격에 대한 네트워크 기반 탐지. 이는 경고의 기본 형식을 보여줍니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message xmlns:idmef="http://iana.org/idmef"
                        version="1.0">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="hq-dmz-analyzer01">
         <idmef:Node category="dns">
           <idmef:location>Headquarters DMZ Network</idmef:location>
           <idmef:name>analyzer01.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc723b45.0xef449129">
         2000-03-09T10:01:25.93464-05:00
       </idmef:CreateTime>
       <idmef:Source ident="a1b2c3d4">
         <idmef:Node ident="a1b2c3d4-001" category="dns">
           <idmef:name>badguy.example.net</idmef:name>
           <idmef:Address ident="a1b2c3d4-002"
                          category="ipv4-net-mask">
             <idmef:address>192.0.2.50</idmef:address>
             <idmef:netmask>255.255.255.255</idmef:netmask>
           </idmef:Address>
         </idmef:Node>
       </idmef:Source>
       <idmef:Target ident="d1c2b3a4">
         <idmef:Node ident="d1c2b3a4-001" category="dns">
           <idmef:Address category="ipv4-addr-hex">
             <idmef:address>0xde796f70</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Target>
       <idmef:Classification text="Teardrop detected">
         <idmef:Reference origin="bugtraqid">
           <idmef:name>124</idmef:name>
           <idmef:url>http://www.securityfocus.com/bid/124</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>

   </idmef:IDMEF-Message>
```

---
#### **7.1.2.  The "ping of death" Attack**

"Ping of death" 공격에 대한 네트워크 기반 탐지. 여러 대상을 식별하고 소스를 스푸핑된 주소로 식별합니다.

참고: URL은 IETF 형식 요구 사항에 맞게 잘렸습니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="bc-sensor01">
         <idmef:Node category="dns">
           <idmef:name>sensor.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc71f4f5.0xef449129">
         2000-03-09T10:01:25.93464Z
       </idmef:CreateTime>
       <idmef:Source ident="a1a2" spoofed="yes">
         <idmef:Node ident="a1a2-1">
           <idmef:Address ident="a1a2-2" category="ipv4-addr">
             <idmef:address>192.0.2.200</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Source>
       <idmef:Target ident="b3b4">
         <idmef:Node>
           <idmef:Address ident="b3b4-1" category="ipv4-addr">
             <idmef:address>192.0.2.50</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Target>
       <idmef:Target ident="c5c6">
         <idmef:Node ident="c5c6-1" category="nisplus">
           <idmef:name>lollipop</idmef:name>
         </idmef:Node>
       </idmef:Target>
       <idmef:Target ident="d7d8">
         <idmef:Node ident="d7d8-1">
           <idmef:location>Cabinet B10</idmef:location>
           <idmef:name>Cisco.router.b10</idmef:name>
         </idmef:Node>
       </idmef:Target>

       <idmef:Classification text="Ping-of-death detected">
         <idmef:Reference origin="cve">
           <idmef:name>CVE-1999-128</idmef:name>
           <idmef:url>http://www.cve.mitre.org/cgi-bin/
           cvename.cgi?name=CVE-1999-128</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
### **7.2.  Port Scanning Attacks**

다음 예는 IDMEF에서 몇 가지 일반적인 포트 스캐닝 공격이 어떻게 표현될 수 있는지 보여줍니다.

---
#### **7.2.1.  Connection to a Disallowed Service**

호스트 기반 정책 위반 감지\("손가락"을 통해 정보 획득 시도\) 원래 사용자\(예: RFC 1413\[11\]을 통해 획득\)뿐만 아니라 대상 서비스의 식별도 확인합니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="bc-sensor01">
         <idmef:Node category="dns">
           <idmef:name>sensor.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc72541d.0x00000000">
         2000-03-09T18:47:25+02:00
       </idmef:CreateTime>
       <idmef:Source ident="a123">
         <idmef:Node ident="a123-01">
           <idmef:Address ident="a123-02" category="ipv4-addr">
             <idmef:address>192.0.2.200</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:User ident="q987-03" category="os-device">
           <idmef:UserId ident="q987-04" type="target-user">
             <idmef:name>badguy</idmef:name>
           </idmef:UserId>
         </idmef:User>
         <idmef:Service ident="a123-03">
           <idmef:port>31532</idmef:port>

         </idmef:Service>
       </idmef:Source>
       <idmef:Target ident="z456">
         <idmef:Node ident="z456-01" category="nis">
           <idmef:name>myhost</idmef:name>
           <idmef:Address ident="z456-02" category="ipv4-addr">
             <idmef:address>192.0.2.50</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:Service ident="z456-03">
           <idmef:name>finger</idmef:name>
           <idmef:port>79</idmef:port>
         </idmef:Service>
       </idmef:Target>
       <idmef:Classification text="Portscan">
         <idmef:Reference origin="vendor-specific">
           <idmef:name>finger</idmef:name>
           <idmef:url>http://www.vendor.com/finger</idmef:url>
         </idmef:Reference>
         <idmef:Reference origin="vendor-specific"
                          meaning="general documentation">
           <idmef:name>Distributed attack</idmef:name>
           <idmef:url>http://www.vendor.com/distributed</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
#### **7.2.2.  Simple Port Scanning**

포트 스캔의 네트워크 기반 감지. 이는 단일 분석기에 의한 감지를 보여줍니다. 상관 엔진에 의해 탐지된 것과 동일한 공격에 대해서는 섹션 7.5를 참조하십시오. 스캔된 포트를 표시하려면 <portlist\>를 사용하십시오.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                  xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="hq-dmz-analyzer62">
         <idmef:Node category="dns">
           <idmef:location>Headquarters Web Server</idmef:location>
           <idmef:name>analyzer62.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc72b2b4.0x00000000">
         2000-03-09T15:31:00-08:00

       </idmef:CreateTime>
       <idmef:Source ident="abc01">
         <idmef:Node ident="abc01-01">
           <idmef:Address ident="abc01-02" category="ipv4-addr">
             <idmef:address>192.0.2.200</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Source>
       <idmef:Target ident="def01">
         <idmef:Node ident="def01-01" category="dns">
           <idmef:name>www.example.com</idmef:name>
           <idmef:Address ident="def01-02" category="ipv4-addr">
             <idmef:address>192.0.2.50</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:Service ident="def01-03">
           <idmef:portlist>5-25,37,42,43,53,69-119,123-514
           </idmef:portlist>
         </idmef:Service>
       </idmef:Target>
       <idmef:Classification text="simple portscan">
         <idmef:Reference origin="vendor-specific">
           <idmef:name>portscan</idmef:name>
           <idmef:url>http://www.vendor.com/portscan</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
### **7.3.  Local Attacks**

다음 예에서는 몇 가지 일반적인 로컬 호스트 공격이 IDMEF에 어떻게 표시되는지 보여줍니다.

---
#### **7.3.1.  The "loadmodule" Attack**

"loadmodule" 익스플로잇의 호스트 기반 탐지. 이 공격에는 "loadmodule" 프로그램을 속여 다른 프로그램을 실행하도록 하는 것이 포함됩니다. "loadmodule"은 set-user-id "root"이므로 실행된 프로그램은 슈퍼유저 권한으로 실행됩니다. 익스플로잇을 시도하는 사용자와 그 방법을 식별하기 위해 <User\> 및 <Process\>를 사용하는 것에 주목하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">

       <idmef:Analyzer analyzerid="bc-fs-sensor13">
         <idmef:Node category="dns">
           <idmef:name>fileserver.example.com</idmef:name>
         </idmef:Node>
         <idmef:Process>
           <idmef:name>monitor</idmef:name>
           <idmef:pid>8956</idmef:pid>
           <idmef:arg>monitor</idmef:arg>
           <idmef:arg>-d</idmef:arg>
           <idmef:arg>-m</idmef:arg>
           <idmef:arg>idmanager.example.com</idmef:arg>
           <idmef:arg>-l</idmef:arg>
           <idmef:arg>/var/logs/idlog</idmef:arg>
         </idmef:Process>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc7221c0.0x4ccccccc">
         2000-03-09T08:12:32.3-05:00
       </idmef:CreateTime>
       <idmef:Source ident="a1a2">
         <idmef:User ident="a1a2-01" category="os-device">
           <idmef:UserId ident="a1a2-02"
                         type="original-user">
             <idmef:name>joe</idmef:name>
             <idmef:number>13243</idmef:number>
           </idmef:UserId>
         </idmef:User>
         <idmef:Process ident="a1a2-03">
           <idmef:name>loadmodule</idmef:name>
           <idmef:path>/usr/openwin/bin</idmef:path>
         </idmef:Process>
       </idmef:Source>
       <idmef:Target ident="z3z4">
         <idmef:Node ident="z3z4-01" category="dns">
           <idmef:name>fileserver.example.com</idmef:name>
         </idmef:Node>
       </idmef:Target>
       <idmef:Classification text="Loadmodule attack"
                             ident="loadmodule">
         <idmef:Reference origin="bugtraqid">
           <idmef:name>33</idmef:name>
           <idmef:url>http://www.securityfocus.com</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

IDS\(침입 감지 시스템\)는 대상 사용자가 "루트" 사용자임을 나타내고 시도된 명령을 표시할 수도 있습니다. 그러면 경고는 다음과 같을 수 있습니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="bc-fs-sensor13">
         <idmef:Node category="dns">
           <idmef:name>fileserver.example.com</idmef:name>
         </idmef:Node>
         <idmef:Process>
           <idmef:name>monitor</idmef:name>
           <idmef:pid>8956</idmef:pid>
           <idmef:arg>monitor</idmef:arg>
           <idmef:arg>-d</idmef:arg>
           <idmef:arg>-m</idmef:arg>
           <idmef:arg>idmanager.example.com</idmef:arg>
           <idmef:arg>-l</idmef:arg>
           <idmef:arg>/var/logs/idlog</idmef:arg>
         </idmef:Process>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc7221c0.0x4ccccccc">
         2000-03-09T08:12:32.3-05:00
       </idmef:CreateTime>
       <idmef:Source ident="a1a2">
         <idmef:User ident="a1a2-01" category="os-device">
           <idmef:UserId ident="a1a2-02" type="original-user">
             <idmef:name>joe</idmef:name>
             <idmef:number>13243</idmef:number>
           </idmef:UserId>
         </idmef:User>
         <idmef:Process ident="a1a2-03">
           <idmef:name>loadmodule</idmef:name>
           <idmef:path>/usr/openwin/bin</idmef:path>
         </idmef:Process>
       </idmef:Source>
       <idmef:Target ident="z3z4">
         <idmef:Node ident="z3z4-01" category="dns">
           <idmef:name>fileserver.example.com</idmef:name>
         </idmef:Node>
         <idmef:User ident="z3z4-02" category="os-device">
           <idmef:UserId ident="z3z4-03" type="target-user">
             <idmef:name>root</idmef:name>
             <idmef:number>0</idmef:number>
           </idmef:UserId>

         </idmef:User>
         <idmef:Process ident="z3z4-04">
           <idmef:name>sh</idmef:name>
           <idmef:pid>25134</idmef:pid>
           <idmef:path>/bin/sh</idmef:path>
         </idmef:Process>
       </idmef:Target>
       <idmef:Classification text="Loadmodule attack"
                             ident="loadmodule">
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

분류 식별이 사용된다는 점에 유의하세요.

---
#### **7.3.2.  The "phf" Attack**

"phf" 공격의 네트워크 기반 탐지. 이 특정 공격에 대한 자세한 내용을 제공하려면 <WebService\> 요소를 사용하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="bc-sensor01">
         <idmef:Node category="dns">
           <idmef:name>sensor.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc71e980.0x00000000">
         2000-03-09T08:12:32-01:00
       </idmef:CreateTime>
       <idmef:Source ident="abc123">
         <idmef:Node ident="abc123-001">
           <idmef:Address ident="abc123-002"
                          category="ipv4-addr">
             <idmef:address>192.0.2.200</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:Service ident="abc123-003">
           <idmef:port>21534</idmef:port>
         </idmef:Service>
       </idmef:Source>
       <idmef:Target ident="xyz789">
         <idmef:Node ident="xyz789-001" category="dns">
           <idmef:name>www.example.com</idmef:name>

           <idmef:Address ident="xyz789-002"
                          category="ipv4-addr">
             <idmef:address>192.0.2.100</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:Service>
           <idmef:port>8080</idmef:port>
           <idmef:WebService>
             <idmef:url>
             http://www.example.com/cgi-bin/phf?/etc/group
             </idmef:url>
             <idmef:cgi>/cgi-bin/phf</idmef:cgi>
             <idmef:http-method>GET</idmef:http-method>
           </idmef:WebService>
         </idmef:Service>
       </idmef:Target>
       <idmef:Classification text="phf attack">
         <idmef:Reference origin="bugtraqid">
           <idmef:name>629</idmef:name>
           <idmef:url>
           http://www.securityfocus.com/bid/629
           </idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
#### **7.3.3.  File Modification**

경쟁 조건 공격에 대한 호스트 기반 탐지. 공격을 수행하는 데 사용되는 파일에 대한 정보를 제공하려면 <File\>을 사용하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert>
       <idmef:Analyzer analyzerid="bids-192.0.2.1"
                       ostype="Linux"
                       osversion="2.2.16-3">
         <idmef:Node category="hosts">
           <idmef:name>etude</idmef:name>
           <idmef:Address category="ipv4-addr">
             <idmef:address>192.0.2.1</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Analyzer>

       <idmef:CreateTime ntpstamp="0xbc71e980.0x00000000">
         2000-03-09T08:12:32-01:00
       </idmef:CreateTime>
       <idmef:Source spoofed="no">
         <idmef:Node>
           <idmef:location>console</idmef:location>
           <idmef:Address category="ipv4-addr">
             <idmef:address>192.0.2.1</idmef:address>
           </idmef:Address>
           </idmef:Node>
       </idmef:Source>
       <idmef:Target decoy="no">
         <idmef:Node>
           <idmef:location>local</idmef:location>
           <idmef:Address category="ipv4-addr">
             <idmef:address>192.0.2.1</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:User category="os-device">
           <idmef:UserId type="original-user">
             <idmef:number>456</idmef:number>
           </idmef:UserId>
           <idmef:UserId type="current-user">
             <idmef:name>fred</idmef:name>
             <idmef:number>456</idmef:number>
           </idmef:UserId>
           <idmef:UserId type="user-privs">
             <idmef:number>456</idmef:number>
           </idmef:UserId>
         </idmef:User>
         <idmef:File category="current" fstype="tmpfs">
           <idmef:name>xxx000238483</idmef:name>
           <idmef:path>/tmp/xxx000238483</idmef:path>
           <idmef:FileAccess>
             <idmef:UserId type="user-privs">
               <idmef:name>alice</idmef:name>
               <idmef:number>777</idmef:number>
             </idmef:UserId>
             <idmef:permission perms="read" />
             <idmef:permission perms="write" />
             <idmef:permission perms="delete" />
             <idmef:permission perms="changePermissions" />
           </idmef:FileAccess>
           <idmef:FileAccess>
             <idmef:UserId type="group-privs">
               <idmef:name>user</idmef:name>
               <idmef:number>42</idmef:number>
             </idmef:UserId>

             <idmef:permission perms="read" />
             <idmef:permission perms="write" />
             <idmef:permission perms="delete" />
           </idmef:FileAccess>
           <idmef:FileAccess>
             <idmef:UserId type="other-privs">
               <idmef:name>world</idmef:name>
             </idmef:UserId>
             <idmef:permission perms="noAccess" />
           </idmef:FileAccess>
           <idmef:Linkage category="symbolic-link">
             <idmef:name>passwd</idmef:name>
             <idmef:path>/etc/passwd</idmef:path>
           </idmef:Linkage>
         </idmef:File>
       </idmef:Target>
       <idmef:Classification text="DOM race condition">
         <idmef:Reference origin="vendor-specific">
           <idmef:name>DOM race condition</idmef:name>
           <idmef:url>file://attack-info/race.html
           </idmef:url>
         </idmef:Reference>
       </idmef:Classification>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
### **7.4.  System Policy Violation**

이 예에서는 로그인이 낮 시간으로 제한됩니다. 경고는 사용자가 오후 10시가 조금 지나 로그인할 때 발생하는 이 정책 위반을 보고합니다. 위반되는 정책에 대한 정보를 제공하기 위해 <AdditionalData\>를 사용한다는 점에 유의하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="bc-ds-01">
         <idmef:Node category="dns">
           <idmef:name>dialserver.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc72e7ef.0x00000000">
         2000-03-09T22:18:07-05:00
       </idmef:CreateTime>
       <idmef:Source ident="s01">
         <idmef:Node ident="s01-1">

           <idmef:Address category="ipv4-addr">
             <idmef:address>127.0.0.1</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:Service ident="s01-2">
           <idmef:port>4325</idmef:port>
         </idmef:Service>
       </idmef:Source>
       <idmef:Target ident="t01">
         <idmef:Node ident="t01-1" category="dns">
           <idmef:name>mainframe.example.com</idmef:name>
         </idmef:Node>
         <idmef:User ident="t01-2" category="os-device">
           <idmef:UserId ident="t01-3" type="current-user">
             <idmef:name>louis</idmef:name>
             <idmef:number>501</idmef:number>
           </idmef:UserId>
         </idmef:User>
         <idmef:Service ident="t01-4">
           <idmef:name>login</idmef:name>
           <idmef:port>23</idmef:port>
         </idmef:Service>
       </idmef:Target>
       <idmef:Classification text="Login policy violation">
         <idmef:Reference origin="user-specific">
           <idmef:name>out-of-hours activity</idmef:name>
           <idmef:url>http://my.company.com/policies
           </idmef:url>
         </idmef:Reference>
       </idmef:Classification>
       <idmef:AdditionalData type="date-time"
                             meaning="start-time">
         <idmef:date-time>2000-03-09T07:00:00-05:00</idmef:date-time>
       </idmef:AdditionalData>
       <idmef:AdditionalData type="date-time"
                             meaning="stop-time">
         <idmef:date-time>2000-03-09T19:30:00-05:00</idmef:date-time>
       </idmef:AdditionalData>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
### **7.5.  Correlated Alerts**

다음 예에서는 섹션 7.2.2의 포트 검색 경고가 단일 분석기 대신 상관 엔진에서 감지되어 전송된 경우 어떻게 표시될 수 있는지 보여줍니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>
```

<idmef:IDMEF-메시지 버전="1.0"

- xmlns:idmef="http://iana.org/idmef"\> <idmef:Alert messageid="abc123456789"\> <idmef:Analyzer analyzerid="bc-corr-01"\> <idmef:노드 카테고리="dns" \> <idmef:name\>correlator01.example.com</idmef:name\> </idmef:Node\> </idmef:Analyzer\> <idmef:CreateTime ntpstamp="0xbc72423b.0x00000000"\> 2000-03-09T15:31:07Z </idmef:CreateTime\> <idmef:Source ident="a1"\> <idmef:Node ident="a1-1"\> <idmef:Address ident="a1-2" 카테고리="ipv4-addr"\> <idmef: 주소\>192.0.2.200</idmef:address\> </idmef:Address\> </idmef:Node\> </idmef:Source\> <idmef:Target ident="a2"\> <idmef:Node ident="a2-1" Category="dns"\> <idmef:name\>www.example.com</idmef:name\> <idmef:Address ident="a2-2" Category="ipv4-addr"\> <idmef:address\>192.0.2.50< /idmef:address\> </idmef:Address\> </idmef:Node\> <idmef:Service ident="a2-3"\> <idmef:portlist\>5-25,37,42,43,53,69-119,123- 514 </idmef:portlist\> </idmef:Service\> </idmef:Target\> <idmef:Classification text="Portscan"\> <idmef:Reference Origin="vendor-Specific"\> <idmef:name\>포트 스캔</idmef :name\> <idmef:url\>http://www.vendor.com/portscan</idmef:url\> </idmef:Reference\> </idmef:Classification\> <idmef:CorrelationAlert\> <idmef:name\>여러 포트 짧은 시간</idmef:name\> <idmef:alertident\>123456781</idmef:alertident\> <idmef:alertident\>123456782</idmef:alertident\>

```text
         <idmef:alertident>123456783</idmef:alertident>
         <idmef:alertident>123456784</idmef:alertident>
         <idmef:alertident>123456785</idmef:alertident>
         <idmef:alertident>123456786</idmef:alertident>
         <idmef:alertident analyzerid="a1b2c3d4">987654321
         </idmef:alertident>
         <idmef:alertident analyzerid="a1b2c3d4">987654322
         </idmef:alertident>
       </idmef:CorrelationAlert>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
### **7.6.  Analyzer Assessments**

꺼내기 버퍼 오버플로를 통해 루트 액세스에 대한 무단 획득 성공을 호스트 기반으로 감지합니다. 공격에 대한 분석기의 평가 및 반응에 대한 정보를 제공하기 위해 <Assessment\>를 사용하는 점에 유의하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                        xmlns:idmef="http://iana.org/idmef">
     <idmef:Alert>
       <idmef:Analyzer analyzerid="bids-192.0.2.1">
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc71e980.0x00000000">
         2000-03-09T08:12:32-01:00
       </idmef:CreateTime>
       <idmef:Source spoofed="no">
         <idmef:Node>
           <idmef:location>console</idmef:location>
           <idmef:Address category="ipv4-addr">
             <idmef:address>192.0.2.1</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Source>
       <idmef:Target decoy="no">
         <idmef:Node>
           <idmef:location>local</idmef:location>
           <idmef:Address category="ipv4-addr">
             <idmef:address>192.0.2.1</idmef:address>
           </idmef:Address>
         </idmef:Node>
         <idmef:User category="os-device">
           <idmef:UserId type="original-user">
             <idmef:number>456</idmef:number>
           </idmef:UserId>
```

<idmef:UserId type="현재-사용자"\>

- <idmef:name\>루트</idmef:name\> <idmef:number\>0</idmef:number\> </idmef:UserId\> <idmef:UserId type="user-privs"\> <idmef:number\>0< /idmef:번호\> </idmef:UserId\> </idmef:User\> <idmef:Process\> <idmef:name\>꺼내기</idmef:name\> <idmef:pid\>32451</idmef:pid\> <idmef:path \>/usr/bin/eject</idmef:path\> <idmef:arg\>\x90\x80\x3f\xff...\x08/bin/sh</idmef:arg\> </idmef:Process\> </idmef :대상\> <idmef:Classification text="승인되지 않은 관리 액세스"\> <idmef:Reference Origin="vendor-Specific"\> <idmef:name\>수퍼유저에 대한 승인되지 않은 사용자</idmef:name\> <idmef:url\>파일:/ /attack-info/u2s.html</idmef:url\> </idmef:Reference\> </idmef:Classification\> <idmef:Assessment\> <idmef:Impact 심각도="높음" 완료="성공" type="admin" /\> <idmef:Action Category="notification-sent"\> 페이지 </idmef:Action\> <idmef:Action Category="block-installed"\> 비활성화된 사용자\(fred\) </idmef:Action\> <idmef:Action Category= "taken-offline"\> 로그아웃 사용자\(fred\) </idmef:Action\> <idmef:Confidence rating="high"/\> </idmef:Assessment\> </idmef:Alert\> </idmef:IDMEF-Message\>

---
### **7.7.  Heartbeat**

이 예에서는 관리자에게 "나는 살아 있고 일하고 있습니다"라는 정보를 제공하는 하트비트 메시지를 보여줍니다. 몇 가지 추가 정보를 제공하기 위해 "의미" 속성과 함께 <AdditionalData\> 요소를 사용하는 것에 유의하세요.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
                  xmlns:idmef="http://iana.org/idmef">
     <idmef:Heartbeat messageid="abc123456789">
       <idmef:Analyzer analyzerid="hq-dmz-analyzer01">
         <idmef:Node category="dns">
           <idmef:location>Headquarters DMZ Network</idmef:location>
           <idmef:name>analyzer01.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc722ebe.0x00000000">
         2000-03-09T14:07:58Z
       </idmef:CreateTime>
       <idmef:AdditionalData type="real" meaning="%memused">
         <idmef:real>62.5</idmef:real>
       </idmef:AdditionalData>
       <idmef:AdditionalData type="real" meaning="%diskused">
         <idmef:real>87.1</idmef:real>
       </idmef:AdditionalData>
     </idmef:Heartbeat>
   </idmef:IDMEF-Message>
```

---
### **7.8.  XML Extension**

다음 예에서는 IDMEF DTD를 확장하는 방법을 보여줍니다. 이 예에서 VendorCo 회사는 Node 클래스에 지리 정보를 추가하기로 결정했습니다. 이를 위해 VendorCo는 클래스 형식을 정의하는 문서 유형 정의\(DTD\)를 만듭니다.

```text
   <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
               xmlns:vendorco="http://vendor.com/idmef"
               targetNamespace="http://vendor.com/idmef"
               elementFormDefault="qualified" >
```

<xsd:주석\>

- <xsd:documentation\> 지리 정보에 대한 IDMEF\(침입 감지 메시지 교환 형식\) 확장 </xsd:documentation\> </xsd:annotation\>

```text
     <xsd:complexType name="NodeGeoType">
       <xsd:sequence>
       <xsd:element name="latitude"
                    type="xsd:string" />
       <xsd:element name="longitude"

                    type="xsd:string" />

       <xsd:element name="elevation"
                    type="xsd:string"
                    minOccurs="0"
                    maxOccurs="1" />
           </xsd:sequence>
       <xsd:attribute name="node-ident"
                      type="xsd:integer"
                      use="required"/>
     </xsd:complexType>

     <xsd:element name="NodeGeography" type="vendorco:NodeGeoType" />

   </xsd:schema>
```

VendorCo:NodeGeography 클래스에는 VendorCo:latitude, VendorCo:longitude 및 VendorCo:elevation의 세 가지 집계 클래스에 지리 데이터가 포함됩니다. 이 클래스의 정보를 특정 노드와 연결하기 위해 "VendorCo:node-ident" 속성이 제공됩니다. 관련 Node 요소의 "ident" 속성과 동일한 값을 포함해야 합니다.

이제 이 DTD를 사용하기 위해 VendorCo는 섹션 5.2의 규칙을 따르고 문서 유형 정의 내에 "x-vendorco"라는 매개변수 엔터티를 정의한 다음 이 엔터티를 참조합니다. 경고에서 VendorCo 요소는 아래와 같이 "xml"의 "type" 특성과 함께 추가 데이터 요소 아래에 포함됩니다.

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <idmef:IDMEF-Message version="1.0"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:idmef="http://iana.org/idmef"
        xmlns:vendorco="http://v.com/idmef"
        xsi:schemaLocation="http://v.com/idmef http://v.com/geo.xsd">

     <idmef:Alert messageid="abc123456789">
       <idmef:Analyzer analyzerid="hq-dmz-analyzer01">
         <idmef:Node category="dns">
           <idmef:location>Headquarters DMZ Network</idmef:location>
           <idmef:name>analyzer01.example.com</idmef:name>
         </idmef:Node>
       </idmef:Analyzer>
       <idmef:CreateTime ntpstamp="0xbc723b45.0xef449129">
         2000-03-09T10:01:25.93464-05:00
       </idmef:CreateTime>

       <idmef:Source ident="a1b2c3d4">
         <idmef:Node ident="a1b2c3d4-001" category="dns">
           <idmef:name>badguy.example.net</idmef:name>
           <idmef:Address ident="a1b2c3d4-002" category="ipv4-net-mask">
             <idmef:address>192.0.2.50</idmef:address>
             <idmef:netmask>255.255.255.255</idmef:netmask>
           </idmef:Address>
         </idmef:Node>
       </idmef:Source>
       <idmef:Target ident="d1c2b3a4">
         <idmef:Node ident="d1c2b3a4-001" category="dns">
           <idmef:Address category="ipv4-addr-hex">
             <idmef:address>0xde796f70</idmef:address>
           </idmef:Address>
         </idmef:Node>
       </idmef:Target>
       <idmef:Classification text="Teardrop">
         <idmef:Reference origin="bugtraqid">
           <idmef:name>124</idmef:name>
           <idmef:url>http://www.securityfocus.com/bid/124</idmef:url>
         </idmef:Reference>
       </idmef:Classification>
       <idmef:AdditionalData type="xml" meaning="node geo info">
         <idmef:xml>
           <vendorco:NodeGeography
             xmlns:vendorco="http://vendor.com/idmef"
      xsi:schemaLocation="http://v.com/idmef http://v.com/geo.xsd"
             vendorco:node-ident="a1b2c3d4-001">
           <vendorco:latitude>38.89</vendorco:latitude>
           <vendorco:longitude>-77.02</vendorco:longitude>
         </vendorco:NodeGeography>
         </idmef:xml>
       </idmef:AdditionalData>
     </idmef:Alert>
   </idmef:IDMEF-Message>
```

---
## **8.  The IDMEF Document Type Definition (Normative)**

```text
   <?xml version="1.0" encoding="UTF-8"?>

   <!-- ***************************************************************
    *******************************************************************
    *** Intrusion Detection Message Exchange Format (IDMEF) XML DTD ***
    ***                Version 1.0, 07 March 2006                   ***
    ***                                                             ***
    *** The use and extension of the IDMEF XML DTD are described in ***
    *** RFC 4765, "The Intrusion Detection Message Exchange         ***
    *** Format",  H. Debar, D. Curry, B. Feinstein.                 ***
    *******************************************************************
    *************************************************************** -->

   <!-- ===============================================================
    ===================================================================
    === SECTION 1.  Attribute list declarations.
    ===================================================================
    =============================================================== -->

   <!--
    | Attributes of the IDMEF element.  In general, the fixed values of
    | these attributes will change each time a new version of the DTD
    | is released.
    -->

   <!ENTITY % attlist.idmef                "
       version             CDATA                   #FIXED    '1.0'
     ">

   <!--
    | Attributes of all elements.  These are the "XML" attributes that
    | every element should have.  Space handling, language, and name
    | space.
    -->
   <!ENTITY % attlist.global               "
       xmlns:idmef         CDATA                   #FIXED
           'http://iana.org/idmef'
       xmlns               CDATA                   #FIXED
           'http://iana.org/idmef'
       xml:space           (default | preserve)    'default'
       xml:lang            NMTOKEN                 #IMPLIED
     ">

   <!-- ===============================================================
    ===================================================================
    === SECTION 2.  Attribute value declarations.  Enumerated values for
    ===            many of the element-specific attribute lists.
    ===================================================================
    =============================================================== -->

   <!--
    | Values for the Action.category attribute.
    -->
   <!ENTITY % attvals.actioncat            "
       ( block-installed | notification-sent | taken-offline | other )
     ">

   <!--
    | Values for the Address.category attribute.
    -->
   <!ENTITY % attvals.addrcat              "
       ( unknown | atm | e-mail | lotus-notes | mac | sna | vm |
         ipv4-addr | ipv4-addr-hex | ipv4-net | ipv4-net-mask |
         ipv6-addr | ipv6-addr-hex | ipv6-net | ipv6-net-mask )
     ">

   <!--
    | Values for the AdditionalData.type attribute.
    -->
   <!ENTITY % attvals.adtype               "
       ( boolean | byte | character | date-time | integer | ntpstamp |
         portlist | real | string | byte-string | xmltext )
     ">

   <!--
    | Values for the Impact.completion attribute.
    -->
   <!ENTITY % attvals.completion           "
       ( failed | succeeded )
     ">
   <!--
    | Values for the File.category attribute.
    -->
   <!ENTITY % attvals.filecat              "
       ( current | original )
     ">

   <!ENTITY % attvals.fileperm "( noAccess | read | write | execute |
     search | delete | executeAs | changePermissions |
     takeOwnership)" >

   <!--
    | Values for the UserId.type attribute.
    -->
   <!ENTITY % attvals.idtype               "
       ( current-user | original-user | target-user | user-privs |
         current-group | group-privs | other-privs )
     ">

   <!--
    | Values for the Impact.type attribute.
    -->
   <!ENTITY % attvals.impacttype           "
       ( admin | dos | file | recon | user | other )
     ">

   <!--
    | Values for the Linkage.category attribute.
    -->
   <!ENTITY % attvals.linkcat              "
       ( hard-link | mount-point | reparse-point | shortcut | stream |
         symbolic-link )
     ">

   <!--
    | Values for the Checksum.algorithm attribute
    -->
   <!ENTITY % attvals.checksumalgos        "
         ( MD4 | MD5 | SHA1 | SHA2-256 | SHA2-384 | SHA2-512 | CRC-32 |
           Haval | Tiger | Gost )
     ">

   <!--
    | Values for the Node.category attribute.
    -->
   <!ENTITY % attvals.nodecat              "
       ( unknown | ads | afs | coda | dfs | dns | hosts | kerberos |
         nds | nis | nisplus | nt | wfw )
     ">

   <!--
    | Values for the Reference.origin attribute.
    -->
   <!ENTITY % attvals.origin               "
       ( unknown | vendor-specific | user-specific | bugtraqid | cve |
         osvdb )
     ">

   <!--

    | Values for the Confidence.rating attribute.
    -->
   <!ENTITY % attvals.rating               "
       ( low | medium | high | numeric )
     ">

   <!--
    | Values for the Impact.severity attribute.
    -->
   <!ENTITY % attvals.severity             "
       ( info | low | medium | high )
     ">

   <!--
    | Values for the User.category attribute.
    -->
   <!ENTITY % attvals.usercat              "
       ( unknown | application | os-device )
     ">

   <!--
    | Values for yes/no attributes such as Source.spoofed and
    | Target.decoy.
    -->
   <!ENTITY % attvals.yesno                "
       ( unknown | yes | no )
     ">

   <!-- ===============================================================
    ===================================================================
    === SECTION 3.  Top-level element declarations.  The IDMEF-Message
    ===            element and the types of messages it can include.
    ===================================================================
    =============================================================== -->

   <!ELEMENT IDMEF-Message                 (
       (Alert | Heartbeat)*
     )>
   <!ATTLIST IDMEF-Message
       %attlist.global;
       %attlist.idmef;
     >

   <!ELEMENT Alert                         (
       Analyzer, CreateTime, DetectTime?, AnalyzerTime?,
       Source*, Target*, Classification, Assessment?, (ToolAlert |
       OverflowAlert | CorrelationAlert)?, AdditionalData*
     )>

   <!ATTLIST Alert
       messageid           CDATA                   '0'
       %attlist.global;
     >

   <!ELEMENT Heartbeat                     (
       Analyzer, CreateTime, HeartbeatInterval?, AnalyzerTime?,
       AdditionalData*
     )>
   <!ATTLIST Heartbeat
       messageid           CDATA                   '0'
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 4.  Subclasses of the Alert element that provide more
    ===            data for specific types of alerts.
    ===================================================================
    =============================================================== -->

   <!ELEMENT CorrelationAlert              (
       name, alertident+
     )>
   <!ATTLIST CorrelationAlert
       %attlist.global;
     >

   <!ELEMENT OverflowAlert                 (
       program, size?, buffer?
     )>
   <!ATTLIST OverflowAlert
       %attlist.global;
     >

   <!ELEMENT ToolAlert                     (
       name, command?, alertident+
     )>
   <!ATTLIST ToolAlert
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 5.  The AdditionalData element.  This element allows an
    ===             alert to include additional information that cannot
    ===             be encoded elsewhere in the data model.
    ===================================================================

    =============================================================== -->

   <!ELEMENT AdditionalData           (
     (boolean | byte        | character | date-time |
      integer | ntpstamp    | portlist  | real      |
      string  | byte-string | xmltext   )
    )>

   <!ATTLIST AdditionalData
       type                %attvals.adtype;        'string'
       meaning             CDATA                   #IMPLIED
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 6.  Elements related to identifying entities - analyzers
    ===            (the senders of these messages), sources (of
    ===            attacks), and targets (of attacks).
    ===================================================================
    =============================================================== -->

   <!ELEMENT Analyzer                      (
       Node?, Process?, Analyzer?
     )>
   <!ATTLIST Analyzer
       analyzerid          CDATA                   '0'
       name                CDATA                   #IMPLIED
       manufacturer        CDATA                   #IMPLIED
       model               CDATA                   #IMPLIED
       version             CDATA                   #IMPLIED
       class               CDATA                   #IMPLIED
       ostype              CDATA                   #IMPLIED
       osversion           CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT Classification                (
       Reference*
     )>
   <!ATTLIST Classification
       ident               CDATA                   '0'
       text                CDATA                   #REQUIRED
     >

   <!ELEMENT Source                        (
       Node?, User?, Process?, Service?

     )>
   <!ATTLIST Source
       ident               CDATA                   '0'
       spoofed             %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT Target                        (
       Node?, User?, Process?, Service?, File*
     )>
   <!ATTLIST Target
       ident               CDATA                   '0'
       decoy               %attvals.yesno;         'unknown'
       interface           CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT Assessment                    (
       Impact?, Action*, Confidence?
     )>
   <!ATTLIST Assessment
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 7.  Support elements used for providing detailed info
    ===            about entities - addresses, names, etc.
    ===================================================================
    =============================================================== -->

   <!ELEMENT Reference                (
       name, url
     )>
   <!ATTLIST Reference
       origin              %attvals.origin;        'unknown'
       meaning             CDATA                   #IMPLIED
     >

   <!ELEMENT Node                          (
       location?, (name | Address), Address*
     )>
   <!ATTLIST Node
       ident               CDATA                   '0'
       category            %attvals.nodecat;       'unknown'
       %attlist.global;
     >

   <!ELEMENT Address                       (
       address, netmask?
     )>
   <!ATTLIST Address
       ident               CDATA                   '0'
       category            %attvals.addrcat;       'unknown'
       vlan-name           CDATA                   #IMPLIED
       vlan-num            CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT File                          (
       name, path, create-time?, modify-time?, access-time?,
       data-size?, disk-size?, FileAccess*, Linkage*, Inode?,
       Checksum*
     )>
   <!ATTLIST File
       ident               CDATA                   '0'
       category            %attvals.filecat;       #REQUIRED
       fstype              CDATA                   #IMPLIED
       file-type           CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT Permission EMPTY >
   <!ATTLIST Permission
       perms               %attvals.fileperm;      #REQUIRED
       %attlist.global;
   >

   <!ELEMENT FileAccess                    (
       UserId, Permission+
     )>
   <!ATTLIST FileAccess
       %attlist.global;
     >

   <!ELEMENT Inode                         (
       change-time?, (number, major-device, minor-device)?,
       (c-major-device, c-minor-device)?
     )>
   <!ATTLIST Inode
       %attlist.global;
     >

   <!ELEMENT Linkage                       (
       (name, path) | File
     )>

   <!ATTLIST Linkage
       category            %attvals.linkcat;       #REQUIRED
       %attlist.global;
     >

   <!ELEMENT Checksum                      (
       value, key?
     )>
   <!ATTLIST Checksum
       algorithm           %attvals.checksumalgos; #REQUIRED
       %attlist.global;
     >

   <!ELEMENT Process                       (
       name, pid?, path?, arg*, env*
     )>
   <!ATTLIST Process
       ident               CDATA                   '0'
       %attlist.global;
     >

   <!ELEMENT Service                       (
       (((name, port?) | (port, name?)) | portlist), protocol?,
       SNMPService?, WebService?
     )>
   <!ATTLIST Service
       ident                CDATA                   '0'
   ip_version           CDATA                   #IMPLIED
   iana_protocol_number CDATA                  #IMPLIED
   iana_protocol_name   CDATA                  #IMPLIED
       %attlist.global;
     >

   <!ELEMENT SNMPService                   (
       oid?, messageProcessingModel?, securityModel?, securityName?,
       securityLevel?, contextName?, contextEngineID?, command?
     )>
   <!ATTLIST SNMPService
       %attlist.global;
     >

   <!ELEMENT User                          (
       UserId+
     )>
   <!ATTLIST User
       ident               CDATA                   '0'
       category            %attvals.usercat;       'unknown'
       %attlist.global;

     >

   <!ELEMENT UserId                        (
       (name, number?) | (number, name?)
     )>
   <!ATTLIST UserId
       ident               CDATA                   '0'
       type                %attvals.idtype;        'original-user'
       tty                 CDATA                   #IMPLIED
       %attlist.global;
     >

   <!ELEMENT WebService                    (
       url, cgi?, http-method?, arg*
     )>
   <!ATTLIST WebService
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 8.  Simple elements with sub-elements or attributes of a
    ===            special nature.
    ===================================================================
    =============================================================== -->

   <!ELEMENT Action              (#PCDATA) >
   <!ATTLIST Action
       category            %attvals.actioncat;     'other'
       %attlist.global;
     >

   <!ELEMENT CreateTime          (#PCDATA) >
   <!ATTLIST CreateTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;
     >

   <!ELEMENT DetectTime          (#PCDATA) >
   <!ATTLIST DetectTime
       ntpstamp            CDATA                   #REQUIRED
       %attlist.global;

     >

   <!ELEMENT AnalyzerTime        (#PCDATA) >
   <!ATTLIST AnalyzerTime
       ntpstamp            CDATA                   #REQUIRED

       %attlist.global;
     >

   <!ELEMENT Confidence          (#PCDATA) >
   <!ATTLIST Confidence
       rating              %attvals.rating;        'numeric'
       %attlist.global;
     >

   <!ELEMENT Impact              (#PCDATA) >
   <!ATTLIST Impact
       severity            %attvals.severity;      #IMPLIED
       completion          %attvals.completion;    #IMPLIED
       type                %attvals.impacttype;    'other'
       %attlist.global;
     >

   <!ELEMENT alertident          (#PCDATA) >
   <!ATTLIST alertident
       analyzerid          CDATA                   #IMPLIED
       %attlist.global;
     >

   <!-- ===============================================================
    ===================================================================
    === SECTION 9.  Simple elements with no sub-elements and no special
    === attributes.
    ===================================================================
    =============================================================== -->

   <!ELEMENT boolean           (#PCDATA)         >
   <!ATTLIST boolean           %attlist.global;  >

   <!ELEMENT byte              (#PCDATA)         >
   <!ATTLIST byte              %attlist.global;  >

   <!ELEMENT character         (#PCDATA)         >
   <!ATTLIST character         %attlist.global;  >

   <!ELEMENT date-time         (#PCDATA)         >
   <!ATTLIST date-time         %attlist.global;  >

   <!ELEMENT integer           (#PCDATA)         >
   <!ATTLIST integer           %attlist.global;  >

   <!ELEMENT ntpstamp          (#PCDATA)         >
   <!ATTLIST ntpstamp          %attlist.global;  >

   <!ELEMENT real              (#PCDATA)         >
   <!ATTLIST real              %attlist.global;  >

   <!ELEMENT string            (#PCDATA)         >
   <!ATTLIST string            %attlist.global;  >

   <!ELEMENT byte-string       (#PCDATA)         >
   <!ATTLIST byte-string       %attlist.global;  >

   <!ELEMENT xmltext           ANY               >
   <!ATTLIST xmltext           %attlist.global;  >

   <!ELEMENT access-time       (#PCDATA)         >
   <!ATTLIST access-time       %attlist.global;  >

   <!ELEMENT address           (#PCDATA)         >
   <!ATTLIST address           %attlist.global;  >

   <!ELEMENT arg               (#PCDATA)         >
   <!ATTLIST arg               %attlist.global;  >

   <!ELEMENT buffer            (#PCDATA)         >
   <!ATTLIST buffer            %attlist.global;  >

   <!ELEMENT c-major-device    (#PCDATA)         >
   <!ATTLIST c-major-device    %attlist.global;  >

   <!ELEMENT c-minor-device    (#PCDATA)         >
   <!ATTLIST c-minor-device    %attlist.global;  >

   <!ELEMENT cgi               (#PCDATA)         >
   <!ATTLIST cgi               %attlist.global;  >

   <!ELEMENT change-time       (#PCDATA)         >
   <!ATTLIST change-time       %attlist.global;  >

   <!ELEMENT command           (#PCDATA)         >
   <!ATTLIST command           %attlist.global;  >

   <!ELEMENT create-time       (#PCDATA)         >
   <!ATTLIST create-time       %attlist.global;  >

   <!ELEMENT data-size         (#PCDATA)         >
   <!ATTLIST data-size         %attlist.global;  >

   <!ELEMENT disk-size         (#PCDATA)         >
   <!ATTLIST disk-size         %attlist.global;  >

   <!ELEMENT env               (#PCDATA)         >
   <!ATTLIST env               %attlist.global;  >

   <!ELEMENT http-method       (#PCDATA)         >
   <!ATTLIST http-method       %attlist.global;  >

   <!ELEMENT location          (#PCDATA)         >
   <!ATTLIST location          %attlist.global;  >

   <!ELEMENT major-device      (#PCDATA)         >
   <!ATTLIST major-device      %attlist.global;  >

   <!ELEMENT minor-device      (#PCDATA)         >
   <!ATTLIST minor-device      %attlist.global;  >

   <!ELEMENT modify-time       (#PCDATA)         >
   <!ATTLIST modify-time       %attlist.global;  >

   <!ELEMENT name              (#PCDATA)         >
   <!ATTLIST name              %attlist.global;  >

   <!ELEMENT netmask           (#PCDATA)         >
   <!ATTLIST netmask           %attlist.global;  >

   <!ELEMENT number            (#PCDATA)         >
   <!ATTLIST number            %attlist.global;  >

   <!ELEMENT oid               (#PCDATA)         >
   <!ATTLIST oid               %attlist.global;  >

   <!ELEMENT path              (#PCDATA)         >
   <!ATTLIST path              %attlist.global;  >

   <!ELEMENT permission        (#PCDATA)         >
   <!ATTLIST permission        %attlist.global;  >

   <!ELEMENT pid               (#PCDATA)         >
   <!ATTLIST pid               %attlist.global;  >

   <!ELEMENT port              (#PCDATA)         >
   <!ATTLIST port              %attlist.global;  >

   <!ELEMENT portlist          (#PCDATA)         >
   <!ATTLIST portlist          %attlist.global;  >

   <!ELEMENT program           (#PCDATA)         >
   <!ATTLIST program           %attlist.global;  >

   <!ELEMENT protocol          (#PCDATA)         >
   <!ATTLIST protocol          %attlist.global;  >

   <!ELEMENT size              (#PCDATA)         >
   <!ATTLIST size              %attlist.global;  >

   <!ELEMENT url               (#PCDATA)         >
   <!ATTLIST url               %attlist.global;  >

   <!ELEMENT HeartbeatInterval (#PCDATA)         >
   <!ATTLIST HeartbeatInterval %attlist.global;  >

   <!ELEMENT messageProcessingModel (#PCDATA)    >
   <!ATTLIST messageProcessingModel %attlist.global;>

   <!ELEMENT securityModel     (#PCDATA)         >
   <!ATTLIST securityModel     %attlist.global;  >

   <!ELEMENT securityName      (#PCDATA)         >
   <!ATTLIST securityName      %attlist.global;  >

   <!ELEMENT securityLevel     (#PCDATA)         >
   <!ATTLIST securityLevel     %attlist.global;  >

   <!ELEMENT contextName       (#PCDATA)         >
   <!ATTLIST contextName       %attlist.global;  >

   <!ELEMENT contextEngineID   (#PCDATA)         >
   <!ATTLIST contextEngineID   %attlist.global;  >

   <!ELEMENT value             (#PCDATA)         >
   <!ATTLIST value             %attlist.global;  >

   <!ELEMENT key               (#PCDATA)         >
   <!ATTLIST key               %attlist.global;  >

   <!-- End of IDMEF DTD -->
```

---
## **9.  Security Considerations**

이 문서에서는 침입 탐지 시스템 구현 간에 보안 관련 정보를 교환하기 위한 데이터 표현을 설명합니다. 이 데이터 형식에 직접적으로 적용되는 보안 문제는 없지만 데이터 자체에는 기밀성, 무결성 및/또는 가용성을 보호해야 할 수 있는 보안에 민감한 정보가 포함될 수 있습니다.

이는 이 데이터를 수집, 전송, 처리 및 저장하는 데 사용되는 시스템이 무단 사용으로부터 보호되어야 하며 데이터 자체가 무단 액세스로부터 보호되어야 함을 의미합니다. 이러한 보호를 달성하기 위한 수단은 이 문서의 범위를 벗어납니다.

\[2\]의 섹션 5에서는 분석기에서 관리자에게 IDMEF 데이터를 전달하는 데 사용되는 전송 프로토콜의 필수 및 권장 보안 특성을 설명합니다. 이러한 요구 사항에는 메시지 기밀성, 메시지 무결성, 부인 방지 및 중복 메시지 방지가 포함됩니다. 이러한 기능을 제공하는 표준 프로토콜과 제안된 프로토콜이 모두 존재합니다.

\[2\]의 섹션 5의 요구 사항을 충족하지 않는 프로토콜을 사용하여 IDMEF 메시지를 교환하는 경우 디지털 서명을 사용하여 이러한 메시지의 무결성을 인증하는 것이 바람직할 수 있습니다. 이에 대해서는 이 문서의 섹션 6.5에서 설명합니다.

---
## **10.  IANA Considerations**

섹션 5에서는 추가 데이터 클래스를 사용하여 IDMEF 메시지에 임의의 "원자" 데이터 항목을 포함하는 방법과 새 클래스 및 속성을 추가하여 DTD 자체를 확장하는 데 추가 데이터를 사용하는 방법을 설명합니다.

때때로 확장을 개인 또는 로컬 사용 상태\(위의 메커니즘을 통해 만들어진 모든 확장이 그렇듯이\)에서 모든 구현에서 지원해야 하는 "표준" 상태로 이동하는 것이 바람직할 수 있습니다.

이는 이 섹션에 설명된 대로 수행될 수 있습니다.

---
### **10.1.  Adding Values to Existing Attributes**

이 문서에 지정된 여러 속성에는 포함할 수 있는 허용 값 목록이 있습니다. 이러한 목록에 새 값을 추가할 수 있도록 IANA는 "IDMEF\(침입 감지 메시지 교환 형식\) 속성 값"이라는 속성 값에 대한 저장소를 만들었습니다.

\[9\]에 설명된 정책에 따라 이 저장소는 RFC에 의해 "사양이 필요"합니다. 섹션 10.1.1에서는 이 저장소의 초기 값을 설명합니다.

새 속성을 생성하려면 유형을 문서화하는 RFC를 게시해야 합니다. RFC에는 이 문서의 섹션 10.1.2에 있는 등록 템플릿의 사본을 포함하십시오. IANA 고려 사항 섹션에 템플릿을 넣고 해당 필드를 채웁니다. 문서에 상호 운용성 및 보안 문제를 설명해야 합니다.\(MUST, MUST\)

저장소에 새 속성 값을 추가할 때 IANA는 해당 값에 대해 숫자 순서로 다음 순위 번호를 할당해야 합니다.

---
#### **10.1.1.  Attribute Registrations**

```text
   IDMEF Class Name:  Reference

   IDMEF Attribute Name:  origin

   Registered Values:

   +------+-----------------+------------------------------------------+
   | Rank | Keyword         | Description                              |
   +------+-----------------+------------------------------------------+
   |    0 | unknown         | Origin of the name is not known          |
   |    1 | vendor-specific | A vendor-specific name (and hence, URL); |
   |      |                 | this can be used to provide              |
   |      |                 | product-specific information             |
   |    2 | user-specific   | A user-specific name (and hence, URL);   |
   |      |                 | this can be used to provide              |
   |      |                 | installation-specific information        |
   |    3 | bugtraqid       | The SecurityFocus ("Bugtraq")            |
   |      |                 | vulnerability database identifier        |
   |      |                 | (http://www.securityfocus.com/bid)       |
   |    4 | cve             | The Common Vulnerabilities and Exposures |
   |      |                 | (CVE) name (http://cve.mitre.org/)       |
   |    5 | osvdb           | The Open Source Vulnerability Database   |
   |      |                 | (http://www.osvdb.org)                   |
   +------+-----------------+------------------------------------------+

   IDMEF Class Name:  Source

   IDMEF Attribute Name:  spoofed

   Registered Values:

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of source information unknown |
        |    1 | yes     | Source is believed to be a decoy       |
        |    2 | no      | Source is believed to be "real"        |
        +------+---------+----------------------------------------+

   IDMEF Class Name:  Target

   IDMEF Attribute Name:  decoy

   Registered Values:

        +------+---------+----------------------------------------+
        | Rank | Keyword | Description                            |
        +------+---------+----------------------------------------+
        |    0 | unknown | Accuracy of target information unknown |
        |    1 | yes     | Target is believed to be a decoy       |
        |    2 | no      | Target is believed to be "real"        |
        +------+---------+----------------------------------------+

   IDMEF Class Name:  AdditionalData

   IDMEF Attribute Name:  type

   Registered Values:

   +------+-------------+----------------------------------------------+
   | Rank | Keyword     | Description                                  |
   +------+-------------+----------------------------------------------+
   |    0 | boolean     | The element contains a boolean value, i.e.,  |
   |      |             | the strings "true" or "false"                |
   |    1 | byte        | The element content is a single 8-bit byte   |
   |      |             | (see Section 3.2.4)                          |
   |    2 | character   | The element content is a single character    |
   |      |             | (see Section 3.2.3)                          |
   |    3 | date-time   | The element content is a date-time string    |
   |      |             | (see Section 3.2.6)                          |
   |    4 | integer     | The element content is an integer (see       |
   |      |             | Section 3.2.1)                               |
   |    5 | ntpstamp    | The element content is an NTP timestamp (see |
   |      |             | Section 3.2.7)                               |
   |    6 | portlist    | The element content is a list of ports (see  |
   |      |             | Section 3.2.8)                               |
   |    7 | real        | The element content is a real number (see    |
   |      |             | Section 3.2.2)                               |
   |    8 | string      | The element content is a string (see         |
   |      |             | Section 3.2.3)                               |
   |    9 | byte-string | The element content is a byte[] (see         |
   |      |             | Section 3.2.4)                               |
   |   10 | xmltext     | The element content is XML-tagged data (see  |
   |      |             | Section 5.2)                                 |
   +------+-------------+----------------------------------------------+

   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  severity

   Registered Values:

       +------+---------+-----------------------------------------+
       | Rank | Keyword | Description                             |
       +------+---------+-----------------------------------------+
       |    0 | info    | Alert represents informational activity |
       |      |         |                                         |
       |    1 | low     | Low severity                            |
       |      |         |                                         |
       |    2 | medium  | Medium severity                         |
       |      |         |                                         |
       |    3 | high    | High severity                           |
       +------+---------+-----------------------------------------+

   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  completion

   Registered Values:

           +------+-----------+--------------------------------+
           | Rank | Keyword   | Description                    |
           +------+-----------+--------------------------------+
           |    0 | failed    | The attempt was not successful |
           |    1 | succeeded | The attempt succeeded          |
           +------+-----------+--------------------------------+

   IDMEF Class Name:  Impact

   IDMEF Attribute Name:  type

   Registered Values:

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | admin   | Administrative privileges were attempted or      |
   |      |         | obtained                                         |
   |    1 | dos     | A denial of service was attempted or completed   |
   |    2 | file    | An action on a file was attempted or completed   |
   |    3 | recon   | A reconnaissance probe was attempted or          |
   |      |         | completed                                        |
   |    4 | user    | User privileges were attempted or obtained       |
   |    5 | other   | Anything not in one of the above categories      |
   +------+---------+--------------------------------------------------+

   IDMEF Class Name:  Action

   IDMEF Attribute Name:  category

   Registered Values:

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | block-installed   | A block of some sort was installed to  |
   |      |                   | prevent an attack from reaching its    |
   |      |                   | destination.  The block could be a     |
   |      |                   | port block, address block, etc., or    |
   |      |                   | disabling a user account.              |
   |    1 | notification-sent | A notification message of some sort    |
   |      |                   | was sent out-of-band (via pager,       |
   |      |                   | e-mail, etc.).  Does not include the   |
   |      |                   | transmission of this alert.            |
   |    2 | taken-offline     | A system, computer, or user was taken  |
   |      |                   | offline, as when the computer is shut  |
   |      |                   | down or a user is logged off.          |
   |    3 | other             | Anything not in one of the above       |
   |      |                   | categories.                            |
   +------+-------------------+----------------------------------------+

   IDMEF Class Name:  Confidence

   IDMEF Attribute Name:  rating

   Registered Values:

   +------+---------+--------------------------------------------------+
   | Rank | Keyword | Description                                      |
   +------+---------+--------------------------------------------------+
   |    0 | low     | The analyzer has little confidence in its        |
   |      |         | validity                                         |
   |    1 | medium  | The analyzer has average confidence in its       |
   |      |         | validity                                         |
   |    2 | high    | The analyzer has high confidence in its validity |
   |    3 | numeric | The analyzer has provided a posterior            |
   |      |         | probability value indicating its confidence in   |
   |      |         | its validity                                     |
   +------+---------+--------------------------------------------------+

   IDMEF Class Name:  Node

   IDMEF Attribute Name:  category

   Registered Values:

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | unknown  | Domain unknown or not relevant           |
      |    1 | ads      | Windows 2000 Advanced Directory Services |
      |    2 | afs      | Andrew File System (Transarc)            |
      |    3 | coda     | Coda Distributed File System             |
      |    4 | dfs      | Distributed File System (IBM)            |
      |    5 | dns      | Domain Name System                       |
      |    6 | hosts    | Local hosts file                         |
      |    7 | kerberos | Kerberos realm                           |
      |    8 | nds      | Novell Directory Services                |
      |    9 | nis      | Network Information Services (Sun)       |
      |   10 | nisplus  | Network Information Services Plus (Sun)  |
      |   11 | nt       | Windows NT domain                        |
      |   12 | wfw      | Windows for Workgroups                   |
      +------+----------+------------------------------------------+

   IDMEF Class Name:  Address

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | unknown       | Address type unknown                       |
   |    1 | atm           | Asynchronous Transfer Mode network address |
   |    2 | e-mail        | Electronic mail address (RFC 822)          |
   |    3 | lotus-notes   | Lotus Notes e-mail address                 |
   |    4 | mac           | Media Access Control (MAC) address         |
   |    5 | sna           | IBM Shared Network Architecture (SNA)      |
   |      |               | address                                    |
   |    6 | vm            | IBM VM ("PROFS") e-mail address            |
   |    7 | ipv4-addr     | IPv4 host address in dotted-decimal        |
   |      |               | notation (a.b.c.d)                         |
   |    8 | ipv4-addr-hex | IPv4 host address in hexadecimal notation  |
   |    9 | ipv4-net      | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, significant bits          |
   |      |               | (a.b.c.d/nn)                               |
   |   10 | ipv4-net-mask | IPv4 network address in dotted-decimal     |
   |      |               | notation, slash, network mask in           |
   |      |               | dotted-decimal notation (a.b.c.d/w.x.y.z)  |
   |   11 | ipv6-addr     | IPv6 host address                          |
   |   12 | ipv6-addr-hex | IPv6 host address in hexadecimal notation  |
   |   13 | ipv6-net      | IPv6 network address, slash, significant   |
   |      |               | bits                                       |
   |   14 | ipv6-net-mask | IPv6 network address, slash, network mask  |
   +------+---------------+--------------------------------------------+

   IDMEF Class Name:  User

   IDMEF Attribute Name:  category

   Registered Values:

        +------+-------------+------------------------------------+
        | Rank | Keyword     | Description                        |
        +------+-------------+------------------------------------+
        |    0 | unknown     | User type unknown                  |
        |    1 | application | An application user                |
        |    2 | os-device   | An operating system or device user |
        +------+-------------+------------------------------------+

   IDMEF Class Name:  UserId

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | current-user  | The current user id being used by the user |
   |      |               | or process.  On Unix systems, this would   |
   |      |               | be the "real" user id, in general.         |
   |    1 | original-user | The actual identity of the user or process |
   |      |               | being reported on.  On those systems that  |
   |      |               | (a) do some type of auditing and (b)       |
   |      |               | support extracting a user id from the      |
   |      |               | "audit id" token, that value should be     |
   |      |               | used.  On those systems that do not        |
   |      |               | support this, and where the user has       |
   |      |               | logged into the system, the "login id"     |
   |      |               | should be used.                            |
   |    2 | target-user   | The user id the user or process is         |
   |      |               | attempting to become.  This would apply,   |
   |      |               | on Unix systems for example, when the user |
   |      |               | attempts to use "su", "rlogin", "telnet",  |
   |      |               | etc.                                       |

   |    3 | user-privs    | Another user id the user or process has    |
   |      |               | the ability to use, or a user id           |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" user id in a user or process   |
   |      |               | context, and the owner permissions in a    |
   |      |               | file context.  Multiple UserId elements of |
   |      |               | this type may be used to specify a list of |
   |      |               | privileges.                                |
   |    4 | current-group | The current group id (if applicable) being |
   |      |               | used by the user or process.  On Unix      |
   |      |               | systems, this would be the "real" group    |
   |      |               | id, in general.                            |
   |    5 | group-privs   | Another group id the group or process has  |
   |      |               | the ability to use, or a group id          |
   |      |               | associated with a file permission.  On     |
   |      |               | Unix systems, this would be the            |
   |      |               | "effective" group id in a group or process |
   |      |               | context, and the group permissions in a    |
   |      |               | file context.  On BSD-derived Unix         |
   |      |               | systems, multiple UserId elements of this  |
   |      |               | type would be used to include all the      |
   |      |               | group ids on the "group list".             |
   |    6 | other-privs   | Not used in a user, group, or process      |
   |      |               | context, only used in the file context.    |
   |      |               | The file permissions assigned to users who |
   |      |               | do not match either the user or group      |
   |      |               | permissions on the file.  On Unix systems, |
   |      |               | this would be the "world" permissions.     |
   +------+---------------+--------------------------------------------+

   IDMEF Class Name:  File

   IDMEF Attribute Name:  category

   Registered Values:

   +------+----------+-------------------------------------------------+
   | Rank | Keyword  | Description                                     |
   +------+----------+-------------------------------------------------+
   |    0 | current  | The file information is from after the reported |
   |      |          | change                                          |
   |    1 | original | The file information is from before the         |
   |      |          | reported change                                 |
   +------+----------+-------------------------------------------------+

   IDMEF Class Name:  File

   IDMEF Attribute Name:  fstype

   Registered Values:

         +------+---------+-------------------------------------+
         | Rank | Keyword | Description                         |
         +------+---------+-------------------------------------+
         |    0 | ufs     | Berkeley Unix Fast File System      |
         |    1 | efs     | Linux "efs" file system             |
         |    2 | nfs     | Network File System                 |
         |    3 | afs     | Andrew File System                  |
         |    4 | ntfs    | Windows NT File System              |
         |    5 | fat16   | 16-bit Windows FAT File System      |
         |    6 | fat32   | 32-bit Windows FAT File System      |
         |    7 | pcfs    | "PC" (MS-DOS) file system on CD-ROM |
         |    8 | joliet  | Joliet CD-ROM file system           |
         |    9 | iso9660 | ISO 9660 CD-ROM file system         |
         +------+---------+-------------------------------------+

   IDMEF Class Name:  FileAccess

   IDMEF Attribute Name:  permission

   Registered Values:

   +------+-------------------+----------------------------------------+
   | Rank | Keyword           | Description                            |
   +------+-------------------+----------------------------------------+
   |    0 | noAccess          | No access at all is allowed for this   |
   |      |                   | user                                   |
   |    1 | read              | This user has read access to the file  |
   |    2 | write             | This user has write access to the file |
   |    3 | execute           | This user has the ability to execute   |
   |      |                   | the file                               |
   |    4 | search            | This user has the ability to search    |
   |      |                   | this file (applies to "execute"        |
   |      |                   | permission on directories in Unix)     |
   |    5 | delete            | This user has the ability to delete    |
   |      |                   | this file                              |
   |    6 | executeAs         | This user has the ability to execute   |
   |      |                   | this file as another user              |
   |    7 | changePermissions | This user has the ability to change    |
   |      |                   | the access permissions on this file    |
   |    8 | takeOwnership     | This user has the ability to take      |
   |      |                   | ownership of this file                 |
   +------+-------------------+----------------------------------------+

   IDMEF Class Name:  Linkage

   IDMEF Attribute Name:  category

   Registered Values:

   +------+---------------+--------------------------------------------+
   | Rank | Keyword       | Description                                |
   +------+---------------+--------------------------------------------+
   |    0 | hard-link     | The <name> element represents another name |
   |      |               | for this file.  This information may be    |
   |      |               | more easily obtainable on NTFS file        |
   |      |               | systems than others.                       |
   |    1 | mount-point   | An alias for the directory specified by    |
   |      |               | the parent's <name> and <path> elements.   |
   |    2 | reparse-point | Applies only to Windows; excludes symbolic |
   |      |               | links and mount points, which are specific |
   |      |               | types of reparse points.                   |
   |    3 | shortcut      | The file represented by a Windows          |
   |      |               | "shortcut".  A shortcut is distinguished   |
   |      |               | from a symbolic link because of the        |
   |      |               | difference in their contents, which may be |
   |      |               | of importance to the manager.              |
   |    4 | stream        | An Alternate Data Stream (ADS) in Windows; |
   |      |               | a fork on MacOS.  Separate file system     |
   |      |               | entity that is considered an extension of  |
   |      |               | the main <File>.                           |
   |    5 | symbolic-link | The <name> element represents the file to  |
   |      |               | which the link points.                     |
   +------+---------------+--------------------------------------------+

   IDMEF Class Name:  Checksum

   IDMEF Attribute Name:  algorithm

   Registered Values:

      +------+----------+------------------------------------------+
      | Rank | Keyword  | Description                              |
      +------+----------+------------------------------------------+
      |    0 | MD4      | The MD4 algorithm.                       |
      |    1 | MD5      | The MD5 algorithm.                       |
      |    2 | SHA1     | The SHA1 algorithm.                      |
      |    3 | SHA2-256 | The SHA2 algorithm with 256 bits length. |
      |    4 | SHA2-384 | The SHA2 algorithm with 384 bits length. |
      |    5 | SHA2-512 | The SHA2 algorithm with 512 bits length. |
      |    6 | CRC-32   | The CRC algorithm with 32 bits length.   |
      |    7 | Haval    | The Haval algorithm.                     |
      |    8 | Tiger    | The Tiger algorithm.                     |
      |    9 | Gost     | The Gost algorithm.                      |
      +------+----------+------------------------------------------+
```

---
#### **10.1.2.  Registration Template**

```text
   IDMEF Class Name:
```

- <새 값을 추가하려는 속성이 포함된 클래스 이름을 제공하세요\(예: "주소"\>\)

```text
   IDMEF Attribute Name:
```

- <새 값을 추가하려는 속성의 이름을 제공하세요\(예: "카테고리"\>\)

정의할 새 속성 값:

- <추가하려는 새 속성 값의 이름을 입력하세요\(예: "sneaker-net"\>\)

새 속성 값의 의미:

- <속성 값이 무엇을 의미하는지 자세히 설명합니다. 즉, 분석기가 이 값을 보내는 경우 정보 수신자에게 무엇을 알려주는가?\>

담당자 및 이메일 주소:

- <귀하의 이름과 이메일 주소\>

---
### **10.2.  Adding New Attributes and Classes**

가능한 한 이 문서에 지정된 IDMEF 클래스와 속성은 현재와 가까운 미래의 모든 요구를 수용하도록 설계되었습니다. 미래에는 새로운 클래스를 추가하는 것뿐만 아니라 기존 클래스에 새로운 속성을 추가하는 것도 필요하다는 점을 인식하고 있지만, 이러한 조치를 가볍게 여겨서는 안 됩니다.

새로운 속성이나 클래스를 추가하려면 현재 클래스와 속성을 사용하여 "깨끗한" 방식으로 정보를 표현할 수 없는 경우에만 수행해야 합니다. 이러한 추가는 일반적으로 유용한 유형의 데이터를 나타내기 위해서만 이루어져야 합니다. 공급업체별 정보, 특정 유형의 분석기에서만 제공되거나 특정 유형의 관리자만 사용하는 모호한 정보, "애완동물" 속성 등은 클래스 및 속성을 추가하는 데 좋은 이유가 아닙니다.

이 RFC가 작성될 당시 새 클래스와 속성을 추가해야 할 첫 번째 예상 사례는 호스트 기반 침입 탐지 시스템을 처리하는 것입니다. 그러나 이러한 추가는 이러한 시스템에서 제공할 데이터 세트에 대해 어느 정도 합의가 이루어질 때까지 이루어져서는 안 됩니다.

\[9\]에 설명된 정책에 따라 IDMEF에 새 클래스와 속성을 추가하려면 "IETF 합의"가 필요합니다.

새로운 속성이나 클래스를 추가하려면 RFC를 게시하여 이를 문서화하고 IESG의 승인을 받아야 합니다. 일반적으로 IESG는 적절한 사람\(예: 관련 작업 그룹이 있는 경우\)으로부터 향후 추가 사항에 대한 의견을 구합니다. 문서에 상호 운용성 및 보안 문제를 설명해야 합니다.\(MUST, MUST\)

---
## **11.  References**
---
### **11.1.  Normative References**

\[1\] Bradner, S., "요구 사항 수준을 나타 내기 위해 RFC에 사용되는 핵심 단어", BCP 14, RFC 2119, 1997년 3월.

\[2\] Wood, M. 및 M. Erlinger, "침입 감지 메시지 교환 요구 사항", RFC 4766, 2007년 3월.

\[3\] Sperberg-McQueen, C., Paoli, J., Maler, E. 및 T. Bray, "XML\(Extensible Markup Language\) 1.0\(제2판\)", World Wide Web 컨소시엄 FirstEdition http://www. w3.org/TR/2000/REC-xml-20001006, 2000년 10월.

\[4\] Bray, T., Hollander, D. 및 A. Layman, "XML의 네임스페이스", World Wide Web 컨소시엄 권장 사항 http://www.w3.org/TR/1999/REC-xml-names-19990114 , 1999년 1월.

\[5\] Berners-Lee, T., Fielding, R. 및 L. Masinter, "URI\(Uniform Resource Identifier\): 일반 구문", STD 66, RFC 3986, 2005년 1월.

\[6\] 국제 표준화 기구, "데이터 요소 및 교환 형식 - 정보 교환 - 날짜 및 시간 표현", ISO 표준 8601, 제2판, 2000년 12월.

```text
   [7]   Mills, D., "Network Time Protocol (Version 3) Specification,
         Implementation", RFC 1305, March 1992.
```

\[8\] Mills, D., "IPv4, IPv6 및 OSI용 SNTP\(Simple Network Time Protocol\) 버전 4", RFC 4330, 2006년 1월.

\[9\] Narten, T. 및 H. Alvestrand, "RFC에서 IANA 고려 사항 섹션 작성 지침", BCP 26, RFC 2434, 1998년 10월.

\[10\] Phillips, A. 및 M. Davis, "언어 식별을 위한 태그", BCP 47, RFC 4646, 2006년 9월.

---
### **11.2.  Informative References**

```text
   [11]  St. Johns, M., "Identification Protocol", RFC 1413,
         February 1993.

   [12]  Resnick, P., "Internet Message Format", RFC 2822, April 2001.
```

\[13\] Eastlake, D., Reagle, J. 및 D. Solo, "\(Extensible Markup Language\) XML 서명 구문 및 처리", RFC 3275, 2002년 3월.

\[14\] Rumbaugh, J., Jacobson, I. 및 G. Booch, "통합 모델링 언어 참조 모델", ISBN 020130998X, 1998.

\[15\] Harrington, D., Presuhn, R. 및 B. Wijnen, "SNMP\(단순 네트워크 관리 프로토콜\) 관리 프레임워크 설명을 위한 아키텍처", STD 62, RFC 3411, 2002년 12월.

\[16\] Frye, R., Levi, D., Routhier, S. 및 B. Wijnen, "인터넷 표준 네트워크 관리 프레임워크 버전 1, 버전 2 및 버전 3 간의 공존", BCP 74, RFC 3584 , 2003년 8월.

---
# **Appendix A.  Acknowledgements**

다음 개인은 이 문서에 상당한 기여를 했으며 그들의 노력을 인정받아야 합니다. 이 문서는 그들의 도움 없이는 존재하지 않을 것입니다:

Dominique Alessandri, IBM Corporation Spencer Alllain, Teknowledge Corporation James L. Burden, 캘리포니아 독립 시스템 운영자 Marc Dacier, IBM Corporation Oliver Dain, MIT Lincoln Laboratory Nicolas Delon, Prelude Hybrid IDS 프로젝트 David J. Donahoo, AFIWC Michael Erlinger, Harvey Mudd College Reinhard Handwerker, Internet Security Systems, Inc. Ming-Yuh Huang, Boeing Company Glenn Mansfield, Cyber ​​Solutions, Inc. Joe McAlerney, Silicon Defense Cynthia McLain, MIT Lincoln Laboratory Paul Osterwald, Intrusion.com Jean-Philippe Pouzol James Riordan, IBM Corporation Paul Sangree, Cisco Systems Stephane Schitter, IBM Corporation Michael J. Slifcak, Trusted Network Technologies, Inc. Steven R. Snapp, CyberSafe Corporation Stuart Staniford-Chen, Silicon Defense Michael Steiner, University of Saarland Maureen Stillman, Nokia IP Telephony Vimal Vaidya, AXENT Yoann Vandoorselaere, Prelude Hybrid IDS 프로젝트 Andy Walther, Harvey Mudd College Andreas Wespi, IBM Corporation John C. C. White, MITER Eric D. Williams, Information Brokers, Inc. S. Felix Wu, University of California Davis

---
# **Appendix B.  The IDMEF Schema Definition (Non-normative)**

```text
   <?xml version="1.0"?>
   <xsd:schema xmlns:xsd="http://www.w3.org/2001/XMLSchema"
               xmlns:idmef="http://iana.org/idmef"
               targetNamespace="http://iana.org/idmef"
               elementFormDefault="qualified" >

     <xsd:annotation>
       <xsd:documentation>
         Intrusion Detection Message Exchange Format (IDMEF) Version 1.0
       </xsd:documentation>
     </xsd:annotation>

     <!-- Section 1 -->
     <!-- Omitted.  This section did namespace magic and is not
          needed with XSD validation. -->

     <!-- Section 2 -->

     <!--
       Values for the Action.category attribute.
     -->
     <xsd:simpleType name="action-category">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="block-installed"   />
         <xsd:enumeration value="notification-sent" />
         <xsd:enumeration value="taken-offline"     />
         <xsd:enumeration value="other"             />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
       Values for the Address.category attribute.
      -->
     <xsd:simpleType name="address-category">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="unknown"       />
         <xsd:enumeration value="atm"           />
         <xsd:enumeration value="e-mail"        />
         <xsd:enumeration value="lotus-notes"   />
         <xsd:enumeration value="mac"           />
         <xsd:enumeration value="sna"           />
         <xsd:enumeration value="vm"            />
         <xsd:enumeration value="ipv4-addr"     />
         <xsd:enumeration value="ipv4-addr-hex" />
         <xsd:enumeration value="ipv4-net"      />
         <xsd:enumeration value="ipv4-net-mask" />

         <xsd:enumeration value="ipv6-addr"     />
         <xsd:enumeration value="ipv6-addr-hex" />
         <xsd:enumeration value="ipv6-net"      />
         <xsd:enumeration value="ipv6-net-mask" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the Impact.severity attribute.
      -->
     <xsd:simpleType name="impact-severity">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="info" />
         <xsd:enumeration value="low" />
         <xsd:enumeration value="medium" />
         <xsd:enumeration value="high" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
       Values for the Impact.completion attribute.
      -->
     <xsd:simpleType name="impact-completion">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="failed" />
         <xsd:enumeration value="succeeded" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the Impact.type attribute.
      -->
     <xsd:simpleType name="impact-type">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="admin" />
         <xsd:enumeration value="dos"   />
         <xsd:enumeration value="file"  />
         <xsd:enumeration value="recon" />
         <xsd:enumeration value="user"  />
         <xsd:enumeration value="other" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
       Values for the File.category attribute.
      -->
     <xsd:simpleType name="file-category">
       <xsd:restriction base="xsd:token">

         <xsd:enumeration value="current"  />
         <xsd:enumeration value="original" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
       Values for the FileAccess.Permissions attribute
     -->
     <xsd:simpleType name="file-permission">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="noAccess"/>
         <xsd:enumeration value="read"/>
         <xsd:enumeration value="write"/>
         <xsd:enumeration value="execute"/>
         <xsd:enumeration value="search" />
         <xsd:enumeration value="delete" />
         <xsd:enumeration value="executeAs" />
         <xsd:enumeration value="changePermissions" />
         <xsd:enumeration value="takeOwnership" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
       Values for the Id.type attribute.
      -->
     <xsd:simpleType name="id-type">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="current-user"  />
         <xsd:enumeration value="original-user" />
         <xsd:enumeration value="target-user"   />
         <xsd:enumeration value="user-privs"    />
         <xsd:enumeration value="current-group" />
         <xsd:enumeration value="group-privs"   />
         <xsd:enumeration value="other-privs"   />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the Linkage.category attribute.
      -->
     <xsd:simpleType name="linkage-category">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="hard-link"     />
         <xsd:enumeration value="mount-point"   />
         <xsd:enumeration value="reparse-point" />
         <xsd:enumeration value="shortcut"      />
         <xsd:enumeration value="stream"        />
         <xsd:enumeration value="symbolic-link" />

       </xsd:restriction>
     </xsd:simpleType>

     <!--
       | Values for the Checksum.algorithm attribute
     -->
     <xsd:simpleType name="checksum-algorithm">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="MD4" />
         <xsd:enumeration value="MD5" />
         <xsd:enumeration value="SHA1" />
         <xsd:enumeration value="SHA2-256" />
         <xsd:enumeration value="SHA2-384" />
         <xsd:enumeration value="SHA2-512" />
         <xsd:enumeration value="CRC-32" />
         <xsd:enumeration value="Haval" />
         <xsd:enumeration value="Tiger" />
         <xsd:enumeration value="Gost" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the Node.category attribute.
      -->
     <xsd:simpleType name="node-category">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="unknown"  />
         <xsd:enumeration value="ads"      />
         <xsd:enumeration value="afs"      />
         <xsd:enumeration value="coda"     />
         <xsd:enumeration value="dfs"      />
         <xsd:enumeration value="dns"      />
         <xsd:enumeration value="hosts"    />
         <xsd:enumeration value="kerberos" />
         <xsd:enumeration value="nds"      />
         <xsd:enumeration value="nis"      />
         <xsd:enumeration value="nisplus"  />
         <xsd:enumeration value="nt"       />
         <xsd:enumeration value="wfw"      />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the reference.origin attribute.
      -->
     <xsd:simpleType name="reference-origin">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="unknown" />

         <xsd:enumeration value="vendor-specific" />
         <xsd:enumeration value="user-specific" />
         <xsd:enumeration value="bugtraqid" />
         <xsd:enumeration value="cve" />
         <xsd:enumeration value="osvdb" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the Confidence.rating attribute.
      -->
     <xsd:simpleType name="confidence-rating">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="low"    />
         <xsd:enumeration value="medium" />
         <xsd:enumeration value="high"   />
         <xsd:enumeration value="numeric" />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
      | Values for the User.category attribute.
      -->
     <xsd:simpleType name="user-category">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="unknown"     />
         <xsd:enumeration value="application" />
         <xsd:enumeration value="os-device"   />
       </xsd:restriction>
     </xsd:simpleType>

     <!--
     / Values for the additionaldata.type attribute.
     -->
     <xsd:simpleType name="additionaldata-type">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="boolean"     />
         <xsd:enumeration value="byte"        />
         <xsd:enumeration value="character"   />
         <xsd:enumeration value="date-time"   />
         <xsd:enumeration value="integer"     />
         <xsd:enumeration value="ntpstamp"    />
         <xsd:enumeration value="portlist"    />
         <xsd:enumeration value="real"        />
         <xsd:enumeration value="string"      />
         <xsd:enumeration value="byte-string" />
         <xsd:enumeration value="xml"         />
       </xsd:restriction>

     </xsd:simpleType>

     <!--
      | Values for yes/no attributes such as Source.spoofed and
      | Target.decoy.
      -->
     <xsd:simpleType name="yes-no-type">
       <xsd:restriction base="xsd:token">
         <xsd:enumeration value="unknown" />
         <xsd:enumeration value="yes"     />
         <xsd:enumeration value="no"      />
       </xsd:restriction>
     </xsd:simpleType>

     <xsd:simpleType name="port-range">
       <xsd:restriction base="xsd:string">
         <xsd:pattern value="[0-9]{1,5}(\-[0-9]{1,5})?"/>
       </xsd:restriction>
     </xsd:simpleType>

     <xsd:simpleType name="port-list">
       <xsd:list itemType="idmef:port-range" />
     </xsd:simpleType>

     <xsd:simpleType name="ntpstamp">
       <xsd:restriction base="xsd:string">
         <xsd:pattern value="0x[A-Fa-f0-9]{8}.0x[A-Fa-f0-9]{8}"/>
       </xsd:restriction>
     </xsd:simpleType>

     <xsd:simpleType name="mime-type">
       <xsd:restriction base="xsd:string">
       </xsd:restriction>
     </xsd:simpleType>

     <!-- Section 3: Top-level element declarations.  The IDMEF-Message
          element and the types of messages it can include. -->

     <xsd:complexType name="IDMEF-Message" >
       <xsd:choice minOccurs="1" maxOccurs="unbounded">
         <xsd:element ref="idmef:Alert"     />
         <xsd:element ref="idmef:Heartbeat" />
       </xsd:choice>
       <xsd:attribute name="version" type="xsd:decimal"
                      fixed="1.0" />
     </xsd:complexType>

     <xsd:element name="IDMEF-Message" type="idmef:IDMEF-Message" />

     <xsd:complexType name="Alert">
       <xsd:sequence>
         <xsd:element name="Analyzer"
                      type="idmef:Analyzer" />
         <xsd:element name="CreateTime"
                      type="idmef:TimeWithNtpstamp" />
         <xsd:element name="DetectTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="AnalyzerTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Source"
                      type="idmef:Source"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="Target"
                      type="idmef:Target"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="Classification"
                      type="idmef:Classification" />
         <xsd:element name="Assessment"
                      type="idmef:Assessment"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:choice minOccurs="0" maxOccurs="1">
           <xsd:element name="ToolAlert"
                        type="idmef:ToolAlert" />
           <xsd:element name="OverflowAlert"
                        type="idmef:OverflowAlert" />
           <xsd:element name="CorrelationAlert"
                        type="idmef:CorrelationAlert" />
         </xsd:choice>
         <xsd:element name="AdditionalData"
                      type="idmef:AdditionalData"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="messageid"
                      type="xsd:string"
                      default="0" />
     </xsd:complexType>

     <xsd:element name="Alert" type="idmef:Alert" />

     <xsd:complexType name="Heartbeat">
       <xsd:sequence>
         <xsd:element name="Analyzer" type="idmef:Analyzer" />
         <xsd:element name="CreateTime"
                      type="idmef:TimeWithNtpstamp" />
         <xsd:element name="HeartbeatInterval"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="AnalyzerTime"
                      type="idmef:TimeWithNtpstamp"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="AdditionalData"
                      type="idmef:AdditionalData"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="messageid"
                      type="xsd:string"
                      default="0" />
     </xsd:complexType>

     <xsd:element name="Heartbeat"
                  type="idmef:Heartbeat" />

     <!-- Section 4: Subclasses of the Alert class that provide
          more data for specific types of alerts. -->

     <xsd:complexType name="CorrelationAlert">
       <xsd:sequence>
         <xsd:element name="name"
                      type="xsd:string" />
         <xsd:element name="alertident"
                      type="idmef:Alertident"
                      minOccurs="1"
                      maxOccurs="unbounded" />
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="OverflowAlert">
       <xsd:sequence>
         <xsd:element name="program"
                      type="xsd:string" />
         <xsd:element name="size"
                      type="xsd:string" />

         <xsd:element name="buffer"
                      type="xsd:hexBinary" />
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="ToolAlert">
       <xsd:sequence>
         <xsd:element name="name"
                      type="xsd:string" />
         <xsd:element name="command"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="alertident"
                      type="idmef:Alertident"
                      minOccurs="1"
                      maxOccurs="unbounded" />
       </xsd:sequence>
     </xsd:complexType>

     <!-- Section 5: The AdditionalData element.  This element allows an
          alert to include additional information that cannot be encoded
          elsewhere in the data model. -->

     <xsd:complexType name="AdditionalData">
       <xsd:choice>
         <xsd:element name="boolean"
                      type="xsd:boolean" />
         <xsd:element name="byte"
                      type="xsd:byte" />
         <xsd:element name="character">
           <xsd:simpleType>
             <xsd:restriction base="xsd:string">
               <xsd:minLength value="1"/>
               <xsd:maxLength value="1"/>
             </xsd:restriction>
           </xsd:simpleType>
         </xsd:element>
         <xsd:element name="date-time"
                      type="xsd:dateTime" />
         <xsd:element name="integer"
                      type="xsd:integer" />
         <xsd:element name="ntpstamp"
                      type="idmef:ntpstamp" />
         <xsd:element name="portlist"
                      type="idmef:port-list" />
         <xsd:element name="real"
                      type="xsd:decimal" />

         <xsd:element name="string"
                      type="xsd:string" />
         <xsd:element name="byte-string"
                      type="xsd:hexBinary" />
         <xsd:element name="xml"
                      type="idmef:xmltext" />
       </xsd:choice>
       <xsd:attribute name="type"
                      type="idmef:additionaldata-type" />
       <xsd:attribute name="meaning"
                      type="xsd:string" />
     </xsd:complexType>

     <!-- Section 6: Elements related to identifying entities -
          analyzers (the senders of these messages), sources (of
          attacks), and targets (of attacks). -->

     <xsd:complexType name="Analyzer">
       <xsd:sequence>
         <xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Analyzer"
                      type="idmef:Analyzer"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
       <xsd:attribute name="analyzerid"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="name"
                      type="xsd:string" />
       <xsd:attribute name="manufacturer"
                      type="xsd:string" />
       <xsd:attribute name="model"
                      type="xsd:string" />
       <xsd:attribute name="version"
                      type="xsd:string" />
       <xsd:attribute name="class"
                      type="xsd:string" />
       <xsd:attribute name="ostype"
                      type="xsd:string" />
       <xsd:attribute name="osversion"

                      type="xsd:string" />
     </xsd:complexType>

     <xsd:complexType name="Source">
       <xsd:sequence>
         <xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="User"
                      type="idmef:User"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Service"
                      type="idmef:Service"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="spoofed"
                      type="idmef:yes-no-type"
                      default="unknown" />
       <xsd:attribute name="interface"
                      type="xsd:string" />
     </xsd:complexType>

     <xsd:complexType name="Target">
       <xsd:sequence>
         <xsd:element name="Node"
                      type="idmef:Node"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="User"
                      type="idmef:User"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Process"
                      type="idmef:Process"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Service"
                      type="idmef:Service"

                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="File"
                      type="idmef:File"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="decoy"
                      type="idmef:yes-no-type"
                      default="unknown" />
       <xsd:attribute name="interface"
                      type="xsd:string" />
     </xsd:complexType>

     <!-- Section 7: Support elements used for providing detailed info
          about entities - addresses, names, etc. -->

     <xsd:complexType name="Address">
       <xsd:sequence>
         <xsd:element name="address"
                      type="xsd:string" />
         <xsd:element name="netmask"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="category"
                      type="idmef:address-category"
                      default="unknown" />
       <xsd:attribute name="vlan-name"
                      type="xsd:string" />
       <xsd:attribute name="vlan-num"
                      type="xsd:string" />
     </xsd:complexType>

     <xsd:complexType name="Assessment">
       <xsd:sequence>
         <xsd:element name="Impact"
                      type="idmef:Impact"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Action"

                      type="idmef:Action"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="Confidence"
                      type="idmef:Confidence"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
     </xsd:complexType>
     <xsd:complexType name="Reference">
       <xsd:sequence>
         <xsd:element name="name"
                      type="xsd:string" />
         <xsd:element name="url"
                      type="xsd:string" />
       </xsd:sequence>
       <xsd:attribute name="origin"
                      type="idmef:reference-origin"
                      default="unknown" />
       <xsd:attribute name="meaning"
                      type="xsd:string" />
     </xsd:complexType>

     <xsd:complexType name="Classification">
       <xsd:sequence>
         <xsd:element name="Reference"
                      type="idmef:Reference"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="text"
                      type="xsd:string"
                      use="required" />
     </xsd:complexType>

     <xsd:complexType name="File">
       <xsd:sequence>
         <xsd:element name="name"
                      type="xsd:string" />
         <xsd:element name="path"
                      type="xsd:string" />
         <xsd:element name="create-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" />

         <xsd:element name="modify-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="access-time"
                      type="xsd:dateTime"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="data-size"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="disk-size"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="FileAccess"
                      type="idmef:FileAccess"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="Linkage"
                      type="idmef:Linkage"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="Inode"
                      type="idmef:Inode"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="Checksum"
                      type="idmef:Checksum"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="category"
                      type="idmef:file-category"
                      use="required" />
       <xsd:attribute name="fstype"
                      type="xsd:string"
                      use="required" />
       <xsd:attribute name="file-type"
                      type="idmef:mime-type" />
     </xsd:complexType>

     <xsd:complexType name="Permission">
       <xsd:attribute name="perms"

                      type="idmef:file-permission"
                      use="required" />
     </xsd:complexType>

     <xsd:complexType name="FileAccess">
       <xsd:sequence>
         <xsd:element name="UserId"
                      type="idmef:UserId" />
         <xsd:element name="permission"
                      type="idmef:Permission"
                      minOccurs="1"
                      maxOccurs="unbounded" />
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="Inode">
       <xsd:sequence>
         <xsd:element name="change-time"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:sequence minOccurs="0" maxOccurs="1">
           <xsd:element name="number"
                        type="xsd:string" />
           <xsd:element name="major-device"
                        type="xsd:string" />
           <xsd:element name="minor-device"
                        type="xsd:string" />
         </xsd:sequence>
         <xsd:sequence minOccurs="0" maxOccurs="1">
           <xsd:element name="c-major-device"
                        type="xsd:string" />
           <xsd:element name="c-minor-device"
                        type="xsd:string" />
         </xsd:sequence>
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="Linkage">
       <xsd:choice>
         <xsd:sequence>
           <xsd:element name="name" type="xsd:string" />
           <xsd:element name="path" type="xsd:string" />
         </xsd:sequence>
         <xsd:element name="File" type="idmef:File" />
       </xsd:choice>
       <xsd:attribute name="category"
                      type="idmef:linkage-category"

                      use="required" />
     </xsd:complexType>

     <xsd:complexType name="Checksum">
       <xsd:sequence>
         <xsd:element name="value"
                      type="xsd:string" />
         <xsd:element name="key"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
       <xsd:attribute name="algorithm"
                      type="idmef:checksum-algorithm"
                      use="required" />
     </xsd:complexType>

     <xsd:complexType name="Node">
       <xsd:sequence>
         <xsd:element name="location"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:choice>
           <xsd:element name="name"
                        type="xsd:string" />
           <xsd:element name="Address"
                        type="idmef:Address" />
         </xsd:choice>
         <xsd:element name="Address"
                      type="idmef:Address"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="category"
                      type="idmef:node-category"
                      default="unknown" />
     </xsd:complexType>

     <xsd:complexType name="Process">
       <xsd:sequence>
         <xsd:element name="name"
                      type="xsd:string" />
         <xsd:element name="pid"
                      type="xsd:integer"

                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="path"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="arg"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" />
         <xsd:element name="env"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
     </xsd:complexType>

     <xsd:complexType name="Service">
       <xsd:sequence>
         <xsd:choice>
           <xsd:sequence>
             <xsd:element name="name"
                          type="xsd:string" />
             <xsd:element name="port"
                          type="xsd:integer"
                          minOccurs="0"
                          maxOccurs="1" />
           </xsd:sequence>
           <xsd:sequence>
             <xsd:element name="port"
                          type="xsd:integer" />
             <xsd:element name="name"
                          type="xsd:string"
                          minOccurs="0"
                          maxOccurs="1" />
           </xsd:sequence>
           <xsd:element name="portlist"
                        type="idmef:port-list" />
         </xsd:choice>
         <xsd:element name="protocol"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="SNMPService"
                      type="idmef:SNMPService"

                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="WebService"
                      type="idmef:WebService"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="ip_version"
                      type="xsd:integer" />
       <xsd:attribute name="iana_protocol_number"
                      type="xsd:integer" />
       <xsd:attribute name="iana_protocol_name"
                      type="xsd:string" />
     </xsd:complexType>

     <xsd:complexType name="WebService">
       <xsd:sequence>
         <xsd:element name="url"
                      type="xsd:anyURI" />
         <xsd:element name="cgi"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="http-method"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="arg"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="unbounded" />
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="SNMPService">
       <xsd:sequence>
         <xsd:element name="oid"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="messageProcessingModel"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="securityModel"

                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="securityName"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="securityLevel"
                      type="xsd:integer"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="contextName"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="contextEngineID"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
         <xsd:element name="command"
                      type="xsd:string"
                      minOccurs="0"
                      maxOccurs="1" />
       </xsd:sequence>
     </xsd:complexType>

     <xsd:complexType name="User">
       <xsd:sequence>
         <xsd:element name="UserId"
                      type="idmef:UserId"
                      minOccurs="1"
                      maxOccurs="unbounded" />
       </xsd:sequence>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="category"
                      type="idmef:user-category"
                      default="unknown" />
     </xsd:complexType>

     <xsd:complexType name="UserId" >
       <xsd:choice>
         <xsd:sequence>
           <xsd:element name="name"
                        type="xsd:string" />
           <xsd:element name="number"
                        type="xsd:integer"

                        minOccurs="0"
                        maxOccurs="1" />
         </xsd:sequence>
         <xsd:sequence>
           <xsd:element name="number"
                        type="xsd:integer" />
           <xsd:element name="name"
                        type="xsd:string"
                        minOccurs="0"
                        maxOccurs="1" />
         </xsd:sequence>
       </xsd:choice>
       <xsd:attribute name="ident"
                      type="xsd:string"
                      default="0" />
       <xsd:attribute name="type"
                      type="idmef:id-type"
                      default="original-user" />
       <xsd:attribute name="tty"
                      type="xsd:string" />
     </xsd:complexType>

     <!-- Section 8: Simple elements with sub-elements or attributes
          of a special nature. -->

     <xsd:complexType name="Action">
       <xsd:simpleContent>
         <xsd:extension base="xsd:string" >
           <xsd:attribute name="category"
                          type="idmef:action-category"
                          default="other" />
         </xsd:extension>
       </xsd:simpleContent>
     </xsd:complexType>

     <xsd:complexType name="Confidence">
       <xsd:simpleContent>
         <xsd:extension base="xsd:string" >
           <xsd:attribute name="rating"
                          type="idmef:confidence-rating"
                          use="required" />
         </xsd:extension>
       </xsd:simpleContent>
     </xsd:complexType>

     <xsd:complexType name="TimeWithNtpstamp">
       <xsd:simpleContent>
         <xsd:extension base="xsd:dateTime">

           <xsd:attribute name="ntpstamp"
                          type="idmef:ntpstamp"
                          use="required"/>
         </xsd:extension>
       </xsd:simpleContent>
     </xsd:complexType>

     <xsd:complexType name="Impact">
       <xsd:simpleContent>
         <xsd:extension base="xsd:string" >
           <xsd:attribute name="severity"
                          type="idmef:impact-severity" />
           <xsd:attribute name="completion"
                          type="idmef:impact-completion" />
           <xsd:attribute name="type" type="idmef:impact-type"
                          default="other" />
         </xsd:extension>
       </xsd:simpleContent>
     </xsd:complexType>

     <xsd:complexType name="Alertident">
       <xsd:simpleContent>
         <xsd:extension base="xsd:string" >
           <xsd:attribute name="analyzerid"
                          type="xsd:string" />
         </xsd:extension>
       </xsd:simpleContent>
     </xsd:complexType>

     <xsd:complexType name="xmltext">
       <xsd:complexContent mixed="true">
         <xsd:restriction base="xsd:anyType">
           <xsd:sequence>
             <xsd:any namespace="##other"
                      processContents="lax"
                      minOccurs="0"
                      maxOccurs="unbounded" />
           </xsd:sequence>
         </xsd:restriction>
       </xsd:complexContent>
     </xsd:complexType>

   </xsd:schema>
```

---
# **Authors' Addresses**

```text
   Herve Debar
   France Telecom R & D
   42 Rue des Coutures
   Caen  14000
   FR

   Phone: +33 2 31 75 92 61
   EMail: herve.debar@orange-ftgroup.com
   URI:   http://www.francetelecom.fr/
```

David A. Curry Guardian Life Insurance Company of America 7 Hanover Square, 24th Floor New York, NY 10004 US

```text
   Phone: +1 212 919-3086
   EMail: david_a_curry@glic.com
   URI:   http://www.glic.com/

   Benjamin S. Feinstein
   SecureWorks, Inc.
   PO Box 95007
   Atlanta, GA 30347
   US

   Phone: +1 404 327-6339
   Email: bfeinstein@acm.org
   URI:   http://www.secureworks.com/
```

---
# **Full Copyright Statement**

저작권\(C\) IETF 트러스트\(2007\).

이 문서는 BCP 78에 포함된 권리, 라이선스 및 제한 사항의 적용을 받으며 여기에 명시된 경우를 제외하고 작성자는 모든 권리를 보유합니다.

이 문서 및 여기에 포함된 정보는 "있는 그대로" 제공되며 기여자, 기여자가 대표하거나 후원하는 조직\(있는 경우\), 인터넷 협회, IETF 트러스트 및 인터넷 엔지니어링 태스크포스는 모든 내용을 부인합니다. 여기에 포함된 정보의 사용이 특정 목적에 대한 상품성 또는 적합성에 대한 권리 또는 묵시적 보증을 침해하지 않는다는 보증을 포함하되 이에 국한되지 않는 명시적 또는 묵시적 보증.

---
# **Intellectual Property**

IETF는 이 문서에 설명된 기술의 구현 또는 사용과 관련이 있다고 주장할 수 있는 지적 재산권 또는 기타 권리의 유효성 또는 범위 또는 그러한 권리에 따른 라이센스의 범위에 대해 어떠한 입장도 취하지 않습니다. 는 가능하다; 또한 그러한 권리를 식별하기 위해 독립적인 노력을 기울였다는 것을 나타내지 않습니다. RFC 문서의 권리와 관련된 절차에 대한 정보는 BCP 78 및 BCP 79에서 찾을 수 있습니다.

IETF 사무국에 제출된 IPR 공개 사본 및 사용 가능한 라이선스에 대한 보증 또는 이 사양의 구현자 또는 사용자가 이러한 독점권 사용에 대한 일반 라이선스 또는 허가를 얻으려는 시도의 결과를 얻을 수 있습니다. http://www.ietf.org/ipr의 IETF 온라인 IPR 저장소에서.

IETF는 이 표준을 구현하는 데 필요할 수 있는 기술을 포함할 수 있는 저작권, 특허 또는 특허 출원 또는 기타 소유권에 관심을 갖도록 이해 당사자를 초대합니다. 정보를 IETF\(ietf-ipr@ietf.org\)로 보내주십시오.

---
# **Acknowledgement**

RFC 편집기 기능에 대한 자금은 현재 Internet Society에서 제공하고 있습니다.