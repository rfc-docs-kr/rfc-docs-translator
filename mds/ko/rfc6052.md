

```text
Internet Engineering Task Force (IETF)                            C. Bao
Request for Comments: 6052             CERNET Center/Tsinghua University
Updates: 4291                                                 C. Huitema
Category: Standards Track                          Microsoft Corporation
ISSN: 2070-1721                                               M. Bagnulo
                                                                    UC3M
                                                            M. Boucadair
                                                          France Telecom
                                                                   X. Li
                                       CERNET Center/Tsinghua University
                                                            October 2010

                IPv6 Addressing of IPv4/IPv6 Translators
```

---
# **Abstract**

이 문서에서는 정적으로 구성된 정보만 사용하여 IPv6 주소를 해당 IPv4 주소로 또는 그 반대로 변환하는 알고리즘을 설명합니다. 이는 알고리즘 변환에 사용할 잘 알려진 접두사를 정의하는 동시에 조직이 적절한 경우 네트워크별 접두사도 사용할 수 있도록 허용합니다. 알고리즘 변환은 IPv4/IPv6 변환기뿐만 아니라 IPv4/IPv6 시나리오에서 사용되는 다른 유형의 프록시 및 게이트웨이\(예: DNS용\)에도 사용됩니다.

---
# **Status of This Memo**

이것은 인터넷 표준 추적 문서입니다.

이 문서는 IETF\(Internet Engineering Task Force\)의 산물입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 게시 승인을 받았습니다. 인터넷 표준에 대한 추가 정보는 RFC 5741의 섹션 2에서 확인할 수 있습니다.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 http://www.rfc-editor.org/info/rfc6052에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2010 IETF Trust 및 문서 작성자로 식별된 사람. 판권 소유.

이 문서는 이 문서 발행일에 유효한 BCP 78 및 IETF 문서와 관련된 IETF Trust의 법적 조항\(http://trustee.ietf.org/license-info\)의 적용을 받습니다. 이 문서에 관한 귀하의 권리와 제한 사항이 설명되어 있으므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출된 코드 구성 요소는 신뢰 법률 조항의 섹션 4.e에 설명된 대로 단순화된 BSD 라이센스 텍스트를 포함해야 하며 단순화된 BSD 라이센스에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1.  Applicability Scope  . . . . . . . . . . . . . . . . . . .  3
     1.2.  Conventions  . . . . . . . . . . . . . . . . . . . . . . .  4
     1.3.  Terminology  . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  IPv4-Embedded IPv6 Address Prefix and Format . . . . . . . . .  5
     2.1.  Well-Known Prefix  . . . . . . . . . . . . . . . . . . . .  5
     2.2.  IPv4-Embedded IPv6 Address Format  . . . . . . . . . . . .  5
     2.3.  Address Translation Algorithms . . . . . . . . . . . . . .  7
     2.4.  Text Representation  . . . . . . . . . . . . . . . . . . .  7
   3.  Deployment Guidelines  . . . . . . . . . . . . . . . . . . . .  8
     3.1.  Restrictions on the Use of the Well-Known Prefix . . . . .  8
     3.2.  Impact on Inter-Domain Routing . . . . . . . . . . . . . .  8
     3.3.  Choice of Prefix for Stateless Translation Deployments . .  9
     3.4.  Choice of Prefix for Stateful Translation Deployments  . . 11
   4.  Design Choices . . . . . . . . . . . . . . . . . . . . . . . . 12
     4.1.  Choice of Suffix . . . . . . . . . . . . . . . . . . . . . 12
     4.2.  Choice of the Well-Known Prefix  . . . . . . . . . . . . . 13
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . . 14
     5.1.  Protection against Spoofing  . . . . . . . . . . . . . . . 14
     5.2.  Secure Configuration . . . . . . . . . . . . . . . . . . . 15
     5.3.  Firewall Configuration . . . . . . . . . . . . . . . . . . 15
   6.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 15
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 16
   8.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . . 16
   9.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 17
     9.1.  Normative References . . . . . . . . . . . . . . . . . . . 17
     9.2.  Informative References . . . . . . . . . . . . . . . . . . 17
```

---
## **1.  Introduction**

이 문서는 IPv4/IPv6 번역 문서 시리즈의 일부입니다. IPv4/IPv6 변환을 위한 프레임워크는 이 문서에서 사용될 시나리오 분류를 포함하여 \[v4v6-FRAMEWORK\]에서 논의됩니다. 다른 문서에서는 IP 헤더와 IP 주소를 포함하는 다른 유형의 메시지 간 변환을 위한 메커니즘을 포함하여 다양한 유형의 변환기 및 게이트웨이의 동작을 지정합니다. 이 문서에서는 알고리즘 매핑이 사용되는 경우 개별 IPv6 주소가 해당 IPv4 주소로 변환되거나 그 반대로 변환되는 방법을 지정합니다. 여기에서는 특정 유형의 장치가 예로 사용되었지만 주소 자체의 알고리즘 매핑을 위해 이 문서를 참조하는 것은 해당 장치 사양의 책임입니다.

섹션 2에서는 "IPv4 내장 IPv6 주소", 즉 32비트에 IPv4 주소가 포함된 IPv6 주소의 접두사와 형식에 대해 설명합니다. 이 형식은 "IPv4 변환" 및 "IPv4 변환 가능" IPv6 주소 모두에 공통됩니다. 이 섹션에서는 주소 변환을 위한 알고리즘과 IPv4 내장 IPv6 주소의 텍스트 표현도 정의합니다.

섹션 3에서는 접두사의 선택, 접두사가 사용될 수 있는 조건, 상태 비저장 및 상태 저장 변환이 포함된 IPv4 내장 IPv6 주소의 사용에 대해 논의합니다.

섹션 4에서는 두 가지 특정 설계 결정, 즉 null 접미사의 선택과 선택한 접두사의 특정 값에 대한 논의를 요약합니다.

```text
   Section 5 discusses security concerns.
```

일부 시나리오에서는 듀얼 스택 호스트가 불필요하게 IPv6/IPv4 변환기를 통해 트래픽을 전송합니다. 이는 호스트의 기본 주소 선택 알고리즘 \[RFC3484\], 참조 또는 기타 이유로 인해 발생할 수 있습니다. 듀얼 스택 호스트에 대해 이러한 시나리오를 최적화하는 것은 향후 연구를 위한 것입니다.

---
### **1.1.  Applicability Scope**

이 문서는 주소 변환 서비스를 정의하는 시리즈의 일부입니다. 우리는 주소 형식이 IPv6와 IPv4 간의 다른 상호 연결 방법\(예: 캡슐화 기반 방법\)에서도 사용될 수 있다는 것을 알고 있습니다. IETF에서 캡슐화 방법을 개발하는 경우 해당 설명에 IPv4 내장 IPv6 주소의 특정 사용이 문서화될 것으로 예상됩니다.

---
### **1.2.  Conventions**

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119 \[RFC2119\]에 설명된 대로 해석됩니다.

---
### **1.3.  Terminology**

이 문서에서는 다음 용어를 사용합니다.

주소 변환기: IPv6 주소에서 IPv4 주소를 파생해야 하거나 그 반대로 파생되어야 하는 모든 엔터티입니다. 이는 IPv4/IPv6 패킷 변환을 수행하는 장치뿐만 아니라 이름 확인 프록시\(예: DNS64 \[DNS64\]\) 및 기타 유형의 애플리케이션 계층 게이트웨이\(ALG\)와 같이 주소를 조작하는 다른 엔터티에도 적용됩니다.

IPv4 변환 IPv6 주소: IPv6 네트워크에서 IPv4 노드를 나타내는 데 사용되는 IPv6 주소입니다. 이는 IPv4 내장 IPv6 주소의 변형이며 섹션 2.2에 설명된 형식을 따릅니다.

IPv4 내장 IPv6 주소: 32비트에 IPv4 주소가 포함된 IPv6 주소입니다. 해당 형식은 섹션 2.2에 설명되어 있습니다.

IPv4/IPv6 변환기: IPv4 패킷을 IPv6 패킷으로 또는 그 반대로 변환하는 엔터티입니다. 이는 흐름별 상태가 필요하지 않음을 의미하는 "상태 비저장" 변환을 수행하거나 흐름의 첫 번째 패킷이 수신될 때 흐름별 상태가 생성됨을 의미하는 "상태 저장" 변환을 수행할 수 있습니다.

IPv4 변환 가능 IPv6 주소: 상태 비저장 변환에 사용하기 위해 IPv6 노드에 할당된 IPv6 주소입니다. 이는 IPv4 내장 IPv6 주소의 변형이며 섹션 2.2에 설명된 형식을 따릅니다.

네트워크별 접두사: 알고리즘 매핑에 사용하기 위해 조직에서 할당한 IPv6 접두사입니다. 네트워크별 접두사에 대한 옵션은 섹션 3.3 및 3.4에서 설명됩니다.

잘 알려진 접두사: 알고리즘 매핑에 사용하기 위해 이 문서에 정의된 IPv6 접두사입니다.

---
## **2.  IPv4-Embedded IPv6 Address Prefix and Format**
---
### **2.1.  Well-Known Prefix**

이 문서에서는 알고리즘 매핑에 사용하기 위해 "잘 알려진 접두사"를 예약합니다. 이 IPv6 접두사의 값은 다음과 같습니다.

```text
      64:ff9b::/96
```

---
### **2.2.  IPv4-Embedded IPv6 Address Format**

IPv4 변환 IPv6 주소와 IPv4 변환 가능 IPv6 주소는 동일한 형식을 따르며, 여기에서는 IPv4 내장 IPv6 주소 형식으로 설명됩니다. IPv4 내장 IPv6 주소는 다음 다이어그램과 같이 가변 길이 접두사, 내장 IPv4 주소 및 가변 길이 접미사로 구성됩니다. 여기서 PL은 접두사 길이를 지정합니다.

```text
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |PL| 0-------------32--40--48--56--64--72--80--88--96--104---------|
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |32|     prefix    |v4(32)         | u | suffix                    |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |40|     prefix        |v4(24)     | u |(8)| suffix                |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |48|     prefix            |v4(16) | u | (16)  | suffix            |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |56|     prefix                |(8)| u |  v4(24)   | suffix        |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |64|     prefix                    | u |   v4(32)      | suffix    |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+
    |96|     prefix                                    |    v4(32)     |
    +--+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+

                                 Figure 1
```

이러한 주소에서 접두사는 주소 변환기를 배포하는 조직에 고유한 "잘 알려진 접두사" 또는 "네트워크별 접두사"입니다. 접두사는 32, 40, 48, 56, 64 또는 96 길이 중 하나만 가질 수 있습니다. \(Well-Known 접두사는 길이가 96비트이며 테이블의 마지막 형식에서만 사용할 수 있습니다.\)

다양한 배포에서는 네트워크별 접두사를 사용하여 다양한 접두사 길이를 정당화합니다. 서로 다른 접두사 길이 간의 균형은 섹션 3.3과 3.4에서 논의됩니다.

주소의 비트 64\~71은 IPv6 주소 지정 아키텍처\[RFC4291\]에 정의된 호스트 식별자 형식과의 호환성을 위해 예약되어 있습니다. 이 비트는 0으로 설정되어야 합니다. /96 네트워크별 접두사를 사용할 때 관리자는 비트 64\~71이 0으로 설정되어 있는지 확인해야 합니다. 이를 달성하는 간단한 방법은 /64 접두사를 선택한 다음 0으로 설정된 4옥텟을 추가하여 /96 네트워크별 접두사를 구성하는 것입니다.

IPv4 주소는 접두사 다음에 가장 중요한 비트가 먼저 인코딩됩니다. 접두사 길이에 따라 주소의 4옥텟은 예약된 옥텟 "u"로 구분될 수 있으며, 이 u의 8비트는 0으로 설정되어야 합니다. 특히:

- 접두사의 길이가 32비트인 경우 IPv4 주소는 32\~63번째 위치에 인코딩됩니다.

- 접두어 길이가 40비트인 경우 IPv4 주소의 24비트는 위치 40\~63에 인코딩되고 나머지 8비트는 위치 72\~79에 인코딩됩니다.

- 접두어 길이가 48비트인 경우 IPv4 주소의 16비트는 위치 48\~63에 인코딩되고 나머지 16비트는 위치 72\~87에 인코딩됩니다.

- 접두어 길이가 56비트인 경우 IPv4 주소의 8비트는 위치 56\~63에 인코딩되고 나머지 24비트는 위치 72\~95에 인코딩됩니다.

- 접두사의 길이가 64비트인 경우 IPv4 주소는 72\~103번째 위치에 인코딩됩니다.

- 접두사의 길이가 96비트인 경우 IPv4 주소는 96\~127번째 위치에 인코딩됩니다.

접두사가 96비트 길이인 경우 남은 비트가 없으므로 접미사가 없습니다. 다른 경우에는 주소의 나머지 비트가 접미사를 구성합니다. 이 비트는 향후 확장을 위해 예약되어 있으며 0으로 설정되어야 합니다. 이러한 비트가 0이 아닌 IPv4 내장 IPv6 주소를 수신하는 주소 변환기는 비트 값을 무시하고 비트 값이 0인 것처럼 진행해야 합니다. \(향후 확장에서는 다른 동작을 지정할 수 있습니다.\)

---
### **2.3.  Address Translation Algorithms**

IPv4 내장 IPv6 주소는 다음 알고리즘에 따라 구성됩니다.

- IPv4 주소의 접두사, 32비트 및 접미사\(필요한 경우\)를 연결하여 128비트 주소를 얻습니다.

- 접두사 길이가 96비트보다 작은 경우 그림 1에 설명된 대로 널 옥텟 "u"를 적절한 위치\(비트 64\~71\)에 삽입하여 최하위 옥텟이 제외되도록 합니다.

IPv4 주소는 다음 알고리즘에 따라 IPv4 내장 IPv6 주소에서 추출됩니다.

- 접두어 길이가 96비트인 경우 IPv6 주소의 마지막 32비트를 추출합니다.

- 다른 접두사 길이의 경우 "u" 옥텟을 제거하여 120비트 시퀀스를 얻은 다음\(비트 72-127을 위치 64-119로 효과적으로 이동\) 그런 다음 접두사 뒤의 32비트를 추출합니다.

---
### **2.4.  Text Representation**

IPv4 내장 IPv6 주소는 \[RFC4291\]의 섹션 2.2에 따라 텍스트로 표시됩니다. Well-Known Prefix 또는 /96 Network-Specific Prefix를 사용하여 구성된 IPv4 내장 IPv6 주소는 점으로 구분된 십진수 표기법으로 표시된 내장 IPv4 주소와 함께 \[RFC4291\]의 섹션 2.2에 제시된 대체 형식을 사용하여 표현될 수 있습니다. 이러한 표현의 예가 표 1과 2에 나와 있습니다.

```text
   +-----------------------+------------+------------------------------+
   | Network-Specific      |    IPv4    | IPv4-embedded IPv6 address   |
   | Prefix                |   address  |                              |
   +-----------------------+------------+------------------------------+
   | 2001:db8::/32         | 192.0.2.33 | 2001:db8:c000:221::          |
   | 2001:db8:100::/40     | 192.0.2.33 | 2001:db8:1c0:2:21::          |
   | 2001:db8:122::/48     | 192.0.2.33 | 2001:db8:122:c000:2:2100::   |
   | 2001:db8:122:300::/56 | 192.0.2.33 | 2001:db8:122:3c0:0:221::     |
   | 2001:db8:122:344::/64 | 192.0.2.33 | 2001:db8:122:344:c0:2:2100:: |
   | 2001:db8:122:344::/96 | 192.0.2.33 | 2001:db8:122:344::192.0.2.33 |
   +-----------------------+------------+------------------------------+

    Table 1: Text Representation of IPv4-Embedded IPv6 Addresses Using
                         Network-Specific Prefixes

     +-------------------+--------------+----------------------------+
     | Well-Known Prefix | IPv4 address | IPv4-Embedded IPv6 address |
     +-------------------+--------------+----------------------------+
     | 64:ff9b::/96      |  192.0.2.33  | 64:ff9b::192.0.2.33        |
     +-------------------+--------------+----------------------------+

    Table 2: Text Representation of IPv4-Embedded IPv6 Addresses Using
                           the Well-Known Prefix
```

표 1의 네트워크별 접두사 예는 \[RFC3849\]의 문서용으로 예약된 IPv6 접두사에서 파생되었습니다. IPv4 주소 192.0.2.33은 \[RFC5735\]의 문서용으로 예약된 서브넷 192.0.2.0/24의 일부입니다. IPv6 주소 표현은 \[RFC5952\]와 호환됩니다.

---
## **3.  Deployment Guidelines**
---
### **3.1.  Restrictions on the Use of the Well-Known Prefix**

잘 알려진 접두사는 \[RFC1918\]에 정의되거나 \[RFC5735\]의 섹션 3에 나열된 것과 같은 비전역 IPv4 주소를 나타내는 데 사용되어서는 안 됩니다. 주소 변환기는 주소가 Well-Known Prefix와 비전역 IPv4 주소로 구성된 패킷을 변환해서는 안 됩니다. 그들은 이 패킷을 삭제해야 합니다.

잘 알려진 접두사는 IPv4로 변환 가능한 IPv6 주소를 구성하는 데 사용되어서는 안 됩니다. IPv4 변환 가능 IPv6 주소로 제공되는 노드는 중간 프로토콜 변환 없이 IPv4 변환 가능 IPv6 주소에 바인딩된 글로벌 IPv6 트래픽을 수신할 수 있어야 합니다. 이는 IPv4 변환 가능 IPv6 주소를 구축하는 데 사용된 특정 접두사가 도메인 간 라우팅에서 광고되는 경우에만 가능하지만 섹션 3.2에 설명된 대로 잘 알려진 접두사에서 파생된 보다 구체적인 접두사의 광고는 지원되지 않습니다. 섹션 3.3에 설명된 대로 이러한 시나리오에서는 네트워크별 접두사를 사용해야 합니다.

잘 알려진 접두사는 섹션 3.4에 설명된 대로 번역 서비스를 배포하는 조직에서 사용할 수 있습니다.

---
### **3.2.  Impact on Inter-Domain Routing**

서비스 공급자가 피어에게 IPv6-IPv4 상호 연결 서비스를 제공하기로 결정한 경우 Well-Known Prefix가 도메인 간 라우팅 테이블에 나타날 수 있습니다. 잘 알려진 접두사 광고는 도메인 간 라우팅 정책에 따라 업스트림 및/또는 다운스트림 서비스 제공자에 의해 제어되어야 합니다.

BGP \[RFC4271\] 구성. 도메인 간 라우팅에서 Well-Known Prefix를 광고하는 조직은 IPv4/IPv6 변환 서비스를 제공할 수 있어야 합니다.

IPv4/IPv6 변환이 Well-Known Prefix에 의존하는 경우 Well-Known Prefix보다 긴 IPv4 내장 IPv6 접두사는 BGP\(특히 외부 BGP\)\[RFC4271\]에 광고되어서는 안 됩니다. 따라서 글로벌 IPv6 라우팅 테이블에 확장성 문제가 발생합니다. BGP 노드의 관리자는 잘 알려진 접두사보다 긴 내장 IPv6 접두사의 광고를 삭제하는 필터를 구성해야 합니다.

IPv4/IPv6 변환 서비스가 네트워크별 접두사에 의존하는 경우 상태 비저장 변환에 사용되는 IPv4 변환 가능 IPv6 접두사는 IPv6 인터넷에 적절한 집계와 함께 광고되어야 합니다. 마찬가지로 변환기가 여러 네트워크별 접두사로 구성된 경우 이러한 접두사는 적절한 집계를 통해 IPv6 인터넷에 알려야 합니다.

---
### **3.3.  Choice of Prefix for Stateless Translation Deployments**

조직은 상태 비저장 번역을 사용하여 번역 서비스를 배포할 수 있습니다. 이러한 배포에서 내부 IPv6 노드는 IPv4 변환 가능 IPv6 주소를 사용하여 주소가 지정되므로 IPv4 노드에서 해당 노드에 액세스할 수 있습니다. 그러면 이러한 외부 IPv4 노드의 주소가 IPv4로 변환된 IPv6 주소로 표시됩니다.

상태 비저장 IPv4/IPv6 변환을 배포하는 조직은 IPv4/IPv6 변환 서비스에 네트워크별 접두사를 할당해야 합니다. IPv4 변환 가능 및 IPv4 변환 IPv6 주소는 섹션 2.2에 지정된 대로 구성되어야 합니다. IPv4 변환 가능 IPv6 주소는 선택된 네트워크별 접두사를 사용해야 합니다. IPv4로 변환 가능한 IPv6 주소와 IPv4로 변환된 IPv6 주소는 모두 동일한 접두사를 사용해야 합니다.

동일한 접두사를 사용하면 조직 내부의 IPv6 노드가 가장 효율적인 경로를 사용하여 IPv4 변환 가능 IPv6 주소가 제공하는 노드에 도달하게 됩니다. 특히, 노드가 대상 내부 노드가 실제로 노드가 사용하는 동일한 변환기 뒤에 있다는 사실을 모르고 대상 내부 노드의 IPv4 주소를 학습하는 경우 변환 규칙은 네트워크별 접두사로 구성된 IPv6 주소가 대상에 할당된 IPv4 변환 가능 IPv6 주소와 동일합니다. 그러면 표준 라우팅 기본 설정\(즉, "가장 구체적인 일치 항목 승리"\)은 변환기가 패킷을 수신한 다음 패킷이 온 방향으로 반환하도록 요구하지 않고 IPv6 패킷이 직접 전달되도록 보장합니다.

도메인 내 라우팅 프로토콜은 IPv4 변환 가능 IPv6 주소가 제공되는 노드에 패킷을 전달할 수 있어야 합니다. 이를 위해서는 내장된 IPv4 주소 비트 중 일부 또는 전체에 대한 라우팅이 필요할 수 있습니다. 섹션 5에 자세히 설명된 보안 고려 사항에서는 라우터가 역방향 경로 확인 형식을 사용하여 IPv4로 변환 가능한 IPv6 소스 주소의 유효성을 확인해야 합니다.

상태 비저장 주소 변환 관리는 작은 예를 통해 설명할 수 있습니다.

- 접두사가 2001:db8:122::/48인 IPv6 네트워크를 고려해 보겠습니다. 네트워크 관리자는 상태 비저장 IPv4/IPv6 변환을 관리하기 위해 네트워크별 접두사 2001:db8:122:344::/64를 선택했습니다. IPv4 서브넷 192.0.2.0/24에 대한 IPv4 변환 가능 주소 블록은 2001:db8:122:344:c0:2::/96입니다. 이 네트워크에서 호스트 A에는 IPv4 주소 192.0.2.33에 해당하는 IPv4 변환 가능 IPv6 주소 2001:db8:122:344:c0:2:2100::이 할당됩니다. 호스트 A의 주소는 수동으로 또는 DHCPv6을 통해 구성됩니다.

- 이 예에서 호스트 A는 변환기에 직접 연결되지 않고 대신 라우터 R에 의해 관리되는 링크에 연결됩니다. 라우터 R은 2001: db8:122:344:c0:2에 바인딩된 패킷을 A에 전달하도록 구성됩니다. :2100::. 이러한 패킷을 수신하기 위해 R은 도메인 내 라우팅 프로토콜에서 접두사 2001:db8:122:344:c0:2:2100::/ 104의 연결 가능성을 광고합니다. 또는 링크의 많은 호스트에 IPv4가 있는 경우 더 짧은 접두사일 수도 있습니다. -동일한 IPv4 서브넷에서 파생된 변환 가능한 IPv6 주소. 192.0.2.33에 바인딩된 패킷이 변환기에 도달하면 대상 주소는 2001:db8:122:344:c0:2:2100::으로 변환되고 패킷은 R을 거쳐 A로 라우팅됩니다.

- 이제 동일한 도메인의 호스트 B가 아마도 애플리케이션별 추천을 통해 A의 IPv4 주소를 학습한다고 가정해 보겠습니다. B에게 변환 인식 소프트웨어가 있는 경우 B는 네트워크별 접두사 2001:db8:122:344::/64와 IPv4 주소 192.0.2.33을 결합하여 대상 주소를 구성하여 주소 2001:db8:122:를 생성할 수 있습니다. 344:c0:2:2100::. B가 보낸 패킷은 프로토콜 변환을 피하면서 R을 향해 전달된 다음 A로 전달됩니다.

전달 및 역방향 경로 확인은 접두사와 IPv4 주소의 조합에서 수행될 때 더 효율적입니다. 이론적으로 라우터는 모든 길이의 접두사를 통해 라우팅할 수 있지만 실제로는 64비트보다 큰 접두사에 대한 라우팅이 더 느린 라우터가 있을 수 있습니다. 그러나 접두사 길이를 선택할 때 라우팅 효율성이 유일한 고려 사항은 아닙니다. 조직은 또한 접두사의 가용성과 모두 0인 식별자의 잠재적 영향을 고려해야 합니다.

/32 접두사가 사용되는 경우 모든 라우팅 비트가 IPv6 주소의 상위 64비트에 포함되어 뛰어난 라우팅 속성을 제공합니다. 그러나 이러한 접두사는 얻기 어려울 수 있으며 IPv4로 변환 가능한 IPv6 주소의 작은 집합에 /32를 할당하는 것은 낭비적인 것으로 보일 수 있습니다. 또한 /32 접두사와 0 접미사는 모두 0인 인터페이스 식별자로 이어지며, 이는 섹션 4.1에서 논의하는 문제입니다.

/40, /48 또는 /56과 같은 중간 접두사 길이는 절충안으로 나타납니다. IPv4 비트 중 일부만 /64 접두사의 일부입니다. 특히 역방향 경로 검사는 효율성이 제한될 수 있습니다. IPv4 주소의 가장 중요한 비트로 제한된 역방향 경로 검사는 외부 IPv4 주소를 스푸핑할 가능성을 줄이지만 IPv6 노드가 내부 IPv4로 변환 가능한 IPv6 주소를 스푸핑하도록 허용합니다.

우리는 IPv4/IPv6 변환 서비스에 대한 조직의 IPv6 주소 할당량 중 1/256 이하를 사용하는 것을 기준으로 절충안을 제안합니다. 예를 들어 조직이 IPv6 접두사 /32 이하가 할당된 인터넷 서비스 제공업체인 경우 ISP는 /40 접두사를 변환 서비스 전용으로 지정할 수 있습니다. /48 할당이 있는 최종 사이트는 /56 접두사를 변환 서비스 전용으로 지정할 수 있으며, 모든 IPv4 변환 가능 IPv6 주소가 동일한 링크에 있는 경우 /96 접두사를 지정할 수도 있습니다.

권장되는 접두사 길이는 배포 시나리오에 따라 달라집니다. Stateless 변환은 \[v4v6-FRAMEWORK\]에 정의된 시나리오 1, 시나리오 2, 시나리오 5, 시나리오 6에 사용할 수 있습니다. 다양한 시나리오의 경우 접두사 길이 권장 사항은 다음과 같습니다.

- 시나리오 1\(IPv4 인터넷에 대한 IPv6 네트워크\) 및 시나리오 2\(IPv6 네트워크에 대한 IPv4 인터넷\)의 경우 /32 할당을 보유한 ISP는 /40 접두사를 사용해야 하며 /48 할당을 보유한 사이트는 /48 할당을 사용해야 합니다. /56 접두사.

- 시나리오 5\(IPv6 네트워크에서 IPv4 네트워크로\) 및 시나리오 6\(IPv4 네트워크에서 IPv6 네트워크로\)의 경우 배포 시 /64 또는 /96 접두사를 사용해야 합니다.

---
### **3.4.  Choice of Prefix for Stateful Translation Deployments**

조직은 상태 저장 번역 기술을 기반으로 번역 서비스를 배포할 수 있습니다. 조직은 상태 저장 IPv4/IPv6 변환 서비스에 대해 네트워크별 접두사 또는 잘 알려진 접두사를 사용하기로 결정할 수 있습니다.

이러한 서비스를 사용하는 경우 IPv6 노드는 표준 IPv6 주소를 통해 주소가 지정되는 반면 IPv4 노드는 섹션 2.2에 지정된 대로 IPv4로 변환된 IPv6 주소로 표시됩니다.

번역의 상태 저장 특성으로 인해 조직에서 여러 번역자를 배포할 때 잠재적인 안정성 문제가 발생합니다. 여러 변환기가 동일한 접두사를 사용하는 경우 내부 라우팅 상태가 변경됨에 따라 동일한 연결에 속한 패킷이 다른 변환기로 라우팅될 위험이 있습니다. 이 문제는 서로 다른 변환기에 서로 다른 접두사를 할당하거나 동일한 접두사를 사용하는 모든 변환기가 해당 상태를 조정하도록 하면 방지할 수 있습니다.

상태 저장 변환은 \[v4v6-FRAMEWORK\]에 정의된 시나리오에서 사용할 수 있습니다. 잘 알려진 접두사는 다음 두 가지 예외를 제외하고 이러한 시나리오에서 사용해야 합니다.

- 관리상의 이유로 적절하다고 판단되는 경우 모든 시나리오에서 번역은 네트워크별 접두사를 사용할 수 있습니다.

- Well-Known Prefix는 시나리오 3\(IPv6 인터넷에서 IPv4 네트워크로\)에 사용되어서는 안 됩니다. 이렇게 하면 비전역 IPv4 주소에 Well-Known Prefix를 사용하게 되기 때문입니다. 이는 해당 시나리오에서 네트워크별 접두사\(예: /96 접두사\)를 사용해야 함을 의미합니다.

---
## **4.  Design Choices**

우리가 선택한 접두사는 두 가지 디자인 선택, 즉 null 접미사와 Well-Known 접두사의 특정 값을 반영합니다. 우리는 이 두 가지 선택으로 이어지는 논의를 요약하여 여기에 제공합니다.

---
### **4.1.  Choice of Suffix**

섹션 2.2에 설명된 주소 형식에서는 접미사 0을 권장합니다. 이 권장 사항을 제시하기 전에 체크섬 중립성, 포트 범위 인코딩, 0과 다른 값 등 다양한 옵션을 고려했습니다.

상태 비저장 변환의 경우 IPv4 변환 가능 주소와 IPv4 변환 IPv6 주소가 모두 "체크섬 중립" 방식으로 구성된 경우 변환기가 1의 보수 체크섬을 다시 계산할 필요가 없습니다. IPv6 주소는 내장된 IPv4 주소와 동일한 1의 보수 체크섬을 갖습니다. 상태 기반 변환의 경우 체크섬 중립성은 두 주소 중 하나만 체크섬 중립이므로 변환 중 체크섬 계산을 제거하지 않습니다. 체크섬 중립성을 보장하기 위해 접미사에 16비트를 예약하는 것을 고려했지만 거부했습니다.

이는 상태 저장 변환에 도움이 되지 않으며 네트워크별 접두사를 적절하게 선택하여\(즉, 보완 체크섬이 0 또는 0xffff인 접두사를 선택하여\) 체크섬 중립성을 달성할 수도 있기 때문입니다.

포트 범위 기능으로 상태 비저장 변환을 보완하는 제안이 있었습니다. IPv4 주소를 정확히 하나의 IPv6 접두사에 매핑하는 대신 이 옵션을 사용하면 여러 IPv6 노드가 IPv4 주소를 공유할 수 있으며 각 노드는 서로 다른 포트 범위를 관리합니다. 포트 범위 확장이 필요한 경우 접미사에서 현재 null로 예약된 비트를 사용하여 나중에 정의할 수 있습니다.

/32 접두사가 사용되는 경우 모두 0인 접미사는 결과적으로 모두 0인 인터페이스 식별자가 됩니다. 우리는 서브넷 라우터 애니캐스트 주소에 모든 0이 사용되도록 지정하는 RFC4291의 섹션 2.6.1과의 충돌을 이해합니다. 그러나 우리 사양에는 /64 서브넷에 IPv4 변환 가능 IPv6 주소를 가진 노드가 하나만 있으므로 애니캐스트 의미 체계가 혼동을 일으키지 않습니다. 따라서 우리는 지금은 null 접미사를 유지하기로 결정했습니다. 이 문제는 섹션 3.3에서 권장하는 /40, /56, /64 및 /96 접두사와 같이 32비트보다 큰 접두사에는 발생하지 않습니다.

---
### **4.2.  Choice of the Well-Known Prefix**

잘 알려진 접두사를 추천하기 전에 우리는 세 가지 선택에 직면했습니다.

- RFC 2765, 섹션 2.1에 지정된 대로 IPv4 매핑 접두사 ::ffff:0:0/96을 재사용합니다.

- IANA에 /32 접두사 할당을 요청하거나

- 새로운 /96 접두사 할당을 요청합니다.

권장되는 /96 Well-Known 접두사를 결정하기 전에 이러한 선택의 장단점에 가중치를 두었습니다.

기존 IPv4 매핑 접두사의 주요 장점은 이미 정의되어 있다는 것입니다. 해당 접두사를 재사용하려면 최소한의 표준화 노력이 필요합니다. 그러나 이미 정의되어 있다는 것은 단지 장점만은 아닙니다. 현재 구현에는 부작용이 있을 수 있기 때문입니다. IPv4 매핑 접두사가 제공되면 현재 버전의 Windows 및 Mac OS는 IPv4 패킷을 생성하지만 IPv6 패킷을 보내지 않습니다. IPv4 매핑 접두사를 사용한 경우 이러한 노드는 수정 없이는 변환을 지원할 수 없습니다. 이는 번역 기술의 주요 목적을 무너뜨리게 됩니다. 따라서 우리는 첫 번째 선택을 제거했습니다. 즉, IPv4 매핑 접두사 ::ffff:0:0/96을 재사용하지 않기로 결정했습니다.

/32 접두어를 사용하면 내장된 IPv4 주소가 IPv6 주소의 상위 64비트 내에 들어갈 수 있습니다. 이는 조직이 여러 번역자를 배치할 때 라우팅 및 로드 밸런싱을 용이하게 했을 것입니다. 그러나 이러한 대상 주소 기반 로드 밸런싱은 바람직하지 않을 수 있습니다. 각각 서로 다른 IPv4 주소 풀을 갖는 여러 상태 저장 변환기가 포함된 배포에서는 STUN\(Session Traversal Utilities for NAT\) \[RFC5389\]과 호환되지 않습니다. STUN 호환성은 변환기가 동일한 IPv4 주소 풀을 관리하고 변환 상태를 조정할 수 있는 경우에만 달성됩니다. 이 경우 /96 접두사 대신 /32 접두사를 사용하는 데 큰 이점은 없습니다.

\[RFC4291\]의 섹션 2.2에 따르면 IPv6 주소의 법적 텍스트 표현에서 점으로 구분된 십진수는 끝에만 나타날 수 있습니다. /96 접두사는 해당 요구 사항과 호환됩니다. \[RFC4291\]을 업데이트하지 않고도 점으로 구분된 10진수 표기법을 사용할 수 있습니다. 이 표현을 사용하면 주소 형식을 더 쉽게 사용할 수 있고 로그 파일을 더 쉽게 읽을 수 있습니다.

우리가 권장하는 접두사는 "체크섬 중립"이라는 특징을 가지고 있습니다. 16진수 "0064"와 "ff9b"의 합은 "ffff", 즉 1의 보수 연산에서 0과 같은 값입니다. 이 접두사로 구성된 IPv4 내장 IPv6 주소는 내장 IPv4 주소와 동일한 보완 체크섬을 갖습니다.

---
## **5.  Security Considerations**
---
### **5.1.  Protection against Spoofing**

IPv4/IPv6 변환기는 특수 라우터로 모델링될 수 있고 동일한 위험에 노출되며 동일한 완화를 구현할 수 있습니다. \(라우터에 대한 일반적인 위협과 그 완화에 대한 논의는 이 문서의 범위를 벗어납니다.\) 그러나 IPv6에 IPv4 주소를 내장하는 관행에서 직접적으로 파생되는 특정 위험, 즉 주소 스푸핑이 있습니다.

공격자는 IPv4에 내장된 IPv6 주소를 악성 패킷의 소스 주소로 사용할 수 있습니다. 변환 후 패킷은 지정된 소스의 IPv4 패킷으로 나타나므로 공격자를 추적하기 어려울 수 있습니다. 완화하지 않고 그대로 두면 공격으로 인해 악의적인 IPv6 노드가 임의의 IPv4 주소를 스푸핑할 수 있습니다.

완화 방법은 역방향 경로 검사를 구현하고 패킷이 승인된 위치에서 오는지 네트워크 전체에서 확인하는 것입니다.

---
### **5.2.  Secure Configuration**

주소 변환에 사용되는 접두사는 IPv6 노드에서 IPv6/IPv4 변환기에 패킷을 보내는 데 사용됩니다. 공격자는 노드, DNS 게이트웨이 및 IPv4/IPv6 변환기를 속여 이러한 매개변수에 잘못된 값을 사용하도록 시도할 수 있으며, 이로 인해 네트워크 중단, 서비스 거부 및 정보 공개가 발생할 수 있습니다. 이러한 공격을 완화하려면 네트워크 관리자는 접두사가 안전한 방식으로 구성되었는지 확인해야 합니다.

접두사의 보안 구성을 달성하기 위한 메커니즘은 이 문서의 범위를 벗어납니다.

---
### **5.3.  Firewall Configuration**

많은 방화벽 및 기타 보안 장치는 IPv4 주소를 기반으로 트래픽을 필터링합니다. 공격자는 필터링된 IPv4 주소로 변환되는 IPv6 주소 간에 IPv6 패킷을 보내 이러한 방화벽을 속이려고 시도할 수 있습니다. 공격이 성공하면 기존에 차단됐던 트래픽이 IPv6 패킷으로 위장해 방화벽을 통과할 수도 있다. 이러한 모든 시나리오에서 관리자는 IPv4 내장 IPv6 주소로 전송되거나 내장된 IPv4 주소에서 직접 전송되는 패킷과 동일한 필터링이 적용되는지 확인해야 합니다.

이 필터링을 달성하기 위해 방화벽 및 보안 장치를 구성하는 메커니즘은 이 문서의 범위를 벗어납니다.

---
## **6.  IANA Considerations**

IANA는 http://www.iana.org에 있는 "인터넷 프로토콜 버전 6 주소 공간" 레지스트리를 다음과 같이 변경했습니다.

```text
   OLD:

      IPv6 Prefix Allocation       Reference    Note
      ----------- ---------------- ------------ ----------------
      0000::/8    Reserved by IETF [RFC4291]    [1][5]

   NEW:

      IPv6 Prefix Allocation       Reference    Note
      ----------- ---------------- ------------ ----------------
      0000::/8    Reserved by IETF [RFC4291]    [1][5][6]

      [6] The "Well-Known Prefix" 64:ff9b::/96 used in an algorithmic
          mapping between IPv4 to IPv6 addresses is defined out of the
          0000::/8 address block, per RFC 6052.
```

---
## **7.  Acknowledgements**

Andrew Sullivan, Andrew Yourtchenko, Ari Keranen, Brian Carpenter, Charlie Kaufman, Dan Wing, Dave Thaler, David Harrington, Ed Jankiewicz, Fred Baker, Hiroshi Miyata를 포함하여 BEHAVE WG의 많은 사람들이 이 문서를 작성한 토론에 기여했습니다. , Iljitsch van Beijnum, John Schnizlein, Keith Moore, Kevin Yin, Magnus Westerlund, Margaret Wasserman, Masahito Endo, Phil Roberts, Philip Matthews, Remi Denis-Courmont, Remi Despres 및 William Waites.

Marcelo Bagnulo는 일곱 번째 프레임워크 프로그램에 따라 유럽 위원회가 지원하는 연구 프로젝트인 Trilogy에서 부분적으로 자금을 지원받습니다.

---
## **8.  Contributors**

다음 개인은 텍스트가 포함된 공동 저작 문서를 작성했으며 알파벳 순서로 나열되어 있습니다.

```text
       Dave Thaler
       Microsoft Corporation
       One Microsoft Way
       Redmond, WA  98052
       USA
       Phone: +1 425 703 8835
       EMail: dthaler@microsoft.com

       Fred Baker
       Cisco Systems
       Santa Barbara, California  93117
       USA
       Phone: +1-408-526-4257
       Fax:   +1-413-473-2403
       EMail: fred@cisco.com

       Hiroshi Miyata
       Yokogawa Electric Corporation
       2-9-32 Nakacho
       Musashino-shi, Tokyo  180-8750
       JAPAN
       EMail: h.miyata@jp.yokogawa.com
```

---
## **9.  References**
---
### **9.1.  Normative References**

```text
   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, February 2006.
```

---
### **9.2.  Informative References**

```text
   [DNS64]    Bagnulo, M., Sullivan, A., Matthews, P., and I. Beijnum,
              "DNS64: DNS extensions for Network Address Translation
              from IPv6 Clients to IPv4 Servers", Work in Progress,
              October 2010.

   [RFC1918]  Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and
              E. Lear, "Address Allocation for Private Internets",
              BCP 5, RFC 1918, February 1996.

   [RFC3484]  Draves, R., "Default Address Selection for Internet
              Protocol version 6 (IPv6)", RFC 3484, February 2003.

   [RFC3849]  Huston, G., Lord, A., and P. Smith, "IPv6 Address Prefix
              Reserved for Documentation", RFC 3849, July 2004.

   [RFC4271]  Rekhter, Y., Li, T., and S. Hares, "A Border Gateway
              Protocol 4 (BGP-4)", RFC 4271, January 2006.

   [RFC5389]  Rosenberg, J., Mahy, R., Matthews, P., and D. Wing,
              "Session Traversal Utilities for NAT (STUN)", RFC 5389,
              October 2008.

   [RFC5735]  Cotton, M. and L. Vegoda, "Special Use IPv4 Addresses",
              BCP 153, RFC 5735, January 2010.

   [RFC5952]  Kawamura, S. and M. Kawashima, "A Recommendation for IPv6
              Address Text Representation", RFC 5952, August 2010.

   [v4v6-FRAMEWORK]
              Baker, F., Li, X., Bao, C., and K. Yin, "Framework for
              IPv4/IPv6 Translation", Work in Progress, August 2010.
```

---
# **Authors' Addresses**

```text
   Congxiao Bao
   CERNET Center/Tsinghua University
   Room 225, Main Building, Tsinghua University
   Beijing,   100084
   China
   Phone: +86 10-62785983
   EMail: congxiao@cernet.edu.cn

   Christian Huitema
   Microsoft Corporation
   One Microsoft Way
   Redmond, WA  98052-6399
   U.S.A.
   EMail: huitema@microsoft.com

   Marcelo Bagnulo
   UC3M
   Av. Universidad 30
   Leganes, Madrid  28911
   Spain
   Phone: +34-91-6249500
   EMail: marcelo@it.uc3m.es
   URI:   http://www.it.uc3m.es/marcelo

   Mohamed Boucadair
   France Telecom
   3, Av Francois Chateaux
   Rennes  350000
   France
   EMail: mohamed.boucadair@orange-ftgroup.com

   Xing Li
   CERNET Center/Tsinghua University
   Room 225, Main Building, Tsinghua University
   Beijing,   100084
   China
   Phone: +86 10-62785983
   EMail: xing@cernet.edu.cn
```