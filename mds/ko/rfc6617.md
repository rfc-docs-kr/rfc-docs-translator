

```text
Internet Engineering Task Force (IETF)                        D. Harkins
Request for Comments: 6617                                Aruba Networks
Category: Experimental                                         June 2012
ISSN: 2070-1721

               Secure Pre-Shared Key (PSK) Authentication
              for the Internet Key Exchange Protocol (IKE)
```

---
# **Abstract**

이 메모에서는 IKE\(인터넷 키 교환 프로토콜\)에 대한 안전한 PSK\(사전 공유 키\) 인증 방법을 설명합니다.  사전 공격에 강하고 취약한 사전 공유 키와 함께 사용하는 경우에도 보안을 유지합니다.

---
# **Status of This Memo**

이 문서는 인터넷 표준 트랙 사양이 아닙니다. 시험, 실험적 구현 및 평가를 위해 출판되었습니다.

이 문서는 인터넷 커뮤니티를 위한 실험 프로토콜을 정의합니다. 이 문서는 IETF\(Internet Engineering Task Force\)의 산물입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 게시 승인을 받았습니다. IESG가 승인한 모든 문서가 모든 수준의 인터넷 표준에 적합한 것은 아닙니다. RFC 5741의 섹션 2를 참조하세요.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 http://www.rfc-editor.org/info/rfc6617에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2012 IETF Trust 및 문서 작성자로 식별된 사람. 판권 소유.

이 문서는 이 문서 발행일에 유효한 BCP 78 및 IETF 문서와 관련된 IETF Trust의 법적 조항\(http://trustee.ietf.org/license-info\)의 적용을 받습니다. 이 문서에 관한 귀하의 권리와 제한 사항이 설명되어 있으므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출된 코드 구성 요소는 신뢰 법률 조항의 섹션 4.e에 설명된 대로 단순화된 BSD 라이센스 텍스트를 포함해야 하며 단순화된 BSD 라이센스에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1. Introduction ....................................................3
      1.1. Keyword Definitions ........................................3
   2. Usage Scenarios .................................................3
   3. Terms and Notation ..............................................4
   4. Discrete Logarithm Cryptography .................................5
      4.1. Elliptic Curve Cryptography (ECP) Groups ...................5
      4.2. Finite Field Cryptography (MODP) Groups ....................7
   5. Random Numbers ..................................................8
   6. Using Passwords and Raw Keys For Authentication .................8
   7. Assumptions .....................................................9
   8. Secure PSK Authentication Message Exchange ......................9
      8.1. Negotiation of Secure PSK Authentication ..................10
      8.2. Fixing the Secret Element, SKE ............................11
           8.2.1. ECP Operation to Select SKE ........................12
           8.2.2. MODP Operation to Select SKE .......................13
      8.3. Encoding and Decoding of Group Elements and Scalars .......14
           8.3.1. Encoding and Decoding of Scalars ...................14
           8.3.2. Encoding and Decoding of ECP Elements ..............15
           8.3.3. Encoding and Decoding of MODP Elements .............15
      8.4. Message Generation and Processing .........................16
           8.4.1. Generation of a Commit .............................16
           8.4.2. Processing of a Commit .............................16
                  8.4.2.1. Validation of an ECP Element ..............16
                  8.4.2.2. Validation of a MODP Element ..............16
                  8.4.2.3. Commit Processing Steps ...................17
           8.4.3. Authentication of the Exchange .....................17
      8.5. Payload Format ............................................18
           8.5.1. Commit Payload .....................................18
      8.6. IKEv2 Messaging ...........................................19
   9. IANA Considerations ............................................20
   10. Security Considerations .......................................20
   11. Acknowledgements ..............................................22
   12. References ....................................................22
      12.1. Normative References .....................................22
      12.2. Informative References ...................................23
```

---
## **1.  Introduction**

\[RFC5996\]은 사전 공유 키를 사용하여 IKE 피어의 인증을 허용합니다.  하지만 이 교환은 사전 공격에 취약하므로 사람이 기억할 수 있는 비밀번호와 같은 취약한 사전 공유 키와 함께 사용하면 안전하지 않습니다.  보안 문제를 해결하기 위해 \[RFC5996\]에서는 인증에 사용되는 사전 공유 키에 "협상되는 가장 강력한 키만큼 예측 불가능성을 포함"할 것을 권장합니다.  이는 16진수가 아닌 키가 AES에 적합한 128비트 키를 생성하는 데 충분한 강도를 제공하려면 100자 이상이 필요하다는 것을 의미합니다.  인간은 20자가 넘는 문자열을 오류 없이 입력하기 어렵기 때문에 이는 비현실적인 요구 사항입니다. 결과적으로 \[RFC5996\]의 사전 공유 키 인증은 오늘날 안전하지 않게 사용됩니다.

영지식 증명을 기반으로 구축된 사전 공유 키 인증 방법은 사전 공격에 대한 저항력을 제공하고 사용자가 선택한 비밀번호와 같은 취약한 사전 공유 키와 함께 사용될 때 여전히 보안을 허용합니다.  이러한 인증 방법은 이 메모에 설명되어 있습니다.

사전 공격에 대한 저항은 적이 활성 공격당 하나의 비밀을 추측할 때 달성됩니다\(예: \[BM92\], \[BMP00\] 및 \[BPR00\] 참조\).  이를 달리 표현하면, 적이 실현할 수 있는 모든 이점은 계산을 통해서가 아니라 상호 작용을 통해서라는 것입니다.  이는 사전 공유 키로 큰 난수를 사용하는 \[RFC5996\]의 기술과 명백히 다릅니다.  이는 사전 공격의 성공 가능성을 낮출 뿐입니다. 사전 공격을 방지하지는 않습니다. 또한 \[RFC5996\]에서 언급했듯이 사용자 생성 비밀번호와 같은 취약한 키와 함께 사용하면 완전히 안전하지 않습니다.

---
### **1.1.  Keyword Definitions**

이 문서의 핵심 단어 "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" 및 "OPTIONAL"은 다음과 같습니다. RFC 2119 \[RFC2119\]에 설명된 대로 해석됩니다.

---
## **2.  Usage Scenarios**

\[RFC5996\]에서는 IKEv2의 사용 시나리오를 설명합니다.  이것들은:

1. "보안 게이트웨이-보안 게이트웨이 터널": IKE\(및 IPsec\) 통신의 끝점은 연결된 네트워크를 대신하여 트래픽을 보호하는 네트워크 노드입니다.  보호된 트래픽은 각각의 보호된 네트워크에 있는 장치 간에 발생합니다.

1. "엔드포인트-투-엔드포인트 전송": IKE\(및 IPsec\) 통신의 엔드포인트는 \[RFC4301\]에 따른 호스트입니다.  보호된 트래픽은 두 끝점 사이에 있습니다.

1. "보안 게이트웨이 터널의 끝점": 하나의 끝점은 네트워크 노드를 통해 보호되는 네트워크에 연결됩니다.  IKE\(및 IPsec\) 통신의 끝점은 끝점과 네트워크 노드이지만 보호되는 트래픽은 끝점과 노드 뒤의 보호되는 네트워크에 있는 다른 장치 사이에 있습니다.

이 메모에 설명된 인증 및 키 교환 프로세스는 \[RFC5996\]에 설명된 모든 사용 시나리오에 적합합니다.  "보안 게이트웨이-보안 게이트웨이 터널" 시나리오 및 "엔드포인트-투-엔드포인트 전송" 시나리오에서는 인증서가 필요 없는 안전한 인증 방법을 제공합니다.  "보안 게이트웨이 터널 끝점" 시나리오의 경우 원격 액세스 VPN 상황에서 널리 사용되는 안전한 사용자 이름+비밀번호 인증을 제공합니다.

---
## **3.  Terms and Notation**

이 메모에는 다음 용어와 표기법이 사용됩니다.

PSK - 피어를 상호 인증하기 위한 자격 증명으로 사용되는 공유, 비밀 및 잠재적으로 엔트로피가 낮은 단어, 문구, 코드 또는 키입니다.

a = prf\(b, c\) - 문자열 "b"와 "c"는 의사 난수 함수\(prf\)에 제공되어 고정 길이 출력 "a"를 생성합니다.

| b - 문자열 "a"와 문자열 "b"의 연결을 나타냅니다.

\[a\]b - "b"번 반복되는 단일 비트 "a"로 구성된 문자열을 나타냅니다.

len\(a\) - 문자열 "a"의 길이를 비트 단위로 나타냅니다.

LSB\(a\) - 비트열 "a"의 최하위 비트를 반환합니다.

요소 - 유한 순환 그룹의 한 구성원.

스칼라 - 요소를 곱할 수 있는 양입니다.

유한 순환군의 원소를 나타내는 이 메모의 관례는 대문자나 두문자어를 사용하고, 스칼라는 소문자나 두문자어로 표시하는 것입니다.

---
## **4.  Discrete Logarithm Cryptography**

이 프로토콜은 이산 로그 암호화를 사용하여 인증을 달성합니다.  교환의 각 당사자는 특정 도메인 매개변수 세트\(여기서는 "그룹"이라고 함\)와 관련하여 임시 공개 및 개인 키를 파생합니다.  그룹은 유한 필드 암호화\(MODP\(모듈형 지수\) 그룹\) 또는 타원 곡선 암호화\(ECP 그룹\)를 기반으로 할 수 있습니다.

이 프로토콜은 특성 2개의 타원 곡선 그룹\(EC2N\)을 제외하고 인증에 사용되는 IKE 교환과 동일한 그룹을 사용합니다.  이러한 그룹의 사용은 이 인증 방법에 대해 정의되지 않으며 이러한 그룹 중 하나를 협상하는 IKE 교환은 이 인증 방법을 사용해서는 안 됩니다.

각 그룹에 대해 다음 작업이 정의됩니다.

- "스칼라 연산" - 그룹의 요소와 스칼라를 가져와 다른 요소를 생성합니다. -- Z = scalar-op\(x, Y\).

- "요소 연산" - 그룹의 두 요소를 가져와 세 번째 요소를 생성합니다. -- Z = 요소 op\(X, Y\).

- "역연산" - 요소를 취하고 두 요소에 대한 요소 연산이 그룹의 항등 요소를 생성하도록 다른 요소를 반환합니다 -- Y = 역\(X\).

---
### **4.1.  Elliptic Curve Cryptography (ECP) Groups**

이 메모에 정의된 키 교환은 \[RFC6090\]에 설명된 대로 ECP 그룹의 기본 알고리즘을 사용합니다.

보안 PSK 인증에 사용되는 ECP 타원 곡선의 도메인 매개변수는 다음과 같습니다.

- 소수 p, 소수 필드 GF\(p\)를 결정합니다.  암호화 그룹은 "무한대 지점"\(여기서는 "0으로 표시됨\)과 함께 타원 곡선의 점\(곡선 방정식을 만족하는 GF\(p\)의 요소\)으로 구성된 전체 타원 곡선 그룹의 하위 그룹입니다. "\)는 ID 요소 역할을 합니다.

- 곡선의 방정식을 정의하는 GF\(p\)의 요소 a 및 b.  점 \(x,y\)는 y^2 = x^3 + a\*x + b인 경우에만 타원 곡선 위에 있습니다.

- 요소 G에 의해 생성된 하위 그룹의 요소 수 또는 순서인 소수 r.

스칼라 연산은 곡선 위의 점 자체를 여러 번 곱하는 것입니다.  점 Y에 x배를 곱하여 또 다른 점 Z를 생성합니다.

```text
       Z = scalar-op(x, Y) = x*Y
```

요소 연산은 곡선에 두 점을 추가하는 것입니다.  점 X와 Y를 합산하여 또 다른 점 Z를 생성합니다.

```text
       Z = element-op(X, Y) = X + Y
```

역함수는 요소와 역함수의 합이 타원 곡선 그룹의 무한대 지점인 "0"이 되도록 정의됩니다.

```text
       Q + inverse(Q) = "0"
```

타원 곡선 그룹에는 그룹 요소를 정수로 변환하기 위한 매핑 함수 q = F\(Q\)가 필요합니다.  이 메모에 사용된 매핑 함수는 전달된 지점의 x 좌표를 반환합니다.

scalar-op\(x, Y\)는 다음을 정의하여 element-op\(\)의 x 반복으로 볼 수 있습니다.

```text
       Y = scalar-op(1, Y)

       Y = scalar-op(x, Y) = element-op(Y, scalar-op(x-1, Y)), for x > 1
```

타원 곡선\(즉, 요소 ​​op\(X, Y\)\)에 두 점을 추가하는 방법에 대한 정의는 \[RFC6090\]에서 찾을 수 있습니다.

참고: 전체 타원 곡선 그룹\("0" 포함\)의 크기가 h와 r의 곱이어야 한다는 요구 사항에 의해 정의되는 또 다른 ECP 도메인 매개 변수인 보조 인자 h가 있습니다.  보안 PSK 인증에 사용되는 ECP 그룹의 보조인자는 1이어야 합니다.  이 메모가 게시될 당시 \[IKEV2-IANA\]의 모든 ECP 그룹은 1의 보조 인자를 가졌습니다.

---
### **4.2.  Finite Field Cryptography (MODP) Groups**

보안 PSK 인증에 사용되는 MODP 그룹의 도메인 매개변수는 다음과 같습니다.

- 소수 p, 소수 필드 GF\(p\), 정수 모듈로 p를 결정합니다.

- 요소 G에 의해 생성된 GF\(p\)\*의 암호화 하위 그룹의 곱셈 순서 및 크기인 소수 r.

스칼라 연산은 생성기 모듈로 a 소수의 지수화입니다. 요소 Y는 소수 모듈로 x제곱을 취하여 다른 요소 Z를 반환합니다.

```text
       Z = scalar-op(x, Y) = Y^x mod p
```

요소 연산은 모듈러 곱셈입니다.  두 요소 X와 Y에 소수를 모듈로 곱하여 다른 요소 Z를 반환합니다.

```text
       Z = element-op(X, Y) = (X * Y) mod p
```

MODP 그룹의 역함수는 요소와 그룹 프라임의 역 모듈로 곱이 1과 같도록 정의됩니다.  다시 말해서,

```text
       (Q * inverse(Q)) mod p = 1
```

ECP 그룹과 달리 MODP 그룹에는 요소를 정수로 변환하는 매핑 기능이 필요하지 않습니다.  그러나 프로토콜 정의의 표기 목적을 위해 함수 F는 아래에서 사용될 때 전달된 값, 즉 F\(i\) = i를 반환합니다.

\[IKEV2-IANA\]의 일부 MODP 그룹은 안전 소수를 기반으로 하며 순서는 그룹의 도메인 매개변수 세트에 포함되지 않습니다.  이 경우에만 차수 r은 소수 빼기 1을 2로 나눈 값\(\(p-1\)/2\)으로 계산되어야 합니다.  그룹의 도메인 매개변수 세트에 주문이 포함된 경우 주문이 요청될 때 이 교환에서 해당 값을 사용해야 합니다.  MODP 그룹이 도메인 매개변수 세트에 순서를 포함하지 않고 안전 소수를 기반으로 하지 않는 경우 이 교환과 함께 사용해서는 안 됩니다.

---
## **5.  Random Numbers**

IKE 자체와 마찬가지로 보안 PSK 인증 방법의 보안은 품질 비밀 난수를 생성하는 프로토콜의 각 참가자에 의존합니다.  단일 교환에서 어느 쪽이든 잘못된 난수를 선택하면 해당 교환의 공유 비밀이 손상되고 사전 공격의 가능성이 열릴 수 있습니다.

특수 하드웨어 없이 고품질의 난수를 생성하려면 암호화 혼합 기능\(예: 강력한 해시 함수\)을 사용하여 상관되지 않은 여러 정보 및 이벤트 소스의 엔트로피를 혼합해야 합니다.  이에 대한 매우 좋은 논의는 \[RFC4086\]에서 찾을 수 있습니다.

---
## **6.  Using Passwords and Raw Keys For Authentication**

이 프로토콜에서 인증 자격 증명으로 사용되는 PSK는 문자 기반 암호 또는 암호 문구이거나 이진수 또는 16진수 문자열일 수 있습니다.  그러나 그럼에도 불구하고 이 프로토콜에서는 개시자와 응답자 모두 공유 자격 증명의 동일한 이진 표현을 가져야 합니다.

PSK가 문자 기반 암호 또는 암호 문구인 경우 암호 또는 암호 문구를 보안 PSK 인증에 사용하기에 적합한 16진수 문자열로 변환하기 위해 사용되는 두 가지 유형의 사전 처리가 있습니다.  PSK가 이미 16진수 또는 이진수 문자열인 경우 사전 처리 없이 공유 자격 증명으로 직접 사용해야 합니다.

전처리의 첫 번째 단계는 국제화로 인해 발생할 수 있는 모호성을 제거하는 것입니다.  각 문자 기반 비밀번호 또는 비밀번호 문구는 \[RFC3454\]의 SASLprep \[RFC4013\] 프로필 규칙에 따라 문자 기반 비밀번호 또는 비밀번호 문구를 처리하여 모호성을 제거하기 위해 사전 처리되어야 합니다.  비밀번호 또는 패스프레이즈는 \[RFC3454\]에 따라 "저장된 문자열"로 간주되므로 할당되지 않은 코드 포인트는 금지됩니다.  출력은 처리된 UTF-8 문자열의 이진 표현이어야 합니다.  SASLprep 사전 처리에서 발견된 금지된 출력 및 할당되지 않은 코드 포인트는 사전 처리 실패를 야기해야 하며 출력은 보안 PSK 인증과 함께 사용되어서는 안 됩니다.

문자 기반 비밀번호 또는 패스프레이즈의 다음 전처리 단계는 문자열을 효과적으로 난독화하는 것입니다.  이는 서버가 손상되거나 서버의 저장된 암호 데이터베이스가 손상되는 경우 저장된 암호의 노출을 줄이기 위한 시도로 수행됩니다.  이 단계에는 \[RFC3454\]의 SASLprep \[RFC4013\] 프로필 출력을 가져와 이를 키로 전달하는 작업이 포함됩니다.

ASCII 문자열 "IKE Secure PSK Authentication"을 데이터로 HMAC-SHA256\(\)에 보냅니다.  이 난독화 단계의 출력은 보안 PSK 인증에 사용되는 공유 자격 증명이 됩니다.

참고: 비밀번호는 여러 목적으로 공유되는 경향이 있으며, 이 경우 저장된 일반 텍스트 비밀번호의 서버나 데이터베이스를 손상시켜 여러 공격을 가할 수 있습니다.  난독화 단계는 단순히 서버가 손상되거나 저장된 비밀번호의 데이터베이스가 손상되는 경우 비밀번호를 숨기는 것입니다.  분산 컴퓨팅 성능의 발전으로 인해 사전 공격을 방지하기 위한 기술로서 여러 prf 반복을 수행하는 효율성이 감소되었으므로 여기서는 그러한 동작을 금지합니다.  상호 동의하는 구현에서는 다른 비밀번호 난독화 방법을 사용하는 데 동의할 수 있습니다. 여기에 설명된 내용은 상호 운용성 목적으로만 사용됩니다.

기기가 나중에 사용하기 위해 비밀번호를 저장하는 경우 저장하기 전에 비밀번호를 사전 처리해야 합니다.  사용자가 인증 시 장치에 비밀번호를 입력하는 경우 보안 PSK 인증을 사용하기 전에 입력 시 비밀번호를 사전 처리해야 합니다.

---
## **7.  Assumptions**

프로토콜의 보안은 특정 가정에 의존합니다.  그들은:

1. \[RFC5996\]에 정의된 의사 난수 함수 prf는 비밀 입력의 엔트로피를 짧은 고정 문자열로 추출하여 "추출기"\(\[RFC5869\] 참조\) 역할을 합니다.  prf의 출력은 임의 소스와 구별할 수 없습니다.

1. 선택된 유한 순환 그룹에 대한 이산 로그 문제는 어렵습니다.  즉, G, p 및 Y = G^x mod p가 주어지면 x를 결정하는 것이 계산상 불가능합니다.  마찬가지로, 곡선 정의, 생성기 G 및 Y = x \* G가 주어진 타원 곡선 그룹의 경우 x를 결정하는 것은 계산상 불가능합니다.

1. 사전 공유 키는 유한한 잠재적 키 풀에서 추출됩니다. 풀에 있는 각각의 가능한 키는 공유 키가 될 확률이 동일합니다.  모든 잠재적인 공격자는 이 키 풀에 액세스할 수 있습니다.

---
## **8.  Secure PSK Authentication Message Exchange**

이 메모에 설명된 키 교환은 802.11 무선 네트워크\(\[SAE\] 참조\) 및 EAP\(Extensible Authentication Protocol\) 방법\(\[RFC5931\] 참조\)에서 사용하도록 정의된 "Dragonfly" 키 교환을 기반으로 합니다. .  "잠자리"는 특허가 없으며

로열티가 없습니다.  이는 "Dragonfly"가 인증하는 IKE 교환에서 사용하기 위해 협상된 동일한 의사 난수 함수\(prf\) 및 동일한 Diffie-Hellman 그룹을 사용해야 합니다.

블록 암호를 사용하는 의사 난수 기능은 "추출기"로 작동하는 작업이 좋지 않기 때문에 보안 PSK 인증과 함께 사용하는 것이 권장되지 않습니다\(섹션 7 참조\).  \[RFC2104\]의 HMAC 구성을 사용하는 해시 함수에 기반한 의사 무작위 함수를 사용해야 합니다.

보안 PSK 인증을 수행하려면 각 측은 사전 공유 키를 기반으로 선택한 그룹에서 공유 및 비밀 요소를 생성해야 합니다.  비밀 키 요소\(SKE\)라고 하는 이 요소는 "잠자리" 인증 및 키 교환 프로토콜에 사용됩니다. "Dragonfly"는 양측이 커밋 페이로드를 교환한 다음 결과 공유 비밀에 대한 지식을 증명하는 것으로 구성됩니다.

커밋 페이로드는 교환에 임시 정보를 제공하고 잠재적인 사전 공유 키 풀에서 사전 공유 키의 단일 값에 발신자를 바인딩합니다.  인증 페이로드\(AUTH\)는 사전 공유 키가 알려져 있음을 증명하고 영지식 증명을 완료합니다.

---
### **8.1.  Negotiation of Secure PSK Authentication**

개시자는 IKE\_SA\_INIT 교환의 첫 번째 메시지에 SECURE\_PASSWORD\_METHODS\(\[RFC6467\] 참조\) 유형의 알림 페이로드를 추가하고 알림 페이로드의 알림 데이터 필드에 보안 PSK 인증을 나타내는 3을 포함하여 보안 PSK 인증을 사용하려는 의사를 나타냅니다. .

응답자는 IKE\_SA\_INIT 교환의 응답에 SECURE\_PASSWORD\_METHODS 유형의 알림 페이로드를 추가하고 알림 페이로드의 알림 데이터 필드에 유일한 값 3을 추가하여 보안 PSK 인증 수행에 대한 수락을 나타냅니다.

응답자가 IKE\_SA\_INIT 응답에 SECURE\_PASSWORD\_METHODS 유형의 알림 페이로드를 포함하지 않는 경우 개시자는 교환을 종료해야 하며 \[RFC5996\]의 PSK 인증 방법으로 대체되어서는 안 됩니다.  개시자가 보안 PSK 인증에 대한 지원만 표시하고\(즉, 알림 데이터 필드에 3개만 포함된 경우\) 응답자가 SECURE\_PASSWORD\_METHODS 유형의 알림 페이로드와 알림 데이터 필드의 다른 값으로 응답하는 경우, 개시자는 교환을 종료해야 합니다. .

---
### **8.2.  Fixing the Secret Element, SKE**

SKE를 수정하는 방법은 그룹 유형\(MODP 또는 ECP\)에 따라 다릅니다.  \[RFC5996\]의 "prf+" 함수는 키 파생 함수로 사용됩니다.

SKE 수정에는 협상된 그룹의 도메인 매개변수 집합의 프라임과 협상된 그룹에 따른 ECP 또는 MODP 관련 작업을 사용하는 반복적인 헌팅 앤 펙킹 기술이 포함됩니다. 이 기술을 사용하려면 사전 공유 키가 이진 문자열이어야 합니다. 따라서 SKE를 수정하기 전에 사전 공유 키에 대해 사전 처리 변환\(섹션 6 참조\)을 수행해야 합니다.

주어진 비밀번호에 대해 SKE를 찾는 데 사용되는 사냥 및 쪼개기 루프의 반복 횟수를 결정하려고 시도하는 부채널 공격을 방지하기 위해 보안 매개변수 k를 사용하여 최소 k번의 반복이 항상 이루어지도록 보장합니다. 수행.

헌팅 앤 펙킹 루프를 시작하기 전에 8비트 카운터는 값 1로 설정됩니다.  그런 다음 루프가 시작됩니다.  먼저, 의사 무작위 함수는 개시자와 응답자가 교환한 카운터, 사전 공유 키, 두 개의 nonce\(고정 헤더 없음\)를 사용하여 비밀 시드를 생성하는 데 사용됩니다\(섹션 8.6 참조\).

```text
      ske-seed = prf(Ni | Nr, psk | counter)
```

그런 다음 prf+를 사용하여 ske-seed를 확장하여 ske-value를 생성합니다.

- ske-값 = prf+\(ske-seed, "IKE SKE 사냥 및 쪼기"\)

여기서 len\(ske-value\)은 협상된 그룹의 도메인 매개변수 세트에 있는 소수의 길이인 len\(p\)와 동일합니다.

스케시드가 소수 p보다 크거나 같으면 카운터가 증가하고 새로운 스케시드가 생성되며 사냥과 쪼기가 계속됩니다.  ske-seed가 소수 p보다 작으면 SKE를 선택하거나 실패하기 위해 그룹별 작업으로 전달됩니다.  그룹별 작업이 실패하면 카운터가 증가하고 새로운 스케시드가 생성되며 사냥과 쪼기가 계속됩니다.  이 프로세스는 그룹별 작업이 비밀번호 요소를 반환할 때까지 계속됩니다.  비밀번호 요소를 선택한 후 스케시드 계산에서 비밀번호 대신 난수를 사용하고 카운터가 보안 매개변수 k보다 커질 때까지 사냥과 쪼개기가 계속됩니다.

---
#### **8.2.1.  ECP Operation to Select SKE**

ECP 그룹에 대한 그룹별 작업은 ske-value, ske-seed 및 곡선 방정식을 사용하여 SKE를 생성합니다.  먼저, ske-값은 y 좌표 y를 풀기 위해 곡선의 도메인 매개변수 세트에서 매개변수 a 및 b를 사용하여 타원 곡선의 방정식과 함께 x 좌표 x로 직접 사용됩니다.

참고: 타원곡선 방정식의 해법 여부를 확인하는 방법은 \(x^3 + ax + b\)의 르장드르 기호가 1과 같은지 확인하는 것입니다.  그렇다면 해결책이 존재하는 것입니다. 그렇지 않다면 해결책이 없습니다.

타원 곡선의 방정식에 대한 해가 없으면 작업이 실패하고 카운터가 증가하며 새 스케 값과 스케 시드가 선택되고 헌팅 앤 펙킹이 계속됩니다.  해가 있는 경우 y는 타원 곡선 방정식을 사용하여 \(x^3 + ax + b\)의 제곱근으로 계산됩니다.  이 경우 방정식에 기술적으로 두 가지 해가 존재하므로 모호성이 존재하며, ske-seed를 사용하여 그 중 하나를 명확하게 선택합니다. ske-seed의 하위 비트가 y의 하위 비트와 같으면 후보 SKE는 점 \(x,y\)로 정의됩니다. ske-seed의 하위 비트가 y의 하위 비트와 다른 경우 후보 SKE는 점 \(x, p-y\)로 정의됩니다. 여기서 p는 협상된 그룹의 도메인 매개변수 집합의 소수입니다.  후보 SKE가 SKE가 되고 ECP 관련 작업이 성공적으로 완료됩니다.

알고리즘적으로 프로세스는 다음과 같습니다.

```text
         found = 0
         counter = 1
         v = psk
         do {
           ske-seed = prf(Ni | Nr, v | counter)
           ske-value = prf+(ske-seed, "IKE SKE Hunting And Pecking")
           if (ske-value < p)
           then
             x = ske-value
             if ( (y = sqrt(x^3 + ax + b)) != FAIL)
             then
               if (found == 0)
               then
                 if (LSB(y) == LSB(ske-seed))
                 then
                   SKE = (x,y)
                 else
                   SKE = (x, p-y)
                 fi
                 found = 1
                 v = random()
               fi
             fi
           fi
           counter = counter + 1
         } while ((found == 0) || (counter <= k))
```

여기서 FAIL은 sqrt\(x^3 + ax + b\)에 대한 해결책이 없음을 나타냅니다.

```text
                    Figure 1: Fixing SKE for ECP Groups
```

참고: ECP 그룹의 경우 SKE를 찾기 위해 "n"회 이상의 사냥 및 쪼기 루프 반복이 필요할 확률은 대략 \(1-\(r/2p\)\)^n이며, 이는 다음과 같이 빠르게 0에 접근합니다. "n"이 증가합니다.

---
#### **8.2.2.  MODP Operation to Select SKE**

MODP 그룹에 대한 그룹별 작업은 그룹의 도메인 매개변수 집합에서 ske 값인 소수 p와 차수 r을 가져와 ske 값을 값\(\(p-1\)에 지수화하여 후보 SKE를 직접 생성합니다. /r\) 소수를 모듈로로 계산합니다.  후보 SKE가 1보다 크면 후보 SKE가 SKE가 되고 MODP 관련 작업이 성공적으로 완료됩니다.  그렇지 않으면 MODP 관련 작업이 실패합니다\(그리고 사냥 및 쪼개기가 계속됩니다\).

알고리즘적으로 프로세스는 다음과 같습니다.

```text
         found = 0
         counter = 1
         v = psk
         do {
           ske-seed = prf(Ni | Nr, v | counter)
           ske-value = prf+(ske-seed, "IKE SKE Hunting And Pecking")
           if (ske-value < p)
           then
             ELE = ske-value ^ ((p-1)/r) mod p
             if (ELE > 1)
             then
               if (found == 0)
                 SKE = ELE
                 found = 1
                 v = random()
               fi
             fi
           fi
           counter = counter + 1
         } while ((found == 0) || (counter <= k))

                   Figure 2: Fixing SKE for MODP Groups
```

참고: MODP 그룹의 경우 SKE를 찾기 위해 "n"회 이상의 사냥 및 쪼기 루프 반복이 필요할 확률은 대략 \(\(m-p\)/p\)^n입니다. 여기서 m은 가능한 가장 큰 부호 없는 숫자입니다. len\(p\) 비트로 표현되며, "n"이 증가함에 따라 0에 빠르게 접근합니다.

---
### **8.3.  Encoding and Decoding of Group Elements and Scalars**

보안 PSK 인증 방법에 사용되는 페이로드에는 협상된 그룹 및 스칼라 값의 요소가 포함되어 있습니다.  상호 운용성을 보장하려면 이 섹션의 요구 사항에 따라 스칼라 및 필드 요소를 페이로드에 표시해야 합니다.

---
#### **8.3.1.  Encoding and Decoding of Scalars**

스칼라는 합의된 암호화 그룹 생성자의 순서인 r보다 엄격하게 작은 부호 없는 정수로 \(이진 형식으로\) 표현되어야 합니다.  각 스칼라의 이진 표현은 r의 이진 표현의 비트 길이와 동일한 비트 길이를 가져야 합니다.  필요한 경우 필요한 길이에 도달할 때까지 정수의 이진 표현 앞에 0을 추가하여 이 요구 사항을 적용합니다.

부호 없는 정수 형태의 스칼라는 \[RFC6090\]에 설명된 기술을 사용하여 옥텟 문자열로 변환되었다가 다시 변환됩니다.

---
#### **8.3.2.  Encoding and Decoding of ECP Elements**

ECP 그룹의 요소는 협상된 타원 곡선의 점입니다. 이러한 각 요소는 x 좌표와 y 좌표라는 두 구성 요소의 연결로 표시되어야 합니다.

x 좌표와 y 좌표의 두 구성요소 각각은 그룹의 도메인 매개변수 세트에서 소수 p보다 엄격하게 작은 부호 없는 정수로 \(이진 형식으로\) 표현되어야 합니다.  각 구성 요소의 이진 표현은 p의 이진 표현의 비트 길이와 동일한 비트 길이를 가져야 합니다. 이 길이 요구 사항은 필요한 경우 필요한 길이에 도달할 때까지 정수의 이진 표현 앞에 0을 추가하여 적용됩니다.

점의 좌표를 나타내는 부호 없는 정수는 \[RFC6090\]에 설명된 기술을 사용하여 옥텟 문자열로 변환되고 다시 변환됩니다.

필드 요소는 x 좌표와 y 좌표로 페이로드에 표시되므로 페이로드의 요소 길이는 p 비트 길이의 두 배여야 합니다.

---
#### **8.3.3.  Encoding and Decoding of MODP Elements**

MODP 그룹의 요소는 그룹의 도메인 매개변수 세트에서 소수 p보다 엄격하게 작은 부호 없는 정수로 \(이진 형식으로\) 표현되어야 합니다.  각 그룹 요소의 이진 표현은 p의 이진 표현의 비트 길이와 동일한 비트 길이를 가져야 합니다.  이 길이 요구 사항은 필요한 경우 필요한 길이에 도달할 때까지 정수의 이진 표현 앞에 0을 추가하여 적용됩니다.

MODP 요소를 나타내는 부호 없는 정수는 \[RFC6090\]에 설명된 기술을 사용하여 옥텟 문자열로 변환되었다가 다시 변환됩니다.

---
### **8.4.  Message Generation and Processing**
---
#### **8.4.1.  Generation of a Commit**

커밋 페이로드를 생성하기 전에 섹션 8.2에 설명된 프로세스를 사용하여 SKE를 수정해야 합니다.

커밋 페이로드에는 스칼라와 요소라는 두 가지 구성 요소가 있습니다.  커밋 페이로드를 생성하려면 "개인" 값과 "마스크" 값이라는 두 개의 난수가 생성됩니다\(섹션 5 참조\).  그룹 순서 r의 모듈로 합은 스칼라 구성요소가 됩니다.

```text
       scalar = (private + mask) mod r
```

스칼라가 1보다 크지 않으면 개인 및 마스크 값을 버려야 하며 새 값이 무작위로 생성되어야 합니다.  스칼라가 1보다 큰 경우 마스크와 SKE를 사용한 스칼라 연산의 역이 요소 구성 요소가 됩니다.

```text
       Element = inverse(scalar-op(mask, SKE))
```

커밋 페이로드는 스칼라와 요소로 구성되며, 스칼라와 요소는 섹션 8.3에 따라 커밋 페이로드에 인코딩됩니다.

---
#### **8.4.2.  Processing of a Commit**

피어의 커밋 페이로드를 수신하면 스칼라와 요소의 유효성을 검사해야 합니다.  요소 처리는 ECP 요소 또는 MODP 요소 유형에 따라 달라집니다.

---
##### **8.4.2.1.  Validation of an ECP Element**

수신된 ECP 요소의 유효성 검사에는 다음이 포함됩니다. 1\) 두 좌표 x와 y가 모두 0보다 크고 기본 필드를 정의하는 소수보다 작은지 확인합니다. 2\) x 및 y 좌표가 곡선의 방정식을 만족하는지\(즉, "0"이 아닌 곡선에서 유효한 점을 생성하는지\) 확인하는 것입니다.  이러한 조건 중 하나라도 충족되지 않으면 수신된 요소가 유효하지 않습니다. 그렇지 않으면 수신된 요소가 유효합니다.

---
##### **8.4.2.2.  Validation of a MODP Element**

수신된 MODP 요소는 다음과 같은 경우에 유효합니다. 1\) 일\(1\)과 소수 p\(배타적\) 사이에 있습니다. 2\) 그룹 순서에 따른 요소의 모듈러 지수화인 경우 r은 1과 같습니다.  이러한 조건 중 하나라도 해당되지 않으면 수신된 요소가 유효하지 않습니다. 그렇지 않으면 수신된 요소가 유효합니다.

---
##### **8.4.2.3.  Commit Processing Steps**

커밋 페이로드 유효성 검사는 다음 단계에 따라 수행됩니다.

1. 커밋 페이로드의 길이는 예상 길이\(스칼라의 예상 길이와 협상된 그룹에 대한 요소의 예상 길이를 더한 값\)와 비교하여 확인됩니다.  올바르지 않으면 커밋 페이로드가 무효화됩니다. 그렇지 않으면 처리가 계속됩니다.

1. 피어의 스칼라는 섹션 8.3.1에 따라 커밋 페이로드에서 추출되고 협상된 그룹의 순서인 1과 r 사이에 있는지 확인합니다.  그렇지 않은 경우 커밋 페이로드가 무효화됩니다. 그렇지 않으면 처리가 계속됩니다.

1. 피어의 요소는 섹션 8.3.2에 따라 커밋 페이로드에서 추출되고 협상된 그룹 유형에 따라 달라지는 방식으로 확인됩니다.  그룹이 ECP인 경우 요소는 섹션 8.4.2.1에 따라 검증됩니다.  그룹이 MODP인 경우 요소는 섹션 8.4.2.2에 따라 검증됩니다.  요소가 유효하지 않으면 커밋 페이로드가 무효화됩니다. 그렇지 않으면 커밋 페이로드가 검증됩니다.

1. IKE 교환 개시자에게는 커밋 페이로드에서 수신된 요소 및 스칼라가 응답자에게 전송된 요소 및 스칼라와 다른지 확인하기 위한 추가 요구 사항이 있습니다. 동일하면 반사 공격을 의미하며 커밋 페이로드가 무효화됩니다.

커밋 페이로드가 무효화되면 페이로드를 폐기하고 IKE 교환을 중단해야 합니다.

---
#### **8.4.3.  Authentication of the Exchange**

커밋 페이로드가 생성되고 피어의 커밋 페이로드가 처리된 후 피어를 인증하는 데 사용되는 공유 비밀이 파생됩니다.  SKE를 사용하면 커밋 페이로드 생성의 일부로 생성된 "개인" 값과 피어의 커밋 페이로드에 있는 피어의 스칼라 및 요소\(여기서 각각 피어-스칼라 및 피어 요소라고 함\)는 예비 공유 비밀인 skey가 다음과 같이 생성됩니다. :

```text
        skey = F(scalar-op(private,
                           element-op(Peer-Element,
                                      scalar-op(peer-scalar, SKE))))
```

후속 계산을 위해 skey의 비트 길이는 MODP 또는 ECP 그룹에서 사용되는 소수 p의 비트 길이와 동일해야 합니다.  이 비트 길이는 필요한 경우 필요한 길이에 도달할 때까지 값에 0을 추가하여 시행해야 합니다.

그러면 공유 비밀 ss가 prf\(\)를 사용하여 개시자\(Ni\)와 응답자\(Nr\)\(고정 헤더 없이\)에 의해 교환된 nonce와 skey로부터 계산됩니다.

- ss = prf\(Ni | Nr, skey | "IKE에서 보안 PSK 인증"\)

공유 비밀 ss는 공유 비밀의 소유와 사전 공유 키에 대한 지식을 증명하기 위해 AUTH 인증 페이로드에 사용됩니다.

---
### **8.5.  Payload Format**
---
#### **8.5.1.  Commit Payload**

\[RFC6467\]은 특정 보안 비밀번호 방법과 관련된 정보를 전달하는 데 사용되는 GSPM\(일반 보안 비밀번호 방법\) 페이로드를 정의합니다.  이 메모는 GSPM 페이로드를 커밋 페이로드로 사용하여 보안 PSK 인증 교환에 사용되는 스칼라와 요소를 포함합니다.

커밋 페이로드는 다음과 같이 정의됩니다.

```text
                            1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ! Next Payload  !C!  RESERVED   !         Payload Length        !
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                                                               |
       +                            scalar                             ~
       |                                                               |
       ~                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                               |                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               ~
       |                                                               |
       ~                           Element                             ~
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
```

스칼라와 요소는 섹션 8.3에 따라 커밋 페이로드에 인코딩되어야 합니다.

---
### **8.6.  IKEv2 Messaging**

보안 PSK 인증은 교환을 위한 추가 왕복을 추가하여 보안 PSK 인증 교환을 수행하기 위한 커밋 페이로드를 추가하고 IKEv2 교환을 보안 PSK 인증 교환의 결과에 바인딩하기 위해 AUTH 페이로드 데이터의 계산을 변경하여 IKE\_AUTH 교환을 수정합니다\(참조: 그림 3\).

```text
    Initiator                               Responder
   -----------                             -----------

   IKE_SA_INIT:

    HDR, SAi1, KEi, Ni,
         N(SPM-SPSK)  -->

                                  <--    HDR, SAr1, KEr, Nr,
                                              N(SPM-SPSK)

   IKE_AUTH:

    HDR, SK {IDi, COMi, [IDr,]
             SAi2, TSi, TSr}      -->
                                  <--    HDR, SK {IDr, COMr}
    HDR, SK {AUTHi}               -->
                                  <--    HDR, SK {AUTHr, SAr2, TSi, TSr}
```

여기서 N\(SPM-SPSK\)은 보안 PSK 인증\(섹션 8.1 참조\) 사용을 협상하는 데 사용되는 보안 암호 방법 알림 페이로드를 나타내고, COMi 및 AUTHi는 각각 개시자가 보낸 커밋 페이로드 및 AUTH 페이로드이며, COMr 및 AUTHr은 응답자가 보낸 커밋 페이로드와 AUTH 페이로드입니다.

```text
                       Figure 3: Secure PSK in IKEv2
```

보안 PSK 인증을 수행할 때 AUTH 페이로드는 다음과 같이 계산됩니다.

```text
       AUTHi = prf(ss, <InitiatorSignedOctets> | COMi | COMr)

       AUTHr = prf(ss, <ResponderSignedOctets> | COMr | COMi)
```

여기서 "ss"는 섹션 8.4.3에서 파생된 공유 비밀이고, COMi 및 COMr은 각각 개시자와 응답자가 보낸 전체 커밋 페이로드\(고정 헤더 포함\)이며 <InitiatorSignedOctets\> 및 <ResponderSignedOctets\>는

\[RFC5996\].  두 AUTH 페이로드에 표시된 인증 방법은 \[IKEV2-IANA\]의 "일반 보안 비밀번호 인증 방법", 값 12여야 합니다.

---
## **9.  IANA Considerations**

IANA는 \[IKEV2-IANA\]의 보안 비밀번호 인증 방법 레지스트리에서 "보안 PSK 인증"에 값 3을 할당했습니다.

---
## **10.  Security Considerations**

개시자와 응답자 모두 비밀 그룹 요소와 교환에 기여한 자신의 개인 가치를 기반으로 공유 비밀 "ss"\(섹션 8.4.3 참조\)를 얻습니다.  동일한 사전 공유 키를 공유하지 않으면 동일한 비밀 그룹 요소를 파생할 수 없고, 동일한 비밀 그룹 요소를 공유하지 않으면 동일한 공유 비밀을 파생할 수 없습니다.

사전 공격에 대한 저항은 공격자가 사전 공유 키에 대해 단일 추측을 하기 위해 적극적인 공격을 시작해야 함을 의미합니다.  키가 추출된 풀의 크기가 d이고 풀의 각 키가 선택될 확률이 동일한 경우 단일 추측 후 성공 확률은 1/d입니다.  x개의 추측을 하고 가능한 키 풀에서 실패한 추측을 제거한 후 확률은 1/\(d-x\)가 됩니다.  x가 커지면 성공 확률도 커집니다.  따라서 공격자가 반복적인 무차별 대입 공격, 적극적 추측 공격을 통해 사전 공유 키를 알아내는 것이 가능합니다.  이 인증 방법은 이에 대해 안전하다고 가정하지 않으며 구현에서는 d 값이 이 공격을 방지할 만큼 충분히 큰지 확인해야 합니다.  또한 구현에서는 실패한 인증 시도 횟수가 특정 임계값에 도달한 후 일정 시간 동안 인증 시도를 거부하는 등의 대응 조치를 취해야 합니다.  이 메모에서는 그러한 임계값이나 시간을 권장하지 않습니다.

활성 공격자는 교환의 응답자를 가장하고 개시자의 커밋 페이로드를 수신한 후 위조된 커밋 페이로드를 보낼 수 있습니다.  그런 다음 공격자는 응답자로부터 인증 페이로드를 받을 때까지 기다립니다.  이제 공격자는 사전 공유 키의 가능한 모든 값을 실행하여 SKE를 계산하고\(8.2절 참조\) "ss"를 계산하고\(8.4.3절 참조\) 응답자로부터 확인 페이로드를 다시 생성하려고 시도할 수 있습니다.

그러나 위조된 커밋 페이로드를 전송함으로써 공격자는 사전 공유 키에 대한 단일 추측을 커밋합니다.  해당 값은 응답자가 인증 페이로드에 사용된 "ss"를 계산하는 데 사용되었습니다.  위조된 커밋 페이로드에 사용된 키와 다른 사전 공유 키를 추측하면 다음과 같은 결과가 발생합니다.

"ss" 계산에서 다른 비밀 요소를 사용하므로 가능한 모든 값을 실행하는 동안 후속 추측이 정확하더라도 인증 페이로드가 올바른지 확인할 수 없습니다.  공격자는 활성 공격당 하나의 추측만 얻습니다.

개시자 또는 응답자 역할을 하는 공격자는 상대방으로부터 받은 커밋 페이로드의 요소를 가져와 구성에 사용된 무작위 "마스크" 값을 재구성한 다음 스칼라에서 상대방의 "개인" 값을 복구할 수 있습니다. 커밋 페이로드에서.  그러나 이를 위해서는 공격자가 다루기 힘든 이산 로그 문제를 해결해야 합니다\(섹션 7\).

공격자는 미리 공유된 키를 추측하는 대신 SKE를 결정한 후 공격을 시도할 수 있지만 SKE는 임의 소스와 구별할 수 없다고 가정되는 의사 난수 함수 prf의 출력에 의해 결정됩니다. \(섹션 7\). 따라서 유한 순환 그룹의 각 요소는 SKE가 될 확률이 동일합니다.  SKE를 추측할 확률은 1/r입니다. 여기서 r은 그룹의 차수입니다.  이는 다루기 힘든 것으로 가정되는 이산 로그에 대한 해를 추측하는 확률과 동일합니다\(섹션 7\).  그룹의 순서가 사전 공유 키 풀의 크기보다 훨씬 더 크기 때문에 공격자는 prf에 대한 입력, 즉 사전 공유 키를 추측하는 데 성공할 가능성이 더 높습니다.

사전 공격에 대한 저항의 의미는 중요합니다. 구현은 실용적이고 현실적인 방식으로 사전 공유 키를 제공할 수 있습니다. 즉, 문자열일 수도 있고 상대적으로 짧을 수도 있으며 여전히 보안을 유지할 수 있습니다.  사전 공유 키의 특성에 따라 풀 크기 D가 결정되며, 대응책은 공격자가 반복적이고 적극적이며 추측하는 공격이라는 가능한 유일한 방법으로 비밀을 알아내는 것을 방지할 수 있습니다.  예를 들어, 영어 소문자를 사용하고 해당 문자를 무작위로 선택한다고 가정하는 간단한 4자 문자열의 경우 D는 40만 개가 넘습니다.  사전 공유 키를 결정하는 데 상당한 이점을 얻으려면 공격자가 십만 개가 넘는 활성 추측 공격\(쉽게 감지됨\)을 실행해야 합니다.

공격자가 SKE를 결정하는 데 필요한 사냥 및 쪼개기 루프의 수를 알고 있는 경우 잠재적인 비밀번호 풀에서 비밀번호를 제거하고 실제 비밀번호를 성공적으로 추측할 확률을 높일 수 있습니다.  MODP 그룹에는 소수 값을 기반으로 한 확률로 "n"개 이상의 루프가 필요합니다. m이 len\(p\) 비트로 표현될 수 있는 가장 큰 부호 없는 숫자인 경우 확률은 \(\(m-p\)/p입니다. \)^n - \[IKEV2-IANA\]에 정의된 그룹의 경우 일반적으로 매우 작습니다.  ECP

그룹에는 대략 \(1-\(r/2p\)\)^n 확률로 두 개 이상의 "n" 루프가 필요합니다.  따라서 SKE가 k개 미만의 루프에서 발견되는지 여부에 관계없이 항상 k개 이상의 루프가 실행되도록 보장하는 보안 매개변수 k가 정의됩니다.  암호에는 k개 이상의 루프가 필요할 가능성이 여전히 있으며 부채널 공격자가 해당 정보를 유리하게 사용할 수 있으므로 k 값의 선택은 항상 추가 작업 부하 간의 균형을 기반으로 해야 합니다. k 반복을 수행하고 부채널 공격자에게 정보를 제공할 가능성이 있습니다.  성공적인 부채널 공격 가능성은 MODP 그룹보다 ECP 그룹에 대해 더 높으며 두 그룹에 대해 별도의 k 값을 갖는 것이 적절할 수 있다는 점에 유의하는 것이 중요합니다.

이 인증 방법의 기반이 되는 키 교환 보안에 대한 자세한 내용은 \[SAE\] 및 \[RFC5931\]을 참조하세요.

---
## **11.  Acknowledgements**

저자는 이 인증 방법의 기초가 되는 이전 버전의 키 교환에서 결함을 발견하고 이를 개선하는 데 도움이 되는 제안을 제공한 Scott Fluhrer와 Hideyuki Suzuki에게 감사의 말씀을 전하고 싶습니다.  그룹의 요소를 "해시"하는 사냥 및 쪼기 기술에 대한 유용한 조언을 제공한 Lily Chen과 소규모 하위 그룹 공격에 대응하는 방법에 대해 논의한 Jin-Meng Ho에게 감사드립니다.  Rich Davis는 기본 키 교환의 보안을 크게 강화하는 수신된 메시지에 대한 몇 가지 검사를 제안했습니다.  Hugo Krawczyk는 prf를 추출기로 사용할 것을 제안했습니다.

---
## **12.  References**
---
### **12.1.  Normative References**

```text
   [IKEV2-IANA]  IANA, "IKEv2 Parameters",
                 <http://www.iana.org/assignments/ikev2-parameters>.

   [RFC2104]     Krawczyk, H., Bellare, M., and R. Canetti, "HMAC:
                 Keyed-Hashing for Message Authentication", RFC 2104,
                 February 1997.

   [RFC2119]     Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3454]     Hoffman, P. and M. Blanchet, "Preparation of
                 Internationalized Strings ("stringprep")", RFC 3454,
                 December 2002.

   [RFC4013]     Zeilenga, K., "SASLprep: Stringprep Profile for User
                 Names and Passwords", RFC 4013, February 2005.

   [RFC5996]     Kaufman, C., Hoffman, P., Nir, Y., and P. Eronen,
                 "Internet Key Exchange Protocol Version 2 (IKEv2)",
                 RFC 5996, September 2010.

   [RFC6090]     McGrew, D., Igoe, K., and M. Salter, "Fundamental
                 Elliptic Curve Cryptography Algorithms", RFC 6090,
                 February 2011.

   [RFC6467]     Kivinen, T., "Secure Password Framework for Internet
                 Key Exchange Version 2 (IKEv2)", RFC 6467,
                 December 2011.
```

---
### **12.2.  Informative References**

```text
   [BM92]        Bellovin, S. and M. Merritt, "Encrypted Key Exchange:
                 Password-Based Protocols Secure Against Dictionary
                 Attacks", Proceedings of the IEEE Symposium on Security
                 and Privacy, Oakland, 1992.

   [BMP00]       Boyko, V., MacKenzie, P., and S. Patel, "Provably
                 Secure Password-Authenticated Key Exchange Using
                 Diffie-Hellman", Proceedings of Eurocrypt 2000, LNCS
                 1807 Springer-Verlag, 2000.

   [BPR00]       Bellare, M., Pointcheval, D., and P. Rogaway,
                 "Authenticated Key Exchange Secure Against Dictionary
                 Attacks", Advances in Cryptology -- Eurocrypt '00,
                 Lecture Notes in Computer Science Springer-Verlag,
                 2000.

   [RFC4086]     Eastlake, D., Schiller, J., and S. Crocker, "Randomness
                 Requirements for Security", BCP 106, RFC 4086,
                 June 2005.

   [RFC4301]     Kent, S. and K. Seo, "Security Architecture for the
                 Internet Protocol", RFC 4301, December 2005.

   [RFC5869]     Krawczyk, H. and P. Eronen, "HMAC-based Extract-and-
                 Expand Key Derivation Function (HKDF)", RFC 5869,
                 May 2010.

   [RFC5931]     Harkins, D. and G. Zorn, "Extensible Authentication
                 Protocol (EAP) Authentication Using Only a Password",
                 RFC 5931, August 2010.

   [SAE]         Harkins, D., "Simultaneous Authentication of Equals: A
                 Secure, Password-Based Key Exchange for Mesh Networks",
                 Proceedings of the 2008 Second International Conference
                 on Sensor Technologies and Applications Volume 00,
                 2008.
```

---
# **Author's Address**

Dan Harkins Aruba Networks 1322 Crossman Avenue Sunnyvale, CA 94089-1113 미국

```text
   EMail: dharkins@arubanetworks.com
```