

```text
Network Working Group                                           J. Myers
Request for Comments: 1939                               Carnegie Mellon
STD: 53                                                          M. Rose
Obsoletes: 1725                             Dover Beach Consulting, Inc.
Category: Standards Track                                       May 1996

                    Post Office Protocol - Version 3
```

---
# **Status of this Memo**

이 문서는 인터넷 커뮤니티를 위한 인터넷 표준 추적 프로토콜을 지정하고 개선을 위한 토론 및 제안을 요청합니다. 이 프로토콜의 표준화 상태 및 상태에 대해서는 "Internet Official Protocol Standards"\(STD 1\) 최신판을 참조하십시오. 이 메모의 배포는 무제한입니다.

---
# **Table of Contents**

```text
   1. Introduction ................................................    2
   2. A Short Digression ..........................................    2
   3. Basic Operation .............................................    3
   4. The AUTHORIZATION State .....................................    4
      QUIT Command ................................................    5
   5. The TRANSACTION State .......................................    5
      STAT Command ................................................    6
      LIST Command ................................................    6
      RETR Command ................................................    8
      DELE Command ................................................    8
      NOOP Command ................................................    9
      RSET Command ................................................    9
   6. The UPDATE State ............................................   10
      QUIT Command ................................................   10
   7. Optional POP3 Commands ......................................   11
      TOP Command .................................................   11
      UIDL Command ................................................   12
      USER Command ................................................   13
      PASS Command ................................................   14
      APOP Command ................................................   15
   8. Scaling and Operational Considerations ......................   16
   9. POP3 Command Summary ........................................   18
   10. Example POP3 Session .......................................   19
   11. Message Format .............................................   19
   12. References .................................................   20
   13. Security Considerations ....................................   20
   14. Acknowledgements ...........................................   20
   15. Authors' Addresses .........................................   21
   Appendix A. Differences from RFC 1725 ..........................   22
   Appendix B. Command Index ......................................   23
```

---
## **1. Introduction**

인터넷의 특정 유형의 소규모 노드에서는 MTS\(메시지 전송 시스템\)를 유지 관리하는 것이 비현실적인 경우가 많습니다. 예를 들어, 워크스테이션에는 SMTP 서버\[RFC821\] 및 관련 로컬 메일 전달 시스템이 상주하고 지속적으로 실행되도록 허용하기 위한 충분한 리소스\(주기, 디스크 공간\)가 없을 수 있습니다. 마찬가지로 개인용 컴퓨터를 IP 스타일 네트워크에 오랫동안 상호 연결된 상태로 유지하는 것은 비용이 많이 들거나 불가능할 수 있습니다\(노드에는 "연결"이라고 알려진 리소스가 부족함\).

그럼에도 불구하고 이러한 작은 노드에서 메일을 관리할 수 있다는 것은 종종 매우 유용하며 메일 처리 작업을 지원하기 위해 사용자 에이전트\(UA\)를 지원하는 경우가 많습니다. 이 문제를 해결하기 위해 MTS 엔터티를 지원할 수 있는 노드는 부여된 권한이 적은 노드에 메일 드롭 서비스를 제공합니다. POP3\(Post Office Protocol - 버전 3\)는 워크스테이션이 유용한 방식으로 서버 호스트의 메일 드롭에 동적으로 액세스할 수 있도록 하기 위한 것입니다. 일반적으로 이는 POP3 프로토콜을 사용하여 워크스테이션이 서버에 보관된 메일을 검색할 수 있음을 의미합니다.

POP3는 서버에서 광범위한 메일 조작 작업을 제공하기 위한 것이 아닙니다. 일반적으로 메일은 다운로드된 후 삭제됩니다. 보다 발전된\(그리고 복잡한\) 프로토콜인 IMAP4는 \[RFC1730\]에서 논의됩니다.

이 메모의 나머지 부분에서 "클라이언트 호스트"라는 용어는 POP3 서비스를 사용하는 호스트를 의미하고 "서버 호스트"라는 용어는 POP3 서비스를 제공하는 호스트를 의미합니다.

---
## **2. A Short Digression**

이 메모는 클라이언트 호스트가 전송 시스템에 메일을 입력하는 방법을 지정하지 않지만 이 메모의 철학과 일치하는 방법이 여기에 제시되어 있습니다.

- 클라이언트 호스트의 사용자 에이전트가 전송 시스템에 메시지를 입력하려고 할 때 릴레이 호스트에 대한 SMTP 연결을 설정하고 모든 메일을 해당 호스트로 보냅니다. 이 릴레이 호스트는 클라이언트 호스트의 POP3 서버 호스트일 수 있지만 반드시 그럴 필요는 없습니다. 물론 릴레이 호스트는 임의의 수신자 주소로 메일을 배달하기 위해 메일을 수락해야 하며, 모든 SMTP 서버에 해당 기능이 필요한 것은 아닙니다.

---
## **3. Basic Operation**

처음에 서버 호스트는 TCP 포트 110을 수신하여 POP3 서비스를 시작합니다. 클라이언트 호스트가 서비스를 사용하려고 하면 서버 호스트와 TCP 연결을 설정합니다. 연결이 설정되면 POP3 서버가 인사말을 보냅니다. 그런 다음 클라이언트와 POP3 서버는 연결이 닫히거나 중단될 때까지 각각 명령과 응답을 교환합니다.

POP3의 명령은 대소문자를 구분하지 않는 키워드로 구성되며 그 뒤에 하나 이상의 인수가 올 수 있습니다. 모든 명령은 CRLF 쌍으로 종료됩니다. 키워드와 인수는 인쇄 가능한 ASCII 문자로 구성됩니다. 키워드와 인수는 각각 단일 공백 ​​문자로 구분됩니다. 키워드의 길이는 3\~4자입니다. 각 인수의 길이는 최대 40자까지 가능합니다.

POP3의 응답은 상태 표시기와 키워드, 추가 정보로 구성됩니다. 모든 응답은 CRLF 쌍으로 종료됩니다. 응답은 CRLF 종료 문자를 포함하여 최대 512자까지 가능합니다. 현재 긍정적\("+OK"\)과 부정적\("-ERR"\)의 두 가지 상태 표시기가 있습니다. 서버는 "+OK" 및 "-ERR"을 대문자로 보내야 합니다.\(MUST\)

특정 명령에 대한 응답은 여러 줄입니다. 아래에 명확하게 표시된 이러한 경우에는 응답의 첫 번째 라인과 CRLF를 보낸 후 추가 라인이 전송되고 각각 CRLF 쌍으로 종료됩니다. 응답의 모든 라인이 전송되면 종료 옥텟\(10진수 코드 046, "."\)과 CRLF 쌍으로 구성된 마지막 라인이 전송됩니다. 여러 줄 응답의 줄이 종료 옥텟으로 시작하는 경우 해당 줄은 응답 줄 앞에 종료 옥텟을 추가하여 "바이트로 채워집니다". 따라서 여러 줄의 응답은 5개의 옥텟 "CRLF.CRLF"로 종료됩니다. 여러 줄의 응답을 검사할 때 클라이언트는 해당 줄이 종료 옥텟으로 시작하는지 확인합니다. 그렇다면 CRLF 이외의 옥텟이 뒤따르면 줄의 첫 번째 옥텟\(종료 옥텟\)이 제거됩니다. 그렇다면 CRLF가 종료 문자 바로 뒤에 오면 POP 서버의 응답이 종료되고 ".CRLF"가 포함된 줄은 여러 줄 응답의 일부로 간주되지 않습니다.

POP3 세션은 수명 동안 여러 상태를 거쳐 진행됩니다. TCP 연결이 열리고 POP3 서버가 인사말을 보내면 세션은 AUTHORIZATION 상태로 들어갑니다. 이 상태에서 클라이언트는 POP3 서버에 대해 자신을 식별해야 합니다. 클라이언트가 이 작업을 성공적으로 수행하면 서버는 클라이언트의 메일 드롭과 관련된 리소스를 획득하고 세션은 TRANSACTION 상태로 들어갑니다. 이 상태에서 클라이언트는 POP3 서버 측에 작업을 요청합니다. 클라이언트가

QUIT 명령을 실행하면 세션은 UPDATE 상태로 들어갑니다. 이 상태에서 POP3 서버는 TRANSACTION 상태 동안 획득한 모든 리소스를 해제하고 작별 인사를 합니다. 그런 다음 TCP 연결이 닫힙니다.

서버는 인식되지 않거나 구현되지 않았거나 구문적으로 잘못된 명령에 대해 부정적인 상태 표시기로 응답해야 합니다. 서버는 세션이 잘못된 상태에 있을 때 발행된 명령에 부정적인 상태 표시기로 응답해야 합니다. 클라이언트가 선택적 명령을 구현하지 않는 서버와 명령을 처리할 의사가 없거나 처리할 수 없는 서버를 구별하는 일반적인 방법은 없습니다.\(MUST, MUST\)

POP3 서버에는 비활성 자동 로그아웃 타이머가 있을 수 있습니다. 이러한 타이머는 최소 10분 동안 지속되어야 합니다. 해당 간격 동안 클라이언트로부터 명령을 수신하면 자동 로그아웃 타이머가 재설정됩니다. 타이머가 만료되면 세션은 업데이트 상태로 들어가지 않습니다. 서버는 메시지를 제거하거나 클라이언트에 응답을 보내지 않고 TCP 연결을 닫아야 합니다.\(MAY, MUST\)

---
## **4. The AUTHORIZATION State**

POP3 클라이언트가 TCP 연결을 열면 POP3 서버는 한 줄의 인사말을 발행합니다. 이것은 긍정적인 반응일 수 있습니다. 예를 들면 다음과 같습니다.

```text
      S:  +OK POP3 server ready
```

POP3 세션은 이제 AUTHORIZATION 상태입니다. 이제 클라이언트는 POP3 서버에 대해 자신을 식별하고 인증해야 합니다. 이 문서에는 이를 수행하는 두 가지 가능한 메커니즘, 즉 USER 및 PASS 명령 조합과 APOP 명령이 설명되어 있습니다. 두 메커니즘 모두 이 문서의 뒷부분에 설명되어 있습니다. 추가 인증 메커니즘은 \[RFC1734\]에 설명되어 있습니다. 모든 POP3 서버에 필요한 단일 인증 메커니즘은 없지만 POP3 서버는 물론 최소한 하나의 인증 메커니즘을 지원해야 합니다.

POP3 서버가 인증 명령을 사용하여 클라이언트에게 적절한 메일 드롭에 대한 액세스 권한을 부여해야 한다고 결정하면 POP3 서버는 필요에 따라 메일 드롭에 대한 배타적 액세스 잠금을 획득하여 이전에 메시지가 수정되거나 제거되는 것을 방지합니다. 세션이 UPDATE 상태로 들어갑니다. 잠금이 성공적으로 획득되면 POP3 서버는 긍정적인 상태 표시기로 응답합니다. 이제 POP3 세션은 삭제된 것으로 표시된 메시지 없이 TRANSACTION 상태로 들어갑니다. 어떤 이유로 메일드롭을 열 수 없는 경우\(예: 잠금을 획득할 수 없는 경우\) 클라이언트는 해당 메일에 대한 액세스가 거부됩니다.

maildrop 또는 maildrop을 구문 분석할 수 없음\), POP3 서버는 부정적인 상태 표시기로 응답합니다. \(잠금이 획득되었지만 POP3 서버가 부정적인 상태 표시기로 응답하려는 경우 POP3 서버는 명령을 거부하기 전에 잠금을 해제해야 합니다.\) 부정적인 상태 표시기를 반환한 후 서버는 연결을 닫을 수 있습니다. 서버가 연결을 닫지 않으면 클라이언트는 새 인증 명령을 실행하고 다시 시작하거나 QUIT 명령을 실행할 수 있습니다.

POP3 서버가 메일드롭을 연 후 각 메시지에 메시지 번호를 할당하고 각 메시지의 크기를 옥텟으로 기록합니다. 메일드롭의 첫 번째 메시지에는 메시지 번호 "1"이 할당되고, 두 번째 메시지에는 "2"가 할당되는 식으로, 메일드롭의 n번째 메시지에는 메시지 번호 "n"이 할당됩니다. POP3 명령 및 응답에서 모든 메시지 번호와 메시지 크기는 10진수\(즉, 10진수\)로 표현됩니다.

다음은 AUTHORIZATION 상태에서 사용될 때 QUIT 명령에 대한 요약입니다.

```text
      QUIT

         Arguments: none

         Restrictions: none

         Possible Responses:
             +OK

         Examples:
             C: QUIT
             S: +OK dewey POP3 server signing off
```

---
## **5. The TRANSACTION State**

클라이언트가 POP3 서버에 대해 자신을 성공적으로 식별하고 POP3 서버가 적절한 메일 드롭을 잠근 후 열면 POP3 세션은 이제 TRANSACTION 상태가 됩니다. 이제 클라이언트는 다음 POP3 명령 중 하나를 반복적으로 실행할 수 있습니다. 각 명령 후에 POP3 서버는 응답을 발행합니다. 결국 클라이언트는 QUIT 명령을 실행하고 POP3 세션은 UPDATE 상태로 들어갑니다.

다음은 TRANSACTION 상태에서 유효한 POP3 명령입니다.

```text
      STAT

         Arguments: none
```

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버는 메일드롭에 대한 정보가 포함된 줄로 긍정적인 응답을 보냅니다. 이 행을 해당 메일드롭에 대한 "드롭 목록"이라고 합니다.

구문 분석을 단순화하기 위해 모든 POP3 서버는

- 드롭 목록에 특정 형식을 사용해야 합니다. 긍정적인 응답은 "+OK" 다음에 단일 공백, 메일드롭에 있는 메시지 수, 단일 공백 ​​및 메일드롭의 크기\(옥텟\)로 구성됩니다. 이 메모는 우편물 크기에 따른 요구사항을 제시하지 않습니다. 최소 구현에서는 해당 응답 줄을 CRLF 쌍으로 끝내야 합니다. 보다 고급 구현에는 다른 정보가 포함될 수 있습니다.

- 참고: 이 메모는 구현이 드롭 목록에 추가 정보를 제공하는 것을 강력히 권장합니다. 클라이언트가 메일드롭의 메시지를 구문 분석할 수 있도록 허용하는 기타 선택적 기능은 나중에 논의됩니다.

- 삭제된 것으로 표시된 메시지는 총계에 포함되지 않습니다.

```text
         Possible Responses:
             +OK nn mm

         Examples:
             C: STAT
             S: +OK 2 320

      LIST [msg]
```

인수:

- 메시지 번호\(선택 사항\). 존재하는 경우 삭제된 것으로 표시된 메시지를 참조할 수 없습니다.

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- 인수가 제공되고 POP3 서버가 해당 메시지에 대한 정보가 포함된 줄과 함께 긍정적인 응답을 발행하는 경우. 이 줄을 해당 메시지에 대한 "스캔 목록"이라고 합니다.

- 인수가 제공되지 않고 POP3 서버가 긍정적인 응답을 발행하는 경우 제공된 응답은 여러 줄입니다. 초기 +OK 이후, maildrop의 각 메시지에 대해 POP3 서버는 해당 메시지에 대한 정보가 포함된 줄로 응답합니다. 이 줄은 해당 메시지에 대한 "스캔 목록"이라고도 합니다. 메일드롭에 메시지가 없으면 POP3 서버는 검색 목록 없이 응답합니다. 즉, 종료 옥텟과 CRLF 쌍이 포함된 줄이 뒤따르는 긍정적인 응답을 발행합니다.

구문 분석을 단순화하기 위해 모든 POP3 서버는

- 스캔 목록에 특정 형식을 사용해야 합니다. 스캔 목록은 메시지의 메시지 번호, 단일 공백 ​​및 옥텟 단위의 메시지의 정확한 크기로 구성됩니다. 메시지의 정확한 크기를 계산하는 방법은 아래 "메시지 형식" 섹션에 설명되어 있습니다. 이 메모는 스캔 목록에서 메시지 크기를 따르는 것에 대한 요구 사항을 지정하지 않습니다. 최소 구현에서는 해당 응답 줄을 CRLF 쌍으로 끝내야 합니다. 보다 고급 구현에는 메시지에서 구문 분석된 다른 정보가 포함될 수 있습니다.

- 참고: 이 메모는 구현이 스캔 목록에 추가 정보를 제공하는 것을 강력히 권장합니다. 클라이언트가 메일드롭의 메시지를 구문 분석할 수 있도록 허용하는 기타 선택적 기능은 나중에 논의됩니다.

- 삭제된 것으로 표시된 메시지는 목록에 표시되지 않습니다.

```text
         Possible Responses:
             +OK scan listing follows
             -ERR no such message

         Examples:
             C: LIST
             S: +OK 2 messages (320 octets)
             S: 1 120

             S: 2 200
             S: .
               ...
             C: LIST 2
             S: +OK 2 200
               ...
             C: LIST 3
             S: -ERR no such message, only 2 messages in maildrop

      RETR msg
```

인수:

- 삭제된 것으로 표시된 메시지를 참조할 수 없는 메시지 번호\(필수\)

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버가 긍정적인 응답을 발행하면 제공된 응답은 여러 줄입니다. 초기 +OK 이후에 POP3 서버는 \(모든 여러 줄 응답과 마찬가지로\) 종료 문자를 바이트로 채우도록 주의하면서 주어진 메시지 번호에 해당하는 메시지를 보냅니다.

```text
         Possible Responses:
             +OK message follows
             -ERR no such message

         Examples:
             C: RETR 1
             S: +OK 120 octets
             S: <the POP3 server sends the entire message here>
             S: .

      DELE msg
```

인수:

- 삭제된 것으로 표시된 메시지를 참조할 수 없는 메시지 번호\(필수\)

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버는 메시지를 삭제된 것으로 표시합니다. POP3 명령의 메시지와 관련된 메시지 번호에 대한 향후 참조는 오류를 생성합니다. POP3 서버는 POP3 세션이 UPDATE 상태가 될 때까지 실제로 메시지를 삭제하지 않습니다.

```text
         Possible Responses:
             +OK message deleted
             -ERR no such message

         Examples:
             C: DELE 1
             S: +OK message 1 deleted
                ...
             C: DELE 2
             S: -ERR message 2 already deleted

      NOOP

         Arguments: none
```

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버는 아무 작업도 수행하지 않으며 단지 긍정적인 응답으로만 응답합니다.

```text
         Possible Responses:
             +OK

         Examples:
             C: NOOP
             S: +OK

      RSET

         Arguments: none
```

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버에 의해 삭제된 것으로 표시된 메시지가 있으면 표시가 해제됩니다. 그러면 POP3 서버가 응답합니다.

- 긍정적인 반응으로.

```text
         Possible Responses:
             +OK

         Examples:
             C: RSET
             S: +OK maildrop has 2 messages (320 octets)
```

---
## **6. The UPDATE State**

클라이언트가 TRANSACTION 상태에서 QUIT 명령을 실행하면 POP3 세션은 UPDATE 상태로 들어갑니다. \(클라이언트가 AUTHORIZATION 상태에서 QUIT 명령을 실행하면 POP3 세션은 종료되지만 UPDATE 상태로 들어가지는 않습니다.\)

클라이언트가 발행한 QUIT 명령 이외의 이유로 세션이 종료되면 POP3 세션은 UPDATE 상태로 들어가지 않으며 메일 드롭에서 어떤 메시지도 제거해서는 안 됩니다.\(MUST\)

```text
      QUIT

         Arguments: none

         Restrictions: none
```

논의:

- POP3 서버는 메일 드롭에서 삭제된 것으로 표시된 모든 메시지를 제거하고 이 작업의 상태에 대해 응답합니다. 메시지를 제거하는 동안 리소스 부족과 같은 오류가 발생하면 메일 드롭으로 인해 삭제된 것으로 표시된 메시지 중 일부가 제거되거나 전혀 제거되지 않을 수 있습니다. 어떤 경우에도 서버는 삭제된 것으로 표시되지 않은 메시지를 제거할 수 없습니다.

- 제거 성공 여부에 관계없이 서버는 메일 드롭에 대한 배타적 액세스 잠금을 해제하고 TCP 연결을 닫습니다.

```text
         Possible Responses:
             +OK
             -ERR some deleted messages not removed
```

예:

- C: 종료 S: +OK 듀이 POP3 서버 로그오프\(메일드롭 비어 있음\) ... C: 종료

```text
             S: +OK dewey POP3 server signing off (2 messages left)
                ...
```

---
## **7. Optional POP3 Commands**

위에서 설명한 POP3 명령은 POP3 서버의 모든 최소 구현에서 지원되어야 합니다.

아래에 설명된 선택적 POP3 명령을 사용하면 간단한 POP3 서버 구현을 유지하면서 POP3 클라이언트가 메시지를 더 자유롭게 처리할 수 있습니다.

- 참고: 이 메모는 증강된 드롭 및 스캔 목록을 개발하는 대신 이러한 명령을 지원하도록 구현을 강력히 권장합니다. 간단히 말해서, 이 메모의 철학은 POP3 서버가 아닌 POP3 클라이언트 부분에 지능을 두는 것입니다.

```text
      TOP msg n

         Arguments:
             a message-number (required) which may NOT refer to to a
             message marked as deleted, and a non-negative number
             of lines (required)
```

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- POP3 서버가 긍정적인 응답을 발행하면 제공된 응답은 여러 줄입니다. 초기 +OK 후 POP3 서버는 메시지의 헤더, 헤더와 본문을 구분하는 빈 줄, 그리고 표시된 메시지 본문의 줄 수를 전송합니다. 이때 종료 문자를 바이트로 채우도록 주의합니다. 모든 여러 줄 응답\).

- POP3 클라이언트가 요청한 라인 수가 본문의 라인 수보다 많으면 POP3 서버가 전체 메시지를 보냅니다.

가능한 응답:

- +OK 메시지 상단이 이어집니다. -ERR 해당 메시지가 없습니다.

```text
         Examples:
             C: TOP 1 10
             S: +OK

             S: <the POP3 server sends the headers of the
                message, a blank line, and the first 10 lines
                of the body of the message>
             S: .
                ...
             C: TOP 100 3
             S: -ERR no such message

      UIDL [msg]
```

인수:

- 메시지 번호\(선택 사항\). 존재하는 경우 삭제된 것으로 표시된 메시지를 참조할 수 없습니다.

제한:

- TRANSACTION 상태에서만 제공될 수 있습니다.

논의:

- 인수가 제공되고 POP3 서버가 해당 메시지에 대한 정보가 포함된 줄과 함께 긍정적인 응답을 발행하는 경우. 이 줄을 해당 메시지에 대한 "고유 ID 목록"이라고 합니다.

- 인수가 제공되지 않고 POP3 서버가 긍정적인 응답을 발행하는 경우 제공된 응답은 여러 줄입니다. 초기 +OK 이후, maildrop의 각 메시지에 대해 POP3 서버는 해당 메시지에 대한 정보가 포함된 줄로 응답합니다. 이 줄을 해당 메시지에 대한 "고유 ID 목록"이라고 합니다.

- 구문 분석을 단순화하기 위해 모든 POP3 서버는 고유 ID 목록에 특정 형식을 사용해야 합니다. 고유 ID 목록은 메시지의 메시지 번호, 그 뒤에 단일 공백 ​​및 메시지의 고유 ID로 구성됩니다. 고유 ID 목록의 고유 ID 뒤에는 정보가 없습니다.

- 메시지의 고유 ID는 0x21\~0x7E 범위의 1\~70자로 구성된 임의의 서버 결정 문자열로, 메일 드롭 내에서 메시지를 고유하게 식별하고 세션 전반에 걸쳐 지속됩니다. UPDATE 상태로 진입하지 않고 세션이 종료되는 경우에도 이 지속성은 필요합니다. 서버는 고유 ID를 사용하는 엔터티가 존재하는 한 특정 메일 드롭에서 고유 ID를 재사용해서는 안 됩니다.

- 삭제된 것으로 표시된 메시지는 목록에 표시되지 않습니다.

```text
          While it is generally preferable for server implementations
          to store arbitrarily assigned unique-ids in the maildrop,
```

- 이 사양은 고유 ID가 메시지의 해시로 계산되도록 허용하기 위한 것입니다. 클라이언트는 메일드롭에 있는 두 개의 동일한 메시지 사본이 동일한 고유 ID를 갖는 상황을 처리할 수 있어야 합니다.

```text
      Possible Responses:
          +OK unique-id listing follows
          -ERR no such message
```

예:

- C: UIDL S: +OK S: 1 whqtswO00WBw418f9t5JxYwZ S: 2 QhdPYR:00WBw1Ph7x7 S: . ... C: UIDL 2 S: +OK 2 QhdPYR:00WBw1Ph7x7 ... C: UIDL 3 S: -ERR 해당 메시지는 없으며 메일드롭에는 메시지가 2개만 있습니다.

```text
      USER name
```

인수:

- 메일함을 식별하는 문자열\(필수\), 이는 서버에만 중요합니다.

제한:

- POP3 인사말 이후 또는 실패한 USER 또는 PASS 명령 이후에 AUTHORIZATION 상태에서만 제공될 수 있습니다.

논의:

- USER 및 PASS 명령 조합을 사용하여 인증하려면 클라이언트가 먼저 USER 명령을 실행해야 합니다. POP3 서버가 긍정적인 상태 표시기\("+OK"\)로 응답하면 클라이언트는 PASS 명령을 실행하여 인증을 완료하거나 QUIT 명령을 실행하여 POP3 세션을 종료할 수 있습니다. POP3 서버가 USER 명령에 대해 부정적인 상태 표시기\("-ERR"\)로 응답하면 클라이언트는 새 인증 명령을 발행하거나 QUIT 명령을 발행할 수 있습니다.

```text
             The server may return a positive response even though no
             such mailbox exists.  The server may return a negative
             response if mailbox exists, but does not permit plaintext

             password authentication.
```

가능한 응답:

- +OK 이름은 유효한 메일함입니다. -ERR 메일함 이름을 들어본 적이 없습니다.

예:

- C: USER frated S: -ERR 죄송합니다. 여기에는 frated에 대한 사서함이 없습니다 ... C: USER mrose S: ​​+OK mrose는 진짜 멍청한 놈입니다

```text
      PASS string

         Arguments:
             a server/mailbox-specific password (required)
```

제한:

- USER 명령이 성공한 직후 AUTHORIZATION 상태에서만 제공될 수 있습니다.

논의:

- 클라이언트가 PASS 명령을 실행하면 POP3 서버는 USER 및 PASS 명령의 인수 쌍을 사용하여 클라이언트에게 적절한 메일 드롭에 대한 액세스 권한을 부여해야 하는지 결정합니다.

- PASS 명령에는 정확히 하나의 인수가 있으므로 POP3 서버는 인수 구분 기호 대신 암호의 일부로 인수의 공백을 처리할 수 있습니다.

가능한 응답:

- +OK 메일드롭이 잠겨 있고 준비됨 -ERR 잘못된 비밀번호 -ERR 메일드롭을 잠글 수 없음

```text
         Examples:
             C: USER mrose
             S: +OK mrose is a real hoopy frood
             C: PASS secret
             S: -ERR maildrop already locked
               ...
             C: USER mrose
             S: +OK mrose is a real hoopy frood
             C: PASS secret
             S: +OK mrose's maildrop has 2 messages (320 octets)

      APOP name digest

         Arguments:
             a string identifying a mailbox and a MD5 digest string
             (both required)
```

제한:

- POP3 인사말 이후 또는 실패한 USER 또는 PASS 명령 이후에 AUTHORIZATION 상태에서만 제공될 수 있습니다.

논의:

- 일반적으로 각 POP3 세션은 USER/PASS 교환으로 시작됩니다. 이로 인해 서버/사용자 ID별 비밀번호가 네트워크에서 암호화되지 않은 상태로 전송됩니다. POP3를 간헐적으로 사용하는 경우에는 상당한 위험이 발생하지 않을 수 있습니다. 그러나 많은 POP3 클라이언트 구현은 정기적으로 POP3 서버에 연결하여 새 메일을 확인합니다. 또한 세션 시작 간격은 약 5분일 수 있습니다. 따라서 비밀번호 캡처의 위험이 크게 높아집니다.

- 원본 인증과 재생 방지를 모두 제공하지만 네트워크를 통해 암호화되지 않은 비밀번호를 보내는 것을 포함하지 않는 대체 인증 방법이 필요합니다. APOP 명령은 이 기능을 제공합니다.

- APOP 명령을 구현하는 POP3 서버는 배너 인사말에 타임스탬프를 포함합니다. 타임스탬프의 구문은 \[RFC822\]의 \`msg-id'에 해당하며 POP3 서버가 배너 인사말을 발행할 때마다 달라야 합니다. 예를 들어, POP3 서버의 각 인스턴스에 대해 별도의 UNIX 프로세스가 사용되는 UNIX 구현에서 타임스탬프 구문은 다음과 같습니다.\(MUST\)

```text
                <process-ID.clock@hostname>
```

- 여기서 \`process-ID'는 프로세스 PID의 10진수 값이고, clock은 시스템 시계의 10진수 값이며, 호스트 이름은 POP3 서버가 실행 중인 호스트에 해당하는 정규화된 도메인 이름입니다.

```text
             The POP3 client makes note of this timestamp, and then
             issues the APOP command.  The `name' parameter has
             identical semantics to the `name' parameter of the USER
             command. The `digest' parameter is calculated by applying
             the MD5 algorithm [RFC1321] to a string consisting of the
             timestamp (including angle-brackets) followed by a shared
```

-         비밀. 이 공유 비밀은 POP3 클라이언트와 서버에만 알려진 문자열입니다. 비밀을 알면 모든 엔터티가 명명된 사용자로 가장할 수 있으므로 비밀의 무단 공개를 방지하기 위해 세심한 주의를 기울여야 합니다. \`digest' 매개변수 자체는 소문자 ASCII 문자를 사용하여 16진수 형식으로 전송되는 16옥텟 값입니다.

- POP3 서버는 APOP 명령을 수신하면 제공된 다이제스트를 확인합니다. 다이제스트가 정확하면 POP3 서버는 긍정적인 응답을 보내고 POP3 세션은 TRANSACTION 상태로 들어갑니다. 그렇지 않으면 부정적인 응답이 발행되고 POP3 세션은 AUTHORIZATION 상태로 유지됩니다.

- 공유 비밀의 길이가 길어질수록 이를 도출하는 것도 어려워집니다. 따라서 공유 비밀은 긴 문자열이어야 합니다\(아래 표시된 8자 예보다 상당히 길어야 함\).

가능한 응답:

- +OK 메일드롭이 잠겨 있고 준비되었습니다. -ERR 권한이 거부되었습니다.

```text
         Examples:
             S: +OK POP3 server ready <1896.697170952@dbc.mtview.ca.us>
             C: APOP mrose c4c9334bac560ecc979e58001b3e22fb
             S: +OK maildrop has 1 message (369 octets)

             In this example, the shared  secret  is  the  string  `tan-
             staaf'.  Hence, the MD5 algorithm is applied to the string

                <1896.697170952@dbc.mtview.ca.us>tanstaaf

             which produces a digest value of

                c4c9334bac560ecc979e58001b3e22fb
```

---
## **8. Scaling and Operational Considerations**

위에서 설명한 선택적 기능 중 일부가 POP3 프로토콜에 추가되었기 때문에 대부분의 사용자가 서로 관련이 없는 대규모 상업용 우체국 운영에서 이를 사용하는 경험이 축적되었습니다. 이러한 상황과 기타 상황에서 POP3 클라이언트의 사용자와 공급업체는 UIDL 명령을 사용하고 DELE 명령을 실행하지 않는 조합이 일반적으로 IMAP과 관련된 "반영구 저장소로서의 메일 드롭" 기능의 약한 버전을 제공할 수 있음을 발견했습니다. 물론 다른 능력도

새로 도착한 메시지에 대해 기존 연결을 폴링하고 서버의 여러 폴더를 지원하는 것과 같은 IMAP은 POP3에 없습니다.

일반 사용자가 이러한 기능을 사용하게 되면 이미 읽은 메시지가 서버에 무한정 쌓이는 경향이 있었습니다. 이는 서버 운영자의 입장에서는 명백히 바람직하지 않은 행동 패턴입니다. 이러한 상황은 POP3의 제한된 기능으로 인해 수백 또는 수천 개의 메시지가 포함된 메일드롭을 효율적으로 처리할 수 없다는 사실로 인해 더욱 악화됩니다.

결과적으로, 대규모 다중 사용자 서버의 운영자, 특히 사용자가 POP3를 통해서만 메일드롭에 액세스할 수 있는 서버의 운영자는 다음과 같은 옵션을 고려할 것을 권장합니다.

\* 사용자별 메일드롭 저장 할당량 등을 부과합니다.

- 이 옵션의 단점은 메시지가 누적되면 사용자가 메일드랍으로 새 메시지를 받을 수 없게 될 수 있다는 것입니다. 이 옵션을 선택하는 사이트는 아마도 사용자의 메일함에 적절한 메시지를 삽입하여 할당량이 임박했거나 현재 할당량에 도달했음을 사용자에게 알려야 합니다.

\* 서버의 메일 보존과 관련된 사이트 정책을 시행합니다.

- 사이트는 읽은 메시지와 읽지 않은 메시지 모두 서버에 저장하고 보관하는 것과 관련된 로컬 정책을 자유롭게 설정할 수 있습니다. 예를 들어 사이트에서는 60일 후에 읽지 않은 메시지를 서버에서 삭제하고, 읽은 메시지를 7일 후에 삭제할 수 있습니다. 이러한 메시지 삭제는 POP3 프로토콜 범위를 벗어나며 프로토콜 위반으로 간주되지 않습니다.

- 메시지 삭제 정책을 시행하는 서버 운영자는 모든 사용자가 시행 중인 정책을 인지할 수 있도록 주의를 기울여야 합니다.

- 클라이언트는 사이트 정책이 메시지 삭제를 자동화할 것이라고 가정해서는 안 되며, 적절한 경우 DELE 명령을 사용하여 메시지를 명시적으로 계속 삭제해야 합니다.

- 사이트 메시지 삭제 정책을 시행하는 것은 사용자 커뮤니티에 혼란을 줄 수 있다는 점에 유의해야 합니다. 왜냐하면 POP3 클라이언트에는 서버에서 실제로 지원되지 않는 메일을 서버에 남겨 두는 구성 옵션이 포함될 수 있기 때문입니다.

- 사이트 정책의 특별한 경우 중 하나는 메시지를 서버에서 한 번만 다운로드할 수 있으며 다운로드가 완료된 후에는 삭제된다는 것입니다. 이는 POP3 서버에서 구현될 수 있습니다.

- 다음 메커니즘을 사용하는 소프트웨어: "QUIT에 의해 종료된 클라이언트의 POP3 로그인 이후 RETR 명령을 사용하여 세션 중에 다운로드된 모든 메시지를 삭제합니다." 클라이언트가 메시지를 성공적으로 수신하거나 저장하지 못했을 수 있으므로 연결이 비정상적으로 종료된 경우\(즉, 클라이언트로부터 QUIT를 수신하지 못한 경우\) 메시지를 삭제하지 않는 것이 중요합니다. 다운로드 및 삭제 정책을 구현하는 서버에서는 전체 메시지를 다운로드하는 대체 메커니즘으로 사용될 수 있는 선택적 TOP 명령을 비활성화하거나 제한할 수도 있습니다.

---
## **9. POP3 Command Summary**

```text
      Minimal POP3 Commands:

         USER name               valid in the AUTHORIZATION state
         PASS string
         QUIT

         STAT                    valid in the TRANSACTION state
         LIST [msg]
         RETR msg
         DELE msg
         NOOP
         RSET
         QUIT

      Optional POP3 Commands:

         APOP name digest        valid in the AUTHORIZATION state

         TOP msg n               valid in the TRANSACTION state
         UIDL [msg]

      POP3 Replies:

         +OK
         -ERR
```

- STAT, LIST 및 UIDL 명령을 제외하고 모든 명령에 대한 POP3 서버의 응답은 "+OK" 및 "-ERR"에만 중요합니다. 이 응답 이후에 발생하는 모든 텍스트는 클라이언트에서 무시될 수 있습니다.

---
## **10. Example POP3 Session**

S: <TCP 포트 110에서 연결 대기\>

- C: <연결 열기\> S: +OK POP3 서버 준비됨 <1896.697170952@dbc.mtview.ca.us\> C: APOP mrose c4c9334bac560ecc979e58001b3e22fb S: +OK mrose의 메일드롭에는 2개의 메시지\(320 옥텟\)가 있습니다. C: STAT S: +OK 2 320 C: LIST S: +OK 메시지 2개\(320옥텟\) S: 1 120 S: 2 200 S: . C: RETR 1 S: +OK 120 옥텟 S: <POP3 서버가 메시지 1을 보냅니다.\> S: . C: DELE 1 S: +OK 메시지 1이 삭제됨 C: RETR 2 S: +OK 200옥텟 S: <POP3 서버가 메시지 2를 보냅니다.\> S: . C: DELE 2 S: +OK 메시지 2 삭제됨 C: QUIT S: +OK 듀이 POP3 서버 로그오프\(maildrop 비어 있음\) C: <연결 닫기\> S: <다음 연결 대기\>

---
## **11. Message Format**

POP3 세션 중에 전송되는 모든 메시지는 인터넷 텍스트 메시지 형식 표준 \[RFC822\]을 따르는 것으로 가정됩니다.

서버 호스트에 있는 메시지의 옥텟 수는 줄 끝을 지정하는 로컬 규칙으로 인해 해당 메시지에 할당된 옥텟 수와 다를 수 있다는 점에 유의하는 것이 중요합니다. 일반적으로 POP3 세션의 AUTHORIZATION 상태 동안 POP3 서버는 메일드롭을 열 때 각 메시지의 크기를 옥텟 단위로 계산할 수 있습니다. 예를 들어, POP3 서버 호스트가 내부적으로 줄 끝을 단일 문자로 나타내는 경우 POP3 서버는 메시지에서 이 문자가 나타날 때마다 두 개의 옥텟으로 계산합니다. 종료 옥텟으로 시작하는 메시지의 행은 두 번 계산될 필요가 없습니다\(또한 있어서도 안 됩니다\). POP3 클라이언트는 여러 줄 응답을 수신할 때 바이트로 채워진 종료 문자를 모두 제거하기 때문입니다.

---
## **12. References**

```text
   [RFC821] Postel, J., "Simple Mail Transfer Protocol", STD 10, RFC
       821, USC/Information Sciences Institute, August 1982.
```

\[RFC822\] Crocker, D., "ARPA-인터넷 문자 메시지 형식의 표준", STD 11, RFC 822, University of Delaware, 1982년 8월.

\[RFC1321\] Rivest, R., "MD5 메시지 다이제스트 알고리즘", RFC 1321, MIT 컴퓨터 과학 연구소, 1992년 4월.

\[RFC1730\] Crispin, M., "인터넷 메시지 액세스 프로토콜 - 버전 4", RFC 1730, 워싱턴 대학교, 1994년 12월.

```text
   [RFC1734] Myers, J., "POP3 AUTHentication command", RFC 1734,
       Carnegie Mellon, December 1994.
```

---
## **13. Security Considerations**

APOP 명령을 사용하면 POP3 세션에 대한 원본 식별 및 재생 보호 기능이 제공되는 것으로 추측됩니다. 따라서 PASS 및 APOP 명령을 모두 구현하는 POP3 서버는 특정 사용자에게 두 가지 액세스 방법을 모두 허용해서는 안 됩니다. 즉, 지정된 사서함 이름에 대해 USER/PASS 명령 시퀀스나 APOP 명령 중 하나가 허용되지만 둘 다 허용될 수는 없습니다.

또한 공유 비밀의 길이가 길어질수록 이를 파생하는 것도 어려워집니다.

USER 명령에 -ERR로 응답하는 서버는 잠재적인 공격자에게 어떤 이름이 유효한지에 대한 단서를 제공합니다.

PASS 명령을 사용하면 네트워크를 통해 암호가 암호화되지 않은 상태로 전송됩니다.

RETR 및 TOP 명령을 사용하면 네트워크를 통해 메일이 암호화되지 않은 상태로 전송됩니다.

그렇지 않으면 이 메모에서는 보안 문제를 논의하지 않습니다.

---
## **14. Acknowledgements**

POP 계열은 길고 복잡한 역사를 가지고 있습니다. 주로 RFC 1460에 ​​대한 사소한 개정이지만 POP3는 RFC 918, 937 및 1081에 제시된 아이디어를 기반으로 합니다.

또한 Alfred Grimstad, Keith McCloghrie 및 Neil Ostroff는 APOP 명령에 대해 중요한 의견을 제시했습니다.

---
## **15. Authors' Addresses**

```text
   John G. Myers
   Carnegie-Mellon University
   5000 Forbes Ave
   Pittsburgh, PA 15213

   EMail: jgm+@cmu.edu

   Marshall T. Rose
   Dover Beach Consulting, Inc.
   420 Whisman Court
   Mountain View, CA  94043-2186

   EMail: mrose@dbc.mtview.ca.us
```

---
# **Appendix A. Differences from RFC 1725**

이 메모는 초안 표준인 RFC 1725의 개정판입니다. 해당 문서에서 다음과 같이 변경됩니다.

- - 명령 키워드가 대소문자를 구분하지 않음을 명시합니다.

- 서버가 "+OK" 및 "-ERR"를 전송해야 함을 지정합니다.

- 대문자.

- - 초기 인사말이 긍정적인 응답이어야 하는 문자열 대신 긍정적인 응답임을 지정합니다.

- - 구현되지 않은 명령의 동작을 명확하게 합니다.

- - USER 및 PASS 명령을 선택 사항으로 만듭니다.

- - USER 명령에 대해 가능한 응답 세트를 명확히 했습니다.

- USER 및 PASS의 예제 순서를 반대로 바꿉니다.

- 혼란을 줄이기 위한 명령입니다.

- - PASS 명령은 성공적인 USER 명령 직후에만 제공될 수 있음을 명확히 합니다.

- - UID의 지속성 요구 사항을 명확히 하고 일부 구현 참고 사항을 추가했습니다.

- - UID 길이 제한을 1\~70옥텟으로 지정합니다.

- 상태 표시기 길이 제한을 지정합니다.

- CRLF를 포함하여 512옥텟.

- - 빈 사서함에 인수가 없는 LIST가 성공을 반환함을 명확히 합니다.

- - LIST 명령의 참조를 메시지 형식 섹션에 추가합니다.

- - 실패 시 QUIT의 동작을 명확히 합니다.

- - APOP 명령과 함께 USER 명령의 사용을 암시하지 않도록 보안 섹션을 명확히 합니다.

- - RFC 1730 및 1734에 대한 참조를 추가합니다.

- - UA가 전송 시스템에 메일을 입력할 수 있는 방법을 명확히 합니다.

- - TOP 명령에 대한 두 번째 인수가 행 수임을 명시합니다.

- - 서버가 특정 사용자에 대해 PASS와 APOP를 모두 허용하지 않도록 보안 고려 사항 섹션의 제안을 "반드시"에서 "해야 함"으로 변경합니다.

- - 확장 및 운영 고려 사항에 대한 섹션을 추가합니다.

---
# **Appendix B. Command Index**

```text
       APOP .......................................................   15
       DELE .......................................................    8
       LIST .......................................................    6
       NOOP .......................................................    9
       PASS .......................................................   14
       QUIT .......................................................    5
       QUIT .......................................................   10
       RETR .......................................................    8
       RSET .......................................................    9
       STAT .......................................................    6
       TOP ........................................................   11
       UIDL .......................................................   12
       USER .......................................................   13
```