

```text
Internet Engineering Task Force (IETF)                     Y. Weingarten
Request for Comments: 6974
Category: Informational                                        S. Bryant
ISSN: 2070-1721                                            Cisco Systems
                                                           D. Ceccarelli
                                                             D. Caviglia
                                                             F. Fondelli
                                                                Ericsson
                                                                M. Corsi
                                                                  Altran
                                                                   B. Wu
                                                         ZTE Corporation
                                                                  X. Dai
                                                               July 2013
```

- 링 토폴로지에 대한 MPLS 전송 프로파일의 적용 가능성

---
# **Abstract**

이 문서에서는 링 토폴로지의 MPLS-TP\(MPLS 전송 프로필\)에 로컬 및 종단 간 기존 MPLS 보호 메커니즘의 적용 가능성을 제시합니다. 이 문서는 새로운 메커니즘이나 프로토콜을 제안하지 않습니다. 특히 링 토폴로지의 보호를 위한 MPLS-TP 보호 요구 사항은 "MPLS 전송 프로필 요구 사항"\(RFC 5654\) 및 "MPLS 전송 프로필\(MPLS-TP\) 생존 가능성 프레임워크"\(RFC 6372\)에서 설명됩니다. 이 문서에서는 링 토폴로지에서 RFC 6378에 정의된 선형 보호를 적용하여 대부분의 요구 사항을 충족하는 방법에 대해 설명합니다.

---
# **Status of This Memo**

이 문서는 인터넷 표준 추적 사양이 아닙니다. 정보 제공의 목적으로 게시됩니다.

이 문서는 IETF\(Internet Engineering Task Force\)의 제품입니다. 이는 IETF 커뮤니티의 합의를 나타냅니다. 공개 검토를 받았으며 IESG\(Internet Engineering Steering Group\)의 출판 승인을 받았습니다. IESG에서 승인한 모든 문서가 모든 수준의 인터넷 표준에 적합한 것은 아닙니다. RFC 5741의 섹션 2를 참조하십시오.

이 문서의 현재 상태, 정오표, 피드백 제공 방법에 대한 정보는 http://www.rfc-editor.org/info/rfc6974에서 얻을 수 있습니다.

---
# **Copyright Notice**

Copyright \(c\) 2013 IETF Trust 및 문서 작성자로 확인된 사람. 판권 소유.

이 문서는 이 문서의 발행일에 유효한 BCP 78 및 IETF 문서에 관한 IETF 트러스트의 법적 조항\(http://trustee.ietf.org/license-info\)의 적용을 받습니다. 이 문서와 관련된 귀하의 권리 및 제한 사항을 설명하므로 이 문서를 주의 깊게 검토하십시오. 이 문서에서 추출한 코드 구성 요소는 Trust Legal Provisions의 섹션 4.e에 설명된 대로 Simplified BSD License 텍스트를 포함해야 하며 Simplified BSD License에 설명된 대로 보증 없이 제공됩니다.

---
# **Table of Contents**

```text
   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
     1.1.  Problem Statement  . . . . . . . . . . . . . . . . . . . .  3
     1.2.  Scope of the Document  . . . . . . . . . . . . . . . . . .  4
     1.3.  Terminology and Notation . . . . . . . . . . . . . . . . .  5
   2.  Point-to-Point (P2P) Ring Protection . . . . . . . . . . . . .  6
     2.1.  Wrapping . . . . . . . . . . . . . . . . . . . . . . . . .  6
     2.2.  Steering . . . . . . . . . . . . . . . . . . . . . . . . .  8
     2.3.  SPME for P2P Protection of a Ring Topology . . . . . . . . 10
       2.3.1.  Path SPME for Steering . . . . . . . . . . . . . . . . 11
       2.3.2.  Wrapping Link Protection with Segment-Based SPME . . . 12
       2.3.3.  Wrapping Node Protection . . . . . . . . . . . . . . . 13
       2.3.4.  Wrapping for Link and Node Protection  . . . . . . . . 14
     2.4.  Analysis of P2P Protection . . . . . . . . . . . . . . . . 15
       2.4.1.  Recommendations for Protection of P2P Paths
               Traversing a Ring  . . . . . . . . . . . . . . . . . . 16
   3.  Point-to-Multipoint Protection . . . . . . . . . . . . . . . . 17
     3.1.  Wrapping for P2MP LSPs . . . . . . . . . . . . . . . . . . 17
       3.1.1.  Comparison of Wrapping and ROM-Wrapping  . . . . . . . 19
       3.1.2.  Multiple Failures Comparison . . . . . . . . . . . . . 20
     3.2.  Steering for P2MP Paths  . . . . . . . . . . . . . . . . . 21
       3.2.1.  Context Labels . . . . . . . . . . . . . . . . . . . . 21
       3.2.2.  Walk-Through Using Context Labels  . . . . . . . . . . 23
   4.  Coordination Protocol  . . . . . . . . . . . . . . . . . . . . 26
   5.  Conclusions and Recommendations  . . . . . . . . . . . . . . . 26
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . . 27
   7.  References . . . . . . . . . . . . . . . . . . . . . . . . . . 27
     7.1.  Normative References . . . . . . . . . . . . . . . . . . . 27
     7.2.  Informative References . . . . . . . . . . . . . . . . . . 27
   Appendix A.  Acknowledgements  . . . . . . . . . . . . . . . . . . 29
   Appendix B.  Contributors  . . . . . . . . . . . . . . . . . . . . 29
```

---
## **1.  Introduction**

MPLS 전송 프로필\(MPLS-TP\)은 IETF\(Internet Engineering Task Force\)와 ITU-T\(International Telecommunications Union Telecommunications Standardization Sector\) 간의 공동 노력의 일환으로 표준화되었습니다. 이러한 사양은 이러한 공동 노력을 통해 생성된 요구 사항을 기반으로 합니다.

MPLS-TP 요구사항 문서 \[RFC5654\]에는 문서에 정의된 대로 MPLS-TP 링을 구성하는 하위 네트워크를 포함할 수 있는 네트워크를 지원하기 위한 요구사항이 포함되어 있습니다. 그러나 이 문서에서는 링 토폴로지와 관련된 보호 요구 사항을 식별하지 않습니다. 요구 사항에는 네트워크가 다음을 최소화할 수 있는 경우 링 토폴로지에 적용되는 특정 보호 메커니즘을 개발할 수 있다고 명시되어 있습니다.

o 보호를 트리거하는 데 필요한 OAM 엔터티 수

o 필요한 복구 요소의 수

o 필요한 라벨 수

o 유지 관리 작업 중 제어 및 관리 평면 트랜잭션 수

o 제어 평면이 있는 경우 보호 중에 교환되는 신호 및 라우팅 정보의 영향

이 문서에서는 \[RFC6378\]에 정의된 일련의 기본 MPLS-TP 선형 보호 메커니즘을 적용하여 MPLS-TP 링을 통과하는 데이터 흐름을 보호하는 방법을 설명합니다. 이러한 메커니즘은 합리적인 시간 내에 전환 트리거로 인해 데이터 흐름 보호를 제공하고 위에 요약된 대로 \[RFC5654\]에 설정된 기준을 최적화합니다. 이 문서는 새로운 프로토콜 메커니즘이나 절차를 정의하지 않습니다.

\[RFC5654\]의 관련 항목에서는 상호 연결된 링에 필요한 지원을 다룹니다. 이 주제에는 추가 연구가 필요한 다양한 시나리오가 포함되어 있으며 이 문서에 설명된 원칙에 따라 별도의 문서에서 다루어질 것입니다.

---
### **1.1.  Problem Statement**

\[RFC5654\]에 정의된 링 토폴로지는 전송 네트워크에서 사용됩니다. 단일 링 토폴로지에 대한 보호 메커니즘을 설계할 때 다음 두 가지 경우를 모두 해결해야 합니다.

1. 링 노드에서 시작하거나 단일 수신 노드에서 MPLS-TP 가능 링으로 들어가고 단일 송신 노드에서 링을 빠져나가며 링 너머까지 계속되는 지점 간 전송 경로입니다.

2. 링이 지점 대 다중 지점 전송 경로의 분기점으로 사용되는 경우, 즉 전송 경로는 수신 노드의 MPLS-TP 가능 링에서 시작하거나 들어가며 여러 출구 노드를 통해 종료됩니다. , 아마도 링 너머로 계속될 수도 있습니다.

이 두 가지 상황 중 하나에서는 다음과 같은 다양한 사례를 해결해야 합니다.

1. 링 링크 중 하나가 오류 상태를 유발합니다. 이는 단방향 또는 양방향 오류일 수 있으며 인접 노드에서 감지해야 합니다.

2. 링 노드 중 하나가 오류 상태를 유발합니다. 이 조건은 항상 양방향 오류이며\(드물게 잘못된 구성의 경우에도 단방향 오류로 감지될 수 있음\), 인접한 두 링 노드에서 감지해야 합니다.

3. 특정 링 노드에 운영자 명령이 내려집니다. 노드나 링크의 작동 상태를 변경하거나 명시적으로 보호 작업을 트리거합니다. 운영자 명령은 노드 또는 링크의 작동 상태를 변경하거나 특정 링 노드에 대해 실행되는 보호 조치를 구체적으로 트리거합니다. 다양한 연산자 명령에 대한 설명은 \[RFC4427\]의 섹션 4.13에 나와 있습니다. 이러한 명령의 예로는 수동 전환, 강제 전환 및 지우기 작업이 있습니다.

이 문서에서 다루는 보호 도메인은 링을 통과하는 트래픽으로 제한됩니다. 링의 수신 노드 이전이나 송신 노드 너머의 전송 경로에 있는 보호 트리거는 다른 메커니즘에 의해 보호될 수 있습니다.

---
### **1.2.  Scope of the Document**

이 문서는 \[RFC6378\]에 정의된 선형 보호 적용을 기반으로 링 보호에 대한 \[RFC5654\]의 섹션 2.5.6.1에 나타나는 요구 사항을 다루고 있습니다. 상호 연결된 링의 지원과 상호 연결 노드 및 링크의 결함 보호에 관한 요구 사항 R93은 추가 연구 대상입니다.

또한 특정 노드 또는 범위의 잠금 지원을 요구하는 요구사항 R105는 선형 보호 메커니즘이 지원하는 정도까지만 지원됩니다.

---
### **1.3.  Terminology and Notation**

이 문서에 사용된 용어는 MPLS-TP 프레임워크 문서에 정의된 용어를 기반으로 합니다.

```text
   o  MPLS-TP framework [RFC5921]

   o  MPLS-TP OAM framework [RFC6371]

   o  MPLS-TP survivability framework [RFC6372]
```

MPLS-TP 프레임워크 문서 \[RFC5921\]는 MPLS-TP LSP\(레이블 전환 경로\)의 두 LSR\(레이블 전환 라우터\) 간에 정의할 수 있는 SPME\(하위 경로 유지 엔터티\) 구성을 정의합니다. 이 SPME는 동일 라우팅 양방향 경로로 구성될 수 있습니다. SPME는 전송 경로의 모든 세그먼트를 관리하고 모니터링할 수 있도록 정의됩니다. 이 개념은 MPLS-TP 링을 통과하는 트래픽 보호를 지원하기 위해 문서 전체에서 광범위하게 사용됩니다.

또한 보호 메커니즘을 통해 데이터 패킷을 리디렉션하는 것과 관련하여 레이블 스택을 사용하는 방법도 설명합니다. 레이블 스택의 내용을 설명하는 데 다음 구문이 사용됩니다.

1. 라벨 스택은 대괄호\("\[\]"\)로 묶입니다.

2. 스택의 각 레벨은 '|'로 구분됩니다. 성격. 라벨 스택에는 추가 레벨이 포함될 수 있습니다. 그러나 우리는 보호 메커니즘과 관련된 수준만 제시합니다.

3. 적용 가능한 경우 S 비트\(주어진 레이블이 레이블 스택의 맨 아래임을 나타냄\)는 레이블 내에서 문자열 '+S'로 표시됩니다. 레이블이 '+S' 로 표시되지 않으면 해당 레이블은 스택의 맨 아래 레이블일 수도 있고 아닐 수도 있습니다. '+S'는 주어진 라벨이 확실히 라벨 스택의 마지막 라벨임을 설명하는 것이 중요한 경우에만 표시됩니다.

4. 링의 입구 노드에 있는 LSP의 레이블은 문자열 "LI"로 표시되고, 링의 출구 지점에서 예상되는 LSP의 레이블은 문자열 "LE"로 표시됩니다. "LSE"는 SPME의 출구 LSR에서 예상되는 레이블을 나타냅니다\(예를 들어 섹션 2.3에 설명된 대로 링의 출구 지점과 다른 경우\).

5. 스택의 레이블 Pxi\(y\)는 LSR-x가 인덱스가 i인 SPME를 통해 LSR-y로 패킷을 전송하는 데 사용할 레이블을 나타냅니다.

예를 들어:

o 라벨 스택\[LI\]은 링의 입구 노드에서 수신된 라벨 스택을 나타냅니다. LI 뒤에 추가 레이블\(예: PW 레이블\)이 있을 수 있습니다. 그러나 이는 보호 시나리오에 대한 논의와는 관련이 없습니다.

o \[PB1\(G\) | LE\]는 LSR-B가 LSR-G로 데이터 패킷을 전송하기 위한 SPME-1 라벨이고, 두 번째 라벨은 패킷을 계속 전송하기 위해 출구 LSR이 사용하는 라벨인 스택을 나타냅니다. 원래 LSP.

o "LE"가 스택의 맨 아래 레이블인 경우 레이블 스택은 \[PB1\(G\) | LE+S\].

---
## **2.  Point-to-Point (P2P) Ring Protection**

역사적으로 SDH\(Synchronous Digital Hierarchy\) 사양 \[G.841\]을 기반으로 링 토폴로지에 적용되어 다양한 포럼에서 수행하기 위해 제안된 두 가지 보호 아키텍처 메커니즘인 "래핑"과 "스티어링"이 있습니다. 토폴로지 링 네트워크의 복구. 다음 하위 섹션에서는 MPLS 전송 네트워크에 적용되는 이 두 가지 메커니즘을 살펴봅니다.

---
### **2.1.  Wrapping**

```text
   Wrapping is defined as a local protection architecture.  This
   mechanism is local to the nodes that are neighbors to the detected
   fault.  When a fault is detected (either a link or node failure), the
   neighboring node can identify that the fault would prevent forwarding
   of the data along the data path.  Therefore, in order to continue to
   transmit the data along the path, there is a need to "wrap" all data
   traffic around the ring, on an alternate data path, until the arrives
   at the node that is on the opposite side of the fault.  When this
   far-side node also detects that there is a fault condition on the
   working path, it can identify that the data traffic that is arriving
   on the alternate (protecting) data path is intended for the "broken"
```

데이터 경로. 따라서 다시 로컬 결정을 내리면 원거리 노드는 링 세그먼트에서 나갈 때까지 데이터를 일반 작업 경로로 다시 래핑할 수 있습니다.

래핑 동작은 우회 또는 우회 터널을 사용하는 \[RFC4090\]에 정의된 MPLS-TE Fast Reroute와 유사합니다. MPLS에 Fast Reroute를 적용하면 우회 터널과 단일 레이블을 사용하여 모든 LSP를 래핑하거나 각 LSP마다 다른 레이블을 사용하여 우회 터널을 통해 실패한 링크 주변의 각 LSP 트래픽을 래핑하는 것이 가능합니다.

```text
                       ___ ######## ___ ######## ___
               ======>/LSR\********/LSR\***XX***/LSR\
                      \_B_/@@@@@@@@\_A_/        \_F_/
                        *@                       #*@
                        *@                       #*@
                        *@                       #*@
                       _*@          ___          #*@
                      /LSR\********/LSR\********/LSR\======>
                      \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/

                 ===> connected LSP  *** physical link
                 ###  working path   @@@ wrapped data path

                Figure 1: Wrapping Protection for P2P Path
```

LSR-B에서 LSR 링으로 들어가고 LSR-E에서 나가는 그림 1에 표시된 LSP를 생각해 보세요. 일반 작업 경로 LSP는 LSR B-A-F-E를 따릅니다. 링크 A<-\>F에서 오류가 감지되면 래핑 메커니즘은 LSR-A가 래핑된 데이터 경로 A-B-C-D-E-F에서 링 주위로 트래픽을 래핑하여 LSR-F\(링크의 반대편에 있음\)에 도달하도록 결정합니다. 실패한 링크\). 그런 다음 LSR-F는 데이터 패킷을 출구 노드에 대한 작업 경로 F-\>E로 다시 래핑합니다. 이 보호 체계에서 트래픽은 B-A-B-C-D-E-F-E 경로를 따릅니다.

이 보호 체계는 링에 있는 서로 다른 LSR 간의 조정이 필요하지 않다는 점에서 간단합니다. 오류를 감지한 LSR만이 래핑된 데이터 경로\(근거리 끝에서\)로 또는 다시 트래픽을 래핑해야 합니다. 작업 경로\(맨 끝\)로 이동합니다. 그러나 단방향 오류 조건의 경우에도 동일 라우팅된 양방향 LSP에서 트래픽을 유지하려면 보호 경로로의 전환 조정이 필요합니다.

포장 보호 사용을 고려할 때 다음 사항을 고려해야 합니다.

o 노드 수준 보호를 사용할 때 연결 오류 또는 연속성 손실의 감지는 링크 수준 및/또는 LSR별로 수행되어야 합니다. 수행 중인 보호 구성\(예: 링크 보호 또는 노드 보호\)은 적절한 보호 경로 구성이 이 결정에 따라 달라지므로 선험적으로 수행되어야 합니다.

o 감지된 오류의 두 이웃 사이를 연결하기 위해 링 주위의 대체 경로를 통과하는 데이터 경로를 정의할 필요가 있습니다. LSP의 링크와 노드를 모두 보호하는 경우 N 노드가 있는 링의 경우 O\(2N\) 대체 경로가 필요합니다.

o 래핑할 때 데이터는 일부 링크를 통해 각 방향으로 한 번씩, 두 번 전송됩니다. 예를 들어 위 그림에서 트래픽은 B-\>A, A-\>B로 전송되고 나중에는 E-\>F, F-\>E로 전송됩니다. 이는 이 보호를 위해 추가 대역폭이 필요하다는 것을 의미합니다.

o 링에서 이중 오류 상황이 발생하면 래핑은 작업 경로에서 발생하는 수신 지점과 첫 번째 오류 위치 사이를 제외하고는 어떤 패킷도 전달할 수 없습니다. 이는 결함 위치의 이웃 사이를 연결하기 위해 래핑이 필요하다는 점을 기반으로 하며 분할된 링에서는 불가능합니다.

o 모든 대체 경로에 대한 리소스 사전 할당은 문제가 될 수 있습니다\(사용 가능한 리소스의 과도한 구독을 유발\). 그러나 이러한 대체 경로의 대부분은 동시에 사용되지 않으므로 리소스를 할당하지 않고 NMS\(네트워크 관리 시스템\)에 따라 실제 트래픽 사용량을 기반으로 링 주위에 적절한 리소스를 할당할 가능성이 있습니다.

o 래핑에는 보호 중에 전체 링을 통과한 결과로 패킷 전달 시 트래픽 대기 시간이 약간 증가합니다.

---
### **2.2.  Steering**

링 보호를 위한 두 번째 일반적인 방식인 스티어링은 링의 입구 노드에서 링 주위의 반대 방향으로 이동하는 출구 지점까지 두 개의 경로를 정의하여 링 토폴로지를 활용합니다. 이는 그림 2에 설명되어 있습니다. 여기서 트래픽이 노드 B에서 링으로 들어가고 다음을 통해 나가야 한다고 가정하면

노드 F에서는 노드 B-A-F를 통한 기본 경로와 노드 B-C-D-E-F를 통한 대체 경로를 정의할 수 있습니다. 스티어링에서 스위칭은 항상 수신 노드\(그림 2의 노드 B\)에 의해 수행됩니다. 작업 경로\(B-A-F\) 어디에서나 오류 조건이 감지되면 트래픽은 B에 의해 대체 경로\(예: B-C-D-E-F\)로 리디렉션됩니다.

```text
                       ___          ___          ___
               ======>/LSR\********/LSR\********/LSR\======>
                      \_B_/########\_A_/########\_F_/
                        *@                       @*
                        *@                       @*
                        *@                       @*
                       _*@          ___          @*_
                      /LSR\********/LSR\********/LSR\
                      \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/

                ===> connected LSP     *** physical link
                ###  working path      @@@ protection path

             Figure 2: Steering Protection in an MPLS-TP Ring
```

이 메커니즘은 선형 1:1 보호 \[RFC6372\]와 유사합니다. 링 주위의 두 경로는 작업 경로와 보호 경로 역할을 합니다. 이를 위해서는 보호 경로로 전환해야 할 필요성을 수신 노드에 알리고 수신 및 송신 노드가 전환을 조정해야 합니다. 보호 경로로 전환해야 한다는 필요성을 수신 노드에 전달해야 하며 보호되는 도메인의 두 끝점 간의 전환을 조정해야 합니다.

스티어링 아키텍처와 관련하여 다음 사항을 고려해야 합니다.

o 스티어링은 오류 상태를 수신 노드에 알릴 수 있는 오류 감지 방법에 의존합니다. 여기에는 \[RFC6371\]에 설명된 OAM 기능\(예: 원격 결함 표시, 경보 보고\)이 포함될 수 있습니다.

o 오류 상태 감지 후 수신 노드에 알리는 프로세스로 인해 보호 전환 프로세스의 대기 시간이 추가됩니다.

o 데이터 경로에 이중 대역폭이 필요하지 않지만 링 주위의 양방향에서 모든 데이터에 대해 충분한 용량을 유지하려면 링이 필요합니다.

---
### **2.3.  SPME for P2P Protection of a Ring Topology**

SPME 개념은 전송의 임의 세그먼트 관리 및 모니터링을 지원하기 위해 \[RFC5921\]에 의해 도입되었습니다. 그러나 SPME는 본질적으로 SPME에 의해 정의된 하위 경로를 통과하는 모든 LSP 트래픽을 집계하는 데 사용될 수 있는 유효한 LSP입니다. SPME는 MPLS-TP OAM 프레임워크 문서 \[RFC6371\]에 설명된 대로 OAM 메커니즘을 사용하여 모니터링할 수 있습니다.

MPLS-TP 링을 보호 도메인으로 정의할 때 MPLS-TP 링을 통과하는 모든 LSP를 보호하는 보호 메커니즘을 설계할 필요가 있습니다. 이를 위해 \(작동하는\) SPME를 링을 통과하는 전송 경로 세그먼트와 연관시킵니다. 또한 링을 중심으로 반대 방향으로 링을 횡단하는 대체\(보호\) SPME를 구성합니다. SPME의 정확한 선택은 구현되는 전송 경로 및 보호 유형에 따라 달라집니다. 이에 대해서는 다음 하위 섹션에서 자세히 설명합니다.

링 토폴로지 보호를 위한 이러한 아키텍처 구성을 기반으로 링을 통과하는 데이터를 보호하는 데 필요한 대체 경로 수를 제한할 수 있습니다. 또한 트래픽에 대해 구성된 SPME에서 모든 OAM 기능을 수행하므로 개별 LSP를 모니터링하는 대신 링의 데이터 트래픽을 모니터링하는 데 필요한 OAM 세션 수를 최소화할 수 있습니다.

다음 하위 섹션에서는 모두 1:1 선형 보호 \[RFC6372\] \[RFC6378\]를 사용하여 신호 오류가 감지될 때 보호 전환 및 조정을 수행합니다. 사용되는 SPME의 실제 구성은 방법론 선택에 따라 변경될 수 있으며 이에 대해서는 다음 섹션에서 자세히 설명합니다. 그러나 이러한 모든 구성에서 메커니즘은 기본 SPME에서 데이터 트래픽을 전송하는 동시에 기본 및 보조 SPME 모두에 OAM 기능을 적용하여 두 경로 중 하나에서 신호 오류 조건을 감지하는 것입니다. 기본 SPME에서 신호 오류가 감지되면 \[RFC6378\]에 설명된 메커니즘을 사용하여 보조 SPME로의 데이터 트래픽 전환을 조정해야 합니다.

SPME가 계층적 LSP로 구현된다고 가정하면 레이블 스택\[LI\]을 사용하여 LSR-B에 도착하는 패킷은 LSR-B에 푸시된 SPME 레이블을 가지며 LSP 레이블은 예상되는 레이블로 교체됩니다. 송신 LSR\(즉, 패킷은 \[PA1\(B\) | LE\]의 레이블 스택을 사용하여 LSR-A에 도착하고 \[PE1\(F\) | LE\]를 사용하여 LSR-F에 도착합니다\). SPME 라벨은 LSR-F에 의해 팝되고 LSP 라벨은 LSR-F에서 적절하게 처리되어 LSP를 따라 링 외부로 전달됩니다. 이 시나리오는 이 기본 SPME에 의해 집계되는 모든 LSP에 적용됩니다.

---
#### **2.3.1.  Path SPME for Steering**

링의 일부를 통과하는 P2P SPME에는 두 개의 유지 관리 엔터티 그룹 끝점\(MEP\)이 있으며, 각각은 양방향 SPME의 한 방향에서 수신 및 송신 역할을 합니다. SPME가 링을 통과하므로 링의 또 다른 특성을 활용할 수 있습니다. 즉, 두 MEP 사이에는 항상 대체 경로가 있습니다. 즉, 반대 방향으로 링을 통과하는 것입니다. 이 대체 SPME는 LSP의 일부로 구성되고 SPME로 정의되는 작업 경로에 대한 보호 경로로 정의될 수 있습니다.

이러한 방식으로 정의된 각 SPME 쌍에 대해 MPLS-TP OAM 기능을 작동 SPME와 보호 SPME 모두에 적용하여 연결성과 연속성을 검증할 수 있습니다. 불연속성 또는 잘못된 연결이 감지되면 MEP는 이 조건을 인식하고 모든 LSP를 대체 보호 SPME로 보호 전환을 수행할 수 있습니다.

다음 그림은 더 큰 MPLS-TP 네트워크의 일부인 MPLS-TP 링을 보여줍니다. 링은 수많은 LSP가 통과할 수 있는 네트워크 세그먼트로 사용될 수 있습니다. 특히 그림은 LSR-B에서 링에 연결되고 LSR-F에서 링을 나가는 모든 LSP에 대해 링을 통해 두 개의 SPME를 구성한다는 것을 보여줍니다\(첫 번째 SPME는 B-A-F를 통과하고 두 번째 SPME는 B-C-D-E-F를 통과합니다\).

```text
                       ___          ___          ___
                =====>/LSR\********/LSR\********/LSR\======>
                      \_B_/########\_A_/########\_F_/
                        *@                       @*
                        *@                       @*
                        *@                       @*
                       _*@          ___          @*_
                      /LSR\********/LSR\********/LSR\
                      \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/

                 ===> connected LSP    *** physical link
                 ###  primary SPME     @@@ secondary SPME

                         Figure 3: An MPLS-TP Ring
```

이 보호 메커니즘은 SPME 쌍에 1:1 선형 보호 \[RFC6372\] \[RFC6378\]를 적용하는 것과 동일합니다. 정상적인 조건에서는 모든 LSP 데이터 트래픽이 작동 중인 SPME에서 전송됩니다. 선형 보호가 OAM 표시, 다른 오류 표시 트리거 또는 운영자 명령에 의해 트리거되면 MEP는 모든 LSP 데이터 패킷을 전송하기 위해 보호 SPME를 선택합니다.

보호 SPME는 오류 상태가 안정적으로 복구될 때까지 데이터 패킷을 계속 전송합니다. 복구 시, 즉 결함 상태가 해결되고 네트워크가 안정화되면 보호 도메인이 복귀 동작을 위해 구성된 경우 수신 LSR이 트래픽을 작동 중인 SPME로 다시 전환할 수 있습니다.

특히 운영자 명령의 경우 보호 전환 제어는 \[RFC6378\]에 정의된 프로토콜에 의해 다루어집니다.

---
#### **2.3.2.  Wrapping Link Protection with Segment-Based SPME**

SPME 메커니즘을 사용하여 세그먼트 기반 보호를 수행할 수 있습니다. 링의 각 링크에 대해 두 개의 SPME를 정의합니다. 첫 번째는 링크로 연결된 두 LSR 사이의 SPME이고 두 번째 SPME는 동일한 두 LSR 사이에 있지만 전체 링을 통과합니다\(연결하는 링크 제외\). LSR\). 그림 4에서는 세그먼트 연결을 통해 LSR-A와 LSR-F를 연결하는 1차 SPME와 반대 방향으로 링을 횡단하여 동일한 LSR을 연결하는 2차 SPME를 보여줍니다.

```text
                        ___          ___          ___
                       /LSR\********/LSR\********/LSR\
                       \_B_/@@@@@@@@\_A_/########\_F_/
                         *@                        *@
                         *@                        *@
                         *@                        *@
                        _*@          ___          _*@
                       /LSR\********/LSR\********/LSR\
                       \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/

                  *** physical link
                  ### primary SPME      @@@ secondary SPME

                          Figure 4: Segment SPMEs
```

이들 두 SPME\(각 LSR에서\)의 OAM 모니터링을 적용함으로써 링을 통과하는 LSP 트래픽에 대한 래핑 보호 메커니즘을 적용하는 것이 가능합니다. 세그먼트의 양쪽에 있는 LSR은 링크에 오류 상태가 있음을 식별하고 모든 LSP 트래픽을 보조 SPME로 리디렉션합니다. 트래픽은 인접한\(세그먼트에 상대적인\) LSR에 도착할 때까지 링을 통과합니다. 이 시점에서 LSP 트래픽은 인접한 SPME를 통해 원래 LSP로 리디렉션됩니다.

이 스위칭 작업을 통해 라벨 스택의 진행을 따르십시오\(LSR-B에서 링에 들어가고 LSR-E에서 링을 나가는 LSP의 경우\).

```text
   1.  The data packet arrives at LSR-A with label stack [L1+S] (i.e.,
       the top label from the LSP and bottom-of-stack indicator)
```

2. 일반적인 경우\(보호 전환 없음\) LSR-A는 레이블 스택 \[PA1\(F\) | LSE+S\]\(즉, SPME 송신이 허용되도록 LSP의 레이블을 교체하고 기본 SPME의 레이블을 LSR-A에서 LSR-F로 푸시합니다.\)

3. 보호 전환이 적용되면 LSR-A는 레이블 스택 \[PA2\(B\) | LSE+S\] \(즉, LSR-A는 하위 레벨 LSP의 레이블을 교체한 후 LSR-A에서 LSR-F로 보조 SPME의 레이블을 푸시합니다.\) 이는 LSR-E가 라벨 스택 \[PE2\(F\) | LSE+S\].

4. 패킷이 LSR-F에 도착하면 SPME 레이블을 팝하고 LSP 레이블을 처리한 후 패킷을 다음 지점으로 전달합니다. 다음 세그먼트도 마찬가지로 보호되는 경우 SPME 레이블을 푸시할 수 있습니다.

---
#### **2.3.3.  Wrapping Node Protection**

노드 수준에서의 보호 구현은 이전 하위 섹션에서 설명한 메커니즘과 유사합니다. 차이점은 사용되는 SPME에 있습니다. 노드 보호를 위해 기본 SPME는 보호되는 노드에 연결된 두 LSR 사이에 구성되며\(그림 5의 LSR-F를 통해 LSR-A와 LSR-E 사이의 SPME 참조\) 보조 SPME는 링을 돌아서 동일한 노드 사이에 구성됩니다\(그림 5의 보조 SPME 참조\).

```text
                        ___          ___          ___
                       /LSR\********/LSR\********/LSR\
                       \_B_/@@@@@@@@\_A_/########\_F_/
                         *@                        *#
                         *@                        *#
                         *@                        *#
                        _*@          ___          _*#
                       /LSR\********/LSR\********/LSR\
                       \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/

                  *** physical link
                  ### primary SPME      @@@ secondary SPME

                      Figure 5: Node-Protection SPMEs
```

보호 메커니즘은 비슷하게 작동합니다. 즉, 1:1 선형 보호\[RFC6372\]를 기반으로 하며 두 SPME 모두에서 OAM 기능에 의해 트리거됩니다. 이는 데이터 패킷을 SPME의 수신 MEP\(예: 그림의 LSR-A\)에서 보조 SPME로 래핑하고 송신 MEP\(예: 그림의 LSR-E\)에서 LSP의 연속으로 다시 래핑합니다. SPME.

---
#### **2.3.4.  Wrapping for Link and Node Protection**

섹션 2.3.2 및 섹션 2.3.3에 제시된 다양한 유형의 래핑에는 보호 메커니즘이 링크 장애 또는 노드 장애로부터 보호하는지 여부를 선험적으로 결정해야 한다는 제한이 있습니다. 또한, 결함을 감지한 이웃 LSR은 링크 실패인지 노드 실패인지 쉽게 구별할 수 없습니다.

그림 6에 표시된 링 구성에 도달하면 링크 및 노드 오류 모두를 보호하기 위해 추가 SPME를 구성할 수 있습니다. 여기에는 세 가지 보호 SPME가 구성되어 있습니다.

o 보조 노드#1은 LSR-F를 사용할 수 없다는 표시의 결과로 트래픽을 전환하는 데 사용됩니다. LSR-A와 LSR-E 사이의 경로로 트래픽을 리디렉션합니다.

o 보조 노드#2는 LSR-A를 사용할 수 없다는 표시의 결과로 트래픽을 전환하는 데 사용됩니다. LSR-F와 LSR-B 사이의 경로로 트래픽을 리디렉션합니다.

o 보조 세그먼트는 LSR-A와 LSR-F 사이의 세그먼트를 사용할 수 없다는 표시의 결과로 트래픽을 전환하는 데 사용됩니다. 링의 긴 회로에서 LSR-A와 LSR-F 사이의 경로로 트래픽을 리디렉션합니다.

그러나 래핑에 사용할 SPME를 선택하려면 상당한 노력이 필요하며 보호된 트래픽이 양방향에서 동일한 보호 경로를 공유하지 않게 될 수 있습니다.

```text
                          ___ ++++++++ ___          ___
                         /LSR\********/LSR\********/LSR\
                         \_B_/@@@@@@@@\_A_/########\_F_/
                         $+*@                       +*$
                         $+*@                       +*$
                         $+*@                       +*$
                         $+*@ ++++++++ ___ ++++++++ +*$
                         /LSR\********/LSR\********/LSR\
                         \_C_/@@@@@@@@\_D_/@@@@@@@@\_E_/
                              $$$$$$$$     $$$$$$$$

           *** physical link
           ### primary SPME            @@@ secondary node#1 SPME
           $$$ secondary node#2 SPME   +++ secondary segment SPME

             Figure 6: SPMEs for Protecting Segments and Node
```

---
### **2.4.  Analysis of P2P Protection**

스티어링 SPME 보호\(섹션 2.3.1\) 및 SPME 기반 래핑\(섹션 2.3.2 또는 2.3.3\)을 분석하여 다음과 같은 관찰을 할 수 있습니다\(N 노드가 있는 링을 기반으로 하며 여기서 N은 16 이하임\).

o 구성해야 하는 SPME 수

- 조향용: O\(2N^2\). 각 수신 LSR에서 링의 다른 노드 각각으로 연결되는 두 개의 SPME가 있습니다.

- 포장용 : O\(2N\). \(단, 각 지점에서 링크 장애 또는 노드 장애에 대한 보호 여부를 운영자가 선험적으로 결정해야 합니다.\)

o 각 노드의 OAM 세션 수

```text
         For steering: O(2N)
```

- 포장용 : 3개

```text
   o  Bandwidth requirements
```

- 스티어링용: 각 링크의 단일 대역폭

- 래핑의 경우: 수신 노드와 래핑 노드 사이, 두 번째 래핑 노드와 송신 노드 사이에 있는 링크의 대역폭을 두 배로 늘립니다.

```text
   o  Special considerations
```

- 스티어링의 경우: 수신 MEP에 의한 결함 상태의 OAM 감지 대기 시간입니다. \(알람 보고를 사용하면 CC-V만 사용하는 것보다 최적화할 수 있습니다.\)

- 래핑의 경우: 각 노드는 링크 장애 또는 노드 장애에 대한 보호 여부를 선험적으로 결정해야 합니다. 노드와 링크 장애를 모두 보호하려면 사용할 보호 경로를 결정하는 복잡성이 증가할 뿐만 아니라 보호되는 트래픽의 동일 라우팅도 위반됩니다.

이 분석을 바탕으로 섹션 2.3.1에 설명된 조향을 사용하는 것은 단순성으로 인해 권장되는 보호 메커니즘이 될 것입니다. 수신 및 송신 쌍으로 사용되지 않는 LSR 쌍 사이의 각 SPME를 제거함으로써 이 보호에 포함된 SPME의 수를 줄일 수 있다는 점에 유의해야 합니다.

---
#### **2.4.1.  Recommendations for Protection of P2P Paths Traversing a Ring**

제시된 분석에 따르면 선형 보호를 적용하여 링 토폴로지에서 래핑 보호 효과를 적용하는 것이 가능하지만 필요한 동작 중 일부를 해결하는 데는 특정 제한 사항이 있습니다. 제한사항은 다음과 같습니다.

o 링크 보호 또는 노드 보호 제공 여부를 사전에 구성해야 할 필요성

o 정의해야 하는 SPME의 수가 더 많습니다.

o 링에서 여러 번 실패하는 경우를 해결하기가 어렵습니다.

링 토폴로지를 보호하기 위한 스티어링 방법론을 구현하기 위해 링 내 SPME 사용을 기반으로 선형 보호를 적용하는 것은 다소 간단하고 위에 나열된 제한 사항을 극복하며 매우 잘 확장됩니다. 이러한 이유와 이전에 나열된 다른 이유로 인해 저자는 링 토폴로지를 통과하는 P2P 경로 보호를 제공하기 위해 조정 사용을 권장합니다.

---
## **3.  Point-to-Multipoint Protection**

\[RFC5654\]에서는 링 보호가 링을 통한 단방향 지점 대 다중 지점 경로에 대한 보호를 제공해야 한다고 요구합니다. 링 토폴로지는 이러한 데이터 경로를 지원하기 위한 준비된 플랫폼을 제공합니다. MPLS-TP 링의 P2MP\(point-to-multipoint\) LSP는 단일 수신 LSR과 다중 송신 LSR로 특징지어집니다. 다음 하위 섹션에서는 이러한 LSP의 링 기반 섹션 보호를 해결하는 방법을 제시합니다.

---
### **3.1.  Wrapping for P2MP LSPs**

래핑 아키텍처를 사용하여 P2MP 링 데이터 경로를 보호할 때 기본 작업은 주어진 설명과 유사합니다. 트래픽은 감지된 결함의 반대편에 있는 일반 작업 경로로 다시 래핑되어 계속해서 모든 경로로 전송됩니다. 출구 지점 중.

링 네트워크의 토폴로지를 활용하여 P2MP LSP에 적용할 때 래핑 메커니즘의 성능을 최적화하는 것이 가능합니다.

ROM-Wrapping\(Ring Optimized Multipoint Wrapping\)이라고 하는 이 향상된 메커니즘은 기존 래핑과 거의 동일하게 작동합니다. 그러나 ROM-Wrapping은 장애 위험으로 간주되는 각 노드에 대해 보호 P2MP LSP를 구성합니다. 보호 P2MP LSP는 실패 위험 노드의 업스트림 이웃과 실패 위험 노드의 다운스트림인 모든 출구 노드\(특정 LSP에 대한\) 사이에 라우팅됩니다.

그림 7을 참조하면 보호\(작업\) LSP\(A-B-{C}-{D}-E-{F}\)와 하나의 가능한 백업\(보호\) LSP를 식별할 수 있다. \(참고: 출구 노드는 중괄호로 표시됩니다.\) 이 보호 LSP는 링크 B-C의 오류로부터 보호하기 위해 링 주위에 데이터를 다시 래핑하는 데 사용됩니다. 이 보호 LSP는 손상된 작업 데이터 경로를 보완하는 출구 지점\(노드 F, D 및 C\)으로 구성된 P2MP LSP이기도 합니다.

```text
                                  |
                                  |
                                  V  Ingress
               ___               _V_                ___
              /LSR\             /LSR\**************/LSR\
           <@@\_F_/@@@@@@@@@@@@@\_A_/@@@@@@@@@@@@@@\_B_/
               @ *                                    *
               @ *                                    *
               @ *                                  XXXX Failure
               @ *                                    *
               @_*               ___                __*
              /LSR\*************/LSR\**************/LSR\
              \_E_/@@@@@@@@@@@@@\_D_/@@@@@@@@@@@@@@\_C_/
                                 @                  @
                                 @                  @
                                 V                  V

               ***  working LSP      @@@ protection LSP

                        Figure 7: P2MP ROM-Wrapping
```

이 메커니즘을 사용하면 작동 LSP의 각 노드에 대해 특정 보호 LSP를 구성해야 합니다. 아래 표에서 "X의 백업"은 노드 Y\(X에 대한 다운스트림 노드\) 또는 링크 X-Y에 영향을 미치는 오류의 결과로 노드 X에 의해 활성화되는 백업 경로입니다. \(참고: 경로의 중괄호는 송신 노드를 나타냅니다.\)

```text
                   Protected LSP: A->B->{C}->{D}->E->{F}

                        -- LINK/NODE PROTECTION --

              A's Backup:              A->{F}->E->{D}->{C}
              B's Backup:              B->A->{F}->E->{D}->{C}
              C's Backup:              C->B->A->{F}->E->{D}
              D's Backup:              D->C->B->A->{F}
              E's Backup:              E->D->C->B->A->{F}
```

ROM-Wrapping은 이 문서의 다른 섹션에 제시된 SPME 기반 보호 메커니즘과 달리 LSP 기반 보호 메커니즘이라는 점에 유의해야 합니다. 범위가 제한되어 있는 것처럼 보일 수 있지만 이 메커니즘은 P2MP 배포 체계를 기반으로 하는 많은 애플리케이션에 매우 효율적일 수 있습니다. ROM-Wrapping은 모든 네트워크 토폴로지에 적용될 수 있지만 특히 상호 연결된 링 토폴로지에 효율적입니다.

---
#### **3.1.1.  Comparison of Wrapping and ROM-Wrapping**

래핑과 ROM-Wrapping 메커니즘을 다양한 측면에서 비교하고 ROM-Wrapping이 제공하는 몇 가지 개선 사항을 보여주는 것이 가능합니다.

래핑을 위해 보호 LSP를 구성할 때 링크 보호 또는 노드 보호와 같은 특정 오류에 대한 구성이 필요합니다. 보호 방법이 노드 장애로부터 보호하도록 구성되었지만 실제 장애가 링크에 영향을 미치는 경우 가능한 경우 노드에 트래픽을 전달하지 못할 수 있습니다.

그러나 ROM-Wrapping은 노드 보호와 링크 보호 사이에 구분이 없기 때문에 이러한 제한이 없습니다. 링크 B-C 또는 노드 C에 장애가 발생하면 재라우팅은 C에 도달하려고 시도합니다. 링크에 장애가 있는 경우 트래픽은 C로 전달됩니다. 노드 C에서 오류가 발생한 경우 트래픽은 노드 D까지 올바르게 다시 라우팅되고 이 지점에서는 차단됩니다. 그러나 장애까지의 모든 송신 노드는 트래픽을 올바르게 전달할 수 있습니다.

두 번째 측면은 트래픽을 적절하게 전달하는 데 필요한 홉 수입니다. 링크 B-C에서 오류가 감지된 그림 7의 예를 참조하면 다음 표에는 보호의 데이터가 통과하는 노드 집합이 나열되어 있습니다.

```text
                              Basic Wrapping:

   A-B                   B-A-F-E-D-C              {C}-{D}-E-{F}
   "Upstream" segment    backup path              "Downstream" segment
   with respect to the                            with respect to the
   failure                                        failure

                               ROM-Wrapping:

   A-B                  B-A-{F}-E-{D}-{C}        ..
   "Upstream" segment   backup path
   with respect to the
   failure
```

두 개의 노드 목록을 비교하면 이 특별한 경우 기본 래핑을 사용할 때 통과하는 홉 수가 ROM-래핑을 사용할 때 트래픽이 통과하는 홉 수보다 훨씬 높다는 것을 알 수 있습니다. 일반적으로 기본 래핑의 홉 수는 항상 ROM-래핑의 홉 수보다 크거나 같습니다. 이는 양방향으로 교차되는 모든 링크에서 특정 대역폭 낭비를 의미합니다.

그림 7의 링 네트워크를 고려하면 대역폭 활용도를 고려하는 것이 가능합니다. 보호되는 LSP는 A부터 F까지 시계방향으로 설정되며 경로를 따라 M Mbps 대역폭이 예약됩니다. 모든 보호 LSP는 시계 반대 방향으로 사전 프로비저닝되며 각각은 예약된 대역폭 M을 가질 수도 있습니다. 이러한 LSP는 \[RFC2205\]에 설명된 대로 SE\(Shared Explicit\) 스타일에서 동일한 대역폭을 공유합니다.

시계 반대 방향으로 예약된 대역폭은 보호된 LSP가 제대로 작동할 때 사용되지 않으며 이론적으로 추가 트래픽에 사용될 수 있습니다\[RFC4427\]. 그러나 \[RFC5654\]는 그러한 추가 트래픽 지원을 요구하지 않는다는 점에 유의해야 합니다.

두 가지 복구 메커니즘에는 서로 다른 보호 대역폭이 필요합니다. 래핑의 경우 많은 링크에서 양방향으로 사용되는 대역폭은 M입니다. ROM-Wrapping의 경우 Ingress 노드에서 실제 Wrapping을 수행하는 노드까지의 링크만 양방향으로 M개의 대역폭을 사용하고, 다른 모든 링크는 시계 반대 방향으로만 M개의 대역폭을 사용합니다.

그림 7과 같이 링크 B-C에서 오류가 감지된 경우를 생각해 보십시오. 다음 표에는 각 복구 메커니즘 및 각 방향\(CW=시계 방향, CCW=반시계 방향\)에 대한 각 링크\(M과 동일한 단위\)의 대역폭 사용률이 나열되어 있습니다. \).

```text
                  +----------+----------+--------------+
                  |          | Wrapping | ROM-Wrapping |
                  +----------+----------+--------------+
                  | Link A-B |  CW+CCW  | CW+CCW       |
                  | Link A-F |    CCW   | CCW          |
                  | Link F-E |  CW+CCW  | CCW          |
                  | Link E-D |  CW+CCW  | CCW          |
                  | Link D-C |  CW+CCW  | CCW          |
                  +----------+----------+--------------+
```

---
#### **3.1.2.  Multiple Failures Comparison**

여러 오류에 대응하는 능력과 관련하여 래핑과 ROM-래핑을 추가로 비교할 수 있습니다. 래핑 복구 메커니즘에는 링 네트워크의 여러 오류를 복구할 수 있는 기능이 없지만 ROM-Wrapping은 일부 여러 오류를 복구할 수 있습니다.

예를 들어, 그림 7에 표시된 링크 B-C와 C-D에 영향을 미치는 이중 링크 오류를 생각해 보십시오. B는 오류를 감지하면 C에 도달할 대체 경로가 없기 때문에 래핑 메커니즘은 오류에서 복구할 수 없습니다. 모든 P2MP 트래픽 분실되었습니다. 그만큼

ROM-Wrapping 메커니즘은 F 및 D에 대한 백업 P2MP LSP가 올바르게 설정되고 계속해서 트래픽을 전달하기 때문에 오류로부터 부분적으로 복구할 수 있습니다.

---
### **3.2.  Steering for P2MP Paths**

MPLS-TP 링을 분기점으로 사용하는 P2MP 트래픽\(즉, 트래픽이 헤드엔드 노드에서 링으로 들어가고 여러 노드에서 링에서 나가는 경우\)을 보호할 때 1+1 선형 기반의 조정 메커니즘을 사용할 수 있습니다. 보호 \[RFC6372\]. 링의 각 노드에서 두 개의 P2MP 단방향 SPME를 구성할 수 있습니다. 그들은 링을 양방향으로 횡단합니다. 이러한 SPME는 각 링 노드에서 송신으로 구성됩니다. LSP 트래픽을 특정 LSP에 대한 적절한 출구 지점으로 보낼 수 있으려면 \[RFC5331\]에 정의된 대로 컨텍스트 라벨링을 사용해야 합니다. 이러한 라벨을 사용하는 방법은 섹션 3.2.1에서 확장됩니다.

주어진 노드에서 링에 들어가는 모든 LSP에 대해 트래픽은 두 SPME를 통해 전송되며, 각 SPME에는 특정 LSP에 대한 컨텍스트 레이블과 컨텍스트별 레이블이 있습니다. 송신 노드는 작동 중인 SPME에 도착하는 트래픽을 선택해야 합니다. 장애 조건이 식별되면 송신 노드는 두 SPME 중 해당 노드에 트래픽이 도착하는 트래픽을 선택해야 합니다. 즉, 두 SPME 중 하나\(아마도 작동 중인 SPME\)가 장애로 인해 차단되기 때문입니다. 이러한 방식으로 모든 송신 노드는 데이터 트래픽을 수신할 수 있습니다. 각 노드는 링의 수신 노드에서 연결이 있음을 감지하는 동안 작동 중인 SPME에서 들어오는 데이터를 계속 선택합니다. 특정 노드가 작동 중인 SPME로부터 연결 메시지 수신을 중단하면 보호 SPME에서 데이터 패킷을 읽도록 선택해야 함을 식별합니다.

---
#### **3.2.1.  Context Labels**

그림 8은 링의 모든 노드에 송신 지점이 있는 LSR-A에서 구성된 2개의 단방향 P2MP SPME를 보여줍니다. 시계 방향 SPME\(예: A-B-C-D-E-F\)는 LSR-A에서 링에 들어가는 P2MP LSP에 대한 모든 트래픽을 집계하고 링 노드의 모든 하위 집합에서 링 밖으로 전송되어야 하는 작업 SPME로 구성됩니다. 시계 반대 방향 SPME\(즉, A-F-E-D-C-B\)는 보호 SPME로 구성됩니다.

```text
                          ^            ^            ^
                         _|_          _|_          _|_
                  ----->/LSR\********/LSR\********/LSR\
                        \_A_/========\_B_/========\_C_/
                         +*              <+++++++++*||
                         +*                       +*||
                         +*                       +*||
                         +*                       +*||
                         +*_ ++++++++ ___ +++++++++*||
                        /LSR\********/LSR\********/LSR\
                        \_F_/<=======\_E_/========\_D_/
                          |            |            |
                          V            V            V

                ---> connected LSP      *** physical link
                ===  working SPME       +++ protection SPME

                           Figure 8: P2MP SPMEs
```

\[RFC5331\]은 컨텍스트 레이블의 개념을 정의합니다. 상황 식별 레이블은 특정 터널에 대한 상황별 레이블\(상황 식별 레이블 바로 아래에 있음\)을 해석하는 데 사용되는 상황 레이블 공간을 정의합니다. SPME 레이블은 컨텍스트를 식별하는 레이블입니다. 이는 각 홉에서 SPME 레이블을 수신하는 노드가 이를 사용하여 전달 테이블을 직접 가리키는 것이 아니라 LIB\(Label Information Base\)를 가리킨다는 의미입니다. 노드는 SPME 레이블을 수신하면 이를 검사하고 그것이 컨텍스트 레이블임을 발견하고 SPME 레이블을 제거한 다음 컨텍스트 레이블이 나타내는 LIB의 스택에서 아래의 다음 레이블을 찾습니다.

이 컨텍스트 식별 레이블 아래의 레이블은 노드의 전달 기능에서 이 패킷에 대해 수행할 작업을 결정하는 데 사용되어야 합니다. 링 토폴로지의 MPLS-TP 보호에는 두 개의 컨텍스트 LIB가 있습니다. 하나는 작동하는 SPME를 위한 컨텍스트 LIB이고, 다른 하나는 보호 SPME를 위한 컨텍스트 LIB입니다. 모든 컨텍스트 LIB에는 종단 간 LSP 레이블에 대해 정의된 동작이 있지만 각 노드의 동작은 각 SPME의 컨텍스트에서 다를 수 있습니다.

예를 들어 그림 8에 표시된 링을 사용하면 작동 SPME는 링의 각 노드에서 CW라는 컨텍스트 식별 레이블을 갖도록 구성되고 보호 SPME는 다음 노드에서 CP라는 컨텍스트 식별 레이블을 갖도록 구성됩니다. 각 노드. 특정 LSP의 경우 작업 SPME에서 사용되는 컨텍스트별 레이블을 WL\(x-y\)로 지정합니다. 여기서 이는 node-x가 패킷을 node-y로 전달할 때 사용되는 레이블입니다. 마찬가지로 보호 SPME의 상황별 레이블은 PL\(x-y\)로 지정됩니다. 레이블 값의 명시적인 예는 다음 하위 섹션에 나와 있습니다.

그림 8에 표시된 두 개의 SPME를 사용하여 LSR-A에서 링에 들어가고 링에서 LSR-C 및 LSR-E의 출구 지점을 갖는 P2MP LSP에 대해 위에 설명된 대로 1+1 선형 보호를 적용한다고 가정합니다. 레이블 스택 \[LI+S\]을 사용하여 LSR-A에 도착하는 패킷은 레이블 스택 \[CW | WL\(A-B\)\]. 그런 다음 패킷은 \[CW | WL\(B-C\)\], 여기서 WL\(B-C\)는 전달 기능에 \[LE\(C\)\]가 있는 패킷을 내보내고 레이블 스택이 있는 LSR-D에 복사본을 전달하도록 지시해야 합니다. \[CW | WL\(CD\)\].

오류 조건이 감지되면\(예: 링크 C-D에서\) 오류 지점을 넘어선 노드\(이 예에서는 노드 LSR-D, LSR-E 및 LSR-F\)가 수신을 중단합니다. 시계 방향\(작동 중인\) SPME의 데이터 패킷입니다. 그런 다음 각 LSR은 "선택기 브리지"를 전환하기 시작하고 보호\(시계 반대 방향\) SPME로부터 데이터 패킷을 수락해야 합니다. 수신 지점\(LSR-A\)에서 모든 데이터 패킷은 작동 중인 SPME와 보호 SPME 모두에서 전송되었습니다. 예제를 계속하면 LSR-A는 스택 \[CW | WL\(A-B\)\] 및 스택이 있는 LSR-F에 대한 사본 하나 \[CP | PL\(A-F\)\]. 패킷은 작동 중인 SPME에서 LSR-C에 도착하고 링에서 빠져나옵니다. LSR-E는 스택 \[CP | PL\(F-E\)\], 상황에 맞는 레이블 PL\(F-E\)은 전달 기능에 레이블 LE\(E\)가 있는 링 밖으로 복사본을 보내고 스택 \[CP | PL\(ED\)\]. 이러한 방식으로 각 송신 지점은 해당 지점에서 사용 가능한 SPME로부터 패킷을 수신합니다.

이 아키텍처에는 수신 노드가 잘못된 연결의 존재를 식별할 필요가 없으며 송신 지점에서 수신으로의 반환 경로가 필요하지 않다는 추가 이점이 있습니다.

---
#### **3.2.2.  Walk-Through Using Context Labels**

컨텍스트 레이블의 사용을 더 잘 보여주기 위해 이 섹션에 제시된 P2MP 보호 적용 사례를 살펴보겠습니다. 그림 9를 참조하면 링을 횡단하는 P2MP LSP가 있는데, LSR-B에서 링에 진입하고 LSR-D, LSR-E, LSR-H에서 분기되며 LSR-H를 넘어서는 이어지지 않습니다. 보호를 위해 LSR-B에서 시작하는 링에 2개의 P2MP 단방향 SPME가 구성됩니다. SPME 중 하나인 작업 SPME는 각 LSR\(C, D, E, F, G, H, J, K, A\)에 송신 지점으로 구성됩니다. 두 번째 SPME인 보호 SPME는 다음과 같이 구성됩니다. 각 LSR\(A, K, J, H, G, F, E, D, C\)의 출구 지점

```text
                            ^            ^           ^           ^
                            ^            ^           ^           ^
              ___ xxxxxxxxx_+_ xxxxxxxxxX+_xxxxxxxxxX+_ xxxxxxxx_+_
       xxxxx>/LSR\********/LSR\********/LSR\*******/LSR\*******/LSR\
             \_B_/========\_C_/========\_D_/=======\_E_/=======\_F_/
               *+             <+++++++++    +++++++     ++++++++*||x
               *+                                              +*||x
               *+                                              +*||x
               *+                                              +*||x
              _*++++++++++ ___ +++++++++___ ++++++++___+++++++++*||x
             /LSR\********/LSR\********/LSR\*******/LSR\*******/LSR\
             \_A_/<=======\_K_/========\_J_/=======\_H_/=======\_G_/
               +            +            +           +Xxxxxxxxxx +
               v            v            v           v           v
               v            v            v           v           v

       xxx P2MP LSP (X LSP egress)     *** physical link
       === working SPME                +++ protection SPME
                                       +>> protection SPME egress

                           Figure 9: P2MP SPMEs
```

이 예에서는 LSP 트래픽이 레이블 스택 \[99\]을 사용하여 LSR-B의 링에 들어가고 링을 떠난다고 가정합니다.

o 스택이 있는 LSR-D에서 \[199\]

o 스택이 있는 LSR-E에서 \[299\]

o 스택이 있는 LSR-H에서 \[399\]

SPME에 대한 컨텍스트 식별 레이블이 각 LSR에서 다른 값으로 구성되는 것이 가능하지만, 이 예에서는 각 LSR에서 작동하는 SPME에 대한 컨텍스트 식별 레이블로 200의 구성을 가정하겠습니다. 링에 있는 LSR의 400개는 각 LSR의 보호 SPME에 대한 컨텍스트 식별 레이블입니다.

연결된 특정 LSP에 대해 다음과 같은 상황별 레이블을 구성합니다.

```text
   +------+-----------------------------+------------------------------+
   | node | W-context(200)              | P-context(400)               |
   +------+-----------------------------+------------------------------+
   |   A  | 65 {drop packet}            | 165 {fwd w/ [400 | 190]}     |
   |   C  | 90 {fwd w/ [200 | 80]}      | 190 {drop packet}            |
   |   D  | 80 {fwd w/ [200 | 75] +     | 180 {egress w/ [199]}        |
   |      | egress w/ [199]}            |                              |
   |   E  | 75 {fwd w/ [200 | 65] +     | 175 {fwd w/ [400 | 180] +    |
   |      | egress w/ [299]}            | egress w/ [299]}             |
   |   F  | 65 {fwd w/ [200 | 55]}      | 165 {fwd w/ [400 | 175]}     |
   |   G  | 55 {fwd w/ [200 | 45]}      | 155 {fwd w/ [400 | 165]}     |
   |   H  | 45 {egress w/ [399]}        | 145 {fwd w/ [400 | 155] +    |
   |      |                             | egress w/ [399]}             |
   |   J  | 65 {drop packet}            | 165 {fwd w/ [400 | 145]}     |
   |   K  | 65 {drop packet}            | 190 {fwd w/ [400 | 165]}     |
   +------+-----------------------------+------------------------------+
```

패킷이 스택\[99\]을 사용하여 LSP에서 LSR-B로 도착하면 전달 기능은 패킷을 스택\[200 | 90\] 및 스택이 있는 보호 SPME \[400 | 165\]. SPME의 각 LSR은 최상위 레이블\(예: 200 또는 400\)을 컨텍스트 식별 레이블로 식별하고 스택의 다음 레이블을 사용하여 특정 컨텍스트 테이블에서 전달 작업을 선택합니다.

따라서 LSR-C에서 작동 중인 SPME의 패킷은 스택 \[200 | 90\], 200은 위 표의 중간 열을 가리킵니다. 200을 팝한 후 다음 레이블, 즉 90은 "fwd w/ \[200 | 80\]" 전달 작업을 선택하고 패킷은 스택 \[200 | 80\]을 사용하여 LSR-D로 전달됩니다. 80\]. 이러한 방식으로 패킷은 컨텍스트 테이블에 구성된 동작에 따라 두 SPME를 통해 전달됩니다. 그러나 LSR-D, LSR-E 및 LSR-H의 송신 지점은 각각 선택기 브리지로 구성되므로 작동 중인 SPME의 입력만 사용합니다. 이러한 송신 지점 중 하나라도 작동 중인 SPME에 연결 오류가 있음을 식별하면 선택기 브리지는 LSR이 보호 SPME의 입력을 읽도록 합니다.

---
## **4.  Coordination Protocol**

생존 가능성 프레임워크 \[RFC6372\]는 보호되는 양방향 도메인의 끝점 간에 보호 전환을 조정할 필요가 있음을 나타냅니다. 양방향 전송 경로의 동일 라우팅 특성을 유지하려면 특별한 경우에 조정이 필요합니다. 이것이 필요한 특별한 경우에는 단방향 오류 감지 또는 운영자 명령이 사용되는 경우가 포함됩니다.

단일 링 토폴로지를 보호하기 위해 선형 보호에 대해 \[RFC6378\]에 정의된 동일한 메커니즘을 사용함으로써 보호 도메인의 끝점 간의 이러한 조정에 대한 일관된 솔루션을 얻을 수 있습니다. \[RFC6378\]에 명시된 보호 상태 조정 프로토콜은 강제 전환과 같은 운영자 명령에 대한 지원을 포함하여 모든 조정 사례에 대한 적용 범위를 제공합니다.

---
## **5.  Conclusions and Recommendations**

링 토폴로지는 기존 전송 네트워크에서 널리 사용되며 다양한 이유로 계속 사용될 것입니다. MPLS 네트워크 내에서 링을 통과하는 전송 경로에 대한 보호는 \[RFC6372\]에 정의된 대로 선형 보호의 적절한 인스턴스를 적용하여 제공될 수 있습니다. 이 문서는 전통적인 링 보호 아키텍처 각각에 대해 \[RFC5921\] 및 \[RFC6371\]에 정의된 SPME\(Sub-Path Maintenance Entity\) 사용을 기반으로 효율적인 적용 범위를 제공하는 선형 보호 애플리케이션이 있음을 보여주었습니다. . 예를 들어:

o P2P 스티어링 - 링의 입구 노드에서 링의 출구 노드까지 2개의 SPME 구성 및 1:1 선형 보호입니다.

o 링크 보호를 위한 P2P 래핑 - 두 개의 SPME 구성\(하나는 보호 링크용, 다른 하나는 두 인접 노드 사이의 긴 경로용\) 및 1:1 선형 보호입니다.

o 노드 보호를 위한 P2P 래핑 - 보호 노드의 두 이웃 사이에 하나, 긴 경로에 있는 두 노드 사이에 하나, 1:1 선형 보호로 구성된 두 개의 SPME 구성입니다.

o P2MP 래핑 - 적절한 분기 노드에서 데이터를 내보내는 적절한 보호 경로를 구성하여 래핑 성능을 최적화할 수 있습니다.

o P2MP 스티어링 - 1+1 선형 보호와

- 상황에 맞는 보호 경로 라벨링을 기반으로 SPME를 구성합니다.

이 문서는 제안된 보호 아키텍처 및 메커니즘의 사용이 \[RFC5654\]에 정의된 링별 보호를 정당화하는 데 필요한 최적화를 제공한다는 것을 보여줍니다.

기본 1:1 선형 보호를 사용하는 스티어링 아키텍처를 기반으로 하는 링 토폴로지를 통한 트래픽 보호는 링을 통과하는 P2P 전송 경로 섹션에 대해 매우 효율적인 구현입니다. 스티어링은 래핑된 보호를 통해 트래픽이 두 배로 증가할 때 필요한 추가 대역폭을 줄이고 오류 감지를 복잡하게 하거나 다중 보호를 요구하지 않고 링크와 노드 오류로부터 모두 보호할 수 있는 기능을 제공하므로 링 토폴로지에서 P2P 보호를 위해 선호되는 메커니즘이어야 합니다. 경로가 구성됩니다. 이는 사실이지만 OAM 기능\(\[RFC6371\]에 설명되어 있고 다양한 문서에 지정되어 있음\)과 \[RFC6378\]에서 선형 보호를 위해 지정된 조정 프로토콜에 따라 래핑 또는 조정을 지원하는 것이 가능합니다.

---
## **6.  Security Considerations**

이 문서는 네트워크에 보안 위험을 추가하지 않습니다. 모든 보안 고려 사항은 \[RFC6378\]에 정의되어 있으며 이 문서에 포함된 정보에 대한 적용 가능성은 자연스럽게 해당 문서에 정의된 메커니즘의 적용 가능성을 따릅니다.

---
## **7.  References**
---
### **7.1.  Normative References**

\[RFC6378\] Weingarten, Y., Bryant, S., Osborne, E., Sprecher, N. 및 A. Fulignoli, "MPLS 전송 프로필\(MPLS-TP\) 선형 보호", RFC 6378, 2011년 10월.

---
### **7.2.  Informative References**

\[G.841\] ITU, "SDH 네트워크 보호 아키텍처의 유형 및 특성", ITU-T G.841, 1998년 10월.

\[RFC2205\] Braden, B., Zhang, L., Berson, S., Herzog, S. 및 S. Jamin, "RSVP\(Resource ReSerVation Protocol\) -- 버전 1 기능 사양", RFC 2205, 1997년 9월.

\[RFC4090\] Pan, P., Swallow, G. 및 A. Atlas, "빠른 경로 재설정

- LSP 터널을 위한 RSVP-TE 확장", RFC 4090, 2005년 5월.

\[RFC4427\] Mannie, E. 및 D. Papadimitriou, "GMPLS\(Generalized Multi-Protocol Label Switching\)를 위한 복구\(보호 및 복원\) 용어", RFC 4427, 2006년 3월.

\[RFC5331\] Aggarwal, R., Rekhter, Y. 및 E. Rosen, "MPLS 업스트림 레이블 할당 및 상황별 레이블 공간", RFC 5331, 2008년 8월.

\[RFC5654\] Niven-Jenkins, B., Brungard, D., Betts, M., Sprecher, N. 및 S. Ueno, "MPLS 전송 프로필의 요구 사항", RFC 5654, 2009년 9월.

\[RFC5921\] Bocci, M., Bryant, S., Frost, D., Levrau, L. 및 L. Berger, "전송 네트워크의 MPLS를 위한 프레임워크", RFC 5921, 2010년 7월.

\[RFC6371\] Busi, I. 및 D. Allan, "MPLS 기반 전송 네트워크의 운영, 관리 및 유지 관리 프레임워크", RFC 6371, 2011년 9월.

\[RFC6372\] Sprecher, N. 및 A. Farrel, "MPLS 전송 프로필\(MPLS-TP\) 생존 가능성 프레임워크", RFC 6372, 2011년 9월.

---
# **Appendix A.  Acknowledgements**

저자는 이 문서에 의견을 제시하고 개선을 제안한 모든 사람들의 큰 공헌에 감사를 표하고 싶습니다.

---
# **Appendix B.  Contributors**

저자는 이 작업에 대한 통찰력과 조언을 제공한 다음 개인에게 감사를 표하고 싶습니다.

```text
   Nurit Sprecher (NSN)

   Akira Sakurai (NEC)

   Rolf Winter (NEC)

   Eric Osborne (Cisco)
```

---
# **Authors' Addresses**

```text
   Yaacov Weingarten
   34 Hagefen St.
   Karnei Shomron,   4485500
   Israel

   Phone:
   EMail: wyaacov@gmail.com

   Stewart Bryant
   Cisco Systems
   10 New Square, Bedfont Lakes
   Feltham, Middlesex,
   TW18 8HA
   UK

   EMail: stbryant@cisco.com
```

Danielle Ceccarelli Ericsson Via A. Negrone 1/A Genova, Sestri Ponente 이탈리아

```text
   EMail: daniele.ceccarelli@ericsson.com
```

Diego Caviglia Ericsson Via A. Negrone 1/A Genova, Sestri Ponente 이탈리아

```text
   EMail: diego.caviglia@ericsson.com
```

Francesco Fondelli Ericsson Via A. Negrone 1/A Genova, Sestri Ponente 이탈리아

```text
   EMail: francesco.fondelli@ericsson.com
```

Marco Corsi Altran Via A. Negrone 1/A Genova, Sestri Ponente 이탈리아

```text
   EMail: corsi.marco@gmail.com

   Bo Wu
   ZTE Corporation
   4F, RD Building 2, Zijinghua Road
   Nanjing, Yuhuatai District
   P.R. China

   EMail: wu.bo@zte.com.cn

   Xuehui Dai

   EMail: xuehuiwfsy@gmail.com
```