   여기서 u는 왜곡과 속도의 균형을 맞추는 경험적으로 결정된 고정된 매개변수입니다. 주어진 LTP 벡터에 대해 어떤 코드북이 최상의 성능을 제공하는지는 해당 LTP 벡터에 대한 가중치 매트릭스에 따라 다릅니다. 예를 들어, 낮은 값의 W_ltp의 경우 평균 비율이 낮기 때문에 벡터가 10개인 코드북을 사용하는 것이 유리합니다. 반면에 큰 W_ltp의 경우 40개의 벡터가 있는 코드북을 사용하는 것이 더 나은 경우가 많습니다. 왜냐하면 최상의 코드북 벡터를 포함할 가능성이 더 높기 때문입니다. 가중치 행렬 W_ltp는 주로 입력 신호의 두 가지 측면에 따라 달라집니다. 첫 번째는 신호의 주기성입니다. 주기적일수록 W_ltp는 더 커집니다. 두 번째는 한 피치 지연된 신호에 비해 현재 서브프레임의 신호 에너지 변화입니다. 에너지가 감소하면 에너지가 증가하는 것보다 W_ltp가 더 커집니다. 두 측면 모두 비교적 느리게 변동하므로 한 프레임의 서로 다른 서브프레임에 대한 W_ltp 행렬이 자주 발생합니다.