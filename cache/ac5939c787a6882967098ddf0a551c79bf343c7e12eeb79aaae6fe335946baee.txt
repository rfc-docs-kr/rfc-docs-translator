   TLS의 모든 버전에서는 extensions 필드가 선택적으로 compression_methods 필드 뒤에 오는 것을 허용합니다. TLS 1.3 ClientHello 메시지는 항상 확장자를 포함합니다(최소한 "supported_versions", 그렇지 않으면 TLS 1.2 ClientHello 메시지로 해석됨). 그러나 TLS 1.3 서버는 이전 버전의 TLS에서 확장 필드 없이 ClientHello 메시지를 수신할 수 있습니다. ClientHello 끝에 있는 compression_methods 필드 다음에 오는 바이트가 있는지 여부를 확인하여 확장의 존재를 감지할 수 있습니다. 선택적 데이터를 감지하는 이 방법은 가변 길이 필드를 갖는 일반적인 TLS 방법과 다르지만 확장이 정의되기 전에 TLS와의 호환성을 위해 사용됩니다. TLS 1.3 서버는 이 검사를 먼저 수행해야 하며 "supported_versions" 확장자가 있는 경우에만 TLS 1.3 협상을 시도해야 합니다. 1.3 이전의 TLS 버전을 협상하는 경우 서버는 메시지가 legacy_compression_methods 이후에 데이터를 포함하지 않는지 또는 데이터가 뒤따르지 않는 유효한 확장 블록을 포함하는지 확인해야 합니다. 그렇지 않은 경우 "decode_error" 경고와 함께 핸드셰이크를 중단해야 합니다.