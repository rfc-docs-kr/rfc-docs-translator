   Windows CryptAPI 암호화 서비스 공급자는 모든 사용자와 함께 시드 상태 변수를 저장합니다. CryptGenRandom이 호출되면 호출에 제공된 임의성과 프로세스 ID, 스레드 ID, 시스템 시계, 시스템 시간, 시스템 카운터, 메모리 상태, 사용 가능한 디스크 클러스터 및 해시된 사용자와 같은 다양한 시스템 및 사용자 데이터와 결합됩니다. 환경 블록. 이 데이터는 모두 SHA-1에 공급되며 출력은 RC4 키 스트림을 시드하는 데 사용됩니다. 해당 키 스트림은 요청된 의사 난수 데이터를 생성하고 사용자의 시드 상태 변수를 업데이트하는 데 사용됩니다.