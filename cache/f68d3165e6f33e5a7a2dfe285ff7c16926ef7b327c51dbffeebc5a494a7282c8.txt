   추출기를 통한 이 단축은 HMAC가 긴 키에서도 작동하도록 정의되었으므로 반드시 필요한 것은 아닙니다. 그러나 Diffie-Hellman이 있는 TLS의 경우와 같이 IKM이 Diffie-Hellman 값이면 추출 부분을 건너뛰어서는 안 됩니다(SHOULD NOT). 그렇게 하면 Diffie-Hellman 값 g^{xy} 자체(획일적으로 무작위 또는 유사 무작위 문자열이 아님)를 HMAC의 키 PRK로 사용하게 됩니다. 대신 HKDF는 추출 단계를 g^{xy}(가급적 솔트 값 포함)에 적용하고 결과 PRK를 확장 부분의 HMAC에 대한 키로 사용해야 합니다.