터널 모드에서 "내부" IP 헤더는 최종(IP) 소스 및 대상 주소를 전달하는 반면 "외부" IP 헤더에는 IPsec "피어"의 주소(예: 보안 게이트웨이 주소)가 포함됩니다.  혼합된 내부 및 외부 IP 버전이 허용됩니다(예: IPv4를 통한 IPv6 및 IPv6을 통한 IPv4).  터널 모드에서 ESP는 전체 내부 IP 헤더를 포함하여 전체 내부 IP 패킷을 보호합니다.  외부 IP 헤더에 상대적인 터널 모드의 ESP 위치는 전송 모드의 ESP 위치와 동일합니다.  다음 다이어그램은 일반적인 IPv4 및 IPv6 패킷에 대한 ESP 터널 모드 위치 지정을 보여줍니다.